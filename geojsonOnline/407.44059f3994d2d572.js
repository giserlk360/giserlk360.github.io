(self.webpackChunkgeojson_creator_tool=self.webpackChunkgeojson_creator_tool||[]).push([[407],{8527:function(tr){tr.exports=function(){"use strict";var he=function(A,U){var ct={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},oe={on:function(Bt,Pe,cr){if(void 0===ct[Bt])throw new Error("Invalid event type: "+Bt);ct[Bt].push({selector:Pe,fn:cr})},render:function(Bt){U.store.featureChanged(Bt)}},Se=function(Bt,Pe){for(var cr=ct[Bt],ur=cr.length;ur--;){var Rr=cr[ur];if(Rr.selector(Pe)){Rr.fn.call(oe,Pe)||U.store.render(),U.ui.updateMapClasses();break}}};return A.start.call(oe),{render:A.render,stop:function(){A.stop&&A.stop()},trash:function(){A.trash&&(A.trash(),U.store.render())},combineFeatures:function(){A.combineFeatures&&A.combineFeatures()},uncombineFeatures:function(){A.uncombineFeatures&&A.uncombineFeatures()},drag:function(Bt){Se("drag",Bt)},click:function(Bt){Se("click",Bt)},mousemove:function(Bt){Se("mousemove",Bt)},mousedown:function(Bt){Se("mousedown",Bt)},mouseup:function(Bt){Se("mouseup",Bt)},mouseout:function(Bt){Se("mouseout",Bt)},keydown:function(Bt){Se("keydown",Bt)},keyup:function(Bt){Se("keyup",Bt)},touchstart:function(Bt){Se("touchstart",Bt)},touchmove:function(Bt){Se("touchmove",Bt)},touchend:function(Bt){Se("touchend",Bt)},tap:function(Bt){Se("tap",Bt)}}};function dt(A){var U=0;if(A&&A.length>0){U+=Math.abs(Tt(A[0]));for(var ct=1;ct<A.length;ct++)U-=Math.abs(Tt(A[ct]))}return U}function Tt(A){var U,ct,oe,Se,Bt,Pe,cr=0,ur=A.length;if(ur>2){for(Pe=0;Pe<ur;Pe++)Pe===ur-2?(oe=ur-2,Se=ur-1,Bt=0):Pe===ur-1?(oe=ur-1,Se=0,Bt=1):(oe=Pe,Se=Pe+1,Bt=Pe+2),U=A[oe],ct=A[Se],cr+=(s(A[Bt][0])-s(U[0]))*Math.sin(s(ct[1]));cr=6378137*cr*6378137/2}return cr}function s(A){return A*Math.PI/180}var lt_geometry=function A(U){var ct,oe=0;switch(U.type){case"Polygon":return dt(U.coordinates);case"MultiPolygon":for(ct=0;ct<U.coordinates.length;ct++)oe+=dt(U.coordinates[ct]);return oe;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(ct=0;ct<U.geometries.length;ct++)oe+=A(U.geometries[ct]);return oe}},it="mapbox-gl-draw-hot",$="mapbox-gl-draw-cold",tt="add",X="move",H="pointer",et="none",at={POLYGON:"polygon",LINE:"line_string",POINT:"point"},j="Feature",Wt="Polygon",Ct="LineString",kt="Point",gt="FeatureCollection",Pt={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},te="draw.create",Ot="draw.update",Sr="feature",qe="midpoint",ti="vertex",vn="true",Un="false",ae=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],Ve={Point:0,LineString:1,Polygon:2};function Kt(A,U){var ct=Ve[A.geometry.type]-Ve[U.geometry.type];return 0===ct&&A.geometry.type===Wt?A.area-U.area:ct}function st(A){if(this._items={},this._nums={},this._length=A?A.length:0,A)for(var U=0,ct=A.length;U<ct;U++)this.add(A[U]),void 0!==A[U]&&("string"==typeof A[U]?this._items[A[U]]=U:this._nums[A[U]]=U)}st.prototype.add=function(A){return this.has(A)||(this._length++,"string"==typeof A?this._items[A]=this._length:this._nums[A]=this._length),this},st.prototype.delete=function(A){return!1===this.has(A)||(this._length--,delete this._items[A],delete this._nums[A]),this},st.prototype.has=function(A){return!("string"!=typeof A&&"number"!=typeof A||void 0===this._items[A]&&void 0===this._nums[A])},st.prototype.values=function(){var A=this,U=[];return Object.keys(this._items).forEach(function(ct){U.push({k:ct,v:A._items[ct]})}),Object.keys(this._nums).forEach(function(ct){U.push({k:JSON.parse(ct),v:A._nums[ct]})}),U.sort(function(ct,oe){return ct.v-oe.v}).map(function(ct){return ct.k})},st.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var nt=[Sr,qe,ti],ot={click:function(A,U,ct){return Rt(A,U,ct,ct.options.clickBuffer)},touch:function(A,U,ct){return Rt(A,U,ct,ct.options.touchBuffer)}};function Rt(A,U,ct,oe){if(null===ct.map)return[];var Rr,Ae,Se=A?(void 0===(Ae=oe)&&(Ae=0),[[(Rr=A).point.x-Ae,Rr.point.y-Ae],[Rr.point.x+Ae,Rr.point.y+Ae]]):U,Bt={};ct.options.styles&&(Bt.layers=ct.options.styles.map(function(Rr){return Rr.id}));var Pe=ct.map.queryRenderedFeatures(Se,Bt).filter(function(Rr){return-1!==nt.indexOf(Rr.properties.meta)}),cr=new st,ur=[];return Pe.forEach(function(Rr){var Ae=Rr.properties.id;cr.has(Ae)||(cr.add(Ae),ur.push(Rr))}),function(Rr){return Rr.map(function(Ae){return Ae.geometry.type===Wt&&(Ae.area=lt_geometry({type:j,property:{},geometry:Ae.geometry})),Ae}).sort(Kt).map(function(Ae){return delete Ae.area,Ae})}(ur)}function ce(A,U){var ct=ot.click(A,null,U),oe={mouse:et};return ct[0]&&(oe.mouse=ct[0].properties.active===vn?X:H,oe.feature=ct[0].properties.meta),-1!==U.events.currentModeName().indexOf("draw")&&(oe.mouse=tt),U.ui.queueMapClasses(oe),U.ui.updateMapClasses(),ct[0]}function De(A,U){var ct=A.x-U.x,oe=A.y-U.y;return Math.sqrt(ct*ct+oe*oe)}function Qe(A,U,ct){void 0===ct&&(ct={});var oe=null!=ct.fineTolerance?ct.fineTolerance:4,Se=null!=ct.grossTolerance?ct.grossTolerance:12,Bt=null!=ct.interval?ct.interval:500;A.point=A.point||U.point,A.time=A.time||U.time;var Pe=De(A.point,U.point);return Pe<oe||Pe<Se&&U.time-A.time<Bt}function nr(A,U,ct){void 0===ct&&(ct={});var oe=null!=ct.tolerance?ct.tolerance:25,Se=null!=ct.interval?ct.interval:250;return A.point=A.point||U.point,A.time=A.time||U.time,De(A.point,U.point)<oe&&U.time-A.time<Se}function Xe(A,U){return A(U={exports:{}},U.exports),U.exports}var pn=Xe(function(A){var U=A.exports=function(ct,oe){if(oe||(oe=16),void 0===ct&&(ct=128),ct<=0)return"0";for(var Se=Math.log(Math.pow(2,ct))/Math.log(oe),Bt=2;Se===1/0;Bt*=2)Se=Math.log(Math.pow(2,ct/Bt))/Math.log(oe)*Bt;var Pe=Se-Math.floor(Se),cr="";for(Bt=0;Bt<Math.floor(Se);Bt++)cr=Math.floor(Math.random()*oe).toString(oe)+cr;if(Pe){var ur=Math.pow(oe,Pe);cr=Math.floor(Math.random()*ur).toString(oe)+cr}var Rr=parseInt(cr,oe);return Rr!==1/0&&Rr>=Math.pow(2,ct)?U(ct,oe):cr};U.rack=function(ct,oe,Se){var Bt=function(cr){var ur=0;do{if(ur++>10){if(!Se)throw new Error("too many ID collisions, use more bits");ct+=Se}var Rr=U(ct,oe)}while(Object.hasOwnProperty.call(Pe,Rr));return Pe[Rr]=cr,Rr},Pe=Bt.hats={};return Bt.get=function(cr){return Bt.hats[cr]},Bt.set=function(cr,ur){return Bt.hats[cr]=ur,Bt},Bt.bits=ct||128,Bt.base=oe||16,Bt}}),Kr=function(A,U){this.ctx=A,this.properties=U.properties||{},this.coordinates=U.geometry.coordinates,this.id=U.id||pn(),this.type=U.geometry.type};Kr.prototype.changed=function(){this.ctx.store.featureChanged(this.id)},Kr.prototype.incomingCoords=function(A){this.setCoordinates(A)},Kr.prototype.setCoordinates=function(A){this.coordinates=A,this.changed()},Kr.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))},Kr.prototype.setProperty=function(A,U){this.properties[A]=U},Kr.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:j,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))},Kr.prototype.internal=function(A){var U={id:this.id,meta:Sr,"meta:type":this.type,active:Un,mode:A};if(this.ctx.options.userProperties)for(var ct in this.properties)U["user_"+ct]=this.properties[ct];return{type:j,properties:U,geometry:{coordinates:this.getCoordinates(),type:this.type}}};var pr=function(A,U){Kr.call(this,A,U)};(pr.prototype=Object.create(Kr.prototype)).isValid=function(){return"number"==typeof this.coordinates[0]&&"number"==typeof this.coordinates[1]},pr.prototype.updateCoordinate=function(A,U,ct){this.coordinates=3===arguments.length?[U,ct]:[A,U],this.changed()},pr.prototype.getCoordinate=function(){return this.getCoordinates()};var un=function(A,U){Kr.call(this,A,U)};(un.prototype=Object.create(Kr.prototype)).isValid=function(){return this.coordinates.length>1},un.prototype.addCoordinate=function(A,U,ct){this.changed();var oe=parseInt(A,10);this.coordinates.splice(oe,0,[U,ct])},un.prototype.getCoordinate=function(A){var U=parseInt(A,10);return JSON.parse(JSON.stringify(this.coordinates[U]))},un.prototype.removeCoordinate=function(A){this.changed(),this.coordinates.splice(parseInt(A,10),1)},un.prototype.updateCoordinate=function(A,U,ct){var oe=parseInt(A,10);this.coordinates[oe]=[U,ct],this.changed()};var ei=function(A,U){Kr.call(this,A,U),this.coordinates=this.coordinates.map(function(ct){return ct.slice(0,-1)})};(ei.prototype=Object.create(Kr.prototype)).isValid=function(){return 0!==this.coordinates.length&&this.coordinates.every(function(A){return A.length>2})},ei.prototype.incomingCoords=function(A){this.coordinates=A.map(function(U){return U.slice(0,-1)}),this.changed()},ei.prototype.setCoordinates=function(A){this.coordinates=A,this.changed()},ei.prototype.addCoordinate=function(A,U,ct){this.changed();var oe=A.split(".").map(function(Se){return parseInt(Se,10)});this.coordinates[oe[0]].splice(oe[1],0,[U,ct])},ei.prototype.removeCoordinate=function(A){this.changed();var U=A.split(".").map(function(oe){return parseInt(oe,10)}),ct=this.coordinates[U[0]];ct&&(ct.splice(U[1],1),ct.length<3&&this.coordinates.splice(U[0],1))},ei.prototype.getCoordinate=function(A){var U=A.split(".").map(function(oe){return parseInt(oe,10)});return JSON.parse(JSON.stringify(this.coordinates[U[0]][U[1]]))},ei.prototype.getCoordinates=function(){return this.coordinates.map(function(A){return A.concat([A[0]])})},ei.prototype.updateCoordinate=function(A,U,ct){this.changed();var oe=A.split("."),Se=parseInt(oe[0],10),Bt=parseInt(oe[1],10);void 0===this.coordinates[Se]&&(this.coordinates[Se]=[]),this.coordinates[Se][Bt]=[U,ct]};var Kn={MultiPoint:pr,MultiLineString:un,MultiPolygon:ei},Gn=function(A,U,ct,oe,Se){var Bt=ct.split("."),Pe=parseInt(Bt[0],10),cr=Bt[1]?Bt.slice(1).join("."):null;return A[Pe][U](cr,oe,Se)},Mn=function(A,U){if(Kr.call(this,A,U),delete this.coordinates,this.model=Kn[U.geometry.type],void 0===this.model)throw new TypeError(U.geometry.type+" is not a valid type");this.features=this._coordinatesToFeatures(U.geometry.coordinates)};function on(A){this.map=A.map,this.drawConfig=JSON.parse(JSON.stringify(A.options||{})),this._ctx=A}(Mn.prototype=Object.create(Kr.prototype))._coordinatesToFeatures=function(A){var U=this,ct=this.model.bind(this);return A.map(function(oe){return new ct(U.ctx,{id:pn(),type:j,properties:{},geometry:{coordinates:oe,type:U.type.replace("Multi","")}})})},Mn.prototype.isValid=function(){return this.features.every(function(A){return A.isValid()})},Mn.prototype.setCoordinates=function(A){this.features=this._coordinatesToFeatures(A),this.changed()},Mn.prototype.getCoordinate=function(A){return Gn(this.features,"getCoordinate",A)},Mn.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map(function(A){return A.type===Wt?A.getCoordinates():A.coordinates})))},Mn.prototype.updateCoordinate=function(A,U,ct){Gn(this.features,"updateCoordinate",A,U,ct),this.changed()},Mn.prototype.addCoordinate=function(A,U,ct){Gn(this.features,"addCoordinate",A,U,ct),this.changed()},Mn.prototype.removeCoordinate=function(A){Gn(this.features,"removeCoordinate",A),this.changed()},Mn.prototype.getFeatures=function(){return this.features},on.prototype.setSelected=function(A){return this._ctx.store.setSelected(A)},on.prototype.setSelectedCoordinates=function(A){var U=this;this._ctx.store.setSelectedCoordinates(A),A.reduce(function(ct,oe){return void 0===ct[oe.feature_id]&&(ct[oe.feature_id]=!0,U._ctx.store.get(oe.feature_id).changed()),ct},{})},on.prototype.getSelected=function(){return this._ctx.store.getSelected()},on.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()},on.prototype.isSelected=function(A){return this._ctx.store.isSelected(A)},on.prototype.getFeature=function(A){return this._ctx.store.get(A)},on.prototype.select=function(A){return this._ctx.store.select(A)},on.prototype.deselect=function(A){return this._ctx.store.deselect(A)},on.prototype.deleteFeature=function(A,U){return void 0===U&&(U={}),this._ctx.store.delete(A,U)},on.prototype.addFeature=function(A){return this._ctx.store.add(A)},on.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()},on.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()},on.prototype.setActionableState=function(A){return void 0===A&&(A={}),this._ctx.events.actionable({trash:A.trash||!1,combineFeatures:A.combineFeatures||!1,uncombineFeatures:A.uncombineFeatures||!1})},on.prototype.changeMode=function(A,U,ct){return void 0===U&&(U={}),void 0===ct&&(ct={}),this._ctx.events.changeMode(A,U,ct)},on.prototype.updateUIClasses=function(A){return this._ctx.ui.queueMapClasses(A)},on.prototype.activateUIButton=function(A){return this._ctx.ui.setActiveButton(A)},on.prototype.featuresAt=function(A,U,ct){if(void 0===ct&&(ct="click"),"click"!==ct&&"touch"!==ct)throw new Error("invalid buffer type");return ot[ct](A,U,this._ctx)},on.prototype.newFeature=function(A){var U=A.geometry.type;return U===kt?new pr(this._ctx,A):U===Ct?new un(this._ctx,A):U===Wt?new ei(this._ctx,A):new Mn(this._ctx,A)},on.prototype.isInstanceOf=function(A,U){if(A===kt)return U instanceof pr;if(A===Ct)return U instanceof un;if(A===Wt)return U instanceof ei;if("MultiFeature"===A)return U instanceof Mn;throw new Error("Unknown feature class: "+A)},on.prototype.doRender=function(A){return this._ctx.store.featureChanged(A)},on.prototype.onSetup=function(){},on.prototype.onDrag=function(){},on.prototype.onClick=function(){},on.prototype.onMouseMove=function(){},on.prototype.onMouseDown=function(){},on.prototype.onMouseUp=function(){},on.prototype.onMouseOut=function(){},on.prototype.onKeyUp=function(){},on.prototype.onKeyDown=function(){},on.prototype.onTouchStart=function(){},on.prototype.onTouchMove=function(){},on.prototype.onTouchEnd=function(){},on.prototype.onTap=function(){},on.prototype.onStop=function(){},on.prototype.onTrash=function(){},on.prototype.onCombineFeature=function(){},on.prototype.onUncombineFeature=function(){},on.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};var bi={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},To=Object.keys(bi);function gi(A){return[].concat(A).filter(function(U){return void 0!==U})}function vo(){var A=this;if(!A.ctx.map||void 0===A.ctx.map.getSource(it))return ur();var U=A.ctx.events.currentModeName();A.ctx.ui.queueMapClasses({mode:U});var ct=[],oe=[];A.isDirty?oe=A.getAllIds():(ct=A.getChangedIds().filter(function(Rr){return void 0!==A.get(Rr)}),oe=A.sources.hot.filter(function(Rr){return Rr.properties.id&&-1===ct.indexOf(Rr.properties.id)&&void 0!==A.get(Rr.properties.id)}).map(function(Rr){return Rr.properties.id})),A.sources.hot=[];var Se=A.sources.cold.length;A.sources.cold=A.isDirty?[]:A.sources.cold.filter(function(Rr){return-1===ct.indexOf(Rr.properties.id||Rr.properties.parent)});var Bt=Se!==A.sources.cold.length||oe.length>0;function Pe(Rr,Ae){var sr=A.get(Rr).internal(U);A.ctx.events.currentModeRender(sr,function(hr){A.sources[Ae].push(hr)})}if(ct.forEach(function(Rr){return Pe(Rr,"hot")}),oe.forEach(function(Rr){return Pe(Rr,"cold")}),Bt&&A.ctx.map.getSource($).setData({type:gt,features:A.sources.cold}),A.ctx.map.getSource(it).setData({type:gt,features:A.sources.hot}),A._emitSelectionChange&&(A.ctx.map.fire("draw.selectionchange",{features:A.getSelected().map(function(Rr){return Rr.toGeoJSON()}),points:A.getSelectedCoordinates().map(function(Rr){return{type:j,properties:{},geometry:{type:kt,coordinates:Rr.coordinates}}})}),A._emitSelectionChange=!1),A._deletedFeaturesToEmit.length){var cr=A._deletedFeaturesToEmit.map(function(Rr){return Rr.toGeoJSON()});A._deletedFeaturesToEmit=[],A.ctx.map.fire("draw.delete",{features:cr})}function ur(){A.isDirty=!1,A.clearChangedIds()}ur(),A.ctx.map.fire("draw.render",{})}function On(A){var U,ct=this;this._features={},this._featureIds=new st,this._selectedFeatureIds=new st,this._selectedCoordinates=[],this._changedFeatureIds=new st,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=A,this.sources={hot:[],cold:[]},this.render=function(){U||(U=requestAnimationFrame(function(){U=null,vo.call(ct)}))},this.isDirty=!1}function or(A,U){var ct=A._selectedCoordinates.filter(function(oe){return A._selectedFeatureIds.has(oe.feature_id)});A._selectedCoordinates.length===ct.length||U.silent||(A._emitSelectionChange=!0),A._selectedCoordinates=ct}On.prototype.createRenderBatch=function(){var A=this,U=this.render,ct=0;return this.render=function(){ct++},function(){A.render=U,ct>0&&A.render()}},On.prototype.setDirty=function(){return this.isDirty=!0,this},On.prototype.featureChanged=function(A){return this._changedFeatureIds.add(A),this},On.prototype.getChangedIds=function(){return this._changedFeatureIds.values()},On.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this},On.prototype.getAllIds=function(){return this._featureIds.values()},On.prototype.add=function(A){return this.featureChanged(A.id),this._features[A.id]=A,this._featureIds.add(A.id),this},On.prototype.delete=function(A,U){var ct=this;return void 0===U&&(U={}),gi(A).forEach(function(oe){ct._featureIds.has(oe)&&(ct._featureIds.delete(oe),ct._selectedFeatureIds.delete(oe),U.silent||-1===ct._deletedFeaturesToEmit.indexOf(ct._features[oe])&&ct._deletedFeaturesToEmit.push(ct._features[oe]),delete ct._features[oe],ct.isDirty=!0)}),or(this,U),this},On.prototype.get=function(A){return this._features[A]},On.prototype.getAll=function(){var A=this;return Object.keys(this._features).map(function(U){return A._features[U]})},On.prototype.select=function(A,U){var ct=this;return void 0===U&&(U={}),gi(A).forEach(function(oe){ct._selectedFeatureIds.has(oe)||(ct._selectedFeatureIds.add(oe),ct._changedFeatureIds.add(oe),U.silent||(ct._emitSelectionChange=!0))}),this},On.prototype.deselect=function(A,U){var ct=this;return void 0===U&&(U={}),gi(A).forEach(function(oe){ct._selectedFeatureIds.has(oe)&&(ct._selectedFeatureIds.delete(oe),ct._changedFeatureIds.add(oe),U.silent||(ct._emitSelectionChange=!0))}),or(this,U),this},On.prototype.clearSelected=function(A){return void 0===A&&(A={}),this.deselect(this._selectedFeatureIds.values(),{silent:A.silent}),this},On.prototype.setSelected=function(A,U){var ct=this;return void 0===U&&(U={}),A=gi(A),this.deselect(this._selectedFeatureIds.values().filter(function(oe){return-1===A.indexOf(oe)}),{silent:U.silent}),this.select(A.filter(function(oe){return!ct._selectedFeatureIds.has(oe)}),{silent:U.silent}),this},On.prototype.setSelectedCoordinates=function(A){return this._selectedCoordinates=A,this._emitSelectionChange=!0,this},On.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this},On.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()},On.prototype.getSelected=function(){var A=this;return this._selectedFeatureIds.values().map(function(U){return A.get(U)})},On.prototype.getSelectedCoordinates=function(){var A=this;return this._selectedCoordinates.map(function(U){return{coordinates:A.get(U.feature_id).getCoordinate(U.coord_path)}})},On.prototype.isSelected=function(A){return this._selectedFeatureIds.has(A)},On.prototype.setFeatureProperty=function(A,U,ct){this.get(A).setProperty(U,ct),this.featureChanged(A)},On.prototype.storeMapConfig=function(){var A=this;ae.forEach(function(U){A.ctx.map[U]&&(A._mapInitialConfig[U]=A.ctx.map[U].isEnabled())})},On.prototype.restoreMapConfig=function(){var A=this;Object.keys(this._mapInitialConfig).forEach(function(U){A._mapInitialConfig[U]?A.ctx.map[U].enable():A.ctx.map[U].disable()})},On.prototype.getInitialConfigValue=function(A){return void 0===this._mapInitialConfig[A]||this._mapInitialConfig[A]};var wi=function(){for(var A=arguments,U={},ct=0;ct<arguments.length;ct++){var oe=A[ct];for(var Se in oe)Y.call(oe,Se)&&(U[Se]=oe[Se])}return U},Y=Object.prototype.hasOwnProperty,W=["mode","feature","mouse"];function pt(A){var U=null,ct=null,oe={onRemove:function(){return A.map.off("load",oe.connect),clearInterval(ct),oe.removeLayers(),A.store.restoreMapConfig(),A.ui.removeButtons(),A.events.removeEventListeners(),A.ui.clearMapClasses(),A.map=null,A.container=null,A.store=null,U&&U.parentNode&&U.parentNode.removeChild(U),U=null,this},connect:function(){A.map.off("load",oe.connect),clearInterval(ct),oe.addLayers(),A.store.storeMapConfig(),A.events.addEventListeners()},onAdd:function(Se){var Bt=Se.fire;return Se.fire=function(Pe,cr){var ur=arguments;return 1===Bt.length&&1!==arguments.length&&(ur=[wi({},{type:Pe},cr)]),Bt.apply(Se,ur)},A.map=Se,A.events=function(Pe){var cr=Object.keys(Pe.options.modes).reduce(function($e,Vr){return $e[Vr]=function oa(A){var U=Object.keys(A);return function(ct,oe){void 0===oe&&(oe={});var Se={},Bt=U.reduce(function(Pe,cr){return Pe[cr]=A[cr],Pe},new on(ct));return{start:function(){var Pe=this;Se=Bt.onSetup(oe),To.forEach(function(cr){var ur,Rr=bi[cr],Ae=function(){return!1};A[Rr]&&(Ae=function(){return!0}),Pe.on(cr,Ae,(ur=Rr,function(sr){return Bt[ur](Se,sr)}))})},stop:function(){Bt.onStop(Se)},trash:function(){Bt.onTrash(Se)},combineFeatures:function(){Bt.onCombineFeatures(Se)},uncombineFeatures:function(){Bt.onUncombineFeatures(Se)},render:function(Pe,cr){Bt.toDisplayFeatures(Se,Pe,cr)}}}}(Pe.options.modes[Vr]),$e},{}),ur={},Rr={},Ae={},sr=null,hr=null;Ae.drag=function($e,Vr){Vr({point:$e.point,time:(new Date).getTime()})?(Pe.ui.queueMapClasses({mouse:"drag"}),hr.drag($e)):$e.originalEvent.stopPropagation()},Ae.mousedrag=function($e){Ae.drag($e,function(Vr){return!Qe(ur,Vr)})},Ae.touchdrag=function($e){Ae.drag($e,function(Vr){return!nr(Rr,Vr)})},Ae.mousemove=function($e){if(1===(void 0!==$e.originalEvent.buttons?$e.originalEvent.buttons:$e.originalEvent.which))return Ae.mousedrag($e);var Vr=ce($e,Pe);$e.featureTarget=Vr,hr.mousemove($e)},Ae.mousedown=function($e){ur={time:(new Date).getTime(),point:$e.point};var Vr=ce($e,Pe);$e.featureTarget=Vr,hr.mousedown($e)},Ae.mouseup=function($e){var Vr=ce($e,Pe);$e.featureTarget=Vr,Qe(ur,{point:$e.point,time:(new Date).getTime()})?hr.click($e):hr.mouseup($e)},Ae.mouseout=function($e){hr.mouseout($e)},Ae.touchstart=function($e){if($e.originalEvent.preventDefault(),Pe.options.touchEnabled){Rr={time:(new Date).getTime(),point:$e.point};var Vr=ot.touch($e,null,Pe)[0];$e.featureTarget=Vr,hr.touchstart($e)}},Ae.touchmove=function($e){if($e.originalEvent.preventDefault(),Pe.options.touchEnabled)return hr.touchmove($e),Ae.touchdrag($e)},Ae.touchend=function($e){if($e.originalEvent.preventDefault(),Pe.options.touchEnabled){var Vr=ot.touch($e,null,Pe)[0];$e.featureTarget=Vr,nr(Rr,{time:(new Date).getTime(),point:$e.point})?hr.tap($e):hr.touchend($e)}};var Dr=function($e){return!(8===$e||46===$e||$e>=48&&$e<=57)};function Tn($e,Vr,Qn){void 0===Qn&&(Qn={}),hr.stop();var en=cr[$e];if(void 0===en)throw new Error($e+" is not valid");sr=$e;var ci=en(Pe,Vr);hr=he(ci,Pe),Qn.silent||Pe.map.fire("draw.modechange",{mode:$e}),Pe.store.setDirty(),Pe.store.render()}Ae.keydown=function($e){"mapboxgl-canvas"===($e.srcElement||$e.target).classList[0]&&(8!==$e.keyCode&&46!==$e.keyCode||!Pe.options.controls.trash?Dr($e.keyCode)?hr.keydown($e):49===$e.keyCode&&Pe.options.controls.point?Tn(Pt.DRAW_POINT):50===$e.keyCode&&Pe.options.controls.line_string?Tn(Pt.DRAW_LINE_STRING):51===$e.keyCode&&Pe.options.controls.polygon&&Tn(Pt.DRAW_POLYGON):($e.preventDefault(),hr.trash()))},Ae.keyup=function($e){Dr($e.keyCode)&&hr.keyup($e)},Ae.zoomend=function(){Pe.store.changeZoom()},Ae.data=function($e){if("style"===$e.dataType){var Vr=Pe.setup,Qn=Pe.map,ci=Pe.store;Pe.options.styles.some(function(zr){return Qn.getLayer(zr.id)})||(Vr.addLayers(),ci.setDirty(),ci.render())}};var zo={trash:!1,combineFeatures:!1,uncombineFeatures:!1};return{start:function(){hr=he(cr[sr=Pe.options.defaultMode](Pe),Pe)},changeMode:Tn,actionable:function($e){var Vr=!1;Object.keys($e).forEach(function(Qn){if(void 0===zo[Qn])throw new Error("Invalid action type");zo[Qn]!==$e[Qn]&&(Vr=!0),zo[Qn]=$e[Qn]}),Vr&&Pe.map.fire("draw.actionable",{actions:zo})},currentModeName:function(){return sr},currentModeRender:function($e,Vr){return hr.render($e,Vr)},fire:function($e,Vr){Ae[$e]&&Ae[$e](Vr)},addEventListeners:function(){Pe.map.on("mousemove",Ae.mousemove),Pe.map.on("mousedown",Ae.mousedown),Pe.map.on("mouseup",Ae.mouseup),Pe.map.on("data",Ae.data),Pe.map.on("touchmove",Ae.touchmove),Pe.map.on("touchstart",Ae.touchstart),Pe.map.on("touchend",Ae.touchend),Pe.container.addEventListener("mouseout",Ae.mouseout),Pe.options.keybindings&&(Pe.container.addEventListener("keydown",Ae.keydown),Pe.container.addEventListener("keyup",Ae.keyup))},removeEventListeners:function(){Pe.map.off("mousemove",Ae.mousemove),Pe.map.off("mousedown",Ae.mousedown),Pe.map.off("mouseup",Ae.mouseup),Pe.map.off("data",Ae.data),Pe.map.off("touchmove",Ae.touchmove),Pe.map.off("touchstart",Ae.touchstart),Pe.map.off("touchend",Ae.touchend),Pe.container.removeEventListener("mouseout",Ae.mouseout),Pe.options.keybindings&&(Pe.container.removeEventListener("keydown",Ae.keydown),Pe.container.removeEventListener("keyup",Ae.keyup))},trash:function($e){hr.trash($e)},combineFeatures:function(){hr.combineFeatures()},uncombineFeatures:function(){hr.uncombineFeatures()},getMode:function(){return sr}}}(A),A.ui=function(Pe){var cr={},ur=null,Rr={mode:null,feature:null,mouse:null},Ae={mode:null,feature:null,mouse:null};function sr($e){Ae=wi(Ae,$e)}function hr(){var $e,Vr;if(Pe.container){var Qn=[],en=[];W.forEach(function(ci){Ae[ci]!==Rr[ci]&&(Qn.push(ci+"-"+Rr[ci]),null!==Ae[ci]&&en.push(ci+"-"+Ae[ci]))}),Qn.length>0&&($e=Pe.container.classList).remove.apply($e,Qn),en.length>0&&(Vr=Pe.container.classList).add.apply(Vr,en),Rr=wi(Rr,Ae)}}function Dr($e,Vr){void 0===Vr&&(Vr={});var Qn=document.createElement("button");return Qn.className="mapbox-gl-draw_ctrl-draw-btn "+Vr.className,Qn.setAttribute("title",Vr.title),Vr.container.appendChild(Qn),Qn.addEventListener("click",function(en){if(en.preventDefault(),en.stopPropagation(),en.target===ur)return Tn(),void Vr.onDeactivate();zo($e),Vr.onActivate()},!0),Qn}function Tn(){ur&&(ur.classList.remove("active"),ur=null)}function zo($e){Tn();var Vr=cr[$e];Vr&&Vr&&"trash"!==$e&&(Vr.classList.add("active"),ur=Vr)}return{setActiveButton:zo,queueMapClasses:sr,updateMapClasses:hr,clearMapClasses:function(){sr({mode:null,feature:null,mouse:null}),hr()},addButtons:function(){var $e=Pe.options.controls,Vr=document.createElement("div");return Vr.className="mapboxgl-ctrl-group mapboxgl-ctrl",$e&&($e[at.LINE]&&(cr[at.LINE]=Dr(at.LINE,{container:Vr,className:"mapbox-gl-draw_line",title:"LineString tool "+(Pe.options.keybindings?"(l)":""),onActivate:function(){return Pe.events.changeMode(Pt.DRAW_LINE_STRING)},onDeactivate:function(){return Pe.events.trash()}})),$e[at.POLYGON]&&(cr[at.POLYGON]=Dr(at.POLYGON,{container:Vr,className:"mapbox-gl-draw_polygon",title:"Polygon tool "+(Pe.options.keybindings?"(p)":""),onActivate:function(){return Pe.events.changeMode(Pt.DRAW_POLYGON)},onDeactivate:function(){return Pe.events.trash()}})),$e[at.POINT]&&(cr[at.POINT]=Dr(at.POINT,{container:Vr,className:"mapbox-gl-draw_point",title:"Marker tool "+(Pe.options.keybindings?"(m)":""),onActivate:function(){return Pe.events.changeMode(Pt.DRAW_POINT)},onDeactivate:function(){return Pe.events.trash()}})),$e.trash&&(cr.trash=Dr("trash",{container:Vr,className:"mapbox-gl-draw_trash",title:"Delete",onActivate:function(){Pe.events.trash()}})),$e.combine_features&&(cr.combine_features=Dr("combineFeatures",{container:Vr,className:"mapbox-gl-draw_combine",title:"Combine",onActivate:function(){Pe.events.combineFeatures()}})),$e.uncombine_features&&(cr.uncombine_features=Dr("uncombineFeatures",{container:Vr,className:"mapbox-gl-draw_uncombine",title:"Uncombine",onActivate:function(){Pe.events.uncombineFeatures()}}))),Vr},removeButtons:function(){Object.keys(cr).forEach(function($e){var Vr=cr[$e];Vr.parentNode&&Vr.parentNode.removeChild(Vr),delete cr[$e]})}}}(A),A.container=Se.getContainer(),A.store=new On(A),U=A.ui.addButtons(),A.options.boxSelect&&(Se.boxZoom.disable(),Se.dragPan.disable(),Se.dragPan.enable()),Se.loaded()?oe.connect():(Se.on("load",oe.connect),ct=setInterval(function(){Se.loaded()&&oe.connect()},16)),A.events.start(),U},addLayers:function(){A.map.addSource($,{data:{type:gt,features:[]},type:"geojson"}),A.map.addSource(it,{data:{type:gt,features:[]},type:"geojson"}),A.options.styles.forEach(function(Se){A.map.addLayer(Se)}),A.store.setDirty(!0),A.store.render()},removeLayers:function(){A.options.styles.forEach(function(Se){A.map.getLayer(Se.id)&&A.map.removeLayer(Se.id)}),A.map.getSource($)&&A.map.removeSource($),A.map.getSource(it)&&A.map.removeSource(it)}};return A.setup=oe,oe}function bt(A){return function(U){var ct=U.featureTarget;return!!ct&&!!ct.properties&&ct.properties.meta===A}}function Ft(A){return!!A.featureTarget&&!!A.featureTarget.properties&&A.featureTarget.properties.active===vn&&A.featureTarget.properties.meta===Sr}function se(A){return!!A.featureTarget&&!!A.featureTarget.properties&&A.featureTarget.properties.active===Un&&A.featureTarget.properties.meta===Sr}function me(A){return void 0===A.featureTarget}function ue(A){var U=A.featureTarget;return!!U&&!!U.properties&&U.properties.meta===ti}function Dt(A){return!!A.originalEvent&&!0===A.originalEvent.shiftKey}function Ht(A){return 27===A.keyCode}function ir(A){return 13===A.keyCode}var mr=Te;function Te(A,U){this.x=A,this.y=U}function Ye(A,U){var ct=U.getBoundingClientRect();return new mr(A.clientX-ct.left-(U.clientLeft||0),A.clientY-ct.top-(U.clientTop||0))}function vr(A,U,ct,oe){return{type:j,properties:{meta:ti,parent:A,coord_path:ct,active:oe?vn:Un},geometry:{type:kt,coordinates:U}}}function _r(A,U,ct){void 0===U&&(U={}),void 0===ct&&(ct=null);var oe,Se=A.geometry,Bt=Se.type,Pe=Se.coordinates,cr=A.properties&&A.properties.id,ur=[];function Rr(sr,hr){var Dr="",Tn=null;sr.forEach(function(zo,$e){var Vr=null!=hr?hr+"."+$e:String($e),Qn=vr(cr,zo,Vr,Ae(Vr));if(U.midpoints&&Tn){var en=function(zr,Qo,ls){var Qr=Qo.geometry.coordinates,ni=ls.geometry.coordinates;if(Qr[1]>85||Qr[1]<-85||ni[1]>85||ni[1]<-85)return null;var Ao={lng:(Qr[0]+ni[0])/2,lat:(Qr[1]+ni[1])/2};return{type:j,properties:{meta:qe,parent:zr,lng:Ao.lng,lat:Ao.lat,coord_path:ls.properties.coord_path},geometry:{type:kt,coordinates:[Ao.lng,Ao.lat]}}}(cr,Tn,Qn);en&&ur.push(en)}Tn=Qn;var ci=JSON.stringify(zo);Dr!==ci&&ur.push(Qn),0===$e&&(Dr=ci)})}function Ae(sr){return!!U.selectedPaths&&-1!==U.selectedPaths.indexOf(sr)}return Bt===kt?ur.push(vr(cr,Pe,ct,Ae(ct))):Bt===Wt?Pe.forEach(function(sr,hr){Rr(sr,null!==ct?ct+"."+hr:String(hr))}):Bt===Ct?Rr(Pe,ct):0===Bt.indexOf("Multi")&&(oe=Bt.replace("Multi",""),Pe.forEach(function(sr,hr){ur=ur.concat(_r({type:j,properties:A.properties,geometry:{type:oe,coordinates:sr}},U,hr))})),ur}Te.prototype={clone:function(){return new Te(this.x,this.y)},add:function(A){return this.clone()._add(A)},sub:function(A){return this.clone()._sub(A)},multByPoint:function(A){return this.clone()._multByPoint(A)},divByPoint:function(A){return this.clone()._divByPoint(A)},mult:function(A){return this.clone()._mult(A)},div:function(A){return this.clone()._div(A)},rotate:function(A){return this.clone()._rotate(A)},rotateAround:function(A,U){return this.clone()._rotateAround(A,U)},matMult:function(A){return this.clone()._matMult(A)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(A){return this.x===A.x&&this.y===A.y},dist:function(A){return Math.sqrt(this.distSqr(A))},distSqr:function(A){var U=A.x-this.x,ct=A.y-this.y;return U*U+ct*ct},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(A){return Math.atan2(this.y-A.y,this.x-A.x)},angleWith:function(A){return this.angleWithSep(A.x,A.y)},angleWithSep:function(A,U){return Math.atan2(this.x*U-this.y*A,this.x*A+this.y*U)},_matMult:function(A){var ct=A[2]*this.x+A[3]*this.y;return this.x=A[0]*this.x+A[1]*this.y,this.y=ct,this},_add:function(A){return this.x+=A.x,this.y+=A.y,this},_sub:function(A){return this.x-=A.x,this.y-=A.y,this},_mult:function(A){return this.x*=A,this.y*=A,this},_div:function(A){return this.x/=A,this.y/=A,this},_multByPoint:function(A){return this.x*=A.x,this.y*=A.y,this},_divByPoint:function(A){return this.x/=A.x,this.y/=A.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var A=this.y;return this.y=this.x,this.x=-A,this},_rotate:function(A){var U=Math.cos(A),ct=Math.sin(A),Se=ct*this.x+U*this.y;return this.x=U*this.x-ct*this.y,this.y=Se,this},_rotateAround:function(A,U){var ct=Math.cos(A),oe=Math.sin(A),Bt=U.y+oe*(this.x-U.x)+ct*(this.y-U.y);return this.x=U.x+ct*(this.x-U.x)-oe*(this.y-U.y),this.y=Bt,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Te.convert=function(A){return A instanceof Te?A:Array.isArray(A)?new Te(A[0],A[1]):A};var Pr=function(A){setTimeout(function(){A.map&&A.map.doubleClickZoom&&A._ctx&&A._ctx.store&&A._ctx.store.getInitialConfigValue&&A._ctx.store.getInitialConfigValue("doubleClickZoom")&&A.map.doubleClickZoom.enable()},0)},He=function(A){setTimeout(function(){A.map&&A.map.doubleClickZoom&&A.map.doubleClickZoom.disable()},0)},yr=function(A){if(!A||!A.type)return null;var U=Ke[A.type];return U?"geometry"===U?{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:A}]}:"feature"===U?{type:"FeatureCollection",features:[A]}:"featurecollection"===U?A:void 0:null},Ke={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"};function wn(A){switch(A&&A.type||null){case"FeatureCollection":return A.features=A.features.reduce(function(U,ct){return U.concat(wn(ct))},[]),A;case"Feature":return A.geometry?wn(A.geometry).map(function(U){var ct={type:"Feature",properties:JSON.parse(JSON.stringify(A.properties)),geometry:U};return void 0!==A.id&&(ct.id=A.id),ct}):[A];case"MultiPoint":return A.coordinates.map(function(U){return{type:"Point",coordinates:U}});case"MultiPolygon":return A.coordinates.map(function(U){return{type:"Polygon",coordinates:U}});case"MultiLineString":return A.coordinates.map(function(U){return{type:"LineString",coordinates:U}});case"GeometryCollection":return A.geometries.map(wn).reduce(function(U,ct){return U.concat(ct)},[]);case"Point":case"Polygon":case"LineString":return[A]}}var Lr=Xe(function(A){var U=A.exports=function(Ae){return new ct(Ae)};function ct(Ae){this.value=Ae}function oe(Ae,sr,hr){var Dr=[],Tn=[],zo=!0;return function $e(Vr){var Qn=hr?Se(Vr):Vr,en={},ci=!0,zr={node:Qn,node_:Vr,path:[].concat(Dr),parent:Tn[Tn.length-1],parents:Tn,key:Dr.slice(-1)[0],isRoot:0===Dr.length,level:Dr.length,circular:null,update:function(Qr,ni){zr.isRoot||(zr.parent.node[zr.key]=Qr),zr.node=Qr,ni&&(ci=!1)},delete:function(Qr){delete zr.parent.node[zr.key],Qr&&(ci=!1)},remove:function(Qr){cr(zr.parent.node)?zr.parent.node.splice(zr.key,1):delete zr.parent.node[zr.key],Qr&&(ci=!1)},keys:null,before:function(Qr){en.before=Qr},after:function(Qr){en.after=Qr},pre:function(Qr){en.pre=Qr},post:function(Qr){en.post=Qr},stop:function(){zo=!1},block:function(){ci=!1}};if(!zo)return zr;function Qo(){if("object"==typeof zr.node&&null!==zr.node){zr.keys&&zr.node_===zr.node||(zr.keys=Bt(zr.node)),zr.isLeaf=0==zr.keys.length;for(var Qr=0;Qr<Tn.length;Qr++)if(Tn[Qr].node_===Vr){zr.circular=Tn[Qr];break}}else zr.isLeaf=!0,zr.keys=null;zr.notLeaf=!zr.isLeaf,zr.notRoot=!zr.isRoot}Qo();var ls=sr.call(zr,zr.node);return void 0!==ls&&zr.update&&zr.update(ls),en.before&&en.before.call(zr,zr.node),ci&&("object"!=typeof zr.node||null===zr.node||zr.circular||(Tn.push(zr),Qo(),ur(zr.keys,function(Qr,ni){Dr.push(Qr),en.pre&&en.pre.call(zr,zr.node[Qr],Qr);var Ao=$e(zr.node[Qr]);hr&&Rr.call(zr.node,Qr)&&(zr.node[Qr]=Ao.node),Ao.isLast=ni==zr.keys.length-1,Ao.isFirst=0==ni,en.post&&en.post.call(zr,Ao),Dr.pop()}),Tn.pop()),en.after&&en.after.call(zr,zr.node)),zr}(Ae).node}function Se(Ae){if("object"==typeof Ae&&null!==Ae){var sr;if(cr(Ae))sr=[];else if("[object Date]"===Pe(Ae))sr=new Date(Ae.getTime?Ae.getTime():Ae);else if("[object RegExp]"===Pe(Ae))sr=new RegExp(Ae);else if("[object Error]"===Pe(Ae))sr={message:Ae.message};else if(function(Tn){return"[object Boolean]"===Pe(Tn)}(Ae))sr=new Boolean(Ae);else if(function(Tn){return"[object Number]"===Pe(Tn)}(Ae))sr=new Number(Ae);else if(function(Tn){return"[object String]"===Pe(Tn)}(Ae))sr=new String(Ae);else if(Object.create&&Object.getPrototypeOf)sr=Object.create(Object.getPrototypeOf(Ae));else if(Ae.constructor===Object)sr={};else{var Dr=function(){};Dr.prototype=Ae.constructor&&Ae.constructor.prototype||Ae.__proto__||{},sr=new Dr}return ur(Bt(Ae),function(Tn){sr[Tn]=Ae[Tn]}),sr}return Ae}ct.prototype.get=function(Ae){for(var sr=this.value,hr=0;hr<Ae.length;hr++){var Dr=Ae[hr];if(!sr||!Rr.call(sr,Dr)){sr=void 0;break}sr=sr[Dr]}return sr},ct.prototype.has=function(Ae){for(var sr=this.value,hr=0;hr<Ae.length;hr++){var Dr=Ae[hr];if(!sr||!Rr.call(sr,Dr))return!1;sr=sr[Dr]}return!0},ct.prototype.set=function(Ae,sr){for(var hr=this.value,Dr=0;Dr<Ae.length-1;Dr++){var Tn=Ae[Dr];Rr.call(hr,Tn)||(hr[Tn]={}),hr=hr[Tn]}return hr[Ae[Dr]]=sr,sr},ct.prototype.map=function(Ae){return oe(this.value,Ae,!0)},ct.prototype.forEach=function(Ae){return this.value=oe(this.value,Ae,!1),this.value},ct.prototype.reduce=function(Ae,sr){var hr=1===arguments.length,Dr=hr?this.value:sr;return this.forEach(function(Tn){this.isRoot&&hr||(Dr=Ae.call(this,Dr,Tn))}),Dr},ct.prototype.paths=function(){var Ae=[];return this.forEach(function(sr){Ae.push(this.path)}),Ae},ct.prototype.nodes=function(){var Ae=[];return this.forEach(function(sr){Ae.push(this.node)}),Ae},ct.prototype.clone=function(){var Ae=[],sr=[];return function hr(Dr){for(var Tn=0;Tn<Ae.length;Tn++)if(Ae[Tn]===Dr)return sr[Tn];if("object"==typeof Dr&&null!==Dr){var zo=Se(Dr);return Ae.push(Dr),sr.push(zo),ur(Bt(Dr),function($e){zo[$e]=hr(Dr[$e])}),Ae.pop(),sr.pop(),zo}return Dr}(this.value)};var Bt=Object.keys||function(Ae){var sr=[];for(var hr in Ae)sr.push(hr);return sr};function Pe(Ae){return Object.prototype.toString.call(Ae)}var cr=Array.isArray||function(Ae){return"[object Array]"===Object.prototype.toString.call(Ae)},ur=function(Ae,sr){if(Ae.forEach)return Ae.forEach(sr);for(var hr=0;hr<Ae.length;hr++)sr(Ae[hr],hr,Ae)};ur(Bt(ct.prototype),function(Ae){U[Ae]=function(sr){var hr=[].slice.call(arguments,1),Dr=new ct(sr);return Dr[Ae].apply(Dr,hr)}});var Rr=Object.hasOwnProperty||function(Ae,sr){return sr in Ae}}),_n=Nr;function Nr(A){if(!(this instanceof Nr))return new Nr(A);this._bbox=A||[1/0,1/0,-1/0,-1/0],this._valid=!!A}Nr.prototype.include=function(A){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],A[0]),this._bbox[1]=Math.min(this._bbox[1],A[1]),this._bbox[2]=Math.max(this._bbox[2],A[0]),this._bbox[3]=Math.max(this._bbox[3],A[1]),this},Nr.prototype.equals=function(A){var U;return U=A instanceof Nr?A.bbox():A,this._bbox[0]==U[0]&&this._bbox[1]==U[1]&&this._bbox[2]==U[2]&&this._bbox[3]==U[3]},Nr.prototype.center=function(A){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null},Nr.prototype.union=function(A){var U;return this._valid=!0,U=A instanceof Nr?A.bbox():A,this._bbox[0]=Math.min(this._bbox[0],U[0]),this._bbox[1]=Math.min(this._bbox[1],U[1]),this._bbox[2]=Math.max(this._bbox[2],U[2]),this._bbox[3]=Math.max(this._bbox[3],U[3]),this},Nr.prototype.bbox=function(){return this._valid?this._bbox:null},Nr.prototype.contains=function(A){if(!A)return this._fastContains();if(!this._valid)return null;var U=A[0],ct=A[1];return this._bbox[0]<=U&&this._bbox[1]<=ct&&this._bbox[2]>=U&&this._bbox[3]>=ct},Nr.prototype.intersect=function(A){return this._valid?(U=A instanceof Nr?A.bbox():A,!(this._bbox[0]>U[2]||this._bbox[2]<U[0]||this._bbox[3]<U[1]||this._bbox[1]>U[3])):null;var U},Nr.prototype._fastContains=function(){return this._valid?new Function("ll","return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]"):new Function("return null;")},Nr.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var Gi={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},ri=Object.keys(Gi),qn=function(A){return En(A).bbox()};function En(A){for(var U=_n(),ct=function(A){if(!A)return[];var U=wn(yr(A)),ct=[];return U.features.forEach(function(oe){oe.geometry&&(ct=ct.concat(function Se(Bt){return Array.isArray(Bt)&&Bt.length&&"number"==typeof Bt[0]?[Bt]:Bt.reduce(function(Pe,cr){return Array.isArray(cr)&&Array.isArray(cr[0])?Pe.concat(Se(cr)):(Pe.push(cr),Pe)},[])}(oe.geometry.coordinates)))}),ct}(A),oe=0;oe<ct.length;oe++)U.include(ct[oe]);return U}function ho(A,U){var ct=-90,oe=90,Se=-90,Bt=90,Pe=270,cr=-270;A.forEach(function(Rr){var Ae=qn(Rr),sr=Ae[1],hr=Ae[3],Dr=Ae[0],Tn=Ae[2];sr>ct&&(ct=sr),hr<oe&&(oe=hr),hr>Se&&(Se=hr),sr<Bt&&(Bt=sr),Dr<Pe&&(Pe=Dr),Tn>cr&&(cr=Tn)});var ur=U;return ct+ur.lat>85&&(ur.lat=85-ct),Se+ur.lat>90&&(ur.lat=90-Se),oe+ur.lat<-85&&(ur.lat=-85-oe),Bt+ur.lat<-90&&(ur.lat=-90-Bt),Pe+ur.lng<=-270&&(ur.lng+=360*Math.ceil(Math.abs(ur.lng)/360)),cr+ur.lng>=270&&(ur.lng-=360*Math.ceil(Math.abs(ur.lng)/360)),ur}function li(A,U){var ct=ho(A.map(function(oe){return oe.toGeoJSON()}),U);A.forEach(function(oe){var Se,Bt=oe.getCoordinates(),Pe=function(ur){var Rr={lng:ur[0]+ct.lng,lat:ur[1]+ct.lat};return[Rr.lng,Rr.lat]},cr=function(ur){return ur.map(function(Rr){return Pe(Rr)})};oe.type===kt?Se=Pe(Bt):oe.type===Ct||"MultiPoint"===oe.type?Se=Bt.map(Pe):oe.type===Wt||"MultiLineString"===oe.type?Se=Bt.map(cr):"MultiPolygon"===oe.type&&(Se=Bt.map(function(ur){return ur.map(function(Rr){return cr(Rr)})})),oe.incomingCoords(Se)})}qn.polygon=function(A){return En(A).polygon()},qn.bboxify=function(A){return Lr(A).map(function(U){U&&ri.some(function(ct){return!!U[ct]&&-1!==Gi[ct].indexOf(U.type)})&&(U.bbox=En(U).bbox(),this.update(U))})};var Gr={onSetup:function(A){var U=this,ct={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initiallySelectedFeatureIds:A.featureIds||[]};return this.setSelected(ct.initiallySelectedFeatureIds.filter(function(oe){return void 0!==U.getFeature(oe)})),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),ct},fireUpdate:function(){this.map.fire(Ot,{action:"move",features:this.getSelected().map(function(A){return A.toGeoJSON()})})},fireActionable:function(){var A=this,U=this.getSelected(),ct=U.filter(function(cr){return A.isInstanceOf("MultiFeature",cr)}),oe=!1;if(U.length>1){oe=!0;var Se=U[0].type.replace("Multi","");U.forEach(function(cr){cr.type.replace("Multi","")!==Se&&(oe=!1)})}this.setActionableState({combineFeatures:oe,uncombineFeatures:ct.length>0,trash:U.length>0})},getUniqueIds:function(A){return A.length?A.map(function(U){return U.properties.id}).filter(function(U){return void 0!==U}).reduce(function(U,ct){return U.add(ct),U},new st).values():[]},stopExtendedInteractions:function(A){A.boxSelectElement&&(A.boxSelectElement.parentNode&&A.boxSelectElement.parentNode.removeChild(A.boxSelectElement),A.boxSelectElement=null),this.map.dragPan.enable(),A.boxSelecting=!1,A.canBoxSelect=!1,A.dragMoving=!1,A.canDragMove=!1},onStop:function(){Pr(this)},onMouseMove:function(A){return this.stopExtendedInteractions(A),!0},onMouseOut:function(A){return!A.dragMoving||this.fireUpdate()}};Gr.onTap=Gr.onClick=function(A,U){return me(U)?this.clickAnywhere(A,U):bt(ti)(U)?this.clickOnVertex(A,U):(ct=U).featureTarget&&ct.featureTarget.properties&&ct.featureTarget.properties.meta===Sr?this.clickOnFeature(A,U):void 0;var ct},Gr.clickAnywhere=function(A){var U=this,ct=this.getSelectedIds();ct.length&&(this.clearSelectedFeatures(),ct.forEach(function(oe){return U.doRender(oe)})),Pr(this),this.stopExtendedInteractions(A)},Gr.clickOnVertex=function(A,U){this.changeMode(Pt.DIRECT_SELECT,{featureId:U.featureTarget.properties.parent,coordPath:U.featureTarget.properties.coord_path,startPos:U.lngLat}),this.updateUIClasses({mouse:X})},Gr.startOnActiveFeature=function(A,U){this.stopExtendedInteractions(A),this.map.dragPan.disable(),this.doRender(U.featureTarget.properties.id),A.canDragMove=!0,A.dragMoveLocation=U.lngLat},Gr.clickOnFeature=function(A,U){var ct=this;He(this),this.stopExtendedInteractions(A);var oe=Dt(U),Se=this.getSelectedIds(),Bt=U.featureTarget.properties.id,Pe=this.isSelected(Bt);if(!oe&&Pe&&this.getFeature(Bt).type!==kt)return this.changeMode(Pt.DIRECT_SELECT,{featureId:Bt});Pe&&oe?(this.deselect(Bt),this.updateUIClasses({mouse:H}),1===Se.length&&Pr(this)):!Pe&&oe?(this.select(Bt),this.updateUIClasses({mouse:X})):Pe||oe||(Se.forEach(function(cr){return ct.doRender(cr)}),this.setSelected(Bt),this.updateUIClasses({mouse:X})),this.doRender(Bt)},Gr.onMouseDown=function(A,U){return Ft(U)?this.startOnActiveFeature(A,U):this.drawConfig.boxSelect&&(ct=U).originalEvent&&ct.originalEvent.shiftKey&&0===ct.originalEvent.button?this.startBoxSelect(A,U):void 0;var ct},Gr.startBoxSelect=function(A,U){this.stopExtendedInteractions(A),this.map.dragPan.disable(),A.boxSelectStartLocation=Ye(U.originalEvent,this.map.getContainer()),A.canBoxSelect=!0},Gr.onTouchStart=function(A,U){if(Ft(U))return this.startOnActiveFeature(A,U)},Gr.onDrag=function(A,U){return A.canDragMove?this.dragMove(A,U):this.drawConfig.boxSelect&&A.canBoxSelect?this.whileBoxSelect(A,U):void 0},Gr.whileBoxSelect=function(A,U){A.boxSelecting=!0,this.updateUIClasses({mouse:tt}),A.boxSelectElement||(A.boxSelectElement=document.createElement("div"),A.boxSelectElement.classList.add("mapbox-gl-draw_boxselect"),this.map.getContainer().appendChild(A.boxSelectElement));var ct=Ye(U.originalEvent,this.map.getContainer()),oe=Math.min(A.boxSelectStartLocation.x,ct.x),Se=Math.max(A.boxSelectStartLocation.x,ct.x),Bt=Math.min(A.boxSelectStartLocation.y,ct.y),Pe=Math.max(A.boxSelectStartLocation.y,ct.y),cr="translate("+oe+"px, "+Bt+"px)";A.boxSelectElement.style.transform=cr,A.boxSelectElement.style.WebkitTransform=cr,A.boxSelectElement.style.width=Se-oe+"px",A.boxSelectElement.style.height=Pe-Bt+"px"},Gr.dragMove=function(A,U){A.dragMoving=!0,U.originalEvent.stopPropagation();var ct={lng:U.lngLat.lng-A.dragMoveLocation.lng,lat:U.lngLat.lat-A.dragMoveLocation.lat};li(this.getSelected(),ct),A.dragMoveLocation=U.lngLat},Gr.onMouseUp=function(A,U){var ct=this;if(A.dragMoving)this.fireUpdate();else if(A.boxSelecting){var oe=[A.boxSelectStartLocation,Ye(U.originalEvent,this.map.getContainer())],Se=this.featuresAt(null,oe,"click"),Bt=this.getUniqueIds(Se).filter(function(Pe){return!ct.isSelected(Pe)});Bt.length&&(this.select(Bt),Bt.forEach(function(Pe){return ct.doRender(Pe)}),this.updateUIClasses({mouse:X}))}this.stopExtendedInteractions(A)},Gr.toDisplayFeatures=function(A,U,ct){U.properties.active=this.isSelected(U.properties.id)?vn:Un,ct(U),this.fireActionable(),U.properties.active===vn&&U.geometry.type!==kt&&_r(U).forEach(ct)},Gr.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},Gr.onCombineFeatures=function(){var A=this.getSelected();if(!(0===A.length||A.length<2)){for(var U=[],ct=[],oe=A[0].type.replace("Multi",""),Se=0;Se<A.length;Se++){var Bt=A[Se];if(Bt.type.replace("Multi","")!==oe)return;Bt.type.includes("Multi")?Bt.getCoordinates().forEach(function(cr){U.push(cr)}):U.push(Bt.getCoordinates()),ct.push(Bt.toGeoJSON())}if(ct.length>1){var Pe=this.newFeature({type:j,properties:ct[0].properties,geometry:{type:"Multi"+oe,coordinates:U}});this.addFeature(Pe),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([Pe.id]),this.map.fire("draw.combine",{createdFeatures:[Pe.toGeoJSON()],deletedFeatures:ct})}this.fireActionable()}},Gr.onUncombineFeatures=function(){var A=this,U=this.getSelected();if(0!==U.length){for(var ct=[],oe=[],Se=function(Pe){var cr=U[Pe];A.isInstanceOf("MultiFeature",cr)&&(cr.getFeatures().forEach(function(ur){A.addFeature(ur),ur.properties=cr.properties,ct.push(ur.toGeoJSON()),A.select([ur.id])}),A.deleteFeature(cr.id,{silent:!0}),oe.push(cr.toGeoJSON()))},Bt=0;Bt<U.length;Bt++)Se(Bt);ct.length>1&&this.map.fire("draw.uncombine",{createdFeatures:ct,deletedFeatures:oe}),this.fireActionable()}};var fa=bt(ti),Jn=bt(qe),Ra={fireUpdate:function(){this.map.fire(Ot,{action:"change_coordinates",features:this.getSelected().map(function(A){return A.toGeoJSON()})})},fireActionable:function(A){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:A.selectedCoordPaths.length>0})},startDragging:function(A,U){this.map.dragPan.disable(),A.canDragMove=!0,A.dragMoveLocation=U.lngLat},stopDragging:function(A){this.map.dragPan.enable(),A.dragMoving=!1,A.canDragMove=!1,A.dragMoveLocation=null},onVertex:function(A,U){this.startDragging(A,U);var ct=U.featureTarget.properties,oe=A.selectedCoordPaths.indexOf(ct.coord_path);Dt(U)||-1!==oe?Dt(U)&&-1===oe&&A.selectedCoordPaths.push(ct.coord_path):A.selectedCoordPaths=[ct.coord_path];var Se=this.pathsToCoordinates(A.featureId,A.selectedCoordPaths);this.setSelectedCoordinates(Se)},onMidpoint:function(A,U){this.startDragging(A,U);var ct=U.featureTarget.properties;A.feature.addCoordinate(ct.coord_path,ct.lng,ct.lat),this.fireUpdate(),A.selectedCoordPaths=[ct.coord_path]},pathsToCoordinates:function(A,U){return U.map(function(ct){return{feature_id:A,coord_path:ct}})},onFeature:function(A,U){0===A.selectedCoordPaths.length?this.startDragging(A,U):this.stopDragging(A)},dragFeature:function(A,U,ct){li(this.getSelected(),ct),A.dragMoveLocation=U.lngLat},dragVertex:function(A,U,ct){for(var oe=A.selectedCoordPaths.map(function(cr){return A.feature.getCoordinate(cr)}),Se=ho(oe.map(function(cr){return{type:j,properties:{},geometry:{type:kt,coordinates:cr}}}),ct),Bt=0;Bt<oe.length;Bt++){var Pe=oe[Bt];A.feature.updateCoordinate(A.selectedCoordPaths[Bt],Pe[0]+Se.lng,Pe[1]+Se.lat)}},clickNoTarget:function(){this.changeMode(Pt.SIMPLE_SELECT)},clickInactive:function(){this.changeMode(Pt.SIMPLE_SELECT)},clickActiveFeature:function(A){A.selectedCoordPaths=[],this.clearSelectedCoordinates(),A.feature.changed()},onSetup:function(A){var U=A.featureId,ct=this.getFeature(U);if(!ct)throw new Error("You must provide a featureId to enter direct_select mode");if(ct.type===kt)throw new TypeError("direct_select mode doesn't handle point features");var oe={featureId:U,feature:ct,dragMoveLocation:A.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:A.coordPath?[A.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(U,oe.selectedCoordPaths)),this.setSelected(U),He(this),this.setActionableState({trash:!0}),oe},onStop:function(){Pr(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(A,U,ct){A.featureId===U.properties.id?(U.properties.active=vn,ct(U),_r(U,{map:this.map,midpoints:!0,selectedPaths:A.selectedCoordPaths}).forEach(ct)):(U.properties.active=Un,ct(U)),this.fireActionable(A)},onTrash:function(A){A.selectedCoordPaths.sort(function(U,ct){return ct.localeCompare(U,"en",{numeric:!0})}).forEach(function(U){return A.feature.removeCoordinate(U)}),this.fireUpdate(),A.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(A),!1===A.feature.isValid()&&(this.deleteFeature([A.featureId]),this.changeMode(Pt.SIMPLE_SELECT,{}))},onMouseMove:function(A,U){var ct=Ft(U),oe=fa(U),Se=0===A.selectedCoordPaths.length;return this.updateUIClasses(ct&&Se||oe&&!Se?{mouse:X}:{mouse:et}),this.stopDragging(A),!0},onMouseOut:function(A){return A.dragMoving&&this.fireUpdate(),!0}};Ra.onTouchStart=Ra.onMouseDown=function(A,U){return fa(U)?this.onVertex(A,U):Ft(U)?this.onFeature(A,U):Jn(U)?this.onMidpoint(A,U):void 0},Ra.onDrag=function(A,U){if(!0===A.canDragMove){A.dragMoving=!0,U.originalEvent.stopPropagation();var ct={lng:U.lngLat.lng-A.dragMoveLocation.lng,lat:U.lngLat.lat-A.dragMoveLocation.lat};A.selectedCoordPaths.length>0?this.dragVertex(A,U,ct):this.dragFeature(A,U,ct),A.dragMoveLocation=U.lngLat}},Ra.onClick=function(A,U){return me(U)?this.clickNoTarget(A,U):Ft(U)?this.clickActiveFeature(A,U):se(U)?this.clickInactive(A,U):void this.stopDragging(A)},Ra.onTap=function(A,U){return me(U)?this.clickNoTarget(A,U):Ft(U)?this.clickActiveFeature(A,U):se(U)?this.clickInactive(A,U):void 0},Ra.onTouchEnd=Ra.onMouseUp=function(A){A.dragMoving&&this.fireUpdate(),this.stopDragging(A)};var Ka={};function Ro(A,U){return!!A.lngLat&&A.lngLat.lng===U[0]&&A.lngLat.lat===U[1]}Ka.onSetup=function(){var A=this.newFeature({type:j,properties:{},geometry:{type:kt,coordinates:[]}});return this.addFeature(A),this.clearSelectedFeatures(),this.updateUIClasses({mouse:tt}),this.activateUIButton(at.POINT),this.setActionableState({trash:!0}),{point:A}},Ka.stopDrawingAndRemove=function(A){this.deleteFeature([A.point.id],{silent:!0}),this.changeMode(Pt.SIMPLE_SELECT)},Ka.onTap=Ka.onClick=function(A,U){this.updateUIClasses({mouse:X}),A.point.updateCoordinate("",U.lngLat.lng,U.lngLat.lat),this.map.fire(te,{features:[A.point.toGeoJSON()]}),this.changeMode(Pt.SIMPLE_SELECT,{featureIds:[A.point.id]})},Ka.onStop=function(A){this.activateUIButton(),A.point.getCoordinate().length||this.deleteFeature([A.point.id],{silent:!0})},Ka.toDisplayFeatures=function(A,U,ct){var oe=U.properties.id===A.point.id;if(U.properties.active=oe?vn:Un,!oe)return ct(U)},Ka.onTrash=Ka.stopDrawingAndRemove,Ka.onKeyUp=function(A,U){if(Ht(U)||ir(U))return this.stopDrawingAndRemove(A,U)};var Hn={onSetup:function(){var A=this.newFeature({type:j,properties:{},geometry:{type:Wt,coordinates:[[]]}});return this.addFeature(A),this.clearSelectedFeatures(),He(this),this.updateUIClasses({mouse:tt}),this.activateUIButton(at.POLYGON),this.setActionableState({trash:!0}),{polygon:A,currentVertexPosition:0}},clickAnywhere:function(A,U){if(A.currentVertexPosition>0&&Ro(U,A.polygon.coordinates[0][A.currentVertexPosition-1]))return this.changeMode(Pt.SIMPLE_SELECT,{featureIds:[A.polygon.id]});this.updateUIClasses({mouse:tt}),A.polygon.updateCoordinate("0."+A.currentVertexPosition,U.lngLat.lng,U.lngLat.lat),A.currentVertexPosition++,A.polygon.updateCoordinate("0."+A.currentVertexPosition,U.lngLat.lng,U.lngLat.lat)},clickOnVertex:function(A){return this.changeMode(Pt.SIMPLE_SELECT,{featureIds:[A.polygon.id]})},onMouseMove:function(A,U){A.polygon.updateCoordinate("0."+A.currentVertexPosition,U.lngLat.lng,U.lngLat.lat),ue(U)&&this.updateUIClasses({mouse:H})}};Hn.onTap=Hn.onClick=function(A,U){return ue(U)?this.clickOnVertex(A,U):this.clickAnywhere(A,U)},Hn.onKeyUp=function(A,U){Ht(U)?(this.deleteFeature([A.polygon.id],{silent:!0}),this.changeMode(Pt.SIMPLE_SELECT)):ir(U)&&this.changeMode(Pt.SIMPLE_SELECT,{featureIds:[A.polygon.id]})},Hn.onStop=function(A){this.updateUIClasses({mouse:et}),Pr(this),this.activateUIButton(),void 0!==this.getFeature(A.polygon.id)&&(A.polygon.removeCoordinate("0."+A.currentVertexPosition),A.polygon.isValid()?this.map.fire(te,{features:[A.polygon.toGeoJSON()]}):(this.deleteFeature([A.polygon.id],{silent:!0}),this.changeMode(Pt.SIMPLE_SELECT,{},{silent:!0})))},Hn.toDisplayFeatures=function(A,U,ct){var oe=U.properties.id===A.polygon.id;if(U.properties.active=oe?vn:Un,!oe)return ct(U);if(0!==U.geometry.coordinates.length){var Se=U.geometry.coordinates[0].length;if(!(Se<3)){if(U.properties.meta=Sr,ct(vr(A.polygon.id,U.geometry.coordinates[0][0],"0.0",!1)),Se>3){var Bt=U.geometry.coordinates[0].length-3;ct(vr(A.polygon.id,U.geometry.coordinates[0][Bt],"0."+Bt,!1))}if(Se<=4&&(ct({type:j,properties:U.properties,geometry:{coordinates:[[U.geometry.coordinates[0][0][0],U.geometry.coordinates[0][0][1]],[U.geometry.coordinates[0][1][0],U.geometry.coordinates[0][1][1]]],type:Ct}}),3===Se))return;return ct(U)}}},Hn.onTrash=function(A){this.deleteFeature([A.polygon.id],{silent:!0}),this.changeMode(Pt.SIMPLE_SELECT)};var mu={onSetup:function(A){var U,ct,oe=(A=A||{}).featureId,Se="forward";if(oe){if(!(U=this.getFeature(oe)))throw new Error("Could not find a feature with the provided featureId");var Bt=A.from;if(Bt&&"Feature"===Bt.type&&Bt.geometry&&"Point"===Bt.geometry.type&&(Bt=Bt.geometry),Bt&&"Point"===Bt.type&&Bt.coordinates&&2===Bt.coordinates.length&&(Bt=Bt.coordinates),!Bt||!Array.isArray(Bt))throw new Error("Please use the `from` property to indicate which point to continue the line from");var Pe=U.coordinates.length-1;if(U.coordinates[Pe][0]===Bt[0]&&U.coordinates[Pe][1]===Bt[1])U.addCoordinate.apply(U,[ct=Pe+1].concat(U.coordinates[Pe]));else{if(U.coordinates[0][0]!==Bt[0]||U.coordinates[0][1]!==Bt[1])throw new Error("`from` should match the point at either the start or the end of the provided LineString");Se="backwards",U.addCoordinate.apply(U,[ct=0].concat(U.coordinates[0]))}}else U=this.newFeature({type:j,properties:{},geometry:{type:Ct,coordinates:[]}}),ct=0,this.addFeature(U);return this.clearSelectedFeatures(),He(this),this.updateUIClasses({mouse:tt}),this.activateUIButton(at.LINE),this.setActionableState({trash:!0}),{line:U,currentVertexPosition:ct,direction:Se}},clickAnywhere:function(A,U){if(A.currentVertexPosition>0&&Ro(U,A.line.coordinates[A.currentVertexPosition-1])||"backwards"===A.direction&&Ro(U,A.line.coordinates[A.currentVertexPosition+1]))return this.changeMode(Pt.SIMPLE_SELECT,{featureIds:[A.line.id]});this.updateUIClasses({mouse:tt}),A.line.updateCoordinate(A.currentVertexPosition,U.lngLat.lng,U.lngLat.lat),"forward"===A.direction?(A.currentVertexPosition++,A.line.updateCoordinate(A.currentVertexPosition,U.lngLat.lng,U.lngLat.lat)):A.line.addCoordinate(0,U.lngLat.lng,U.lngLat.lat)},clickOnVertex:function(A){return this.changeMode(Pt.SIMPLE_SELECT,{featureIds:[A.line.id]})},onMouseMove:function(A,U){A.line.updateCoordinate(A.currentVertexPosition,U.lngLat.lng,U.lngLat.lat),ue(U)&&this.updateUIClasses({mouse:H})}};mu.onTap=mu.onClick=function(A,U){if(ue(U))return this.clickOnVertex(A,U);this.clickAnywhere(A,U)},mu.onKeyUp=function(A,U){ir(U)?this.changeMode(Pt.SIMPLE_SELECT,{featureIds:[A.line.id]}):Ht(U)&&(this.deleteFeature([A.line.id],{silent:!0}),this.changeMode(Pt.SIMPLE_SELECT))},mu.onStop=function(A){Pr(this),this.activateUIButton(),void 0!==this.getFeature(A.line.id)&&(A.line.removeCoordinate(""+A.currentVertexPosition),A.line.isValid()?this.map.fire(te,{features:[A.line.toGeoJSON()]}):(this.deleteFeature([A.line.id],{silent:!0}),this.changeMode(Pt.SIMPLE_SELECT,{},{silent:!0})))},mu.onTrash=function(A){this.deleteFeature([A.line.id],{silent:!0}),this.changeMode(Pt.SIMPLE_SELECT)},mu.toDisplayFeatures=function(A,U,ct){var oe=U.properties.id===A.line.id;if(U.properties.active=oe?vn:Un,!oe)return ct(U);U.geometry.coordinates.length<2||(U.properties.meta=Sr,ct(vr(A.line.id,U.geometry.coordinates["forward"===A.direction?U.geometry.coordinates.length-2:1],""+("forward"===A.direction?U.geometry.coordinates.length-2:1),!1)),ct(U))};var xa={simple_select:Gr,direct_select:Ra,draw_point:Ka,draw_polygon:Hn,draw_line_string:mu},$o={defaultMode:Pt.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}],modes:xa,controls:{},userProperties:!1},su={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},Pn={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function _o(A,U){return A.map(function(ct){return ct.source?ct:wi(ct,{id:ct.id+"."+U,source:"hot"===U?it:$})})}var Fo=Xe(function(A,U){var ct="[object Arguments]",oe="[object Map]",Se="[object Object]",Bt="[object Set]",Pe=/^\[object .+?Constructor\]$/,cr=/^(?:0|[1-9]\d*)$/,ur={};ur["[object Float32Array]"]=ur["[object Float64Array]"]=ur["[object Int8Array]"]=ur["[object Int16Array]"]=ur["[object Int32Array]"]=ur["[object Uint8Array]"]=ur["[object Uint8ClampedArray]"]=ur["[object Uint16Array]"]=ur["[object Uint32Array]"]=!0,ur[ct]=ur["[object Array]"]=ur["[object ArrayBuffer]"]=ur["[object Boolean]"]=ur["[object DataView]"]=ur["[object Date]"]=ur["[object Error]"]=ur["[object Function]"]=ur[oe]=ur["[object Number]"]=ur[Se]=ur["[object RegExp]"]=ur[Bt]=ur["[object String]"]=ur["[object WeakMap]"]=!1;var Rr="object"==typeof global&&global&&global.Object===Object&&global,Ae="object"==typeof self&&self&&self.Object===Object&&self,sr=Rr||Ae||Function("return this")(),hr=U&&!U.nodeType&&U,Dr=hr&&A&&!A.nodeType&&A,Tn=Dr&&Dr.exports===hr,zo=Tn&&Rr.process,$e=function(){try{return zo&&zo.binding&&zo.binding("util")}catch{}}(),Vr=$e&&$e.isTypedArray;function Qn(be,je){for(var dr=-1,fn=null==be?0:be.length;++dr<fn;)if(je(be[dr],dr,be))return!0;return!1}function en(be){var je=-1,dr=Array(be.size);return be.forEach(function(fn,Ei){dr[++je]=[Ei,fn]}),dr}function ci(be){var je=-1,dr=Array(be.size);return be.forEach(function(fn){dr[++je]=fn}),dr}var zr,Qo,ls,Qr=Array.prototype,Ao=Object.prototype,Lo=sr["__core-js_shared__"],io=Function.prototype.toString,ba=Ao.hasOwnProperty,yu=(zr=/[^.]+$/.exec(Lo&&Lo.keys&&Lo.keys.IE_PROTO||""))?"Symbol(src)_1."+zr:"",Do=Ao.toString,jl=RegExp("^"+io.call(ba).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Vn=Tn?sr.Buffer:void 0,wo=sr.Symbol,Ho=sr.Uint8Array,zu=Ao.propertyIsEnumerable,Dl=Qr.splice,xs=wo?wo.toStringTag:void 0,Ol=Object.getOwnPropertySymbols,tl=Vn?Vn.isBuffer:void 0,da=(Qo=Object.keys,ls=Object,function(be){return Qo(ls(be))}),Ys=Ba(sr,"DataView"),yi=Ba(sr,"Map"),uu=Ba(sr,"Promise"),wa=Ba(sr,"Set"),Rs=Ba(sr,"WeakMap"),Fi=Ba(Object,"create"),Jr=jn(Ys),vu=jn(yi),Js=jn(uu),aa=jn(wa),za=jn(Rs),Mu=wo?wo.prototype:void 0,Vi=Mu?Mu.valueOf:void 0;function Ms(be){var je=-1,dr=null==be?0:be.length;for(this.clear();++je<dr;){var fn=be[je];this.set(fn[0],fn[1])}}function Hs(be){var je=-1,dr=null==be?0:be.length;for(this.clear();++je<dr;){var fn=be[je];this.set(fn[0],fn[1])}}function $n(be){var je=-1,dr=null==be?0:be.length;for(this.clear();++je<dr;){var fn=be[je];this.set(fn[0],fn[1])}}function Ps(be){var je=-1,dr=null==be?0:be.length;for(this.__data__=new $n;++je<dr;)this.add(be[je])}function zi(be){var je=this.__data__=new Hs(be);this.size=je.size}function $a(be,je){for(var dr=be.length;dr--;)if(Ua(be[dr][0],je))return dr;return-1}function cs(be){return null==be?void 0===be?"[object Undefined]":"[object Null]":xs&&xs in Object(be)?function(je){var dr=ba.call(je,xs),fn=je[xs];try{je[xs]=void 0;var Ei=!0}catch{}var An=Do.call(je);return Ei&&(dr?je[xs]=fn:delete je[xs]),An}(be):Do.call(be)}function Nn(be){return ea(be)&&cs(be)==ct}function Ws(be,je,dr,fn,Ei){return be===je||(null==be||null==je||!ea(be)&&!ea(je)?be!=be&&je!=je:function(An,xo,oo,Ga,mi,Wo){var Ts=Uu(An),Qa=Uu(xo),ps=Ts?"[object Array]":ta(An),Ks=Qa?"[object Array]":ta(xo),zs=(ps=ps==ct?Se:ps)==Se,As=(Ks=Ks==ct?Se:Ks)==Se,Bo=ps==Ks;if(Bo&&kl(An)){if(!kl(xo))return!1;Ts=!0,zs=!1}if(Bo&&!zs)return Wo||(Wo=new zi),Ts||hs(An)?ga(An,xo,oo,Ga,mi,Wo):function(So,Ii,oi,Ea,Po,po,bn){switch(oi){case"[object DataView]":if(So.byteLength!=Ii.byteLength||So.byteOffset!=Ii.byteOffset)return!1;So=So.buffer,Ii=Ii.buffer;case"[object ArrayBuffer]":return!(So.byteLength!=Ii.byteLength||!po(new Ho(So),new Ho(Ii)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Ua(+So,+Ii);case"[object Error]":return So.name==Ii.name&&So.message==Ii.message;case"[object RegExp]":case"[object String]":return So==Ii+"";case oe:var Wn=en;case Bt:if(Wn||(Wn=ci),So.size!=Ii.size&&!(1&Ea))return!1;var ja=bn.get(So);if(ja)return ja==Ii;Ea|=2,bn.set(So,Ii);var Zo=ga(Wn(So),Wn(Ii),Ea,Po,po,bn);return bn.delete(So),Zo;case"[object Symbol]":if(Vi)return Vi.call(So)==Vi.call(Ii)}return!1}(An,xo,ps,oo,Ga,mi,Wo);if(!(1&oo)){var $s=zs&&ba.call(An,"__wrapped__"),sa=As&&ba.call(xo,"__wrapped__");if($s||sa){var Bs=$s?An.value():An,Qs=sa?xo.value():xo;return Wo||(Wo=new zi),mi(Bs,Qs,oo,Ga,Wo)}}return!!Bo&&(Wo||(Wo=new zi),function(So,Ii,oi,Ea,Po,po){var bn=1&oi,Wn=bs(So),Va=Wn.length;if(Va!=bs(Ii).length&&!bn)return!1;for(var Zo=Va;Zo--;){var fo=Wn[Zo];if(!(bn?fo in Ii:ba.call(Ii,fo)))return!1}var ts=po.get(So);if(ts&&po.get(Ii))return ts==Ii;var es=!0;po.set(So,Ii),po.set(Ii,So);for(var qu=bn;++Zo<Va;){var tu=So[fo=Wn[Zo]],ws=Ii[fo];if(Ea)var ao=bn?Ea(ws,tu,fo,Ii,So,po):Ea(tu,ws,fo,So,Ii,po);if(!(void 0===ao?tu===ws||Po(tu,ws,oi,Ea,po):ao)){es=!1;break}qu||(qu="constructor"==fo)}if(es&&!qu){var rs=So.constructor,ra=Ii.constructor;rs==ra||!("constructor"in So)||!("constructor"in Ii)||"function"==typeof rs&&rs instanceof rs&&"function"==typeof ra&&ra instanceof ra||(es=!1)}return po.delete(So),po.delete(Ii),es}(An,xo,oo,Ga,mi,Wo))}(be,je,dr,fn,Ws,Ei))}function ga(be,je,dr,fn,Ei,An){var xo=1&dr,oo=be.length,Ga=je.length;if(oo!=Ga&&!(xo&&Ga>oo))return!1;var mi=An.get(be);if(mi&&An.get(je))return mi==je;var Wo=-1,Ts=!0,Qa=2&dr?new Ps:void 0;for(An.set(be,je),An.set(je,be);++Wo<oo;){var ps=be[Wo],Ks=je[Wo];if(fn)var zs=xo?fn(Ks,ps,Wo,je,be,An):fn(ps,Ks,Wo,be,je,An);if(void 0!==zs){if(zs)continue;Ts=!1;break}if(Qa){if(!Qn(je,function(As,Bo){if(!Qa.has(Bo)&&(ps===As||Ei(ps,As,dr,fn,An)))return Qa.push(Bo)})){Ts=!1;break}}else if(ps!==Ks&&!Ei(ps,Ks,dr,fn,An)){Ts=!1;break}}return An.delete(be),An.delete(je),Ts}function bs(be){return fn=hi,Ei=function Fs(be){return null!=(je=be)&&qa(je.length)&&!xu(je)?function el(be,je){var dr=Uu(be),fn=!dr&&Da(be),Ei=!dr&&!fn&&kl(be),An=!dr&&!fn&&!Ei&&hs(be),xo=dr||fn||Ei||An,oo=xo?function(Wo,Ts){for(var Qa=-1,ps=Array(Wo);++Qa<Wo;)ps[Qa]=Ts(Qa);return ps}(be.length,String):[],Ga=oo.length;for(var mi in be)!je&&!ba.call(be,mi)||xo&&("length"==mi||Ei&&("offset"==mi||"parent"==mi)||An&&("buffer"==mi||"byteLength"==mi||"byteOffset"==mi)||Bu(mi,Ga))||oo.push(mi);return oo}(be):function pl(be){if(dr=(je=be)&&je.constructor,je!==("function"==typeof dr&&dr.prototype||Ao))return da(be);var je,dr,Ei=[];for(var An in Object(be))ba.call(be,An)&&"constructor"!=An&&Ei.push(An);return Ei}(be);var je}(je=be),Uu(je)?Ei:function(An,xo){for(var oo=-1,Ga=xo.length,mi=An.length;++oo<Ga;)An[mi+oo]=xo[oo];return An}(Ei,fn(je));var je,fn,Ei}function _u(be,je){var dr,fn,Ei=be.__data__;return("string"==(fn=typeof(dr=je))||"number"==fn||"symbol"==fn||"boolean"==fn?"__proto__"!==dr:null===dr)?Ei["string"==typeof je?"string":"hash"]:Ei.map}function Ba(be,je){var dr=be?.[je];return function Eo(be){return!(!Pu(be)||(je=be,yu&&yu in je))&&(xu(be)?jl:Pe).test(jn(be));var je}(dr)?dr:void 0}Ms.prototype.clear=function(){this.__data__=Fi?Fi(null):{},this.size=0},Ms.prototype.delete=function(be){var je=this.has(be)&&delete this.__data__[be];return this.size-=je?1:0,je},Ms.prototype.get=function(be){var je=this.__data__;if(Fi){var dr=je[be];return"__lodash_hash_undefined__"===dr?void 0:dr}return ba.call(je,be)?je[be]:void 0},Ms.prototype.has=function(be){var je=this.__data__;return Fi?void 0!==je[be]:ba.call(je,be)},Ms.prototype.set=function(be,je){var dr=this.__data__;return this.size+=this.has(be)?0:1,dr[be]=Fi&&void 0===je?"__lodash_hash_undefined__":je,this},Hs.prototype.clear=function(){this.__data__=[],this.size=0},Hs.prototype.delete=function(be){var je=this.__data__,dr=$a(je,be);return!(dr<0||(dr==je.length-1?je.pop():Dl.call(je,dr,1),--this.size,0))},Hs.prototype.get=function(be){var je=this.__data__,dr=$a(je,be);return dr<0?void 0:je[dr][1]},Hs.prototype.has=function(be){return $a(this.__data__,be)>-1},Hs.prototype.set=function(be,je){var dr=this.__data__,fn=$a(dr,be);return fn<0?(++this.size,dr.push([be,je])):dr[fn][1]=je,this},$n.prototype.clear=function(){this.size=0,this.__data__={hash:new Ms,map:new(yi||Hs),string:new Ms}},$n.prototype.delete=function(be){var je=_u(this,be).delete(be);return this.size-=je?1:0,je},$n.prototype.get=function(be){return _u(this,be).get(be)},$n.prototype.has=function(be){return _u(this,be).has(be)},$n.prototype.set=function(be,je){var dr=_u(this,be),fn=dr.size;return dr.set(be,je),this.size+=dr.size==fn?0:1,this},Ps.prototype.add=Ps.prototype.push=function(be){return this.__data__.set(be,"__lodash_hash_undefined__"),this},Ps.prototype.has=function(be){return this.__data__.has(be)},zi.prototype.clear=function(){this.__data__=new Hs,this.size=0},zi.prototype.delete=function(be){var je=this.__data__,dr=je.delete(be);return this.size=je.size,dr},zi.prototype.get=function(be){return this.__data__.get(be)},zi.prototype.has=function(be){return this.__data__.has(be)},zi.prototype.set=function(be,je){var dr=this.__data__;if(dr instanceof Hs){var fn=dr.__data__;if(!yi||fn.length<199)return fn.push([be,je]),this.size=++dr.size,this;dr=this.__data__=new $n(fn)}return dr.set(be,je),this.size=dr.size,this};var hi=Ol?function(be){return null==be?[]:(be=Object(be),function(je,dr){for(var fn=-1,Ei=null==je?0:je.length,An=0,xo=[];++fn<Ei;){var oo=je[fn];dr(oo)&&(xo[An++]=oo)}return xo}(Ol(be),function(je){return zu.call(be,je)}))}:function(){return[]},ta=cs;function Bu(be,je){return!!(je=je??9007199254740991)&&("number"==typeof be||cr.test(be))&&be>-1&&be%1==0&&be<je}function jn(be){if(null!=be){try{return io.call(be)}catch{}try{return be+""}catch{}}return""}function Ua(be,je){return be===je||be!=be&&je!=je}(Ys&&"[object DataView]"!=ta(new Ys(new ArrayBuffer(1)))||yi&&ta(new yi)!=oe||uu&&"[object Promise]"!=ta(uu.resolve())||wa&&ta(new wa)!=Bt||Rs&&"[object WeakMap]"!=ta(new Rs))&&(ta=function(be){var je=cs(be),dr=je==Se?be.constructor:void 0,fn=dr?jn(dr):"";if(fn)switch(fn){case Jr:return"[object DataView]";case vu:return oe;case Js:return"[object Promise]";case aa:return Bt;case za:return"[object WeakMap]"}return je});var Da=Nn(function(){return arguments}())?Nn:function(be){return ea(be)&&ba.call(be,"callee")&&!zu.call(be,"callee")},Uu=Array.isArray,kl=tl||function(){return!1};function xu(be){if(!Pu(be))return!1;var je=cs(be);return"[object Function]"==je||"[object GeneratorFunction]"==je||"[object AsyncFunction]"==je||"[object Proxy]"==je}function qa(be){return"number"==typeof be&&be>-1&&be%1==0&&be<=9007199254740991}function Pu(be){var je=typeof be;return null!=be&&("object"==je||"function"==je)}function ea(be){return null!=be&&"object"==typeof be}var be,hs=Vr?(be=Vr,function(je){return be(je)}):function(be){return ea(be)&&qa(be.length)&&!!ur[cs(be)]};A.exports=function(be,je){return Ws(be,je)}}),Fa={Polygon:ei,LineString:un,Point:pr,MultiPolygon:Mn,MultiLineString:Mn,MultiPoint:Mn};var Iu=function(A,U){var ct={options:A=function(Se){void 0===Se&&(Se={});var Bt=wi(Se);return Se.controls||(Bt.controls={}),Bt.controls=wi(!1===Se.displayControlsDefault?Pn:su,Se.controls),(Bt=wi($o,Bt)).styles=_o(Bt.styles,"cold").concat(_o(Bt.styles,"hot")),Bt}(A)};U=function xn(A,U){return U.modes=Pt,U.getFeatureIdsAt=function(ct){return ot.click({point:ct},null,A).map(function(oe){return oe.properties.id})},U.getSelectedIds=function(){return A.store.getSelectedIds()},U.getSelected=function(){return{type:gt,features:A.store.getSelectedIds().map(function(ct){return A.store.get(ct)}).map(function(ct){return ct.toGeoJSON()})}},U.getSelectedPoints=function(){return{type:gt,features:A.store.getSelectedCoordinates().map(function(ct){return{type:j,properties:{},geometry:{type:kt,coordinates:ct.coordinates}}})}},U.set=function(ct){if(void 0===ct.type||ct.type!==gt||!Array.isArray(ct.features))throw new Error("Invalid FeatureCollection");var oe=A.store.createRenderBatch(),Se=A.store.getAllIds().slice(),Bt=U.add(ct),Pe=new st(Bt);return(Se=Se.filter(function(cr){return!Pe.has(cr)})).length&&U.delete(Se),oe(),Bt},U.add=function(ct){var oe=JSON.parse(JSON.stringify(yr(ct))).features.map(function(Se){if(Se.id=Se.id||pn(),null===Se.geometry)throw new Error("Invalid geometry: null");if(void 0===A.store.get(Se.id)||A.store.get(Se.id).type!==Se.geometry.type){var Bt=Fa[Se.geometry.type];if(void 0===Bt)throw new Error("Invalid geometry type: "+Se.geometry.type+".");var Pe=new Bt(A,Se);A.store.add(Pe)}else{var cr=A.store.get(Se.id);cr.properties=Se.properties,Fo(cr.getCoordinates(),Se.geometry.coordinates)||cr.incomingCoords(Se.geometry.coordinates)}return Se.id});return A.store.render(),oe},U.get=function(ct){var oe=A.store.get(ct);if(oe)return oe.toGeoJSON()},U.getAll=function(){return{type:gt,features:A.store.getAll().map(function(ct){return ct.toGeoJSON()})}},U.delete=function(ct){return A.store.delete(ct,{silent:!0}),U.getMode()!==Pt.DIRECT_SELECT||A.store.getSelectedIds().length?A.store.render():A.events.changeMode(Pt.SIMPLE_SELECT,void 0,{silent:!0}),U},U.deleteAll=function(){return A.store.delete(A.store.getAllIds(),{silent:!0}),U.getMode()===Pt.DIRECT_SELECT?A.events.changeMode(Pt.SIMPLE_SELECT,void 0,{silent:!0}):A.store.render(),U},U.changeMode=function(ct,oe){return void 0===oe&&(oe={}),ct===Pt.SIMPLE_SELECT&&U.getMode()===Pt.SIMPLE_SELECT?(Se=oe.featureIds||[],Bt=A.store.getSelectedIds(),Se.length===Bt.length&&JSON.stringify(Se.map(function(Pe){return Pe}).sort())===JSON.stringify(Bt.map(function(Pe){return Pe}).sort())||(A.store.setSelected(oe.featureIds,{silent:!0}),A.store.render()),U):(ct===Pt.DIRECT_SELECT&&U.getMode()===Pt.DIRECT_SELECT&&oe.featureId===A.store.getSelectedIds()[0]||A.events.changeMode(ct,oe,{silent:!0}),U);var Se,Bt},U.getMode=function(){return A.events.getMode()},U.trash=function(){return A.events.trash({silent:!0}),U},U.combineFeatures=function(){return A.events.combineFeatures({silent:!0}),U},U.uncombineFeatures=function(){return A.events.uncombineFeatures({silent:!0}),U},U.setFeatureProperty=function(ct,oe,Se){return A.store.setFeatureProperty(ct,oe,Se),U},U}(ct,U),ct.api=U;var oe=pt(ct);return U.onAdd=oe.onAdd,U.onRemove=oe.onRemove,U.types=at,U.options=A,U};function oc(A){Iu(A,this)}return oc.modes=xa,oc}()},8407:(tr,he,St)=>{"use strict";St.r(he),St.d(he,{HomeModule:()=>uv});var dt=St(6895),Tt=St(8996),s=St(4650),lt=St(4006),ht=St(5938);let Lt=(()=>{class r{constructor(o,p){this.dialogRef=o,this.data=p,p&&(this.messageData=p.messageData)}ngOnInit(){}closeDialog(o){this.dialogRef.close(o)}}return r.\u0275fac=function(o){return new(o||r)(s.Y36(ht.so),s.Y36(ht.WI))},r.\u0275cmp=s.Xpm({type:r,selectors:[["app-confirm-box"]],decls:8,vars:1,consts:[[1,"p-flex","mt-3"],[1,"btn","btn-sm","btn-secondary","me-2",3,"click"],[1,"btn","btn-sm","btn-info","ms-2",3,"click"]],template:function(o,p){1&o&&(s.TgZ(0,"div")(1,"span"),s._uU(2),s.qZA(),s.TgZ(3,"div",0)(4,"button",1),s.NdJ("click",function(){return p.closeDialog(!1)}),s._uU(5," \u53d6\u6d88 "),s.qZA(),s.TgZ(6,"button",2),s.NdJ("click",function(){return p.closeDialog(!0)}),s._uU(7," \u786e\u5b9a "),s.qZA()()()),2&o&&(s.xp6(2),s.Oqu(p.messageData))}}),r})();var Nt=St(2340);const $t=function(){return{background:"red"}},qt=function(){return{"":""}};function _e(r,a){if(1&r){const o=s.EpF();s.TgZ(0,"span")(1,"img",1),s.NdJ("click",function(){const v=s.CHM(o).$implicit,b=s.oxw();return s.KtG(b.sendMarkerName(v))}),s.qZA()()}if(2&r){const o=a.$implicit,p=s.oxw();s.xp6(1),s.Q6J("ngStyle",o==p.activeMarker?s.DdM(2,$t):s.DdM(3,qt))("src",p.serverUrl+"marker-icons/all_maki_icons/svgs/"+o+".svg",s.LSH)}}let yt=(()=>{class r{constructor(o,p){this.dialogRef=o,this.data=p,this.markerList=["aerialway","landmark","airfield","landuse","airport","laundry","alcohol-shop","library","american-football","lighthouse-JP","amusement-park","lighthouse","aquarium","lodging","arrow","logging","art-gallery","marker-stroked","attraction","marker","bakery","mobile-phone","bank-JP","monument-JP","bank","monument","bar","mountain","barrier","museum","baseball","music","basketball","natural","bbq","observation-tower","beach","optician","beer","paint","bicycle-share","park-alt1","bicycle","park","blood-bank","parking-garage","bowling-alley","parking","bridge","pharmacy","building-alt1","picnic-site","building","pitch","bus","place-of-worship","cafe","playground","campsite","police-JP","car-rental","police","car-repair","post-JP","car","post","casino","prison","castle-JP","racetrack-boat","castle","racetrack-cycling","caution","racetrack-horse","cemetery-JP","racetrack","cemetery","rail-light","charging-station","rail-metro","cinema","rail","circle-stroked","ranger-station","circle","recycling","city","religious-buddhist","clothing-store","religious-christian","college-JP","religious-jewish","college","religious-muslim","commercial","religious-shinto","communications-tower","residential-community","confectionery","restaurant-bbq","construction","restaurant-noodle","convenience","restaurant-pizza","cricket","restaurant-seafood","cross","restaurant-sushi","dam","restaurant","danger","road-accident","defibrillator","roadblock","dentist","rocket","diamond","school-JP","doctor","school","dog-park","scooter","drinking-water","shelter","elevator","shoe","embassy","shop","emergency-phone","skateboard","entrance-alt1","skiing","entrance","slaughterhouse","farm","slipway","fast-food","snowmobile","fence","soccer","ferry-JP","square-stroked","ferry","square","fire-station-JP","stadium","fire-station","star-stroked","fitness-centre","star","florist","suitcase","fuel","swimming","furniture","table-tennis","gaming","teahouse","garden-centre","telephone","garden","tennis","gift","theatre","globe","toilet","golf","town-hall","grocery","town","hairdresser","triangle-stroked","harbor","triangle","hardware","veterinary","heart","viewpoint","heliport","village","highway-rest-area","volcano","home","volleyball","horse-riding","warehouse","hospital-JP","waste-basket","hospital","watch","hot-spring","\twater","ice-cream","waterfall","industry","watermill","information","wetland","jewelry-store","wheelchair","karaoke","windmill","landmark-JP","zoo"],this.serverUrl=Nt.N.serverUrl}ngOnInit(){this.data&&(this.activeMarker=this.data.markerName)}sendMarkerName(o){this.dialogRef.close(o)}}return r.\u0275fac=function(o){return new(o||r)(s.Y36(ht.so),s.Y36(ht.WI))},r.\u0275cmp=s.Xpm({type:r,selectors:[["app-icon-list-dialog"]],decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],["role","button","alt","",1,"p-2",3,"ngStyle","src","click"]],template:function(o,p){1&o&&s.YNc(0,_e,2,4,"span",0),2&o&&s.Q6J("ngForOf",p.markerList)},dependencies:[dt.sg,dt.PC],styles:["img[_ngcontent-%COMP%]:hover{background-color:#0ff}"]}),r})(),xt=(()=>{class r{constructor(){this.showIdentityFeatureStatus=new s.vpe,this.getIdentityFeatureData=new s.vpe}sendShowIdentityFeatureStatus(o){this.showIdentityFeatureStatus.emit(o)}sendIdentityFeatureData(o){this.getIdentityFeatureData.emit(o)}}return r.\u0275fac=function(o){return new(o||r)},r.\u0275prov=s.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var Yt=St(4987);let ge=(()=>{class r{constructor(){this.getDataTableStatus=new s.vpe,this.getSourceData=new s.vpe,this.getStyleDetails=new s.vpe,this.popData=o=>{this.popUp.setLngLat([o.lngLat.lng,o.lngLat.lat]).setHTML(`<span style='${this.popUpStyle}'>${this.popUpMessage}</span>`).addTo(this.map)}}sendShowDataTableStatus(o){this.getDataTableStatus.emit(o)}sendSourceData(o){this.getSourceData.emit(o)}sendStyleDetails(o){this.getStyleDetails.emit(o)}initializeMapPopUp(){this.popUp=new Yt.Popup({closeButton:!1,closeOnClick:!1})}useMapPopUp(o,p,y=""){this.map=o,this.popUpStyle=y,this.popUpMessage=p,o.on("mousemove",this.popData),o.on("mouseout",()=>{this.popUp.remove()})}removeMapPopUp(){this.map.off("mousemove",this.popData),this.popUp.remove()}}return r.\u0275fac=function(o){return new(o||r)},r.\u0275prov=s.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var Z=St(2851);let it=(()=>{class r{constructor(o,p,y,v){this.dataShareService=o,this.styleService=p,this.dialogRef=y,this.data=v,v&&(this.textId=v.textField.id,this.textColor=v.textField.styledetails.styledata.color,this.textName=v.textField.styledetails.styledata.textname,this.textHeight=v.textField.styledetails.styledata.height,this.textWidth=v.textField.styledetails.styledata.width,this.textFontSize=v.textField.styledetails.styledata.textfontsize,this.textLat=v.textField.geometry.coordinates[1],this.textLng=v.textField.geometry.coordinates[0],this.geo_json_main=v.geo_json_main,this.map=v.map)}submitBtn(){this.textFontSize>=5&&this.dialogRef.close({textColor:this.textColor,textLat:this.textLat,textLng:this.textLng,textHeight:this.textHeight,textWidth:this.textWidth,textName:this.textName,textFontSize:this.textFontSize,id:this.textId})}deleteText(){let o=JSON.parse(JSON.stringify({...this.geo_json_main})),p=this.geo_json_main.features.findIndex(y=>y.id==this.textId);o.features.splice(p,1),this.dataShareService.sendSourceData(o),this.styleService.setDataOnMap(this.map,o,!0,!1),this.closeBtn()}closeBtn(){this.dialogRef.close()}ngOnInit(){}}return r.\u0275fac=function(o){return new(o||r)(s.Y36(ge),s.Y36(X),s.Y36(ht.so),s.Y36(ht.WI))},r.\u0275cmp=s.Xpm({type:r,selectors:[["app-text-edit"]],decls:32,vars:7,consts:[[1,"mb-1"],["for","textname"],["type","text","name","","id","textname",3,"ngModel","ngModelChange"],["for","color"],["id","color",3,"colorPicker","colorPickerChange"],["for","textFontSize"],["type","number","name","","id","textFontSize","min","5",3,"ngModel","ngModelChange"],["for","lat"],["type","text","name","","id","lat",3,"ngModel","ngModelChange"],["for","lng"],["type","text","name","","id","lng",3,"ngModel","ngModelChange"],[1,"mt-3","text-center"],[1,"btn","btn-sm","btn-secondary",3,"click"],[1,"btn","btn-sm","btn-success","ms-1",3,"click"],[1,"btn","btn-sm","btn-danger","ms-1",3,"click"]],template:function(o,p){1&o&&(s.TgZ(0,"div",0)(1,"label",1),s._uU(2,"Name"),s.qZA(),s._uU(3," : "),s.TgZ(4,"input",2),s.NdJ("ngModelChange",function(v){return p.textName=v}),s.qZA()(),s.TgZ(5,"div",0)(6,"label",3),s._uU(7,"Color"),s.qZA(),s._uU(8," : "),s.TgZ(9,"input",4),s.NdJ("colorPickerChange",function(v){return p.textColor=v}),s.qZA()(),s.TgZ(10,"div",0)(11,"label",5),s._uU(12,"Size"),s.qZA(),s._uU(13," : "),s.TgZ(14,"input",6),s.NdJ("ngModelChange",function(v){return p.textFontSize=v}),s.qZA()(),s.TgZ(15,"div",0)(16,"label",7),s._uU(17,"Lat"),s.qZA(),s._uU(18," : "),s.TgZ(19,"input",8),s.NdJ("ngModelChange",function(v){return p.textLat=v}),s.qZA()(),s.TgZ(20,"div",0)(21,"label",9),s._uU(22,"Lng"),s.qZA(),s._uU(23," : "),s.TgZ(24,"input",10),s.NdJ("ngModelChange",function(v){return p.textLng=v}),s.qZA()(),s.TgZ(25,"div",11)(26,"button",12),s.NdJ("click",function(){return p.closeBtn()}),s._uU(27,"Close"),s.qZA(),s.TgZ(28,"button",13),s.NdJ("click",function(){return p.submitBtn()}),s._uU(29,"Submit"),s.qZA(),s.TgZ(30,"button",14),s.NdJ("click",function(){return p.deleteText()}),s._uU(31,"Delete"),s.qZA()()),2&o&&(s.xp6(4),s.Q6J("ngModel",p.textName),s.xp6(5),s.Udp("background",p.textColor),s.Q6J("colorPicker",p.textColor),s.xp6(5),s.Q6J("ngModel",p.textFontSize),s.xp6(5),s.Q6J("ngModel",p.textLat),s.xp6(5),s.Q6J("ngModel",p.textLng))},dependencies:[lt.Fj,lt.wV,lt.JJ,lt.qQ,lt.On,Z.Kk],styles:["label[_ngcontent-%COMP%]{width:50px;text-align:left;display:inline-block}input[type=number][_ngcontent-%COMP%]:out-of-range{outline-color:red}"]}),r})();var $=St(7009);let tt=(()=>{class r{constructor(o){this._snackBar=o}openSnackbar(o,p){this._snackBar.open(o,"X",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:p})}}return r.\u0275fac=function(o){return new(o||r)(s.LFG($.ux))},r.\u0275prov=s.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})(),X=(()=>{class r{constructor(o,p,y,v){this.snackBarService=o,this.matDialog=p,this.dataShareService=y,this.identityFeatureService=v,this.canDeleteMarker=!1,this.newMarkerGeoJSON={type:"FeatureCollection",features:[]},this.fillColorArray=[],this.fillOpacityArray=[],this.fillBorderColorArray=[],this.lineColorArray=[],this.lineWidthArray=[],this.circleRadiusArray=[],this.circleColorArray=[],this.fillBorderWidthArray=[],this.dataState=[],this.currentStateIndex=0,this.isUndoChecked=!1,this.dataShareService.getSourceData.subscribe(b=>{this.geo_json_main=b})}setColorArrayData(o){this.fillColorArray=[],this.fillOpacityArray=[],this.fillBorderColorArray=[],this.fillBorderWidthArray=[],this.lineColorArray=[],this.lineWidthArray=[],this.circleColorArray=[],this.circleRadiusArray=[],this.map=o,this.geo_json_main&&(this.geo_json_main.features.forEach(p=>{void 0!==p.styledetails.styledata.circlecolor&&(this.circleColorArray.push(p.id),this.circleColorArray.push(p.styledetails.styledata.circlecolor)),void 0!==p.styledetails.styledata.circleradius&&(this.circleRadiusArray.push(p.id),this.circleRadiusArray.push(Number(p.styledetails.styledata.circleradius))),void 0!==p.styledetails.styledata.linecolor&&(this.lineColorArray.push(p.id),this.lineColorArray.push(p.styledetails.styledata.linecolor)),void 0!==p.styledetails.styledata.linewidth&&(this.lineWidthArray.push(p.id),this.lineWidthArray.push(Number(p.styledetails.styledata.linewidth))),void 0!==p.styledetails.styledata.fillcolor&&(this.fillColorArray.push(p.id),this.fillColorArray.push(p.styledetails.styledata.fillcolor)),void 0!==p.styledetails.styledata.fillbordercolor&&(this.fillBorderColorArray.push(p.id),this.fillBorderColorArray.push(p.styledetails.styledata.fillbordercolor)),void 0!==p.styledetails.styledata.fillopacity&&(this.fillOpacityArray.push(p.id),this.fillOpacityArray.push(Number(p.styledetails.styledata.fillopacity))),void 0!==p.styledetails.styledata.fillborderwidth&&(this.fillBorderWidthArray.push(p.id),this.fillBorderWidthArray.push(Number(p.styledetails.styledata.fillborderwidth))),null==p.styledetails.styledata.circlecolor&&(this.circleColorArray.push(p.id),this.circleColorArray.push("orange")),null==p.styledetails.styledata.circleradius&&(this.circleRadiusArray.push(p.id),this.circleRadiusArray.push(5)),null==p.styledetails.styledata.linecolor&&(this.lineColorArray.push(p.id),this.lineColorArray.push("orange")),null==p.styledetails.styledata.linewidth&&(this.lineWidthArray.push(p.id),this.lineWidthArray.push(5)),null==p.styledetails.styledata.fillopacity&&(this.fillOpacityArray.push(p.id),this.fillOpacityArray.push(5)),null==p.styledetails.styledata.fillbordercolor&&(this.fillBorderColorArray.push(p.id),this.fillBorderColorArray.push("#3b1513")),null==p.styledetails.styledata.fillcolor&&(this.fillColorArray.push(p.id),this.fillColorArray.push("orange")),null==p.styledetails.styledata.fillborderwidth&&(this.fillBorderWidthArray.push(p.id),this.fillBorderWidthArray.push(2))}),this.setLastElementInEachStyle())}setLastElementInEachStyle(){this.circleColorArray.push("#B42222"),this.circleRadiusArray.push(6),this.lineColorArray.push("#BF93E4"),this.lineWidthArray.push(5),this.fillColorArray.push("#10CAF0"),this.fillBorderColorArray.push("#3b1513"),this.fillBorderWidthArray.push(2),this.fillOpacityArray.push(.4),this.setPaintFinally()}setPaintFinally(){this.map.setPaintProperty("YourMapSourceIdPolygon","fill-color",this.paintArrayCreator("fill-color")),this.map.setPaintProperty("YourMapSourceIdPolygon","fill-opacity",this.paintArrayCreator("fill-opacity")),this.map.setPaintProperty("YourMapSourceIdPolygonLineString","line-color",this.paintArrayCreator("polygon-border-color")),this.map.setPaintProperty("YourMapSourceIdPolygonLineString","line-width",this.paintArrayCreator("polygon-border-width")),this.map.setPaintProperty("YourMapSourceIdPoint","circle-color",this.paintArrayCreator("circle-color")),this.map.setPaintProperty("YourMapSourceIdPoint","circle-radius",this.paintArrayCreator("circle-radius")),this.map.setPaintProperty("YourMapSourceIdLineString","line-color",this.paintArrayCreator("line-color")),this.map.setPaintProperty("YourMapSourceIdLineString","line-width",this.paintArrayCreator("line-width"))}paintArrayCreator(o){let p=["match",["get","featureid"]];return"fill-color"==o&&p.push(...this.fillColorArray),"fill-opacity"==o&&p.push(...this.fillOpacityArray),"polygon-border-color"==o&&p.push(...this.fillBorderColorArray),"polygon-border-width"==o&&p.push(...this.fillBorderWidthArray),"circle-color"==o&&p.push(...this.circleColorArray),"circle-radius"==o&&p.push(...this.circleRadiusArray),"line-color"==o&&p.push(...this.lineColorArray),"line-width"==o&&p.push(...this.lineWidthArray),p}setDataOnMap(o,p,y=!0,v=!0){v&&this.setDataSourceFn(JSON.parse(JSON.stringify({...p}))),y&&this.deleteAllMarkers(),this.newMarkerGeoJSON={type:"FeatureCollection",features:[]},this.map=o;let b={...p};-1==b.features.findIndex(M=>"marker"==M.geometry.type)?(this.map.getSource("YourMapSource").setData(b),b.features.length>0&&this.setColorArrayData(this.map)):this.seprateMarkerLayer(b)}seprateMarkerLayer(o){let p=JSON.parse(JSON.stringify(o)),y=[];if(o.features.forEach((v,b)=>{"marker"==v.geometry.type&&(y.push(b),this.newMarkerGeoJSON.features.push(v))}),y){let v=0;y.forEach(b=>{p.features.splice(b-v,1),v++})}this.map.getSource("YourMapSource").setData(p),o.features.length>0&&this.setColorArrayData(this.map),this.addMarkerLayerOnMap()}addMarkerLayerOnMap(){for(const o of this.newMarkerGeoJSON.features)if(o.styledetails.styledata.markername){let p=Nt.N.serverUrl+`marker-icons/all_maki_icons/svgs/${o.styledetails.styledata.markername}.svg`;const y=document.createElement("div"),v=o.styledetails.styledata.height,b=o.styledetails.styledata.width;y.className="marker",y.id=o.styledetails.id,y.style.backgroundImage=`url(${p})`,y.style.width=`${v}px`,y.style.height=`${b}px`,y.style.backgroundSize="100%",y.style.backgroundPosition="center",y.style.backgroundRepeat="no-repeat",y.style.cursor="pointer",y.addEventListener("click",()=>{this.sendIdentityFeatureStatus(o)}),y.addEventListener("contextmenu",()=>{this.sendIdentityFeatureStatus(o)}),new Yt.Marker(y).setLngLat(o.geometry.coordinates).addTo(this.map)}else if(o.styledetails.styledata.textname){let p=!0;const y=document.createElement("div"),v=o.styledetails.styledata.width,b=o.styledetails.styledata.height;y.className="marker",y.id=o.styledetails.id,y.innerHTML=`${o.styledetails.styledata.textname}`,y.style.width=`${v}px`,y.style.height=`${b}px`,y.style.backgroundSize="100%",y.style.backgroundPosition="center",y.style.backgroundRepeat="no-repeat",y.style.cursor="pointer",y.style.color=o.styledetails.styledata.color,y.style.fontSize=`${o.styledetails.styledata.textfontsize}px`,new Yt.Marker(y,{draggable:!0}).setLngLat(o.geometry.coordinates).addTo(this.map).on("dragend",M=>{if(p){let C={...this.geo_json_main};const O=M.target.getLngLat();let k=C.features.findIndex(N=>y.id==N.id);C.features[k].geometry.coordinates=[O.lng,O.lat],this.setDataOnMap(this.map,C),this.dataShareService.sendSourceData(C)}}),y.addEventListener("contextmenu",()=>{p=this.openTextFieldPopUp(o,p)}),y.addEventListener("click",()=>{this.canDeleteMarker?this.deleteFeature(o):p=this.openTextFieldPopUp(o,p)})}}openTextFieldPopUp(o,p){this.matDialog.open(it,{data:{textField:o,geo_json_main:this.geo_json_main,map:this.map},disableClose:!0}).afterClosed().subscribe(v=>{let b={...this.geo_json_main};if(v){let I=b.features.findIndex(M=>v.id==M.id);b.features[I].geometry.coordinates=[v.textLng,v.textLat],b.features[I].styledetails.styledata.color=v.textColor,b.features[I].styledetails.styledata.height=v.textHeight,b.features[I].styledetails.styledata.width=v.textWidth,b.features[I].styledetails.styledata.textname=v.textName,b.features[I].styledetails.styledata.textfontsize=v.textFontSize}return this.setDataOnMap(this.map,b),this.dataShareService.sendSourceData(b),!1})}setTextFieldData(o){}deleteAllMarkers(){this.newMarkerGeoJSON.features.length>0&&(this.newMarkerGeoJSON.features.forEach(o=>{document.getElementById(`${o.styledetails.id}`).remove()}),this.newMarkerGeoJSON={type:"FeatureCollection",features:[]})}sendIdentityFeatureStatus(o){this.canDeleteMarker?this.deleteFeature(o):this.showIdentityFeature(this.identityFeatureData(o.properties))}deleteFeature(o){let p={...this.geo_json_main},y=p.features.findIndex(v=>v.id==o.properties.featureid);p.features.splice(y,1),this.setDataOnMap(this.map,p),this.dataShareService.sendSourceData(p)}identityFeatureData(o){let p=Object.keys(o),y=[];return p.forEach(v=>{let b={name:"",value:""};b.name=v,b.value=o[v],y.push(b)}),y}showIdentityFeature(o){setTimeout(()=>{this.identityFeatureService.sendShowIdentityFeatureStatus(!1),setTimeout(()=>{this.identityFeatureService.sendShowIdentityFeatureStatus(!0),this.identityFeatureService.sendIdentityFeatureData(o)},200)},0)}setDataSourceFn(o){this.isUndoChecked&&(this.dataState.length=this.currentStateIndex);let p=JSON.parse(JSON.stringify({...o}));this.dataState.push(p),this.currentStateIndex++,this.isUndoChecked=!1}handleUndo(){if(this.dataState.length>0)if(this.currentStateIndex--,this.currentStateIndex<=0)this.snackBarService.openSnackbar("You can't undo from this state'","snackbar-err"),this.currentStateIndex++;else{let o=this.dataState[this.currentStateIndex-1];this.setDataOnMap(this.map,JSON.parse(JSON.stringify({...o})),!0,!1),this.dataShareService.sendSourceData(JSON.parse(JSON.stringify({...o}))),this.setColorArrayData(this.map),this.isUndoChecked=!0}else this.snackBarService.openSnackbar("Please draw some feature first","snackbar-err")}handleRedo(){if(this.dataState.length>0)if(this.currentStateIndex++,this.currentStateIndex>this.dataState.length)this.snackBarService.openSnackbar("You can't redo from this state","snackbar-err"),this.currentStateIndex--;else{let o=this.dataState[this.currentStateIndex-1];this.setDataOnMap(this.map,JSON.parse(JSON.stringify({...o})),!0,!1),this.dataShareService.sendSourceData(JSON.parse(JSON.stringify({...o}))),this.setColorArrayData(this.map),this.isUndoChecked=!0}else this.snackBarService.openSnackbar("Please use undo first","snackbar-err")}}return r.\u0275fac=function(o){return new(o||r)(s.LFG(tt),s.LFG(ht.uw),s.LFG(ge),s.LFG(xt))},r.\u0275prov=s.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var rt=St(7392),H=St(455);function et(r,a){if(1&r){const o=s.EpF();s.TgZ(0,"div")(1,"div")(2,"img",19),s.NdJ("click",function(){s.CHM(o);const y=s.oxw(3);return s.KtG(y.showMarkerList())}),s.qZA()(),s.TgZ(3,"div",20)(4,"label",21),s._uU(5,"\u9ad8\u5ea6"),s.qZA(),s._uU(6," : "),s.TgZ(7,"input",22),s.NdJ("ngModelChange",function(y){s.CHM(o);const v=s.oxw(3);return s.KtG(v.markerHeight=y)}),s.qZA()(),s.TgZ(8,"div",23)(9,"label",24),s._uU(10,"\u5bbd\u5ea6"),s.qZA(),s._uU(11," : "),s.TgZ(12,"input",25),s.NdJ("ngModelChange",function(y){s.CHM(o);const v=s.oxw(3);return s.KtG(v.markerWidth=y)}),s.qZA()()()}if(2&r){const o=s.oxw(3);s.xp6(2),s.Q6J("src",o.markerUrl,s.LSH),s.xp6(5),s.Q6J("ngModel",o.markerHeight),s.xp6(5),s.Q6J("ngModel",o.markerWidth)}}function at(r,a){if(1&r){const o=s.EpF();s.TgZ(0,"div")(1,"div",26)(2,"label",27),s._uU(3,"\u586b\u5145\u8272"),s.qZA(),s._uU(4," : "),s.TgZ(5,"input",28),s.NdJ("colorPickerChange",function(y){s.CHM(o);const v=s.oxw(3);return s.KtG(v.fillColor=y)}),s.qZA()(),s.TgZ(6,"div",26)(7,"label",29),s._uU(8,"\u8fb9\u6846\u8272"),s.qZA(),s._uU(9," : "),s.TgZ(10,"input",30),s.NdJ("colorPickerChange",function(y){s.CHM(o);const v=s.oxw(3);return s.KtG(v.fillBorderColor=y)}),s.qZA()(),s.TgZ(11,"div",26)(12,"label",31),s._uU(13,"\u8fb9\u6846\u5bbd\u5ea6"),s.qZA(),s._uU(14," : "),s.TgZ(15,"input",32),s.NdJ("ngModelChange",function(y){s.CHM(o);const v=s.oxw(3);return s.KtG(v.fillBorderWidth=y)}),s.qZA()(),s.TgZ(16,"div",26)(17,"label",31),s._uU(18,"\u586b\u5145\u900f\u660e\u5ea6"),s.qZA(),s._uU(19," : "),s.TgZ(20,"input",32),s.NdJ("ngModelChange",function(y){s.CHM(o);const v=s.oxw(3);return s.KtG(v.fillOpacity=y)}),s.qZA()()()}if(2&r){const o=s.oxw(3);s.xp6(5),s.Udp("background",o.fillColor),s.Q6J("colorPicker",o.fillColor),s.xp6(5),s.Udp("background",o.fillBorderColor),s.Q6J("colorPicker",o.fillBorderColor),s.xp6(5),s.Q6J("ngModel",o.fillBorderWidth),s.xp6(5),s.Q6J("ngModel",o.fillOpacity)}}function j(r,a){if(1&r){const o=s.EpF();s.TgZ(0,"div")(1,"div",26)(2,"label",29),s._uU(3,"\u7ebf\u989c\u8272"),s.qZA(),s._uU(4," : "),s.TgZ(5,"input",30),s.NdJ("colorPickerChange",function(y){s.CHM(o);const v=s.oxw(3);return s.KtG(v.lineColor=y)}),s.qZA()(),s.TgZ(6,"div",26)(7,"label",31),s._uU(8,"\u7ebf\u5bbd"),s.qZA(),s._uU(9," : "),s.TgZ(10,"input",33),s.NdJ("ngModelChange",function(y){s.CHM(o);const v=s.oxw(3);return s.KtG(v.lineWidth=y)}),s.qZA()()()}if(2&r){const o=s.oxw(3);s.xp6(5),s.Udp("background",o.lineColor),s.Q6J("colorPicker",o.lineColor),s.xp6(5),s.Q6J("ngModel",o.lineWidth)}}function Wt(r,a){if(1&r){const o=s.EpF();s.TgZ(0,"div")(1,"div",26)(2,"label",29),s._uU(3,"\u5706\u989c\u8272"),s.qZA(),s._uU(4," : "),s.TgZ(5,"input",30),s.NdJ("colorPickerChange",function(y){s.CHM(o);const v=s.oxw(3);return s.KtG(v.circleColor=y)}),s.qZA()(),s.TgZ(6,"div",26)(7,"label",31),s._uU(8,"\u5706\u534a\u5f84"),s.qZA(),s._uU(9," : "),s.TgZ(10,"input",34),s.NdJ("ngModelChange",function(y){s.CHM(o);const v=s.oxw(3);return s.KtG(v.circleRadius=y)}),s.qZA()()()}if(2&r){const o=s.oxw(3);s.xp6(5),s.Udp("background",o.circleColor),s.Q6J("colorPicker",o.circleColor),s.xp6(5),s.Q6J("ngModel",o.circleRadius)}}function Ct(r,a){if(1&r&&(s.TgZ(0,"div")(1,"div",18),s.YNc(2,et,13,3,"div",7),s.YNc(3,at,21,8,"div",7),s.YNc(4,j,11,4,"div",7),s.YNc(5,Wt,11,4,"div",7),s.qZA()()),2&r){const o=s.oxw(2);s.xp6(2),s.Q6J("ngIf","marker"==(null==o.geo_json_main||null==o.geo_json_main.features[o.CurrentFeatureindex]||null==o.geo_json_main.features[o.CurrentFeatureindex].geometry?null:o.geo_json_main.features[o.CurrentFeatureindex].geometry.type)),s.xp6(1),s.Q6J("ngIf","Polygon"==(null==o.geo_json_main||null==o.geo_json_main.features[o.CurrentFeatureindex]||null==o.geo_json_main.features[o.CurrentFeatureindex].geometry?null:o.geo_json_main.features[o.CurrentFeatureindex].geometry.type)),s.xp6(1),s.Q6J("ngIf","LineString"==(null==o.geo_json_main||null==o.geo_json_main.features[o.CurrentFeatureindex]||null==o.geo_json_main.features[o.CurrentFeatureindex].geometry?null:o.geo_json_main.features[o.CurrentFeatureindex].geometry.type)),s.xp6(1),s.Q6J("ngIf","Point"==(null==o.geo_json_main||null==o.geo_json_main.features[o.CurrentFeatureindex]||null==o.geo_json_main.features[o.CurrentFeatureindex].geometry?null:o.geo_json_main.features[o.CurrentFeatureindex].geometry.type))}}function kt(r,a){if(1&r&&(s.TgZ(0,"div"),s.YNc(1,Ct,6,4,"div",7),s.qZA()),2&r){const o=s.oxw();s.xp6(1),s.Q6J("ngIf",o.geo_json_main)}}function gt(r,a){if(1&r&&(s.TgZ(0,"table",37)(1,"tr")(2,"td",38),s._uU(3," Sq. Meters "),s.qZA(),s.TgZ(4,"td",38),s._uU(5),s.qZA()(),s.TgZ(6,"tr")(7,"td",38),s._uU(8," Sq. Kilometers "),s.qZA(),s.TgZ(9,"td",38),s._uU(10),s.qZA()(),s.TgZ(11,"tr")(12,"td",38),s._uU(13,"Sq. Feet"),s.qZA(),s.TgZ(14,"td",38),s._uU(15),s.qZA()(),s.TgZ(16,"tr")(17,"td",38),s._uU(18,"Acres"),s.qZA(),s.TgZ(19,"td",38),s._uU(20),s.qZA()(),s.TgZ(21,"tr")(22,"td",38),s._uU(23,"Sq. Miles"),s.qZA(),s.TgZ(24,"td",38),s._uU(25),s.qZA()()()),2&r){const o=s.oxw(2);s.xp6(5),s.hij(" ",o.polygonMeasurement," "),s.xp6(5),s.hij(" ",o.polygonMeasurement/1e6," "),s.xp6(5),s.hij(" ",10.76*o.polygonMeasurement," "),s.xp6(5),s.hij(" ",.0002471054*o.polygonMeasurement," "),s.xp6(5),s.hij(" ",39e-8*o.polygonMeasurement," ")}}function Fe(r,a){if(1&r&&(s.TgZ(0,"table",37)(1,"tr")(2,"td",38),s._uU(3,"Meters"),s.qZA(),s.TgZ(4,"td",38),s._uU(5),s.qZA()(),s.TgZ(6,"tr")(7,"td",38),s._uU(8," Kilometers "),s.qZA(),s.TgZ(9,"td",38),s._uU(10),s.qZA()(),s.TgZ(11,"tr")(12,"td",38),s._uU(13,"Feet"),s.qZA(),s.TgZ(14,"td",38),s._uU(15),s.qZA()(),s.TgZ(16,"tr")(17,"td",38),s._uU(18,"Yards"),s.qZA(),s.TgZ(19,"td",38),s._uU(20),s.qZA()(),s.TgZ(21,"tr")(22,"td",38),s._uU(23,"Miles"),s.qZA(),s.TgZ(24,"td",38),s._uU(25),s.qZA()()()),2&r){const o=s.oxw(2);s.xp6(5),s.hij(" ",1e3*o.lineMeasurement," "),s.xp6(5),s.hij(" ",o.lineMeasurement," "),s.xp6(5),s.hij(" ",3280.84*o.lineMeasurement," "),s.xp6(5),s.hij(" ",1093.61*o.lineMeasurement," "),s.xp6(5),s.hij(" ",.621371*o.lineMeasurement," ")}}function Ie(r,a){if(1&r&&(s.TgZ(0,"table",37)(1,"tr")(2,"td",39),s._uU(3,"Latitude"),s.qZA(),s.TgZ(4,"td",39),s._uU(5),s.qZA()(),s.TgZ(6,"tr")(7,"td",39),s._uU(8,"Longitude"),s.qZA(),s.TgZ(9,"td",39),s._uU(10),s.qZA()()()),2&r){const o=s.oxw(2);s.xp6(5),s.hij(" ",o.geo_json_main.features[o.CurrentFeatureindex].geometry.coordinates[0]," "),s.xp6(5),s.hij(" ",o.geo_json_main.features[o.CurrentFeatureindex].geometry.coordinates[1]," ")}}function It(r,a){if(1&r&&(s.TgZ(0,"div",35),s.YNc(1,gt,26,5,"table",36),s.YNc(2,Fe,26,5,"table",36),s.YNc(3,Ie,11,2,"table",36),s.qZA()),2&r){const o=s.oxw();s.xp6(1),s.Q6J("ngIf","Polygon"==(null==o.geo_json_main||null==o.geo_json_main.features[o.CurrentFeatureindex]||null==o.geo_json_main.features[o.CurrentFeatureindex].geometry?null:o.geo_json_main.features[o.CurrentFeatureindex].geometry.type)),s.xp6(1),s.Q6J("ngIf","LineString"==(null==o.geo_json_main||null==o.geo_json_main.features[o.CurrentFeatureindex]||null==o.geo_json_main.features[o.CurrentFeatureindex].geometry?null:o.geo_json_main.features[o.CurrentFeatureindex].geometry.type)),s.xp6(1),s.Q6J("ngIf","Point"==(null==o.geo_json_main||null==o.geo_json_main.features[o.CurrentFeatureindex]||null==o.geo_json_main.features[o.CurrentFeatureindex].geometry?null:o.geo_json_main.features[o.CurrentFeatureindex].geometry.type)||"marker"==(null==o.geo_json_main||null==o.geo_json_main.features[o.CurrentFeatureindex]||null==o.geo_json_main.features[o.CurrentFeatureindex].geometry?null:o.geo_json_main.features[o.CurrentFeatureindex].geometry.type))}}function pe(r,a){if(1&r){const o=s.EpF();s.TgZ(0,"div"),s._UZ(1,"input",42)(2,"input",43),s.TgZ(3,"button",44),s.NdJ("click",function(){s.CHM(o);const y=s.oxw().index,v=s.oxw();return s.KtG(v.removeAttribute(y))}),s._uU(4," - "),s.qZA()()}if(2&r){const o=s.oxw().index;s.xp6(1),s.Q6J("readonly",0==o),s.xp6(1),s.Q6J("readonly",0==o),s.xp6(1),s.Q6J("disabled",0==o)}}function Pt(r,a){if(1&r&&(s.TgZ(0,"div",40)(1,"div",41),s.YNc(2,pe,5,3,"div",7),s.qZA()()),2&r){const o=a.index;s.xp6(1),s.Q6J("formGroupName",o),s.xp6(1),s.Q6J("ngIf",0!==o)}}function te(r,a){1&r&&(s.TgZ(0,"div",45),s._uU(1," * \u70b9\u56fe\u6807\u6837\u5f0f\u53ef\u70b9\u51fb\u4fee\u6539 "),s.qZA())}let le=(()=>{class r{constructor(o,p,y,v,b,I){this.identityFeatureService=o,this.dataShareService=p,this._fb=y,this.matDialog=v,this.styleService=b,this.snackbarService=I}ngOnInit(){this.identityFeatureService.showIdentityFeatureStatus.subscribe(o=>{o||this.closeIdentity(),this.showIdentityFeature=o}),this.identityFeatureService.getIdentityFeatureData.subscribe(o=>{this.featureFormData=o,this.setFeatureFormData(),this.findFeatureIndex(),this.setStyleDetails()}),this.dataShareService.getSourceData.subscribe(o=>{this.geo_json_main=o}),this.initializeFormArray()}setStyleDetails(){"marker"==this.geo_json_main.features[this.CurrentFeatureindex].geometry.type&&(this.markerName=this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.markername,this.markerHeight=this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.height,this.markerWidth=this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.width,this.markerUrl=Nt.N.serverUrl+`marker-icons/all_maki_icons/svgs/${this.markerName}.svg`),"Polygon"==this.geo_json_main.features[this.CurrentFeatureindex].geometry.type&&(this.fillColor=this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.fillcolor,this.fillBorderColor=this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.fillbordercolor,this.fillBorderWidth=this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.fillborderwidth,this.fillOpacity=this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.fillopacity,this.polygonMeasurement=this.geo_json_main.features[this.CurrentFeatureindex].measurement.squaremeters),"LineString"==this.geo_json_main.features[this.CurrentFeatureindex].geometry.type&&(this.lineColor=this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.linecolor,this.lineWidth=this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.linewidth,this.lineMeasurement=this.geo_json_main.features[this.CurrentFeatureindex].measurement.kilometers),"Point"==this.geo_json_main.features[this.CurrentFeatureindex].geometry.type&&(this.circleColor=this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.circlecolor,this.circleRadius=this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.circleradius)}saveStyleDetailsInJson(){"marker"==this.geo_json_main.features[this.CurrentFeatureindex].geometry.type&&this.setMarkerStyleDetails(),"Polygon"==this.geo_json_main.features[this.CurrentFeatureindex].geometry.type&&this.setPolygonStyleDetails(),"LineString"==this.geo_json_main.features[this.CurrentFeatureindex].geometry.type&&this.setLineStringStyleDetails(),"Point"==this.geo_json_main.features[this.CurrentFeatureindex].geometry.type&&this.setPointStyleDetails()}setMarkerStyleDetails(){this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.markername=this.markerName,this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.height=this.markerHeight,this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.width=this.markerWidth,this.dataShareService.sendSourceData(this.geo_json_main)}setPolygonStyleDetails(){this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.fillcolor=this.fillColor,this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.fillbordercolor=this.fillBorderColor,this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.fillborderwidth=this.fillBorderWidth,this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.fillopacity=this.fillOpacity,this.dataShareService.sendSourceData(this.geo_json_main)}setLineStringStyleDetails(){this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.linecolor=this.lineColor,this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.linewidth=this.lineWidth}setPointStyleDetails(){this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.circlecolor=this.circleColor,this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.circleradius=this.circleRadius}findFeatureIndex(){this.CurrentFeatureindex=this.geo_json_main.features.findIndex(o=>this.featureFormData[0].value==o.id)}initializeFormArray(){this.featureForm=this._fb.group({identityFormData:this._fb.array([this.putFormData()])})}putFormData(){return this._fb.group({name:["",lt.kI.required],value:["",lt.kI.required]})}get identityFormData(){return this.featureForm.get("identityFormData")}addNewAttribute(){this.identityFormData.push(this.putFormData())}removeAttribute(o){this.identityFormData.removeAt(o)}setFeatureFormData(){let o=this.featureFormData.length;for(let y=1;y<o;y++)this.addNewAttribute();let p=this.featureFormData.findIndex(y=>"featureid"==y.name);if(0!==p){let y=this.featureFormData.splice(p,1)[0];this.featureFormData.splice(0,0,y)}this.identityFormData.patchValue(this.featureFormData)}submitData(){"Polygon"==this.geo_json_main.features[this.CurrentFeatureindex].geometry.type&&this.fillOpacity>=0&&this.fillBorderWidth>=0&&this.finallySubmitData(),"marker"==this.geo_json_main.features[this.CurrentFeatureindex].geometry.type&&this.markerHeight>=10&&this.markerWidth>=10&&this.finallySubmitData(),"LineString"==this.geo_json_main.features[this.CurrentFeatureindex].geometry.type&&this.lineWidth>=1&&this.finallySubmitData(),"Point"==this.geo_json_main.features[this.CurrentFeatureindex].geometry.type&&this.circleRadius>=1&&this.finallySubmitData()}finallySubmitData(){"VALID"==this.featureForm.status?(this.setDataIn_geo_json_main(this.featureForm.get("identityFormData").value),this.closeIdentity(),this.saveStyleDetailsInJson(),this.styleService.setDataOnMap(this.map,this.geo_json_main)):this.snackbarService.openSnackbar("Please fill all the fields or remove empty fields","snackbar-err")}setDataIn_geo_json_main(o){let p=this.setFormDataForProperties(o);this.setNew_geo_json_main_data(p),this.dataShareService.sendSourceData(this.geo_json_main)}setNew_geo_json_main_data(o){let p=this.geo_json_main.features.findIndex(y=>y.id==o.featureid);this.geo_json_main.features[p].properties=o}setFormDataForProperties(o){let p={};return o.forEach(y=>{p[y.name]=y.value}),p}deleteFeature(){this.matDialog.open(Lt,{width:"250px",data:{messageData:"\u786e\u5b9a\u5220\u9664\u8fd9\u4e2a\u8981\u7d20\u5417"},enterAnimationDuration:"200ms",exitAnimationDuration:"200ms"}).afterClosed().subscribe(p=>{p&&(this.deleteFeatureFromGeojson(this.featureFormData[0].value),this.closeIdentity())})}deleteFeatureFromGeojson(o){let p=this.geo_json_main.features;p.splice(this.CurrentFeatureindex,1),this.geo_json_main.features=p,this.styleService.setDataOnMap(this.map,this.geo_json_main),this.dataShareService.sendSourceData(this.geo_json_main)}showMarkerList(){this.matDialog.open(yt,{width:"500px",data:{markerName:this.markerName}}).afterClosed().subscribe(p=>{p&&(this.markerName=p,this.markerUrl=Nt.N.serverUrl+`marker-icons/all_maki_icons/svgs/${this.markerName}.svg`)})}getShowMeasurementStatus(o){this.showMeasurement=o.checked}showIdentity(o){this.featureFormData=o,this.setFeatureFormData(),this.findFeatureIndex(),this.setStyleDetails()}closeIdentity(){this.showIdentityFeature=!1,this.featureForm.reset(),this.identityFormData.controls=[this.putFormData()]}}return r.\u0275fac=function(o){return new(o||r)(s.Y36(xt),s.Y36(ge),s.Y36(lt.qu),s.Y36(ht.uw),s.Y36(X),s.Y36(tt))},r.\u0275cmp=s.Xpm({type:r,selectors:[["app-identity-feature-side-nav"]],inputs:{map:"map"},decls:32,vars:6,consts:[[1,"identity-feature",3,"ngClass"],[1,"p-flex","shadow-sm"],[1,"cancle-icon",3,"click"],[1,"p-flex","my-2","toggle-div"],[1,"me-2"],[1,"d-block",3,"change"],[1,"ms-2"],[4,"ngIf"],["class","p-flex",4,"ngIf"],[1,"mt-2",3,"formGroup","ngSubmit"],["formArrayName","identityFormData",4,"ngFor","ngForOf"],[1,"p-flex","mb-3"],["type","button",1,"btn","btn-sm","d-flex","btn-primary","mt-2","mb-2",3,"click"],[1,"ms-1"],["type","submit",1,"btn","btn-sm","btn-success","ms-2"],["type","button",1,"d-flex","align-items-center","btn","btn-sm","btn-danger","ms-2",3,"click"],[1,"p-0","m-0","d-flex","align-items-center"],["class","alert alert-danger","style","line-height: 15px;",4,"ngIf"],[1,"mt-2"],["height","35px","width","35px","role","button","alt","",1,"ms-2","fs-1",3,"src","click"],[1,"d-flex","justify-content-center","mt-2"],["for","marker-height"],["id","marker-height","type","number","min","10",3,"ngModel","ngModelChange"],[1,"d-flex","justify-content-center","my-2"],["for","marker-width"],["id","marker-width","type","number","min","10",3,"ngModel","ngModelChange"],[1,"d-flex","justify-content-center","mb-2"],["for","fill-color"],["id","fill-color",3,"colorPicker","colorPickerChange"],["for","fill-outline-color"],["id","fill-outline-color",3,"colorPicker","colorPickerChange"],["for","fill-opacity"],["id","fill-opacity","type","number","min","0",3,"ngModel","ngModelChange"],["id","fill-opacity","type","number","min","1",3,"ngModel","ngModelChange"],["id","fill-opacity","type","number","min","2",3,"ngModel","ngModelChange"],[1,"p-flex"],["class","table w-75",4,"ngIf"],[1,"table","w-75"],["scope","col",1,"border","border-1","border-dark","p-2"],[1,"border","border-1","border-dark","p-2"],["formArrayName","identityFormData"],[1,"text-center",3,"formGroupName"],["type","text","formControlName","name",3,"readonly"],["type","text","formControlName","value",3,"readonly"],["type","button",1,"btn","btn-sm","btn-danger",3,"disabled","click"],[1,"alert","alert-danger",2,"line-height","15px"]],template:function(o,p){1&o&&(s.TgZ(0,"div",0)(1,"header",1)(2,"span"),s._uU(3,"\u8981\u7d20\u8bc6\u522b"),s.qZA(),s.TgZ(4,"mat-icon",2),s.NdJ("click",function(){return p.closeIdentity()}),s._uU(5,"cancel"),s.qZA()(),s.TgZ(6,"main")(7,"div",3)(8,"span",4),s._uU(9,"\u6837\u5f0f"),s.qZA(),s.TgZ(10,"mat-slide-toggle",5),s.NdJ("change",function(v){return p.getShowMeasurementStatus(v)}),s.qZA(),s.TgZ(11,"span",6),s._uU(12,"\u4fe1\u606f"),s.qZA()(),s.YNc(13,kt,2,1,"div",7),s.YNc(14,It,4,3,"div",8),s.TgZ(15,"form",9),s.NdJ("ngSubmit",function(){return p.submitData()}),s.YNc(16,Pt,3,2,"div",10),s.TgZ(17,"div",11)(18,"button",12),s.NdJ("click",function(){return p.addNewAttribute()}),s.TgZ(19,"span"),s._uU(20,"+"),s.qZA(),s.TgZ(21,"span",13),s._uU(22,"\u6dfb\u52a0\u5c5e\u6027"),s.qZA()(),s.TgZ(23,"button",14),s._uU(24,"\u63d0\u4ea4"),s.qZA(),s.TgZ(25,"button",15),s.NdJ("click",function(){return p.deleteFeature()}),s.TgZ(26,"span",16)(27,"mat-icon"),s._uU(28,"delete_forever"),s.qZA(),s.TgZ(29,"span"),s._uU(30,"\u5220\u9664"),s.qZA()()()()(),s.YNc(31,te,2,0,"div",17),s.qZA()()),2&o&&(s.Q6J("ngClass",p.showIdentityFeature?"identity-feature-show":"identity-feature-hide"),s.xp6(13),s.Q6J("ngIf",!p.showMeasurement),s.xp6(1),s.Q6J("ngIf",p.showMeasurement),s.xp6(1),s.Q6J("formGroup",p.featureForm),s.xp6(1),s.Q6J("ngForOf",p.identityFormData.controls),s.xp6(15),s.Q6J("ngIf","marker"==(null==p.geo_json_main||null==p.geo_json_main.features[p.CurrentFeatureindex]||null==p.geo_json_main.features[p.CurrentFeatureindex].geometry?null:p.geo_json_main.features[p.CurrentFeatureindex].geometry.type)))},dependencies:[dt.mk,dt.sg,dt.O5,rt.Hw,H.Rr,lt._Y,lt.Fj,lt.wV,lt.JJ,lt.JL,lt.qQ,lt.sg,lt.u,lt.x0,lt.CE,lt.On,Z.Kk],styles:[".toggle-div[_ngcontent-%COMP%]  .mat-slide-toggle.mat-checked:not(.mat-disabled) .mat-slide-toggle-thumb{background-color:#00f}.toggle-div[_ngcontent-%COMP%]  .mat-slide-toggle.mat-checked:not(.mat-disabled) .mat-slide-toggle-bar{background-color:#87ceeb}.identity-feature[_ngcontent-%COMP%]{position:absolute;z-index:3;left:0;top:0;bottom:0;margin:auto 0;width:400px;height:50%;background-color:#e2f2f0;border-left:none;transition:transform .5s}.identity-feature-hide[_ngcontent-%COMP%]{transform:translate(-100%)}.identity-feature-show[_ngcontent-%COMP%]{transform:translate(0)}header[_ngcontent-%COMP%]{height:8%;background-color:#0fcaf0;position:relative;font-size:15px;font-weight:bolder}.cancle-icon[_ngcontent-%COMP%]{position:absolute;right:0;cursor:pointer}main[_ngcontent-%COMP%]{height:92%;overflow-y:auto;overflow-x:hidden;scrollbar-color:#10CAF0 #EFF8FF}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#1e3770;border-radius:10px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1}[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px;height:8px}input.ng-invalid.ng-touched[_ngcontent-%COMP%]{border:2px solid red}label[_ngcontent-%COMP%]{width:150px}input[type=number][_ngcontent-%COMP%]:out-of-range{outline-color:red}"]}),r})();var Ot=St(8527);function nr(r){const a=r.featureTarget;return!(!a||!a.properties)&&"vertex"===a.properties.meta}function pn(r){return 27===r.keyCode}function Kr(r){return 13===r.keyCode}const un={enable(r){setTimeout(()=>{!r.map||!r.map.doubleClickZoom||!r._ctx||!r._ctx.store||!r._ctx.store.getInitialConfigValue||!r._ctx.store.getInitialConfigValue("doubleClickZoom")||r.map.doubleClickZoom.enable()},0)},disable(r){setTimeout(()=>{!r.map||!r.map.doubleClickZoom||r.map.doubleClickZoom.disable()},0)}},Kn=function ei(r,a){return!!r.lngLat&&r.lngLat.lng===a[0]&&r.lngLat.lat===a[1]};function Gn(r,a,o,p){return{type:"Feature",properties:{meta:"vertex",parent:r,coord_path:o,active:p?"true":"false"},geometry:{type:"Point",coordinates:a}}}const Mn={onSetup:function(){const r=this.newFeature({type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[]]}});return this.addFeature(r),this.clearSelectedFeatures(),un.disable(this),this.updateUIClasses({mouse:"add"}),this.activateUIButton("polygon"),this.setActionableState({trash:!0}),{polygon:r,currentVertexPosition:0}},clickAnywhere:function(r,a){if(r.currentVertexPosition>0&&Kn(a,r.polygon.coordinates[0][r.currentVertexPosition-1]))return this.changeMode("simple_select",{featureIds:[r.polygon.id]});this.updateUIClasses({mouse:"add"}),r.polygon.updateCoordinate(`0.${r.currentVertexPosition}`,a.lngLat.lng,a.lngLat.lat),r.currentVertexPosition++,r.polygon.updateCoordinate(`0.${r.currentVertexPosition}`,a.lngLat.lng,a.lngLat.lat)},clickOnVertex:function(r){return this.changeMode("simple_select",{featureIds:[r.polygon.id]})},onMouseMove:function(r,a){r.polygon.updateCoordinate(`0.${r.currentVertexPosition}`,a.lngLat.lng,a.lngLat.lat),nr(a)&&this.updateUIClasses({mouse:"pointer"})}};Mn.onTap=Mn.onClick=function(r,a){return nr(a)?this.clickOnVertex(r,a):this.clickAnywhere(r,a)},Mn.onKeyUp=function(r,a){pn(a)?(this.deleteFeature([r.polygon.id],{silent:!0}),this.changeMode("simple_select")):Kr(a)&&this.changeMode("simple_select",{featureIds:[r.polygon.id]})},Mn.onStop=function(r){this.updateUIClasses({mouse:"none"}),un.enable(this),this.activateUIButton(),void 0!==this.getFeature(r.polygon.id)&&(r.polygon.removeCoordinate(`0.${r.currentVertexPosition}`),r.polygon.isValid()?this.map.fire("draw.create",{features:[r.polygon.toGeoJSON()]}):(this.deleteFeature([r.polygon.id],{silent:!0}),this.changeMode("simple_select",{},{silent:!0})))},Mn.toDisplayFeatures=function(r,a,o){const p=a.properties.id===r.polygon.id;if(a.properties.active=p?"true":"false",!p)return o(a);if(0===a.geometry.coordinates.length)return;const y=a.geometry.coordinates[0].length;if(!(y<3)){if(a.properties.meta="feature",o(Gn(r.polygon.id,a.geometry.coordinates[0][0],"0.0",!1)),y>3){const v=a.geometry.coordinates[0].length-3;o(Gn(r.polygon.id,a.geometry.coordinates[0][v],`0.${v}`,!1))}if(y<=4&&(o({type:"Feature",properties:a.properties,geometry:{coordinates:[[a.geometry.coordinates[0][0][0],a.geometry.coordinates[0][0][1]],[a.geometry.coordinates[0][1][0],a.geometry.coordinates[0][1][1]]],type:"LineString"}}),3===y))return;return o(a)}},Mn.onTrash=function(r){this.deleteFeature([r.polygon.id],{silent:!0}),this.changeMode("simple_select")};var bi=6371008.8,To={centimeters:100*bi,centimetres:100*bi,degrees:bi/111325,feet:3.28084*bi,inches:39.37*bi,kilometers:bi/1e3,kilometres:bi/1e3,meters:bi,metres:bi,miles:bi/1609.344,millimeters:1e3*bi,millimetres:1e3*bi,nauticalmiles:bi/1852,radians:1,yards:1.0936*bi};function vo(r,a,o){void 0===o&&(o={});var p={type:"Feature"};return(0===o.id||o.id)&&(p.id=o.id),o.bbox&&(p.bbox=o.bbox),p.properties=a||{},p.geometry=r,p}function or(r,a,o){if(void 0===o&&(o={}),!r)throw new Error("coordinates is required");if(!Array.isArray(r))throw new Error("coordinates must be an Array");if(r.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!yr(r[0])||!yr(r[1]))throw new Error("coordinates must contain numbers");return vo({type:"Point",coordinates:r},a,o)}function Y(r,a,o){void 0===o&&(o={});for(var p=0,y=r;p<y.length;p++){var v=y[p];if(v.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var b=0;b<v[v.length-1].length;b++)if(v[v.length-1][b]!==v[0][b])throw new Error("First and last Position are not equivalent.")}return vo({type:"Polygon",coordinates:r},a,o)}function pt(r,a,o){if(void 0===o&&(o={}),r.length<2)throw new Error("coordinates must be an array of two or more positions");return vo({type:"LineString",coordinates:r},a,o)}function vr(r){return r%(2*Math.PI)*180/Math.PI}function _r(r){return r%360*Math.PI/180}function yr(r){return!isNaN(r)&&null!==r&&!Array.isArray(r)}function Lr(r){if(!r)throw new Error("coord is required");if(!Array.isArray(r)){if("Feature"===r.type&&null!==r.geometry&&"Point"===r.geometry.type)return r.geometry.coordinates;if("Point"===r.type)return r.coordinates}if(Array.isArray(r)&&r.length>=2&&!Array.isArray(r[0])&&!Array.isArray(r[1]))return r;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function _n(r){if(Array.isArray(r))return r;if("Feature"===r.type){if(null!==r.geometry)return r.geometry.coordinates}else if(r.coordinates)return r.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function En(r){return"Feature"===r.type?r.geometry:r}function Gr(r){var a=_n(r);if(2===a.length&&!fa(a[0],a[1]))return a;var o=[],p=a.length-1,y=o.length;o.push(a[0]);for(var v=1;v<p;v++){var b=o[o.length-1];a[v][0]===b[0]&&a[v][1]===b[1]||(o.push(a[v]),(y=o.length)>2&&Jn(o[y-3],o[y-1],o[y-2])&&o.splice(o.length-2,1))}if(o.push(a[a.length-1]),y=o.length,fa(a[0],a[a.length-1])&&y<4)throw new Error("invalid polygon");return Jn(o[y-3],o[y-1],o[y-2])&&o.splice(o.length-2,1),o}function fa(r,a){return r[0]===a[0]&&r[1]===a[1]}function Jn(r,a,o){var p=o[0],y=o[1],v=r[0],b=r[1],I=a[0],M=a[1],k=I-v,N=M-b;return 0==(p-v)*N-(y-b)*k&&(Math.abs(k)>=Math.abs(N)?k>0?v<=p&&p<=I:I<=p&&p<=v:N>0?b<=y&&y<=M:M<=y&&y<=b)}function Ro(r){var a={type:"Feature"};return Object.keys(r).forEach(function(o){switch(o){case"type":case"properties":case"geometry":return;default:a[o]=r[o]}}),a.properties=Hn(r.properties),a.geometry=xa(r.geometry),a}function Hn(r){var a={};return r&&Object.keys(r).forEach(function(o){var p=r[o];a[o]="object"==typeof p?null===p?null:Array.isArray(p)?p.map(function(y){return y}):Hn(p):p}),a}function xa(r){var a={type:r.type};return r.bbox&&(a.bbox=r.bbox),"GeometryCollection"===r.type?(a.geometries=r.geometries.map(function(o){return xa(o)}),a):(a.coordinates=$o(r.coordinates),a)}function $o(r){var a=r;return"object"!=typeof a[0]?a.slice():a.map(function(o){return $o(o)})}function Pn(r,a,o){if(null!==r)for(var p,y,v,b,I,M,C,N,O=0,k=0,B=r.type,Zt="FeatureCollection"===B,At="Feature"===B,de=Zt?r.features.length:1,Xt=0;Xt<de;Xt++){I=(N=!!(C=Zt?r.features[Xt].geometry:At?r.geometry:r)&&"GeometryCollection"===C.type)?C.geometries.length:1;for(var wt=0;wt<I;wt++){var Ut=0,xe=0;if(null!==(b=N?C.geometries[wt]:C)){M=b.coordinates;var ve=b.type;switch(O=!o||"Polygon"!==ve&&"MultiPolygon"!==ve?0:1,ve){case null:break;case"Point":if(!1===a(M,k,Xt,Ut,xe))return!1;k++,Ut++;break;case"LineString":case"MultiPoint":for(p=0;p<M.length;p++){if(!1===a(M[p],k,Xt,Ut,xe))return!1;k++,"MultiPoint"===ve&&Ut++}"LineString"===ve&&Ut++;break;case"Polygon":case"MultiLineString":for(p=0;p<M.length;p++){for(y=0;y<M[p].length-O;y++){if(!1===a(M[p][y],k,Xt,Ut,xe))return!1;k++}"MultiLineString"===ve&&Ut++,"Polygon"===ve&&xe++}"Polygon"===ve&&Ut++;break;case"MultiPolygon":for(p=0;p<M.length;p++){for(xe=0,y=0;y<M[p].length;y++){for(v=0;v<M[p][y].length-O;v++){if(!1===a(M[p][y][v],k,Xt,Ut,xe))return!1;k++}xe++}Ut++}break;case"GeometryCollection":for(p=0;p<b.geometries.length;p++)if(!1===Pn(b.geometries[p],a,o))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function A(r,a){var o,p,y,v,b,I,M,C,O,k,N=0,B="FeatureCollection"===r.type,Zt="Feature"===r.type,At=B?r.features.length:1;for(o=0;o<At;o++){for(C=B?r.features[o].properties:Zt?r.properties:{},O=B?r.features[o].bbox:Zt?r.bbox:void 0,k=B?r.features[o].id:Zt?r.id:void 0,b=(M=!!(I=B?r.features[o].geometry:Zt?r.geometry:r)&&"GeometryCollection"===I.type)?I.geometries.length:1,y=0;y<b;y++)if(null!==(v=M?I.geometries[y]:I))switch(v.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===a(v,N,C,O,k))return!1;break;case"GeometryCollection":for(p=0;p<v.geometries.length;p++)if(!1===a(v.geometries[p],N,C,O,k))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===a(null,N,C,O,k))return!1;N++}}function ct(r,a){A(r,function(o,p,y,v,b){var M,I=null===o?null:o.type;switch(I){case null:case"Point":case"LineString":case"Polygon":return!1!==a(vo(o,y,{bbox:v,id:b}),p,0)&&void 0}switch(I){case"MultiPoint":M="Point";break;case"MultiLineString":M="LineString";break;case"MultiPolygon":M="Polygon"}for(var C=0;C<o.coordinates.length;C++)if(!1===a(vo({type:M,coordinates:o.coordinates[C]},y),p,C))return!1})}function Ae(r,a){var o=r.x-a.x,p=r.y-a.y;return o*o+p*p}function sr(r,a,o){var p=a.x,y=a.y,v=o.x-p,b=o.y-y;if(0!==v||0!==b){var I=((r.x-p)*v+(r.y-y)*b)/(v*v+b*b);I>1?(p=o.x,y=o.y):I>0&&(p+=v*I,y+=b*I)}return(v=r.x-p)*v+(b=r.y-y)*b}function Dr(r,a,o,p,y){for(var b,v=p,I=a+1;I<o;I++){var M=sr(r[I],r[a],r[o]);M>v&&(b=I,v=M)}v>p&&(b-a>1&&Dr(r,a,b,p,y),y.push(r[b]),o-b>1&&Dr(r,b,o,p,y))}function Tn(r,a){var o=r.length-1,p=[r[0]];return Dr(r,0,o,a,p),p.push(r[o]),p}function zo(r,a,o){if(r.length<=2)return r;var p=void 0!==a?a*a:1;return r=o?r:function hr(r,a){for(var y,o=r[0],p=[o],v=1,b=r.length;v<b;v++)Ae(y=r[v],o)>a&&(p.push(y),o=y);return o!==y&&p.push(y),p}(r,p),Tn(r,p)}function Qn(r,a,o){return zo(r.map(function(p){return{x:p[0],y:p[1],z:p[2]}}),a,o).map(function(p){return p.z?[p.x,p.y,p.z]:[p.x,p.y]})}function en(r,a,o){return r.map(function(p){var y=p.map(function(b){return{x:b[0],y:b[1]}});if(y.length<4)throw new Error("invalid polygon");for(var v=zo(y,a,o).map(function(b){return[b.x,b.y]});!ci(v);)v=zo(y,a-=.01*a,o).map(function(b){return[b.x,b.y]});return(v[v.length-1][0]!==v[0][0]||v[v.length-1][1]!==v[0][1])&&v.push(v[0]),v})}function ci(r){return!(r.length<3||3===r.length&&r[2][0]===r[0][0]&&r[2][1]===r[0][1])}const zr=function $e(r,a){if(!function Ke(r){return!!r&&r.constructor===Object}(a=a||{}))throw new Error("options is invalid");var o=void 0!==a.tolerance?a.tolerance:1,p=a.highQuality||!1,y=a.mutate||!1;if(!r)throw new Error("geojson is required");if(o&&o<0)throw new Error("invalid tolerance");return!0!==y&&(r=function Ka(r){if(!r)throw new Error("geojson is required");switch(r.type){case"Feature":return Ro(r);case"FeatureCollection":return function mu(r){var a={type:"FeatureCollection"};return Object.keys(r).forEach(function(o){switch(o){case"type":case"features":return;default:a[o]=r[o]}}),a.features=r.features.map(function(o){return Ro(o)}),a}(r);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return xa(r);default:throw new Error("unknown GeoJSON type")}}(r)),A(r,function(v){!function Vr(r,a,o){var p=r.type;if("Point"===p||"MultiPoint"===p)return r;!function li(r,a){void 0===a&&(a={});var o="object"==typeof a?a.mutate:a;if(!r)throw new Error("geojson is required");var p=function ho(r,a){return"FeatureCollection"===r.type?"FeatureCollection":"GeometryCollection"===r.type?"GeometryCollection":"Feature"===r.type&&null!==r.geometry?r.geometry.type:r.type}(r),y=[];switch(p){case"LineString":y=Gr(r);break;case"MultiLineString":case"Polygon":_n(r).forEach(function(b){y.push(Gr(b))});break;case"MultiPolygon":_n(r).forEach(function(b){var I=[];b.forEach(function(M){I.push(Gr(M))}),y.push(I)});break;case"Point":return r;case"MultiPoint":var v={};_n(r).forEach(function(b){var I=b.join("-");Object.prototype.hasOwnProperty.call(v,I)||(y.push(b),v[I]=!0)});break;default:throw new Error(p+" geometry not supported")}r.coordinates?!0===o&&(r.coordinates=y):!0===o?r.geometry.coordinates=y:vo({type:p,coordinates:y},r.properties,{bbox:r.bbox,id:r.id})}(r,!0);var y=r.coordinates;switch(p){case"LineString":r.coordinates=Qn(y,a,o);break;case"MultiLineString":r.coordinates=y.map(function(v){return Qn(v,a,o)});break;case"Polygon":r.coordinates=en(y,a,o);break;case"MultiPolygon":r.coordinates=y.map(function(v){return en(v,a,o)})}}(v,o,p)}),r},Qo=Object.assign({},Mn);Qo.onSetup=function(){const r=this.newFeature({type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[]]}});return this.addFeature(r),this.clearSelectedFeatures(),setTimeout(()=>{!this.map||!this.map.dragPan||this.map.dragPan.disable()},0),this.updateUIClasses({mouse:"add"}),this.activateUIButton("polygon"),this.setActionableState({trash:!0}),{polygon:r,currentVertexPosition:0,dragMoving:!1}},Qo.onDrag=Qo.onTouchMove=function(r,a){r.dragMoving=!0,this.updateUIClasses({mouse:"add"}),r.polygon.updateCoordinate(`0.${r.currentVertexPosition}`,a.lngLat.lng,a.lngLat.lat),r.currentVertexPosition++,r.polygon.updateCoordinate(`0.${r.currentVertexPosition}`,a.lngLat.lng,a.lngLat.lat)},Qo.onMouseUp=function(r,a){r.dragMoving&&(this.simplify(r.polygon),this.fireUpdate(),this.changeMode("simple_select",{featureIds:[r.polygon.id]}))},Qo.onTouchEnd=function(r,a){this.onMouseUp(r,a)},Qo.fireUpdate=function(){this.map.fire("draw.update",{action:"move",features:this.getSelected().map(r=>r.toGeoJSON())})},Qo.simplify=function(r){const a=1/Math.pow(1.05,10*this.map.getZoom());zr(r,{mutate:!0,tolerance:a,highQuality:!0})};const ls=Qo;var Qr=St(6151);const ni={onSetup:function(r){const a=(r=r||{}).featureId;let o,p,y="forward";if(a){if(o=this.getFeature(a),!o)throw new Error("Could not find a feature with the provided featureId");let v=r.from;if(v&&"Feature"===v.type&&v.geometry&&"Point"===v.geometry.type&&(v=v.geometry),v&&"Point"===v.type&&v.coordinates&&2===v.coordinates.length&&(v=v.coordinates),!v||!Array.isArray(v))throw new Error("Please use the `from` property to indicate which point to continue the line from");const b=o.coordinates.length-1;if(o.coordinates[b][0]===v[0]&&o.coordinates[b][1]===v[1])p=b+1,o.addCoordinate(p,...o.coordinates[b]);else{if(o.coordinates[0][0]!==v[0]||o.coordinates[0][1]!==v[1])throw new Error("`from` should match the point at either the start or the end of the provided LineString");y="backwards",p=0,o.addCoordinate(p,...o.coordinates[0])}}else o=this.newFeature({type:"Feature",properties:{},geometry:{type:"LineString",coordinates:[]}}),p=0,this.addFeature(o);return this.clearSelectedFeatures(),un.disable(this),this.updateUIClasses({mouse:"add"}),this.activateUIButton("line_string"),this.setActionableState({trash:!0}),{line:o,currentVertexPosition:p,direction:y}},clickAnywhere:function(r,a){if(r.currentVertexPosition>0&&Kn(a,r.line.coordinates[r.currentVertexPosition-1])||"backwards"===r.direction&&Kn(a,r.line.coordinates[r.currentVertexPosition+1]))return this.changeMode("simple_select",{featureIds:[r.line.id]});this.updateUIClasses({mouse:"add"}),r.line.updateCoordinate(r.currentVertexPosition,a.lngLat.lng,a.lngLat.lat),"forward"===r.direction?(r.currentVertexPosition++,r.line.updateCoordinate(r.currentVertexPosition,a.lngLat.lng,a.lngLat.lat)):r.line.addCoordinate(0,a.lngLat.lng,a.lngLat.lat)},clickOnVertex:function(r){return this.changeMode("simple_select",{featureIds:[r.line.id]})},onMouseMove:function(r,a){r.line.updateCoordinate(r.currentVertexPosition,a.lngLat.lng,a.lngLat.lat),nr(a)&&this.updateUIClasses({mouse:"pointer"})}};ni.onTap=ni.onClick=function(r,a){if(nr(a))return this.clickOnVertex(r,a);this.clickAnywhere(r,a)},ni.onKeyUp=function(r,a){Kr(a)?this.changeMode("simple_select",{featureIds:[r.line.id]}):pn(a)&&(this.deleteFeature([r.line.id],{silent:!0}),this.changeMode("simple_select"))},ni.onStop=function(r){un.enable(this),this.activateUIButton(),void 0!==this.getFeature(r.line.id)&&(r.line.removeCoordinate(`${r.currentVertexPosition}`),r.line.isValid()?this.map.fire("draw.create",{features:[r.line.toGeoJSON()]}):(this.deleteFeature([r.line.id],{silent:!0}),this.changeMode("simple_select",{},{silent:!0})))},ni.onTrash=function(r){this.deleteFeature([r.line.id],{silent:!0}),this.changeMode("simple_select")},ni.toDisplayFeatures=function(r,a,o){const p=a.properties.id===r.line.id;if(a.properties.active=p?"true":"false",!p)return o(a);a.geometry.coordinates.length<2||(a.properties.meta="feature",o(Gn(r.line.id,a.geometry.coordinates["forward"===r.direction?a.geometry.coordinates.length-2:1],""+("forward"===r.direction?a.geometry.coordinates.length-2:1),!1)),o(a))};const Ao=ni;function Lo(r){var a=[1/0,1/0,-1/0,-1/0];return Pn(r,function(o){a[0]>o[0]&&(a[0]=o[0]),a[1]>o[1]&&(a[1]=o[1]),a[2]<o[0]&&(a[2]=o[0]),a[3]<o[1]&&(a[3]=o[1])}),a}Lo.default=Lo;const io=Lo;function vu(r,a,o){if(void 0===o&&(o={}),!r)throw new Error("point is required");if(!a)throw new Error("polygon is required");var p=Lr(r),y=En(a),v=y.type,b=a.bbox,I=y.coordinates;if(b&&!1===function aa(r,a){return a[0]<=r[0]&&a[1]<=r[1]&&a[2]>=r[0]&&a[3]>=r[1]}(p,b))return!1;"Polygon"===v&&(I=[I]);for(var M=!1,C=0;C<I.length&&!M;C++)if(Js(p,I[C][0],o.ignoreBoundary)){for(var O=!1,k=1;k<I[C].length&&!O;)Js(p,I[C][k],!o.ignoreBoundary)&&(O=!0),k++;O||(M=!0)}return M}function Js(r,a,o){var p=!1;a[0][0]===a[a.length-1][0]&&a[0][1]===a[a.length-1][1]&&(a=a.slice(0,a.length-1));for(var y=0,v=a.length-1;y<a.length;v=y++){var b=a[y][0],I=a[y][1],M=a[v][0],C=a[v][1];if(r[1]*(b-M)+I*(M-r[0])+C*(r[0]-b)==0&&(b-r[0])*(M-r[0])<=0&&(I-r[1])*(C-r[1])<=0)return!o;I>r[1]!=C>r[1]&&r[0]<(M-b)*(r[1]-I)/(C-I)+b&&(p=!p)}return p}St(5943),St(1335);const Ms=function Vi(r,a,o){void 0===o&&(o={});var p=Lr(r),y=Lr(a),v=_r(y[1]-p[1]),b=_r(y[0]-p[0]),I=_r(p[1]),M=_r(y[1]),C=Math.pow(Math.sin(v/2),2)+Math.pow(Math.sin(b/2),2)*Math.cos(I)*Math.cos(M);return function ir(r,a){void 0===a&&(a="kilometers");var o=To[a];if(!o)throw new Error(a+" units is invalid");return r*o}(2*Math.atan2(Math.sqrt(C),Math.sqrt(1-C)),o.units)};var ga=new ArrayBuffer(16);new Float64Array(ga),new Uint32Array(ga),St(3544);const mi=function(){function r(a){this.points=a.points||[],this.duration=a.duration||1e4,this.sharpness=a.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=a.stepLength||60,this.length=this.points.length,this.delay=0;for(var o=0;o<this.length;o++)this.points[o].z=this.points[o].z||0;for(o=0;o<this.length-1;o++){var p=this.points[o],y=this.points[o+1];this.centers.push({x:(p.x+y.x)/2,y:(p.y+y.y)/2,z:(p.z+y.z)/2})}for(this.controls.push([this.points[0],this.points[0]]),o=0;o<this.centers.length-1;o++){var v=this.points[o+1].x-(this.centers[o].x+this.centers[o+1].x)/2,b=this.points[o+1].y-(this.centers[o].y+this.centers[o+1].y)/2,I=this.points[o+1].z-(this.centers[o].y+this.centers[o+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[o+1].x+this.sharpness*(this.centers[o].x+v),y:(1-this.sharpness)*this.points[o+1].y+this.sharpness*(this.centers[o].y+b),z:(1-this.sharpness)*this.points[o+1].z+this.sharpness*(this.centers[o].z+I)},{x:(1-this.sharpness)*this.points[o+1].x+this.sharpness*(this.centers[o+1].x+v),y:(1-this.sharpness)*this.points[o+1].y+this.sharpness*(this.centers[o+1].y+b),z:(1-this.sharpness)*this.points[o+1].z+this.sharpness*(this.centers[o+1].z+I)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this}return r.prototype.cacheSteps=function(a){var o=[],p=this.pos(0);o.push(0);for(var y=0;y<this.duration;y+=10){var v=this.pos(y);Math.sqrt((v.x-p.x)*(v.x-p.x)+(v.y-p.y)*(v.y-p.y)+(v.z-p.z)*(v.z-p.z))>a&&(o.push(y),p=v)}return o},r.prototype.vector=function(a){var o=this.pos(a+10),p=this.pos(a-10);return{angle:180*Math.atan2(o.y-p.y,o.x-p.x)/3.14,speed:Math.sqrt((p.x-o.x)*(p.x-o.x)+(p.y-o.y)*(p.y-o.y)+(p.z-o.z)*(p.z-o.z))}},r.prototype.pos=function(a){var o=a-this.delay;o<0&&(o=0),o>this.duration&&(o=this.duration-1);var p=o/this.duration;if(p>=1)return this.points[this.length-1];var y=Math.floor((this.points.length-1)*p);return function Wo(r,a,o,p,y){var v=function Ts(r){var a=r*r;return[a*r,3*a*(1-r),3*r*(1-r)*(1-r),(1-r)*(1-r)*(1-r)]}(r);return{x:y.x*v[0]+p.x*v[1]+o.x*v[2]+a.x*v[3],y:y.y*v[0]+p.y*v[1]+o.y*v[2]+a.y*v[3],z:y.z*v[0]+p.z*v[1]+o.z*v[2]+a.z*v[3]}}((this.length-1)*p-y,this.points[y],this.controls[y][1],this.controls[y+1][0],this.points[y+1])},r}();function oi(r,a,o,p){void 0===p&&(p={});var y=Lr(r),v=_r(y[0]),b=_r(y[1]),I=_r(o),M=function mr(r,a){void 0===a&&(a="kilometers");var o=To[a];if(!o)throw new Error(a+" units is invalid");return r/o}(a,p.units),C=Math.asin(Math.sin(b)*Math.cos(M)+Math.cos(b)*Math.sin(M)*Math.cos(I));return or([vr(v+Math.atan2(Math.sin(I)*Math.sin(M)*Math.cos(b),Math.cos(M)-Math.sin(b)*Math.sin(C))),vr(C)],p.properties)}function Ss(r){return function U(r,a,o){var p=o;return A(r,function(y,v,b,I,M){p=0===v&&void 0===o?y:a(p,y,v,b,I,M)}),p}(r,function(a,o){return a+function nu(r){var o,a=0;switch(r.type){case"Polygon":return Ma(r.coordinates);case"MultiPolygon":for(o=0;o<r.coordinates.length;o++)a+=Ma(r.coordinates[o]);return a;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(o)},0)}function Ma(r){var a=0;if(r&&r.length>0){a+=Math.abs(dn(r[0]));for(var o=1;o<r.length;o++)a-=Math.abs(dn(r[o]))}return a}function dn(r){var a,o,y,v,b,I,M=0,C=r.length;if(C>2){for(I=0;I<C;I++)I===C-2?(y=C-2,v=C-1,b=0):I===C-1?(y=C-1,v=0,b=1):(y=I,v=I+1,b=I+2),a=r[y],o=r[v],M+=(Lu(r[b][0])-Lu(a[0]))*Math.sin(Lu(o[1]));M=6378137*M*6378137/2}return M}function Lu(r){return r*Math.PI/180}function Si(r,a){return void 0===a&&(a={}),function Bt(r,a,o){var p=o,y=!1;return function Se(r,a){ct(r,function(o,p,y){var v=0;if(o.geometry){var b=o.geometry.type;if("Point"!==b&&"MultiPoint"!==b){var I,M=0,C=0,O=0;if(!1===Pn(o,function(k,N,B,Zt,At){if(void 0===I||p>M||Zt>C||At>O)return I=k,M=p,C=Zt,O=At,void(v=0);var de=pt([I,k],o.properties);if(!1===a(de,p,y,At,v))return!1;v++,I=k}))return!1}}})}(r,function(v,b,I,M,C){p=!1===y&&void 0===o?v:a(p,v,b,I,M,C),y=!0}),p}(r,function(o,p){var y=p.geometry.coordinates;return o+Ms(y[0],y[1],a)},0)}St(5469),St(5406);var we=Math.PI/180,Ze=180/Math.PI,Ne=function(r,a){this.lon=r,this.lat=a,this.x=we*r,this.y=we*a};Ne.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)},Ne.prototype.antipode=function(){return new Ne(this.lon<0?180+this.lon:-1*(180-this.lon),-1*this.lat)};var We=function(){this.coords=[],this.length=0};We.prototype.move_to=function(r){this.length++,this.coords.push(r)};var er=function(r){this.properties=r||{},this.geometries=[]};er.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(1===this.geometries.length)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var r=[],a=0;a<this.geometries.length;a++)r.push(this.geometries[a].coords);return{geometry:{type:"MultiLineString",coordinates:r},type:"Feature",properties:this.properties}},er.prototype.wkt=function(){for(var r="",a="LINESTRING(",o=function(v){a+=v[0]+" "+v[1]+","},p=0;p<this.geometries.length;p++){if(0===this.geometries[p].coords.length)return"LINESTRING(empty)";this.geometries[p].coords.forEach(o),r+=a.substring(0,a.length-1)+")"}return r};var br=function(r,a,o){if(!r||void 0===r.x||void 0===r.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!a||void 0===a.x||void 0===a.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new Ne(r.x,r.y),this.end=new Ne(a.x,a.y),this.properties=o||{};var p=this.start.x-this.end.x,v=Math.pow(Math.sin((this.start.y-this.end.y)/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(p/2),2);if(this.g=2*Math.asin(Math.sqrt(v)),this.g===Math.PI)throw new Error("it appears "+r.view()+" and "+a.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+r+" and "+a)};br.prototype.interpolate=function(r){var a=Math.sin((1-r)*this.g)/Math.sin(this.g),o=Math.sin(r*this.g)/Math.sin(this.g),p=a*Math.cos(this.start.y)*Math.cos(this.start.x)+o*Math.cos(this.end.y)*Math.cos(this.end.x),y=a*Math.cos(this.start.y)*Math.sin(this.start.x)+o*Math.cos(this.end.y)*Math.sin(this.end.x),v=a*Math.sin(this.start.y)+o*Math.sin(this.end.y),b=Ze*Math.atan2(v,Math.sqrt(Math.pow(p,2)+Math.pow(y,2)));return[Ze*Math.atan2(y,p),b]},br.prototype.Arc=function(r,a){var o=[];if(!r||r<=2)o.push([this.start.lon,this.start.lat]),o.push([this.end.lon,this.end.lat]);else for(var p=1/(r-1),y=0;y<r;++y){var b=this.interpolate(p*y);o.push(b)}for(var I=!1,M=0,C=a&&a.offset?a.offset:10,O=180-C,k=-180+C,N=360-C,B=1;B<o.length;++B){var Zt=o[B-1][0],At=o[B][0],de=Math.abs(At-Zt);de>N&&(At>O&&Zt<k||Zt>O&&At<k)?I=!0:de>M&&(M=de)}var Xt=[];if(I&&M<C){var wt=[];Xt.push(wt);for(var Ut=0;Ut<o.length;++Ut){var xe=parseFloat(o[Ut][0]);if(Ut>0&&Math.abs(xe-o[Ut-1][0])>N){var ve=parseFloat(o[Ut-1][0]),Oe=parseFloat(o[Ut-1][1]),Le=parseFloat(o[Ut][0]),Je=parseFloat(o[Ut][1]);if(ve>-180&&ve<k&&180===Le&&Ut+1<o.length&&o[Ut-1][0]>-180&&o[Ut-1][0]<k){wt.push([-180,o[Ut][1]]),Ut++,wt.push([o[Ut][0],o[Ut][1]]);continue}if(ve>O&&ve<180&&-180===Le&&Ut+1<o.length&&o[Ut-1][0]>O&&o[Ut-1][0]<180){wt.push([180,o[Ut][1]]),Ut++,wt.push([o[Ut][0],o[Ut][1]]);continue}if(ve<k&&Le>O){var re=ve;ve=Le,Le=re;var Bn=Oe;Oe=Je,Je=Bn}if(ve>O&&Le<k&&(Le+=360),ve<=180&&Le>=180&&ve<Le){var $r=(180-ve)/(Le-ve),ui=$r*Je+(1-$r)*Oe;wt.push([o[Ut-1][0]>O?180:-180,ui]),(wt=[]).push([o[Ut-1][0]>O?-180:180,ui]),Xt.push(wt)}else Xt.push(wt=[]);wt.push([xe,o[Ut][1]])}else wt.push([o[Ut][0],o[Ut][1]])}}else{var xi=[];Xt.push(xi);for(var Or=0;Or<o.length;++Or)xi.push([o[Or][0],o[Or][1]])}for(var kn=new er(this.properties),yn=0;yn<Xt.length;++yn){var jo=new We;kn.geometries.push(jo);for(var No=Xt[yn],Ri=0;Ri<No.length;++Ri)jo.move_to(No[Ri])}return kn},St(6952);var ji=[],Zi=[],Xi=[],Yi=[],Di=[],Ji=[],Ti=[],Bi=[],di=[],Ci=[],Hi=[],Wi=[],Ki=[],$i=[],Qi=[],to=[],eo=[],Oi=[],ro=[],vi=[],no=[],Sn=[],Ai=[],Ui=[];Ti[85]=Ci[85]=-1,Bi[85]=Hi[85]=0,di[85]=Wi[85]=1,ro[85]=Sn[85]=1,vi[85]=Ai[85]=0,no[85]=Ui[85]=1,ji[85]=Yi[85]=0,Zi[85]=Di[85]=-1,Xi[85]=Qi[85]=0,to[85]=Ki[85]=0,eo[85]=$i[85]=1,Ji[85]=Oi[85]=1,Sn[1]=Sn[169]=0,Ai[1]=Ai[169]=-1,Ui[1]=Ui[169]=0,Ki[1]=Ki[169]=-1,$i[1]=$i[169]=0,Qi[1]=Qi[169]=0,Ci[4]=Ci[166]=0,Hi[4]=Hi[166]=-1,Wi[4]=Wi[166]=1,to[4]=to[166]=1,eo[4]=eo[166]=0,Oi[4]=Oi[166]=0,Ti[16]=Ti[154]=0,Bi[16]=Bi[154]=1,di[16]=di[154]=1,Yi[16]=Yi[154]=1,Di[16]=Di[154]=0,Ji[16]=Ji[154]=1,ro[64]=ro[106]=0,vi[64]=vi[106]=1,no[64]=no[106]=0,ji[64]=ji[106]=-1,Zi[64]=Zi[106]=0,Xi[64]=Xi[106]=1,ro[2]=ro[168]=0,vi[2]=vi[168]=-1,no[2]=no[168]=1,Sn[2]=Sn[168]=0,Ai[2]=Ai[168]=-1,Ui[2]=Ui[168]=0,Ki[2]=Ki[168]=-1,$i[2]=$i[168]=0,Qi[2]=Qi[168]=0,to[2]=to[168]=-1,eo[2]=eo[168]=0,Oi[2]=Oi[168]=1,Ti[8]=Ti[162]=0,Bi[8]=Bi[162]=-1,di[8]=di[162]=0,Ci[8]=Ci[162]=0,Hi[8]=Hi[162]=-1,Wi[8]=Wi[162]=1,Ki[8]=Ki[162]=1,$i[8]=$i[162]=0,Qi[8]=Qi[162]=1,to[8]=to[162]=1,eo[8]=eo[162]=0,Oi[8]=Oi[162]=0,Ti[32]=Ti[138]=0,Bi[32]=Bi[138]=1,di[32]=di[138]=1,Ci[32]=Ci[138]=0,Hi[32]=Hi[138]=1,Wi[32]=Wi[138]=0,ji[32]=ji[138]=1,Zi[32]=Zi[138]=0,Xi[32]=Xi[138]=0,Yi[32]=Yi[138]=1,Di[32]=Di[138]=0,Ji[32]=Ji[138]=1,Sn[128]=Sn[42]=0,Ai[128]=Ai[42]=1,Ui[128]=Ui[42]=1,ro[128]=ro[42]=0,vi[128]=vi[42]=1,no[128]=no[42]=0,ji[128]=ji[42]=-1,Zi[128]=Zi[42]=0,Xi[128]=Xi[42]=1,Yi[128]=Yi[42]=-1,Di[128]=Di[42]=0,Ji[128]=Ji[42]=0,Ci[5]=Ci[165]=-1,Hi[5]=Hi[165]=0,Wi[5]=Wi[165]=0,Sn[5]=Sn[165]=1,Ai[5]=Ai[165]=0,Ui[5]=Ui[165]=0,to[20]=to[150]=0,eo[20]=eo[150]=1,Oi[20]=Oi[150]=1,Yi[20]=Yi[150]=0,Di[20]=Di[150]=-1,Ji[20]=Ji[150]=1,Ti[80]=Ti[90]=-1,Bi[80]=Bi[90]=0,di[80]=di[90]=1,ro[80]=ro[90]=1,vi[80]=vi[90]=0,no[80]=no[90]=1,Ki[65]=Ki[105]=0,$i[65]=$i[105]=1,Qi[65]=Qi[105]=0,ji[65]=ji[105]=0,Zi[65]=Zi[105]=-1,Xi[65]=Xi[105]=0,Ti[160]=Ti[10]=-1,Bi[160]=Bi[10]=0,di[160]=di[10]=1,Ci[160]=Ci[10]=-1,Hi[160]=Hi[10]=0,Wi[160]=Wi[10]=0,Sn[160]=Sn[10]=1,Ai[160]=Ai[10]=0,Ui[160]=Ui[10]=0,ro[160]=ro[10]=1,vi[160]=vi[10]=0,no[160]=no[10]=1,to[130]=to[40]=0,eo[130]=eo[40]=1,Oi[130]=Oi[40]=1,Ki[130]=Ki[40]=0,$i[130]=$i[40]=1,Qi[130]=Qi[40]=0,ji[130]=ji[40]=0,Zi[130]=Zi[40]=-1,Xi[130]=Xi[40]=0,Yi[130]=Yi[40]=0,Di[130]=Di[40]=-1,Ji[130]=Ji[40]=1,Ci[37]=Ci[133]=0,Hi[37]=Hi[133]=1,Wi[37]=Wi[133]=1,Sn[37]=Sn[133]=0,Ai[37]=Ai[133]=1,Ui[37]=Ui[133]=0,ji[37]=ji[133]=-1,Zi[37]=Zi[133]=0,Xi[37]=Xi[133]=0,Yi[37]=Yi[133]=1,Di[37]=Di[133]=0,Ji[37]=Ji[133]=0,to[148]=to[22]=-1,eo[148]=eo[22]=0,Oi[148]=Oi[22]=0,Sn[148]=Sn[22]=0,Ai[148]=Ai[22]=-1,Ui[148]=Ui[22]=1,ro[148]=ro[22]=0,vi[148]=vi[22]=1,no[148]=no[22]=1,Yi[148]=Yi[22]=-1,Di[148]=Di[22]=0,Ji[148]=Ji[22]=1,Ti[82]=Ti[88]=0,Bi[82]=Bi[88]=-1,di[82]=di[88]=1,to[82]=to[88]=1,eo[82]=eo[88]=0,Oi[82]=Oi[88]=1,Ki[82]=Ki[88]=-1,$i[82]=$i[88]=0,Qi[82]=Qi[88]=1,ro[82]=ro[88]=0,vi[82]=vi[88]=-1,no[82]=no[88]=0,Ti[73]=Ti[97]=0,Bi[73]=Bi[97]=1,di[73]=di[97]=0,Ci[73]=Ci[97]=0,Hi[73]=Hi[97]=-1,Wi[73]=Wi[97]=0,Ki[73]=Ki[97]=1,$i[73]=$i[97]=0,Qi[73]=Qi[97]=0,ji[73]=ji[97]=1,Zi[73]=Zi[97]=0,Xi[73]=Xi[97]=1,Ti[145]=Ti[25]=0,Bi[145]=Bi[25]=-1,di[145]=di[25]=0,Ki[145]=Ki[25]=1,$i[145]=$i[25]=0,Qi[145]=Qi[25]=1,Sn[145]=Sn[25]=0,Ai[145]=Ai[25]=1,Ui[145]=Ui[25]=1,Yi[145]=Yi[25]=-1,Di[145]=Di[25]=0,Ji[145]=Ji[25]=0,Ci[70]=Ci[100]=0,Hi[70]=Hi[100]=1,Wi[70]=Wi[100]=0,to[70]=to[100]=-1,eo[70]=eo[100]=0,Oi[70]=Oi[100]=1,ro[70]=ro[100]=0,vi[70]=vi[100]=-1,no[70]=no[100]=1,ji[70]=ji[100]=1,Zi[70]=Zi[100]=0,Xi[70]=Xi[100]=0,Ci[101]=Ci[69]=0,Hi[101]=Hi[69]=1,Wi[101]=Wi[69]=0,ji[101]=ji[69]=1,Zi[101]=Zi[69]=0,Xi[101]=Xi[69]=0,Sn[149]=Sn[21]=0,Ai[149]=Ai[21]=1,Ui[149]=Ui[21]=1,Yi[149]=Yi[21]=-1,Di[149]=Di[21]=0,Ji[149]=Ji[21]=0,to[86]=to[84]=-1,eo[86]=eo[84]=0,Oi[86]=Oi[84]=1,ro[86]=ro[84]=0,vi[86]=vi[84]=-1,no[86]=no[84]=1,Ti[89]=Ti[81]=0,Bi[89]=Bi[81]=-1,di[89]=di[81]=0,Ki[89]=Ki[81]=1,$i[89]=$i[81]=0,Qi[89]=Qi[81]=1,Ti[96]=Ti[74]=0,Bi[96]=Bi[74]=1,di[96]=di[74]=0,Ci[96]=Ci[74]=-1,Hi[96]=Hi[74]=0,Wi[96]=Wi[74]=1,ro[96]=ro[74]=1,vi[96]=vi[74]=0,no[96]=no[74]=0,ji[96]=ji[74]=1,Zi[96]=Zi[74]=0,Xi[96]=Xi[74]=1,Ti[24]=Ti[146]=0,Bi[24]=Bi[146]=-1,di[24]=di[146]=1,to[24]=to[146]=1,eo[24]=eo[146]=0,Oi[24]=Oi[146]=1,Ki[24]=Ki[146]=0,$i[24]=$i[146]=1,Qi[24]=Qi[146]=1,Yi[24]=Yi[146]=0,Di[24]=Di[146]=-1,Ji[24]=Ji[146]=0,Ci[6]=Ci[164]=-1,Hi[6]=Hi[164]=0,Wi[6]=Wi[164]=1,to[6]=to[164]=-1,eo[6]=eo[164]=0,Oi[6]=Oi[164]=0,Sn[6]=Sn[164]=0,Ai[6]=Ai[164]=-1,Ui[6]=Ui[164]=1,ro[6]=ro[164]=1,vi[6]=vi[164]=0,no[6]=no[164]=0,Ki[129]=Ki[41]=0,$i[129]=$i[41]=1,Qi[129]=Qi[41]=1,Sn[129]=Sn[41]=0,Ai[129]=Ai[41]=1,Ui[129]=Ui[41]=0,ji[129]=ji[41]=-1,Zi[129]=Zi[41]=0,Xi[129]=Xi[41]=0,Yi[129]=Yi[41]=0,Di[129]=Di[41]=-1,Ji[129]=Ji[41]=0,to[66]=to[104]=0,eo[66]=eo[104]=1,Oi[66]=Oi[104]=0,Ki[66]=Ki[104]=-1,$i[66]=$i[104]=0,Qi[66]=Qi[104]=1,ro[66]=ro[104]=0,vi[66]=vi[104]=-1,no[66]=no[104]=0,ji[66]=ji[104]=0,Zi[66]=Zi[104]=-1,Xi[66]=Xi[104]=1,Ti[144]=Ti[26]=-1,Bi[144]=Bi[26]=0,di[144]=di[26]=0,Sn[144]=Sn[26]=1,Ai[144]=Ai[26]=0,Ui[144]=Ui[26]=1,ro[144]=ro[26]=0,vi[144]=vi[26]=1,no[144]=no[26]=1,Yi[144]=Yi[26]=-1,Di[144]=Di[26]=0,Ji[144]=Ji[26]=1,Ci[36]=Ci[134]=0,Hi[36]=Hi[134]=1,Wi[36]=Wi[134]=1,to[36]=to[134]=0,eo[36]=eo[134]=1,Oi[36]=Oi[134]=0,ji[36]=ji[134]=0,Zi[36]=Zi[134]=-1,Xi[36]=Xi[134]=1,Yi[36]=Yi[134]=1,Di[36]=Di[134]=0,Ji[36]=Ji[134]=0,Ti[9]=Ti[161]=-1,Bi[9]=Bi[161]=0,di[9]=di[161]=0,Ci[9]=Ci[161]=0,Hi[9]=Hi[161]=-1,Wi[9]=Wi[161]=0,Ki[9]=Ki[161]=1,$i[9]=$i[161]=0,Qi[9]=Qi[161]=0,Sn[9]=Sn[161]=1,Ai[9]=Ai[161]=0,Ui[9]=Ui[161]=1,Ti[136]=0,Bi[136]=1,di[136]=1,Ci[136]=0,Hi[136]=1,Wi[136]=0,to[136]=-1,eo[136]=0,Oi[136]=1,Ki[136]=-1,$i[136]=0,Qi[136]=0,Sn[136]=0,Ai[136]=-1,Ui[136]=0,ro[136]=0,vi[136]=-1,no[136]=1,ji[136]=1,Zi[136]=0,Xi[136]=0,Yi[136]=1,Di[136]=0,Ji[136]=1,Ti[34]=0,Bi[34]=-1,di[34]=0,Ci[34]=0,Hi[34]=-1,Wi[34]=1,to[34]=1,eo[34]=0,Oi[34]=0,Ki[34]=1,$i[34]=0,Qi[34]=1,Sn[34]=0,Ai[34]=1,Ui[34]=1,ro[34]=0,vi[34]=1,no[34]=0,ji[34]=-1,Zi[34]=0,Xi[34]=1,Yi[34]=-1,Di[34]=0,Ji[34]=0,Ti[35]=0,Bi[35]=1,di[35]=1,Ci[35]=0,Hi[35]=-1,Wi[35]=1,to[35]=1,eo[35]=0,Oi[35]=0,Ki[35]=-1,$i[35]=0,Qi[35]=0,Sn[35]=0,Ai[35]=-1,Ui[35]=0,ro[35]=0,vi[35]=1,no[35]=0,ji[35]=-1,Zi[35]=0,Xi[35]=1,Yi[35]=1,Di[35]=0,Ji[35]=1,Ti[153]=0,Bi[153]=1,di[153]=1,Ki[153]=-1,$i[153]=0,Qi[153]=0,Sn[153]=0,Ai[153]=-1,Ui[153]=0,Yi[153]=1,Di[153]=0,Ji[153]=1,Ci[102]=0,Hi[102]=-1,Wi[102]=1,to[102]=1,eo[102]=0,Oi[102]=0,ro[102]=0,vi[102]=1,no[102]=0,ji[102]=-1,Zi[102]=0,Xi[102]=1,Ti[155]=0,Bi[155]=-1,di[155]=0,Ki[155]=1,$i[155]=0,Qi[155]=1,Sn[155]=0,Ai[155]=1,Ui[155]=1,Yi[155]=-1,Di[155]=0,Ji[155]=0,Ci[103]=0,Hi[103]=1,Wi[103]=0,to[103]=-1,eo[103]=0,Oi[103]=1,ro[103]=0,vi[103]=-1,no[103]=1,ji[103]=1,Zi[103]=0,Xi[103]=0,Ti[152]=0,Bi[152]=1,di[152]=1,to[152]=-1,eo[152]=0,Oi[152]=1,Ki[152]=-1,$i[152]=0,Qi[152]=0,Sn[152]=0,Ai[152]=-1,Ui[152]=0,ro[152]=0,vi[152]=-1,no[152]=1,Yi[152]=1,Di[152]=0,Ji[152]=1,Ti[156]=0,Bi[156]=-1,di[156]=1,to[156]=1,eo[156]=0,Oi[156]=1,Ki[156]=-1,$i[156]=0,Qi[156]=0,Sn[156]=0,Ai[156]=-1,Ui[156]=0,ro[156]=0,vi[156]=1,no[156]=1,Yi[156]=-1,Di[156]=0,Ji[156]=1,Ti[137]=0,Bi[137]=1,di[137]=1,Ci[137]=0,Hi[137]=1,Wi[137]=0,Ki[137]=-1,$i[137]=0,Qi[137]=0,Sn[137]=0,Ai[137]=-1,Ui[137]=0,ji[137]=1,Zi[137]=0,Xi[137]=0,Yi[137]=1,Di[137]=0,Ji[137]=1,Ti[139]=0,Bi[139]=1,di[139]=1,Ci[139]=0,Hi[139]=-1,Wi[139]=0,Ki[139]=1,$i[139]=0,Qi[139]=0,Sn[139]=0,Ai[139]=1,Ui[139]=0,ji[139]=-1,Zi[139]=0,Xi[139]=0,Yi[139]=1,Di[139]=0,Ji[139]=1,Ti[98]=0,Bi[98]=-1,di[98]=0,Ci[98]=0,Hi[98]=-1,Wi[98]=1,to[98]=1,eo[98]=0,Oi[98]=0,Ki[98]=1,$i[98]=0,Qi[98]=1,ro[98]=0,vi[98]=1,no[98]=0,ji[98]=-1,Zi[98]=0,Xi[98]=1,Ti[99]=0,Bi[99]=1,di[99]=0,Ci[99]=0,Hi[99]=-1,Wi[99]=1,to[99]=1,eo[99]=0,Oi[99]=0,Ki[99]=-1,$i[99]=0,Qi[99]=1,ro[99]=0,vi[99]=-1,no[99]=0,ji[99]=1,Zi[99]=0,Xi[99]=1,Ci[38]=0,Hi[38]=-1,Wi[38]=1,to[38]=1,eo[38]=0,Oi[38]=0,Sn[38]=0,Ai[38]=1,Ui[38]=1,ro[38]=0,vi[38]=1,no[38]=0,ji[38]=-1,Zi[38]=0,Xi[38]=1,Yi[38]=-1,Di[38]=0,Ji[38]=0,Ci[39]=0,Hi[39]=1,Wi[39]=1,to[39]=-1,eo[39]=0,Oi[39]=0,Sn[39]=0,Ai[39]=-1,Ui[39]=1,ro[39]=0,vi[39]=1,no[39]=0,ji[39]=-1,Zi[39]=0,Xi[39]=1,Yi[39]=1,Di[39]=0,Ji[39]=0;var Ic=function(r){return[[r.bottomleft,0],[0,0],[0,r.leftbottom]]},Mc=function(r){return[[1,r.rightbottom],[1,0],[r.bottomright,0]]},fc=function(r){return[[r.topright,1],[1,1],[1,r.righttop]]},Ih=function(r){return[[0,r.lefttop],[0,1],[r.topleft,1]]},Mh=function(r){return[[r.bottomright,0],[r.bottomleft,0],[0,r.leftbottom],[0,r.lefttop]]},dc=function(r){return[[r.bottomright,0],[r.bottomleft,0],[1,r.righttop],[1,r.rightbottom]]},Yc=function(r){return[[1,r.righttop],[1,r.rightbottom],[r.topleft,1],[r.topright,1]]},Jc=function(r){return[[0,r.leftbottom],[0,r.lefttop],[r.topleft,1],[r.topright,1]]},tn=[],Wr=[],In=[],Zr=[],Xn=[],zn=[],qi=[],so=[];Zr[1]=Xn[1]=18,Zr[169]=Xn[169]=18,In[4]=Wr[4]=12,In[166]=Wr[166]=12,tn[16]=so[16]=4,tn[154]=so[154]=4,zn[64]=qi[64]=22,zn[106]=qi[106]=22,In[2]=zn[2]=17,Zr[2]=Xn[2]=18,In[168]=zn[168]=17,Zr[168]=Xn[168]=18,tn[8]=Zr[8]=9,Wr[8]=In[8]=12,tn[162]=Zr[162]=9,Wr[162]=In[162]=12,tn[32]=so[32]=4,Wr[32]=qi[32]=1,tn[138]=so[138]=4,Wr[138]=qi[138]=1,Xn[128]=so[128]=21,zn[128]=qi[128]=22,Xn[42]=so[42]=21,zn[42]=qi[42]=22,Wr[5]=Xn[5]=14,Wr[165]=Xn[165]=14,In[20]=so[20]=6,In[150]=so[150]=6,tn[80]=zn[80]=11,tn[90]=zn[90]=11,Zr[65]=qi[65]=3,Zr[105]=qi[105]=3,tn[160]=zn[160]=11,Wr[160]=Xn[160]=14,tn[10]=zn[10]=11,Wr[10]=Xn[10]=14,In[130]=so[130]=6,Zr[130]=qi[130]=3,In[40]=so[40]=6,Zr[40]=qi[40]=3,Wr[101]=qi[101]=1,Wr[69]=qi[69]=1,Xn[149]=so[149]=21,Xn[21]=so[21]=21,In[86]=zn[86]=17,In[84]=zn[84]=17,tn[89]=Zr[89]=9,tn[81]=Zr[81]=9,tn[96]=qi[96]=0,Wr[96]=zn[96]=15,tn[74]=qi[74]=0,Wr[74]=zn[74]=15,tn[24]=In[24]=8,Zr[24]=so[24]=7,tn[146]=In[146]=8,Zr[146]=so[146]=7,Wr[6]=zn[6]=15,In[6]=Xn[6]=16,Wr[164]=zn[164]=15,In[164]=Xn[164]=16,Zr[129]=so[129]=7,Xn[129]=qi[129]=20,Zr[41]=so[41]=7,Xn[41]=qi[41]=20,In[66]=qi[66]=2,Zr[66]=zn[66]=19,In[104]=qi[104]=2,Zr[104]=zn[104]=19,tn[144]=Xn[144]=10,zn[144]=so[144]=23,tn[26]=Xn[26]=10,zn[26]=so[26]=23,Wr[36]=so[36]=5,In[36]=qi[36]=2,Wr[134]=so[134]=5,In[134]=qi[134]=2,tn[9]=Xn[9]=10,Wr[9]=Zr[9]=13,tn[161]=Xn[161]=10,Wr[161]=Zr[161]=13,Wr[37]=so[37]=5,Xn[37]=qi[37]=20,Wr[133]=so[133]=5,Xn[133]=qi[133]=20,In[148]=Xn[148]=16,zn[148]=so[148]=23,In[22]=Xn[22]=16,zn[22]=so[22]=23,tn[82]=In[82]=8,Zr[82]=zn[82]=19,tn[88]=In[88]=8,Zr[88]=zn[88]=19,tn[73]=qi[73]=0,Wr[73]=Zr[73]=13,tn[97]=qi[97]=0,Wr[97]=Zr[97]=13,tn[145]=Zr[145]=9,Xn[145]=so[145]=21,tn[25]=Zr[25]=9,Xn[25]=so[25]=21,Wr[70]=qi[70]=1,In[70]=zn[70]=17,Wr[100]=qi[100]=1,In[100]=zn[100]=17,tn[34]=Zr[34]=9,Wr[34]=In[34]=12,Xn[34]=so[34]=21,zn[34]=qi[34]=22,tn[136]=so[136]=4,Wr[136]=qi[136]=1,In[136]=zn[136]=17,Zr[136]=Xn[136]=18,tn[35]=so[35]=4,Wr[35]=In[35]=12,Zr[35]=Xn[35]=18,zn[35]=qi[35]=22,tn[153]=so[153]=4,Zr[153]=Xn[153]=18,Wr[102]=In[102]=12,zn[102]=qi[102]=22,tn[155]=Zr[155]=9,Xn[155]=so[155]=23,Wr[103]=qi[103]=1,In[103]=zn[103]=17,tn[152]=so[152]=4,In[152]=zn[152]=17,Zr[152]=Xn[152]=18,tn[156]=In[156]=8,Zr[156]=Xn[156]=18,zn[156]=so[156]=23,tn[137]=so[137]=4,Wr[137]=qi[137]=1,Zr[137]=Xn[137]=18,tn[139]=so[139]=4,Wr[139]=Zr[139]=13,Xn[139]=qi[139]=20,tn[98]=Zr[98]=9,Wr[98]=In[98]=12,zn[98]=qi[98]=22,tn[99]=qi[99]=0,Wr[99]=In[99]=12,Zr[99]=zn[99]=19,Wr[38]=In[38]=12,Xn[38]=so[38]=21,zn[38]=qi[38]=22,Wr[39]=so[39]=5,In[39]=Xn[39]=16,zn[39]=qi[39]=22;var qr=[];function Dc(r,a,o){return function Lh(r){return(r>0)-(r<0)||+r}((a[0]-r[0])*(o[1]-a[1])-(o[0]-a[0])*(a[1]-r[1]))}function dp(r,a){return a.geometry.coordinates[0].every(function(o){return vu(or(o),r)})}qr[1]=qr[169]=Ic,qr[4]=qr[166]=Mc,qr[16]=qr[154]=fc,qr[64]=qr[106]=Ih,qr[168]=qr[2]=Mh,qr[162]=qr[8]=dc,qr[138]=qr[32]=Yc,qr[42]=qr[128]=Jc,qr[5]=qr[165]=function(r){return[[0,0],[0,r.leftbottom],[1,r.rightbottom],[1,0]]},qr[20]=qr[150]=function(r){return[[1,0],[r.bottomright,0],[r.topright,1],[1,1]]},qr[80]=qr[90]=function(r){return[[1,1],[1,r.righttop],[0,r.lefttop],[0,1]]},qr[65]=qr[105]=function(r){return[[r.bottomleft,0],[0,0],[0,1],[r.topleft,1]]},qr[160]=qr[10]=function(r){return[[1,r.righttop],[1,r.rightbottom],[0,r.leftbottom],[0,r.lefttop]]},qr[130]=qr[40]=function(r){return[[r.topleft,1],[r.topright,1],[r.bottomright,0],[r.bottomleft,0]]},qr[85]=function(){return[[0,0],[0,1],[1,1],[1,0]]},qr[101]=qr[69]=function(r){return[[1,r.rightbottom],[1,0],[0,0],[0,1],[r.topleft,1]]},qr[149]=qr[21]=function(r){return[[r.topright,1],[1,1],[1,0],[0,0],[0,r.leftbottom]]},qr[86]=qr[84]=function(r){return[[1,0],[r.bottomright,0],[0,r.lefttop],[0,1],[1,1]]},qr[89]=qr[81]=function(r){return[[1,1],[1,r.righttop],[r.bottomleft,0],[0,0],[0,1]]},qr[96]=qr[74]=function(r){return[[1,r.righttop],[1,r.rightbottom],[0,r.lefttop],[0,1],[r.topleft,1]]},qr[24]=qr[146]=function(r){return[[1,1],[1,r.righttop],[r.bottomright,0],[r.bottomleft,0],[r.topright,1]]},qr[6]=qr[164]=function(r){return[[1,r.rightbottom],[1,0],[r.bottomright,0],[0,r.leftbottom],[0,r.lefttop]]},qr[129]=qr[41]=function(r){return[[r.topright,1],[r.bottomleft,0],[0,0],[0,r.leftbottom],[r.topleft,1]]},qr[66]=qr[104]=function(r){return[[r.bottomright,0],[r.bottomleft,0],[0,r.lefttop],[0,1],[r.topleft,1]]},qr[144]=qr[26]=function(r){return[[1,1],[1,r.righttop],[0,r.leftbottom],[0,r.lefttop],[r.topright,1]]},qr[36]=qr[134]=function(r){return[[1,r.rightbottom],[1,0],[r.bottomright,0],[r.topleft,1],[r.topright,1]]},qr[9]=qr[161]=function(r){return[[1,r.righttop],[1,r.rightbottom],[r.bottomleft,0],[0,0],[0,r.leftbottom]]},qr[37]=qr[133]=function(r){return[[1,r.rightbottom],[1,0],[0,0],[0,r.leftbottom],[r.topleft,1],[r.topright,1]]},qr[148]=qr[22]=function(r){return[[1,1],[1,0],[r.bottomright,0],[0,r.leftbottom],[0,r.lefttop],[r.topright,1]]},qr[82]=qr[88]=function(r){return[[1,1],[1,r.righttop],[r.bottomright,0],[r.bottomleft,0],[0,r.lefttop],[0,1]]},qr[73]=qr[97]=function(r){return[[1,r.righttop],[1,r.rightbottom],[r.bottomleft,0],[0,0],[0,1],[r.topleft,1]]},qr[145]=qr[25]=function(r){return[[1,1],[1,r.righttop],[r.bottomleft,0],[0,0],[0,r.leftbottom],[r.topright,1]]},qr[70]=qr[100]=function(r){return[[1,r.rightbottom],[1,0],[r.bottomright,0],[0,r.lefttop],[0,1],[r.topleft,1]]},qr[34]=function(r){return[Jc(r),dc(r)]},qr[35]=function(r){return[[1,r.righttop],[1,r.rightbottom],[r.bottomright,0],[r.bottomleft,0],[0,r.leftbottom],[0,r.lefttop],[r.topleft,1],[r.topright,1]]},qr[136]=function(r){return[Yc(r),Mh(r)]},qr[153]=function(r){return[fc(r),Ic(r)]},qr[102]=function(r){return[Mc(r),Ih(r)]},qr[155]=function(r){return[[1,1],[1,r.righttop],[r.bottomleft,0],[0,0],[0,r.leftbottom],[r.topright,1]]},qr[103]=function(r){return[[1,r.rightbottom],[1,0],[r.bottomright,0],[0,r.lefttop],[0,1],[r.topleft,1]]},qr[152]=function(r){return[fc(r),Mh(r)]},qr[156]=function(r){return[[1,1],[1,r.righttop],[r.bottomright,0],[r.bottomleft,0],[0,r.leftbottom],[0,r.lefttop],[r.topright,1]]},qr[137]=function(r){return[Yc(r),Ic(r)]},qr[139]=function(r){return[[1,r.righttop],[1,r.rightbottom],[r.bottomleft,0],[0,0],[0,r.leftbottom],[r.topleft,1],[r.topright,1]]},qr[98]=function(r){return[dc(r),Ih(r)]},qr[99]=function(r){return[[1,r.righttop],[1,r.rightbottom],[r.bottomright,0],[r.bottomleft,0],[0,r.lefttop],[0,1],[r.topleft,1]]},qr[38]=function(r){return[Mc(r),Jc(r)]},qr[39]=function(r){return[[1,r.rightbottom],[1,0],[r.bottomright,0],[0,r.leftbottom],[0,r.lefttop],[r.topleft,1],[r.topright,1]]};const gp=function(){function r(a){this.id=r.buildId(a),this.coordinates=a,this.innerEdges=[],this.outerEdges=[],this.outerEdgesSorted=!1}return r.buildId=function(a){return a.join(",")},r.prototype.removeInnerEdge=function(a){this.innerEdges=this.innerEdges.filter(function(o){return o.from.id!==a.from.id})},r.prototype.removeOuterEdge=function(a){this.outerEdges=this.outerEdges.filter(function(o){return o.to.id!==a.to.id})},r.prototype.addOuterEdge=function(a){this.outerEdges.push(a),this.outerEdgesSorted=!1},r.prototype.sortOuterEdges=function(){var a=this;this.outerEdgesSorted||(this.outerEdges.sort(function(o,p){var y=o.to,v=p.to;if(y.coordinates[0]-a.coordinates[0]>=0&&v.coordinates[0]-a.coordinates[0]<0)return 1;if(y.coordinates[0]-a.coordinates[0]<0&&v.coordinates[0]-a.coordinates[0]>=0)return-1;if(y.coordinates[0]-a.coordinates[0]==0&&v.coordinates[0]-a.coordinates[0]==0)return y.coordinates[1]-a.coordinates[1]>=0||v.coordinates[1]-a.coordinates[1]>=0?y.coordinates[1]-v.coordinates[1]:v.coordinates[1]-y.coordinates[1];var b=Dc(a.coordinates,y.coordinates,v.coordinates);return b<0?1:b>0?-1:Math.pow(y.coordinates[0]-a.coordinates[0],2)+Math.pow(y.coordinates[1]-a.coordinates[1],2)-(Math.pow(v.coordinates[0]-a.coordinates[0],2)+Math.pow(v.coordinates[1]-a.coordinates[1],2))}),this.outerEdgesSorted=!0)},r.prototype.getOuterEdges=function(){return this.sortOuterEdges(),this.outerEdges},r.prototype.getOuterEdge=function(a){return this.sortOuterEdges(),this.outerEdges[a]},r.prototype.addInnerEdge=function(a){this.innerEdges.push(a)},r}(),yp=function(){function r(a,o){this.from=a,this.to=o,this.next=void 0,this.label=void 0,this.symetric=void 0,this.ring=void 0,this.from.addOuterEdge(this),this.to.addInnerEdge(this)}return r.prototype.getSymetric=function(){return this.symetric||(this.symetric=new r(this.to,this.from),this.symetric.symetric=this),this.symetric},r.prototype.deleteEdge=function(){this.from.removeOuterEdge(this),this.to.removeInnerEdge(this)},r.prototype.isEqual=function(a){return this.from.id===a.from.id&&this.to.id===a.to.id},r.prototype.toString=function(){return"Edge { "+this.from.id+" -> "+this.to.id+" }"},r.prototype.toLineString=function(){return pt([this.from.coordinates,this.to.coordinates])},r.prototype.compareTo=function(a){return Dc(a.from.coordinates,a.to.coordinates,this.to.coordinates)},r}(),hf=function(){function r(){this.edges=[],this.polygon=void 0,this.envelope=void 0}return r.prototype.push=function(a){this.edges.push(a),this.polygon=this.envelope=void 0},r.prototype.get=function(a){return this.edges[a]},Object.defineProperty(r.prototype,"length",{get:function(){return this.edges.length},enumerable:!0,configurable:!0}),r.prototype.forEach=function(a){this.edges.forEach(a)},r.prototype.map=function(a){return this.edges.map(a)},r.prototype.some=function(a){return this.edges.some(a)},r.prototype.isValid=function(){return!0},r.prototype.isHole=function(){var a=this,o=this.edges.reduce(function(b,I,M){return I.from.coordinates[1]>a.edges[b].from.coordinates[1]&&(b=M),b},0),p=(0===o?this.length:o)-1,y=(o+1)%this.length,v=Dc(this.edges[p].from.coordinates,this.edges[o].from.coordinates,this.edges[y].from.coordinates);return 0===v?this.edges[p].from.coordinates[0]>this.edges[y].from.coordinates[0]:v>0},r.prototype.toMultiPoint=function(){return function me(r,a,o){return void 0===o&&(o={}),vo({type:"MultiPoint",coordinates:r},a,o)}(this.edges.map(function(a){return a.from.coordinates}))},r.prototype.toPolygon=function(){if(this.polygon)return this.polygon;var a=this.edges.map(function(o){return o.from.coordinates});return a.push(this.edges[0].from.coordinates),this.polygon=Y([a])},r.prototype.getEnvelope=function(){return this.envelope?this.envelope:this.envelope=function Bs(r){return function sa(r,a){void 0===a&&(a={});var o=Number(r[0]),p=Number(r[1]),y=Number(r[2]),v=Number(r[3]);if(6===r.length)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var b=[o,p];return Y([[b,[y,p],[y,v],[o,v],b]],a.properties,{bbox:r,id:a.id})}(io(r))}(this.toPolygon())},r.findEdgeRingContaining=function(a,o){var y,v,p=a.getEnvelope();return o.forEach(function(b){var I=b.getEnvelope();if(v&&(y=v.getEnvelope()),!function Ou(r,a){var o=r.geometry.coordinates[0].map(function(b){return b[0]}),p=r.geometry.coordinates[0].map(function(b){return b[1]}),y=a.geometry.coordinates[0].map(function(b){return b[0]}),v=a.geometry.coordinates[0].map(function(b){return b[1]});return Math.max.apply(null,o)===Math.max.apply(null,y)&&Math.max.apply(null,p)===Math.max.apply(null,v)&&Math.min.apply(null,o)===Math.min.apply(null,y)&&Math.min.apply(null,p)===Math.min.apply(null,v)}(I,p)&&dp(I,p)){for(var M=a.map(function(Zt){return Zt.from.coordinates}),C=void 0,O=function(Zt){b.some(function(At){return function cf(r,a){return r[0]===a[0]&&r[1]===a[1]}(Zt,At.from.coordinates)})||(C=Zt)},k=0,N=M;k<N.length;k++)O(N[k]);C&&b.inside(or(C))&&(!v||dp(y,I))&&(v=b)}}),v},r.prototype.inside=function(a){return vu(a,this.toPolygon())},r}();function Sf(r){for(var a=r,o=[];a.parent;)o.unshift(a),a=a.parent;return o}!function(){function r(){this.edges=[],this.nodes={}}r.fromGeoJson=function(a){!function Oc(r){if(!r)throw new Error("No geojson passed");if("FeatureCollection"!==r.type&&"GeometryCollection"!==r.type&&"MultiLineString"!==r.type&&"LineString"!==r.type&&"Feature"!==r.type)throw new Error("Invalid input type '"+r.type+"'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature")}(a);var o=new r;return ct(a,function(p){(function ri(r,a,o){if(!r)throw new Error("No feature passed");if(!o)throw new Error(".featureOf() requires a name");if(!r||"Feature"!==r.type||!r.geometry)throw new Error("Invalid input to "+o+", Feature with geometry required");if(!r.geometry||r.geometry.type!==a)throw new Error("Invalid input to "+o+": must be a "+a+", given "+r.geometry.type)})(p,"LineString","Graph::fromGeoJson"),function _o(r,a,o,p){var y=o;Pn(r,function(v,b,I,M,C){y=0===b&&void 0===o?v:a(y,v,b,I,M,C)},p)}(p,function(y,v){if(y){var b=o.getNode(y),I=o.getNode(v);o.addEdge(b,I)}return v})}),o},r.prototype.getNode=function(a){var o=gp.buildId(a),p=this.nodes[o];return p||(p=this.nodes[o]=new gp(a)),p},r.prototype.addEdge=function(a,o){var p=new yp(a,o),y=p.getSymetric();this.edges.push(p),this.edges.push(y)},r.prototype.deleteDangles=function(){var a=this;Object.keys(this.nodes).map(function(o){return a.nodes[o]}).forEach(function(o){return a._removeIfDangle(o)})},r.prototype._removeIfDangle=function(a){var o=this;if(a.innerEdges.length<=1){var p=a.getOuterEdges().map(function(y){return y.to});this.removeNode(a),p.forEach(function(y){return o._removeIfDangle(y)})}},r.prototype.deleteCutEdges=function(){var a=this;this._computeNextCWEdges(),this._findLabeledEdgeRings(),this.edges.forEach(function(o){o.label===o.symetric.label&&(a.removeEdge(o.symetric),a.removeEdge(o))})},r.prototype._computeNextCWEdges=function(a){var o=this;typeof a>"u"?Object.keys(this.nodes).forEach(function(p){return o._computeNextCWEdges(o.nodes[p])}):a.getOuterEdges().forEach(function(p,y){a.getOuterEdge((0===y?a.getOuterEdges().length:y)-1).symetric.next=p})},r.prototype._computeNextCCWEdges=function(a,o){for(var y,v,p=a.getOuterEdges(),b=p.length-1;b>=0;--b){var I=p[b],M=I.symetric,C=void 0,O=void 0;I.label===o&&(C=I),M.label===o&&(O=M),C&&O&&(O&&(v=O),C&&(v&&(v.next=C,v=void 0),y||(y=C)))}v&&(v.next=y)},r.prototype._findLabeledEdgeRings=function(){var a=[],o=0;return this.edges.forEach(function(p){if(!(p.label>=0)){a.push(p);var y=p;do{y.label=o,y=y.next}while(!p.isEqual(y));o++}}),a},r.prototype.getEdgeRings=function(){var a=this;this._computeNextCWEdges(),this.edges.forEach(function(p){p.label=void 0}),this._findLabeledEdgeRings().forEach(function(p){a._findIntersectionNodes(p).forEach(function(y){a._computeNextCCWEdges(y,p.label)})});var o=[];return this.edges.forEach(function(p){p.ring||o.push(a._findEdgeRing(p))}),o},r.prototype._findIntersectionNodes=function(a){var o=[],p=a,y=function(){var v=0;p.from.getOuterEdges().forEach(function(b){b.label===a.label&&++v}),v>1&&o.push(p.from),p=p.next};do{y()}while(!a.isEqual(p));return o},r.prototype._findEdgeRing=function(a){var o=a,p=new hf;do{p.push(o),o.ring=p,o=o.next}while(!a.isEqual(o));return p},r.prototype.removeNode=function(a){var o=this;a.getOuterEdges().forEach(function(p){return o.removeEdge(p)}),a.innerEdges.forEach(function(p){return o.removeEdge(p)}),delete this.nodes[a.id]},r.prototype.removeEdge=function(a){this.edges=this.edges.filter(function(o){return!o.isEqual(a)}),a.deleteEdge()}}(),St(5013),St(7470),St(9475);var rh={search:function(r,a,o,p){r.cleanDirty();var y=(p=p||{}).heuristic||rh.heuristics.manhattan,v=p.closest||!1,b=function Cf(){return new ih(function(r){return r.f})}(),I=a;for(a.h=y(a,o),b.push(a);b.size()>0;){var M=b.pop();if(M===o)return Sf(M);M.closed=!0;for(var C=r.neighbors(M),O=0,k=C.length;O<k;++O){var N=C[O];if(!N.closed&&!N.isWall()){var B=M.g+N.getCost(M),Zt=N.visited;(!Zt||B<N.g)&&(N.visited=!0,N.parent=M,N.h=N.h||y(N,o),N.g=B,N.f=N.g+N.h,r.markDirty(N),v&&(N.h<I.h||N.h===I.h&&N.g<I.g)&&(I=N),Zt?b.rescoreElement(N):b.push(N))}}}return v?Sf(I):[]},heuristics:{manhattan:function(r,a){return Math.abs(a.x-r.x)+Math.abs(a.y-r.y)},diagonal:function(r,a){var p=Math.sqrt(2),y=Math.abs(a.x-r.x),v=Math.abs(a.y-r.y);return 1*(y+v)+(p-2)*Math.min(y,v)}},cleanNode:function(r){r.f=0,r.g=0,r.h=0,r.visited=!1,r.closed=!1,r.parent=null}};function gc(r,a){a=a||{},this.nodes=[],this.diagonal=!!a.diagonal,this.grid=[];for(var o=0;o<r.length;o++){this.grid[o]=[];for(var p=0,y=r[o];p<y.length;p++){var v=new nh(o,p,y[p]);this.grid[o][p]=v,this.nodes.push(v)}}this.init()}function nh(r,a,o){this.x=r,this.y=a,this.weight=o}function ih(r){this.content=[],this.scoreFunction=r}function Fh(){this._=null}function Ta(r){r.U=r.C=r.L=r.R=r.P=r.N=null}function ko(r,a){var o=a,p=a.R,y=o.U;y?y.L===o?y.L=p:y.R=p:r._=p,p.U=y,o.U=p,o.R=p.L,o.R&&(o.R.U=o),p.L=o}function Rc(r,a){var o=a,p=a.L,y=o.U;y?y.L===o?y.L=p:y.R=p:r._=p,p.U=y,o.U=p,o.L=p.R,o.L&&(o.L.U=o),p.R=o}function Cp(r){for(;r.L;)r=r.L;return r}gc.prototype.init=function(){this.dirtyNodes=[];for(var r=0;r<this.nodes.length;r++)rh.cleanNode(this.nodes[r])},gc.prototype.cleanDirty=function(){for(var r=0;r<this.dirtyNodes.length;r++)rh.cleanNode(this.dirtyNodes[r]);this.dirtyNodes=[]},gc.prototype.markDirty=function(r){this.dirtyNodes.push(r)},gc.prototype.neighbors=function(r){var a=[],o=r.x,p=r.y,y=this.grid;return y[o-1]&&y[o-1][p]&&a.push(y[o-1][p]),y[o+1]&&y[o+1][p]&&a.push(y[o+1][p]),y[o]&&y[o][p-1]&&a.push(y[o][p-1]),y[o]&&y[o][p+1]&&a.push(y[o][p+1]),this.diagonal&&(y[o-1]&&y[o-1][p-1]&&a.push(y[o-1][p-1]),y[o+1]&&y[o+1][p-1]&&a.push(y[o+1][p-1]),y[o-1]&&y[o-1][p+1]&&a.push(y[o-1][p+1]),y[o+1]&&y[o+1][p+1]&&a.push(y[o+1][p+1])),a},gc.prototype.toString=function(){for(var o,p,y,v,r=[],a=this.grid,b=0,I=a.length;b<I;b++){for(o=[],y=0,v=(p=a[b]).length;y<v;y++)o.push(p[y].weight);r.push(o.join(" "))}return r.join("\n")},nh.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},nh.prototype.getCost=function(r){return r&&r.x!==this.x&&r.y!==this.y?1.41421*this.weight:this.weight},nh.prototype.isWall=function(){return 0===this.weight},ih.prototype={push:function(r){this.content.push(r),this.sinkDown(this.content.length-1)},pop:function(){var r=this.content[0],a=this.content.pop();return this.content.length>0&&(this.content[0]=a,this.bubbleUp(0)),r},remove:function(r){var a=this.content.indexOf(r),o=this.content.pop();a!==this.content.length-1&&(this.content[a]=o,this.scoreFunction(o)<this.scoreFunction(r)?this.sinkDown(a):this.bubbleUp(a))},size:function(){return this.content.length},rescoreElement:function(r){this.sinkDown(this.content.indexOf(r))},sinkDown:function(r){for(var a=this.content[r];r>0;){var o=(r+1>>1)-1,p=this.content[o];if(!(this.scoreFunction(a)<this.scoreFunction(p)))break;this.content[o]=a,this.content[r]=p,r=o}},bubbleUp:function(r){for(var a=this.content.length,o=this.content[r],p=this.scoreFunction(o);;){var I,y=r+1<<1,v=y-1,b=null;if(v<a&&(I=this.scoreFunction(this.content[v]))<p&&(b=v),y<a&&this.scoreFunction(this.content[y])<(null===b?p:I)&&(b=y),null===b)break;this.content[r]=this.content[b],this.content[b]=o,r=b}}},Fh.prototype={constructor:Fh,insert:function(r,a){var o,p,y;if(r){if(a.P=r,a.N=r.N,r.N&&(r.N.P=a),r.N=a,r.R){for(r=r.R;r.L;)r=r.L;r.L=a}else r.R=a;o=r}else this._?(r=Cp(this._),a.P=null,a.N=r,r.P=r.L=a,o=r):(a.P=a.N=null,this._=a,o=null);for(a.L=a.R=null,a.U=o,a.C=!0,r=a;o&&o.C;)o===(p=o.U).L?(y=p.R)&&y.C?(o.C=y.C=!1,p.C=!0,r=p):(r===o.R&&(ko(this,o),o=(r=o).U),o.C=!1,p.C=!0,Rc(this,p)):(y=p.L)&&y.C?(o.C=y.C=!1,p.C=!0,r=p):(r===o.L&&(Rc(this,o),o=(r=o).U),o.C=!1,p.C=!0,ko(this,p)),o=r.U;this._.C=!1},remove:function(r){r.N&&(r.N.P=r.P),r.P&&(r.P.N=r.N),r.N=r.P=null;var o,v,b,a=r.U,p=r.L,y=r.R;if(v=p?y?Cp(y):p:y,a?a.L===r?a.L=v:a.R=v:this._=v,p&&y?(b=v.C,v.C=r.C,v.L=p,p.U=v,v!==y?(a=v.U,v.U=r.U,a.L=r=v.R,v.R=y,y.U=v):(v.U=a,a=v,r=v.R)):(b=r.C,r=v),r&&(r.U=a),!b){if(r&&r.C)return void(r.C=!1);do{if(r===this._)break;if(r===a.L){if((o=a.R).C&&(o.C=!1,a.C=!0,ko(this,a),o=a.R),o.L&&o.L.C||o.R&&o.R.C){(!o.R||!o.R.C)&&(o.L.C=!1,o.C=!0,Rc(this,o),o=a.R),o.C=a.C,a.C=o.R.C=!1,ko(this,a),r=this._;break}}else if((o=a.L).C&&(o.C=!1,a.C=!0,Rc(this,a),o=a.L),o.L&&o.L.C||o.R&&o.R.C){(!o.L||!o.L.C)&&(o.R.C=!1,o.C=!0,ko(this,o),o=a.L),o.C=a.C,a.C=o.L.C=!1,Rc(this,a),r=this._;break}o.C=!0,r=a,a=a.U}while(!r.C);r&&(r.C=!1)}}};const Ip=Fh;function Fc(r,a,o,p){var y=[null,null],v=G.push(y)-1;return y.left=r,y.right=a,o&&Bc(y,r,a,o),p&&Bc(y,a,r,p),z[r.index].halfedges.push(v),z[a.index].halfedges.push(v),y}function zc(r,a,o){var p=[a,o];return p.left=r,p}function Bc(r,a,o,p){r[0]||r[1]?r.left===o?r[1]=p:r[0]=p:(r[0]=p,r.left=a,r.right=o)}function mc(r,a,o,p,y){var At,v=r[0],b=r[1],I=v[0],M=v[1],k=0,N=1,B=b[0]-I,Zt=b[1]-M;if(At=a-I,B||!(At>0)){if(At/=B,B<0){if(At<k)return;At<N&&(N=At)}else if(B>0){if(At>N)return;At>k&&(k=At)}if(At=p-I,B||!(At<0)){if(At/=B,B<0){if(At>N)return;At>k&&(k=At)}else if(B>0){if(At<k)return;At<N&&(N=At)}if(At=o-M,Zt||!(At>0)){if(At/=Zt,Zt<0){if(At<k)return;At<N&&(N=At)}else if(Zt>0){if(At>N)return;At>k&&(k=At)}if(At=y-M,Zt||!(At<0)){if(At/=Zt,Zt<0){if(At>N)return;At>k&&(k=At)}else if(Zt>0){if(At<k)return;At<N&&(N=At)}return!(k>0)&&!(N<1)||(k>0&&(r[0]=[I+k*B,M+k*Zt]),N<1&&(r[1]=[I+N*B,M+N*Zt])),!0}}}}}function yc(r,a,o,p,y){var v=r[1];if(v)return!0;var At,de,b=r[0],I=r.left,M=r.right,C=I[0],O=I[1],k=M[0],N=M[1],B=(C+k)/2;if(N===O){if(B<a||B>=p)return;if(C>k){if(b){if(b[1]>=y)return}else b=[B,o];v=[B,y]}else{if(b){if(b[1]<o)return}else b=[B,y];v=[B,o]}}else if(de=(O+N)/2-(At=(C-k)/(N-O))*B,At<-1||At>1)if(C>k){if(b){if(b[1]>=y)return}else b=[(o-de)/At,o];v=[(y-de)/At,y]}else{if(b){if(b[1]<o)return}else b=[(y-de)/At,y];v=[(o-de)/At,o]}else if(O<N){if(b){if(b[0]>=p)return}else b=[a,At*a+de];v=[p,At*p+de]}else{if(b){if(b[0]<a)return}else b=[p,At*p+de];v=[a,At*a+de]}return r[0]=b,r[1]=v,!0}function ah(r,a){var o=r.site,p=a.left,y=a.right;return o===y&&(y=p,p=o),y?Math.atan2(y[1]-p[1],y[0]-p[0]):(o===p?(p=a[1],y=a[0]):(p=a[0],y=a[1]),Math.atan2(p[0]-y[0],y[1]-p[1]))}function Sl(r,a){return a[+(a.left!==r.site)]}function zh(r,a){return a[+(a.left===r.site)]}var vl,vc=[];function Mf(){Ta(this),this.x=this.y=this.arc=this.site=this.cy=null}function _c(r){var a=r.P,o=r.N;if(a&&o){var p=a.site,y=r.site,v=o.site;if(p!==v){var b=y[0],I=y[1],M=p[0]-b,C=p[1]-I,O=v[0]-b,k=v[1]-I,N=2*(M*k-C*O);if(!(N>=-S)){var B=M*M+C*C,Zt=O*O+k*k,At=(k*B-C*Zt)/N,de=(M*Zt-O*B)/N,Xt=vc.pop()||new Mf;Xt.arc=r,Xt.site=y,Xt.x=At+b,Xt.y=(Xt.cy=de+I)+Math.sqrt(At*At+de*de),r.circle=Xt;for(var wt=null,Ut=q._;Ut;)if(Xt.y<Ut.y||Xt.y===Ut.y&&Xt.x<=Ut.x){if(!Ut.L){wt=Ut.P;break}Ut=Ut.L}else{if(!Ut.R){wt=Ut;break}Ut=Ut.R}q.insert(wt,Xt),wt||(vl=Xt)}}}}function Uc(r){var a=r.circle;a&&(a.P||(vl=a.N),q.remove(a),vc.push(a),Ta(a),r.circle=null)}var vs=[];function Hl(){Ta(this),this.edge=this.site=this.circle=null}function Pp(r){var a=vs.pop()||new Hl;return a.site=r,a}function t(r){Uc(r),D.remove(r),vs.push(r),Ta(r)}function n(r){var a=r.circle,o=a.x,p=a.cy,y=[o,p],v=r.P,b=r.N,I=[r];t(r);for(var M=v;M.circle&&Math.abs(o-M.circle.x)<w&&Math.abs(p-M.circle.cy)<w;)v=M.P,I.unshift(M),t(M),M=v;I.unshift(M),Uc(M);for(var C=b;C.circle&&Math.abs(o-C.circle.x)<w&&Math.abs(p-C.circle.cy)<w;)b=C.N,I.push(C),t(C),C=b;I.push(C),Uc(C);var k,O=I.length;for(k=1;k<O;++k)Bc((C=I[k]).edge,(M=I[k-1]).site,C.site,y);(C=I[O-1]).edge=Fc((M=I[0]).site,C.site,null,y),_c(M),_c(C)}function u(r){for(var p,y,v,b,a=r[0],o=r[1],I=D._;I;)if((v=g(I,o)-a)>w)I=I.L;else{if(!((b=a-_(I,o))>w)){v>-w?(p=I.P,y=I):b>-w?(p=I,y=I.N):p=y=I;break}if(!I.R){p=I;break}I=I.R}!function is(r){z[r.index]={site:r,halfedges:[]}}(r);var M=Pp(r);if(D.insert(p,M),p||y){if(p===y)return Uc(p),y=Pp(p.site),D.insert(M,y),M.edge=y.edge=Fc(p.site,M.site),_c(p),void _c(y);if(!y)return void(M.edge=Fc(p.site,M.site));Uc(p),Uc(y);var C=p.site,O=C[0],k=C[1],N=r[0]-O,B=r[1]-k,Zt=y.site,At=Zt[0]-O,de=Zt[1]-k,Xt=2*(N*de-B*At),wt=N*N+B*B,Ut=At*At+de*de,xe=[(de*wt-B*Ut)/Xt+O,(N*Ut-At*wt)/Xt+k];Bc(y.edge,C,Zt,xe),M.edge=Fc(C,r,null,xe),y.edge=Fc(r,Zt,null,xe),_c(p),_c(y)}}function g(r,a){var o=r.site,p=o[0],y=o[1],v=y-a;if(!v)return p;var b=r.P;if(!b)return-1/0;var I=(o=b.site)[0],M=o[1],C=M-a;if(!C)return I;var O=I-p,k=1/v-1/C,N=O/C;return k?(-N+Math.sqrt(N*N-2*k*(O*O/(-2*C)-M+C/2+y-v/2)))/k+p:(p+I)/2}function _(r,a){var o=r.N;if(o)return g(o,a);var p=r.site;return p[1]===a?p[0]:1/0}var D,z,q,G,w=1e-6,S=1e-12;function J(r,a,o){return(r[0]-o[0])*(a[1]-r[1])-(r[0]-a[0])*(o[1]-r[1])}function ut(r,a){return a[1]-r[1]||a[0]-r[0]}function mt(r,a){var p,y,v,o=r.sort(ut).pop();for(G=[],z=new Array(r.length),D=new Ip,q=new Ip;;)if(v=vl,o&&(!v||o[1]<v.y||o[1]===v.y&&o[0]<v.x))(o[0]!==p||o[1]!==y)&&(u(o),p=o[0],y=o[1]),o=r.pop();else{if(!v)break;n(v.arc)}if(function Bh(){for(var o,p,y,v,r=0,a=z.length;r<a;++r)if((o=z[r])&&(v=(p=o.halfedges).length)){var b=new Array(v),I=new Array(v);for(y=0;y<v;++y)b[y]=y,I[y]=ah(o,G[p[y]]);for(b.sort(function(M,C){return I[C]-I[M]}),y=0;y<v;++y)I[y]=p[b[y]];for(y=0;y<v;++y)p[y]=I[y]}}(),a){var b=+a[0][0],I=+a[0][1],M=+a[1][0],C=+a[1][1];(function If(r,a,o,p){for(var v,y=G.length;y--;)yc(v=G[y],r,a,o,p)&&mc(v,r,a,o,p)&&(Math.abs(v[0][0]-v[1][0])>w||Math.abs(v[0][1]-v[1][1])>w)||delete G[y]})(b,I,M,C),function Mp(r,a,o,p){var v,b,I,M,C,O,k,N,B,Zt,At,de,y=z.length,Xt=!0;for(v=0;v<y;++v)if(b=z[v]){for(I=b.site,M=(C=b.halfedges).length;M--;)G[C[M]]||C.splice(M,1);for(M=0,O=C.length;M<O;)At=(Zt=zh(b,G[C[M]]))[0],de=Zt[1],N=(k=Sl(b,G[C[++M%O]]))[0],B=k[1],(Math.abs(At-N)>w||Math.abs(de-B)>w)&&(C.splice(M,0,G.push(zc(I,Zt,Math.abs(At-r)<w&&p-de>w?[r,Math.abs(N-r)<w?B:p]:Math.abs(de-p)<w&&o-At>w?[Math.abs(B-p)<w?N:o,p]:Math.abs(At-o)<w&&de-a>w?[o,Math.abs(N-o)<w?B:a]:Math.abs(de-a)<w&&At-r>w?[Math.abs(B-a)<w?N:r,a]:null))-1),++O);O&&(Xt=!1)}if(Xt){var wt,Ut,xe,ve=1/0;for(v=0,Xt=null;v<y;++v)(b=z[v])&&(xe=(wt=(I=b.site)[0]-r)*wt+(Ut=I[1]-a)*Ut)<ve&&(ve=xe,Xt=b);if(Xt){var Oe=[r,a],Le=[r,p],Je=[o,p],re=[o,a];Xt.halfedges.push(G.push(zc(I=Xt.site,Oe,Le))-1,G.push(zc(I,Le,Je))-1,G.push(zc(I,Je,re))-1,G.push(zc(I,re,Oe))-1)}}for(v=0;v<y;++v)(b=z[v])&&(b.halfedges.length||delete z[v])}(b,I,M,C)}this.edges=G,this.cells=z,D=q=G=z=null}function Wu(){return new al}function al(){this.reset()}mt.prototype={constructor:mt,polygons:function(){var r=this.edges;return this.cells.map(function(a){var o=a.halfedges.map(function(p){return Sl(a,r[p])});return o.data=a.site.data,o})},triangles:function(){var r=[],a=this.edges;return this.cells.forEach(function(o,p){if(I=(v=o.halfedges).length)for(var v,I,M,y=o.site,b=-1,C=a[v[I-1]],O=C.left===y?C.right:C.left;++b<I;)M=O,O=(C=a[v[b]]).left===y?C.right:C.left,M&&O&&p<M.index&&p<O.index&&J(y,M,O)<0&&r.push([y.data,M.data,O.data])}),r},links:function(){return this.edges.filter(function(r){return r.right}).map(function(r){return{source:r.left.data,target:r.right.data}})},find:function(r,a,o){for(var y,I,p=this,v=p._found||0,b=p.cells.length;!(I=p.cells[v]);)if(++v>=b)return null;var M=r-I.site[0],C=a-I.site[1],O=M*M+C*C;do{I=p.cells[y=v],v=null,I.halfedges.forEach(function(k){var N=p.edges[k],B=N.left;if(B!==I.site&&B||(B=N.right)){var Zt=r-B[0],At=a-B[1],de=Zt*Zt+At*At;de<O&&(O=de,v=B.index)}})}while(null!==v);return p._found=y,null==o||O<=o*o?I.site:null}},St(9855),St(770),al.prototype={constructor:al,reset:function(){this.s=this.t=0},add:function(r){uh(ql,r,this.t),uh(this,ql.s,this.s),this.s?this.t+=ql.t:this.s=ql.t},valueOf:function(){return this.s}};var ql=new al;function uh(r,a,o){var p=r.s=a+o,y=p-a;r.t=a-(p-y)+(o-y)}var Aa=Math.PI,gu=Aa/2,Ml=2*Aa,Vo=Aa/180,Kl=(Math,Math.atan),Gl=Math.atan2,yo=Math.cos,Ni=(Math,Math,Math,Math,Math,Math.sin),ul=(Math,Math.sqrt);Math;function ll(r){return r>1?gu:r<-1?-gu:Math.asin(r)}function Nd(r,a){return[r>Aa?r-Ml:r<-Aa?r+Ml:r,a]}function Tg(r,a){return r<a?-1:r>a?1:r>=a?0:NaN}Wu(),Wu(),Wu(),Nd.invert=Nd,function Im(r){1===r.length&&(r=function Mm(r){return function(a,o){return Tg(r(a),o)}}(r))}(Tg),Math.sqrt(50),Math.sqrt(10),Math.sqrt(2);Wu();function tg(){}function em(r){return function(a,o){var p=yo(a),y=yo(o),v=r(p*y);return[v*y*Ni(a),v*Ni(o)]}}function Jp(r){return function(a,o){var p=ul(a*a+o*o),y=r(p),v=Ni(y),b=yo(y);return[Gl(a*v,p*b),ll(p&&o*v/p)]}}function rg(r,a){return[r,a]}Wu(),Wu(),Wu(),Wu(),function $g(r){return"m0,"+r+"a"+r+","+r+" 0 1,1 0,"+-2*r+"a"+r+","+r+" 0 1,1 0,"+2*r+"z"}(4.5),tg.prototype={constructor:tg,point:function(r,a){this.stream.point(r,a)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},yo(30*Vo),function Qg(r){return function(a){var o=new tg;for(var p in r)o[p]=r[p];return o.stream=a,o}}({point:function(r,a){this.stream.point(r*Vo,a*Vo)}}),em(function(r){return ul(2/(1+r))}).invert=Jp(function(r){return 2*ll(r/2)}),em(function(r){return(r=function hh(r){return r>1?0:r<-1?Aa:Math.acos(r)}(r))&&r/Ni(r)}).invert=Jp(function(r){return r}),rg.invert=rg,Jp(Kl),Jp(ll),Jp(function(r){return 2*Kl(r)});const Zc=Object.assign({},Ao);Zc.onSetup=function(){const r=this.newFeature({type:"Feature",properties:{},geometry:{type:"LineString",coordinates:[[]]}});return this.addFeature(r),this.clearSelectedFeatures(),setTimeout(()=>{!this.map||!this.map.dragPan||this.map.dragPan.disable()},0),this.updateUIClasses({mouse:"add"}),this.activateUIButton("line_string"),this.setActionableState({trash:!0}),{line:r,currentVertexPosition:0,dragMoving:!1}};var Hp=0;Zc.onDrag=Zc.onTouchMove=function(r,a){r.dragMoving=!0,this.updateUIClasses({mouse:"add"}),Hp||(Hp=+new Date,console.log(Hp));let o=new Date;o-Hp>=150&&(r.line.updateCoordinate(r.currentVertexPosition,a.lngLat.lng,a.lngLat.lat),"forward"===r.direction?(r.currentVertexPosition++,r.line.updateCoordinate(r.currentVertexPosition,a.lngLat.lng,a.lngLat.lat)):r.line.addCoordinate(0,a.lngLat.lng,a.lngLat.lat),Hp=o)},Zc.onMouseUp=function(r,a){r.dragMoving&&(console.log(r),this.bezierSpline(r.line),this.fireUpdate(),this.changeMode("simple_select",{featureIds:[r.line.id]}))},Zc.onTouchEnd=function(r,a){this.onMouseUp(r,a)},Zc.fireUpdate=function(){this.map.fire("draw.update",{action:"move",features:this.getSelected().map(r=>r.toGeoJSON())})},Zc.bezierSpline=function(r){!function Qa(r,a){void 0===a&&(a={});for(var o=a.resolution||1e4,p=a.sharpness||.85,y=[],v=En(r).coordinates.map(function(C){return{x:C[0],y:C[1]}}),b=new mi({duration:o,points:v,sharpness:p}),I=function(C){var O=b.pos(C);Math.floor(C/100)%2==0&&y.push([O.x,O.y])},M=0;M<b.duration;M+=10)I(M);I(b.duration),pt(y,a.properties)}(r)};const xy=Zc;var by=St(9990),wy=St.n(by),fm=St(3990);let Xf=(()=>{class r{constructor(){this.getCircleFeature=new s.vpe,this.style={version:8,sources:{osm:{type:"raster",tiles:["https://a.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png"],tileSize:256,attribution:"&copy; OpenStreetMap Contributors",maxzoom:19}},glyphs:"https://fonts.openmaptiles.org/{fontstack}/{range}.pbf",layers:[{id:"osm",type:"raster",source:"osm"}]}}setDrawCircleMode(){const p=v=>function Ea(r,a,o){void 0===o&&(o={});for(var p=o.steps||64,y=o.properties?o.properties:!Array.isArray(r)&&"Feature"===r.type&&r.properties?r.properties:{},v=[],b=0;b<p;b++)v.push(oi(r,a,-360*b/p,o).geometry.coordinates);return v.push(v[0]),Y([v],y)}(v.geometry.coordinates[0],Si(v));return{...Ot.modes.draw_line_string,clickAnywhere:function(v,b){return 1===v.currentVertexPosition?(v.line.addCoordinate(0,b.lngLat.lng,b.lngLat.lat),this.changeMode("simple_select",{featureIds:[v.line.id]})):(v.line.updateCoordinate(v.currentVertexPosition,b.lngLat.lng,b.lngLat.lat),"forward"===v.direction?(v.currentVertexPosition+=1,v.line.updateCoordinate(v.currentVertexPosition,b.lngLat.lng,b.lngLat.lat)):v.line.addCoordinate(0,b.lngLat.lng,b.lngLat.lat),null)},onStop:v=>{if(v.line.removeCoordinate("0"),v.line.isValid()){const b=v.line.toGeoJSON(),I=p(b);this.getCircleFeature.emit(JSON.parse(JSON.stringify({...I}))),this.map.fire("draw.create",{features:[I]}),this.draw.deleteAll()}else this.draw.deleteAll()},toDisplayFeatures:function(v,b,I){if(b.geometry.coordinates.length<2)return null;I({type:"Feature",properties:{active:"true"},geometry:{type:"Point",coordinates:b.geometry.coordinates[0]}}),b.properties.active="true",I(b);const M=(v=>{const b=1e3*Si(v);let C,N,I="m",M="0,0",O="ft",k="0,0";return C=b,b>=1e3&&(C=b/1e3,I="km",M="0.00"),N=3.28084*b,N>=5280&&(N/=5280,O="mi",k="0.00"),{metric:`${fm(C).format(M)} ${I}`,standard:`${fm(N).format(k)} ${O}`}})(b);I({type:"Feature",properties:{meta:"currentPosition",radius:`${M.metric} ${M.standard}`,parent:v.line.id},geometry:{type:"Point",coordinates:b.geometry.coordinates[1]}});const O=p(b);return O.properties={active:"true"},I(O),null}}}initializeDraw(){this.DrawCircle=this.setDrawCircleMode(),this.draw=new Ot({displayControlsDefault:!1,modes:Object.assign(Ot.modes,{draw_radius:this.DrawCircle,draw_freehand:ls,draw_rectangle:Qr.Z,draw_freehand_line:xy,rotate_mode:wy()})})}initializeMap(o){this.map=new Yt.Map({container:o,style:{version:8,sources:{tdtVec:{type:"raster",tiles:["https://t0.tianditu.gov.cn/vec_w/wmts?tk=1d109683f4d84198e37a38c442d68311&SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=vec&STYLE=default&TILEMATRIXSET=w&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}&FORMAT=tiles"],tileSize:256},tdtCva:{type:"raster",tiles:["https://t0.tianditu.gov.cn/cva_w/wmts?tk=1d109683f4d84198e37a38c442d68311&SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=cva&STYLE=default&TILEMATRIXSET=w&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}&FORMAT=tiles"],tileSize:256}},layers:[{id:"tdtVec",type:"raster",source:"tdtVec",minzoom:0,maxzoom:17},{id:"tdtCva",type:"raster",source:"tdtCva",minzoom:0,maxzoom:17}]},center:[118,32],zoom:4})}initializeGeolocator(){return new Yt.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0})}coordinatesGeocoder(o){const p=o.match(/^[ ]*(?:Lat: )?(-?\d+\.?\d*)[, ]+(?:Lng: )?(-?\d+\.?\d*)[ ]*$/i);if(!p)return null;function y(M,C){return{center:[M,C],geometry:{type:"Point",coordinates:[M,C]},place_name:"Lat: "+C+" Lng: "+M,place_type:["coordinate"],properties:{},type:"Feature"}}const v=Number(p[1]),b=Number(p[2]),I=[];return(v<-90||v>90)&&I.push(y(v,b)),(b<-90||b>90)&&I.push(y(b,v)),0===I.length&&(I.push(y(v,b)),I.push(y(b,v))),I}addControlsOnMap(){this.map?.addControl(new Yt.FullscreenControl,"bottom-left"),this.map?.addControl(new Yt.NavigationControl,"bottom-left"),this.map?.addControl(this.initializeGeolocator(),"bottom-left"),this.map?.addControl(this.draw,"bottom-left")}addControlGeocoder(){this.map?.addControl(this.geocoder,"top-left")}removeControlGeocoder(){this.map?.removeControl(this.geocoder)}getMapData(){return null==this.map||null==this.draw?void console.log("Error -------------- >>   Map and Draw is undefined"):{map:this.map,draw:this.draw}}removeLayerFn(){this.map.removeLayer("YourMapSourceIdLineString"),this.map.removeLayer("YourMapSourceIdPolygon"),this.map.removeLayer("YourMapSourceIdPoint"),this.map.removeLayer("YourMapSourceIdPolygonLineString")}removeSourceFn(){this.map.removeSource("YourMapSource")}addSourceFn(o={type:"FeatureCollection",features:[]}){this.map.addSource("YourMapSource",{type:"geojson",data:o}),this.addLayerFn()}addLayerFn(){this.map.addLayer({id:"YourMapSourceIdLineString",type:"line",source:"YourMapSource",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#572d06","line-width":2},filter:["==","$type","LineString"]}),this.map.addLayer({id:"YourMapSourceIdPolygon",type:"fill",source:"YourMapSource",paint:{"fill-color":"#10CAF0","fill-opacity":.4},filter:["==","$type","Polygon"]}),this.map.addLayer({id:"YourMapSourceIdPoint",type:"circle",source:"YourMapSource",paint:{"circle-radius":6,"circle-color":"#B42222"},filter:["==","$type","Point"]}),this.map.addLayer({id:"YourMapSourceIdPolygonLineString",type:"line",source:"YourMapSource",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#3b1513","line-width":2},filter:["==","$type","Polygon"]})}addLabelFn(o){this.map.addSource("YourMapLabelSource",{type:"geojson",data:o}),this.map.addLayer({id:"YourMapSourceLabels",type:"symbol",source:"YourMapLabelSource",layout:{"text-font":["Open Sans Bold"],"text-field":["get","featureid"],"text-variable-anchor":["top","bottom","left","right"],"text-radial-offset":.5,"text-justify":"center","icon-image":["concat",["get","icon"],"-15"],"text-size":15,"text-optional":!1},paint:{"text-color":"red","text-halo-color":"lightpink","text-halo-width":1}})}removeLabelFn(){this.map.removeLayer("YourMapSourceLabels"),this.map.removeSource("YourMapLabelSource")}}return r.\u0275fac=function(o){return new(o||r)},r.\u0275prov=s.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var dm=St(1572),Ey=St(9300),Sy=St(5698),Cy=St(1135);const Iy=["editor"];let Py=(()=>{class r{constructor(o,p){this.ngZone=o,this.monacoPathConfig=p,this.isMonacoLoaded$=new Cy.X(!1),this._monacoPath="assets/monaco-editor/min/vs",window.monacoEditorAlreadyInitialized?o.run(()=>this.isMonacoLoaded$.next(!0)):(window.monacoEditorAlreadyInitialized=!0,this.monacoPathConfig&&(this.monacoPath=this.monacoPathConfig),this.loadMonaco())}set monacoPath(o){o&&(this._monacoPath=o)}loadMonaco(){const o=()=>{let b=this._monacoPath;window.amdRequire=window.require;const I=!!this.nodeRequire,M=b.includes("http");I&&(window.require=this.nodeRequire,M||(b=window.require("path").resolve(window.__dirname,this._monacoPath))),window.amdRequire.config({paths:{vs:b}}),window.amdRequire(["vs/editor/editor.main"],()=>{this.ngZone.run(()=>this.isMonacoLoaded$.next(!0))},C=>console.error("Error loading monaco-editor: ",C))};if(window.amdRequire)return o();window.require&&(this.addElectronFixScripts(),this.nodeRequire=window.require);const v=document.createElement("script");v.type="text/javascript",v.src=`${this._monacoPath}/loader.js`,v.addEventListener("load",o),document.body.appendChild(v)}addElectronFixScripts(){const o=document.createElement("script"),p=document.createTextNode("self.module = undefined;"),y=document.createTextNode("self.process.browser = true;");o.appendChild(p),o.appendChild(y),document.body.appendChild(o)}}return r.\u0275fac=function(o){return new(o||r)(s.LFG(s.R0b),s.LFG("MONACO_PATH",8))},r.\u0275prov=s.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})(),gm=(()=>{class r{constructor(o){this.monacoLoader=o,this.init=new s.vpe,this.onTouched=()=>{},this.onErrorStatusChange=()=>{},this.propagateChange=()=>{}}get model(){return this.editor&&this.editor.getModel()}get modelMarkers(){return this.model&&monaco.editor.getModelMarkers({resource:this.model.uri})}ngOnInit(){this.monacoLoader.isMonacoLoaded$.pipe((0,Ey.h)(o=>o),(0,Sy.q)(1)).subscribe(()=>{this.initEditor()})}ngOnChanges(o){if(this.editor&&o.options&&!o.options.firstChange){const{language:p,theme:y,...v}=o.options.currentValue,{language:b,theme:I}=o.options.previousValue;b!==p&&monaco.editor.setModelLanguage(this.editor.getModel(),this.options&&this.options.language?this.options.language:"text"),I!==y&&monaco.editor.setTheme(y),this.editor.updateOptions(v)}if(this.editor&&o.uri){const p=o.uri.currentValue,y=o.uri.previousValue;if(y&&!p||!y&&p||p&&y&&p.path!==y.path){const v=this.editor.getValue();let b;this.modelUriInstance&&this.modelUriInstance.dispose(),p&&(b=monaco.editor.getModels().find(I=>I.uri.path===p.path)),this.modelUriInstance=b||monaco.editor.createModel(v,this.options.language||"text",this.uri),this.editor.setModel(this.modelUriInstance)}}}writeValue(o){this.value=o,this.editor&&o?this.editor.setValue(o):this.editor&&this.editor.setValue("")}registerOnChange(o){this.propagateChange=o}registerOnTouched(o){this.onTouched=o}validate(){return this.parsedError?{monaco:{value:this.parsedError.split("|")}}:null}registerOnValidatorChange(o){this.onErrorStatusChange=o}initEditor(){const o={value:[this.value].join("\n"),language:"text",automaticLayout:!0,scrollBeyondLastLine:!1,theme:"vc"};this.editor=monaco.editor.create(this.editorContent.nativeElement,this.options?{...o,...this.options}:o),this.registerEditorListeners(),this.init.emit(this.editor)}registerEditorListeners(){this.editor.onDidChangeModelContent(()=>{this.propagateChange(this.editor.getValue())}),this.editor.onDidChangeModelDecorations(()=>{const o=this.modelMarkers.map(({message:y})=>y).join("|");this.parsedError!==o&&(this.parsedError=o,this.onErrorStatusChange())}),this.editor.onDidBlurEditorText(()=>{this.onTouched()})}ngOnDestroy(){this.editor&&this.editor.dispose()}}return r.\u0275fac=function(o){return new(o||r)(s.Y36(Py))},r.\u0275cmp=s.Xpm({type:r,selectors:[["ngx-monaco-editor"]],viewQuery:function(o,p){if(1&o&&s.Gf(Iy,7),2&o){let y;s.iGM(y=s.CRH())&&(p.editorContent=y.first)}},inputs:{options:"options",uri:"uri"},outputs:{init:"init"},features:[s._Bn([{provide:lt.JU,useExisting:(0,s.Gpc)(()=>r),multi:!0},{provide:lt.Cf,useExisting:(0,s.Gpc)(()=>r),multi:!0}]),s.TTD],decls:4,vars:0,consts:[["fxFlex","",1,"editor-container"],["container",""],[1,"monaco-editor"],["editor",""]],template:function(o,p){1&o&&(s.TgZ(0,"div",0,1),s._UZ(2,"div",2,3),s.qZA())},styles:[".monaco-editor[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0}.editor-container[_ngcontent-%COMP%]{overflow:hidden;position:relative;display:table;width:100%;height:100%;min-width:0}"],changeDetection:0}),r})(),Ty=(()=>{class r{}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=s.oAB({type:r}),r.\u0275inj=s.cJS({imports:[[]]}),r})();function co(r,a,o){return"<"+r+((p=o)&&p.length?" "+p.map(function(y){return y[0]+'="'+y[1]+'"'}).join(" "):"")+">"+a+"</"+r+">";var p}function Wp(r){return(null===r?"":r.toString()).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function ng(r,a){return function(o){if(!o.properties||!Ll.valid(o.geometry))return"";var p=Ll.any(o.geometry);if(!p)return"";var I,M,y="",v="";if(r.simplestyle){var b=(M="",(I=o.properties)["marker-symbol"]&&(M=M+"ms"+I["marker-symbol"]),I["marker-color"]&&(M=M+"mc"+I["marker-color"].replace("#","")),I["marker-size"]&&(M=M+"ms"+I["marker-size"]),I.stroke&&(M=M+"s"+I.stroke.replace("#","")),I["stroke-width"]&&(M=M+"sw"+I["stroke-width"].toString().replace(".","")),I["stroke-opacity"]&&(M=M+"mo"+I["stroke-opacity"].toString().replace(".","")),I.fill&&(M=M+"f"+I.fill.replace("#","")),I["fill-opacity"]&&(M=M+"fo"+I["fill-opacity"].toString().replace(".","")),M);b&&(Ll.isPoint(o.geometry)&&function(I){return!!(I["marker-size"]||I["marker-symbol"]||I["marker-color"])}(o.properties)?(-1===a.indexOf(b)&&(y=function(I,M){return co("Style",co("IconStyle",co("Icon",co("href",(O=(C=I)["marker-size"]||"medium",k=C["marker-symbol"]?"-"+C["marker-symbol"]:"",N=(C["marker-color"]||"7e7e7e").replace("#",""),"https://api.tiles.mapbox.com/v3/marker/pin-"+O.charAt(0)+k+"+"+N+".png"))))+co("hotSpot","",[["xunits","fraction"],["yunits","fraction"],["x",.5],["y",.5]]),[["id",M]]);var C,O,k,N}(o.properties,b),a.push(b)),v=co("styleUrl","#"+b)):(Ll.isPolygon(o.geometry)||Ll.isLine(o.geometry))&&function(I){for(var M in I)if({stroke:!0,"stroke-opacity":!0,"stroke-width":!0,fill:!0,"fill-opacity":!0}[M])return!0}(o.properties)&&(-1===a.indexOf(b)&&(y=function(I,M){var C=co("LineStyle",[co("color",mm(I.stroke,I["stroke-opacity"])||"ff555555")+co("width",void 0===I["stroke-width"]?2:I["stroke-width"])]),O="";return(I.fill||I["fill-opacity"])&&(O=co("PolyStyle",[co("color",mm(I.fill,I["fill-opacity"])||"88555555")])),co("Style",C+O,[["id",M]])}(o.properties,b),a.push(b)),v=co("styleUrl","#"+b)))}return y+co("Placemark",function(I,M){return I[M.name]?co("name",Wp(I[M.name])):""}(o.properties,r)+function(I,M){return I[M.description]?co("description",Wp(I[M.description])):""}(o.properties,r)+function(I){return co("ExtendedData",function(M){var C=[];for(var O in M)C.push([O,M[O]]);return C}(I).map(Ay).join(""))}(o.properties)+function(I,M){return I[M.timestamp]?co("TimeStamp",co("when",Wp(I[M.timestamp]))):""}(o.properties,r)+p+v)}}var Ll={Point:function(r){return co("Point",co("coordinates",r.coordinates.join(",")))},LineString:function(r){return co("LineString",co("coordinates",ig(r.coordinates)))},Polygon:function(r){if(!r.coordinates.length)return"";var a=r.coordinates[0],o=r.coordinates.slice(1),p=co("outerBoundaryIs",co("LinearRing",co("coordinates",ig(a)))),y=o.map(function(v){return co("innerBoundaryIs",co("LinearRing",co("coordinates",ig(v))))}).join("");return co("Polygon",p+y)},MultiPoint:function(r){return r.coordinates.length?co("MultiGeometry",r.coordinates.map(function(a){return Ll.Point({coordinates:a})}).join("")):""},MultiPolygon:function(r){return r.coordinates.length?co("MultiGeometry",r.coordinates.map(function(a){return Ll.Polygon({coordinates:a})}).join("")):""},MultiLineString:function(r){return r.coordinates.length?co("MultiGeometry",r.coordinates.map(function(a){return Ll.LineString({coordinates:a})}).join("")):""},GeometryCollection:function(r){return co("MultiGeometry",r.geometries.map(Ll.any).join(""))},valid:function(r){return r&&r.type&&(r.coordinates||"GeometryCollection"===r.type&&r.geometries&&r.geometries.every(Ll.valid))},any:function(r){return Ll[r.type]?Ll[r.type](r):""},isPoint:function(r){return"Point"===r.type||"MultiPoint"===r.type},isPolygon:function(r){return"Polygon"===r.type||"MultiPolygon"===r.type},isLine:function(r){return"LineString"===r.type||"MultiLineString"===r.type}};function ig(r){return r.map(function(a){return a.join(",")}).join(" ")}function Ay(r){return co("Data",co("value",Wp(r[1])),[["name",Wp(r[0])]])}function mm(r,a){if("string"!=typeof r)return"";if(3===(r=r.replace("#","").toLowerCase()).length)r=r[0]+r[0]+r[1]+r[1]+r[2]+r[2];else if(6!==r.length)return"";var o=r[0]+r[1],p=r[2]+r[3],y=r[4]+r[5],v="ff";return"number"==typeof a&&a>=0&&a<=1&&((v=(255*a).toString(16)).indexOf(".")>-1&&(v=v.substr(0,v.indexOf("."))),v.length<2&&(v="0"+v)),v+y+p+o}function og(r,a){return'<?xml version="1.0" encoding="UTF-8"?>'+co("kml",co("Document",(void 0!==(o=a=a||{documentName:void 0,documentDescription:void 0,name:"name",description:"description",simplestyle:!1,timestamp:"timestamp"}).documentName?co("name",o.documentName):"")+function(o){return void 0!==o.documentDescription?co("description",o.documentDescription):""}(a)+function(o,p){if(!o.type)return"";var y=[];switch(o.type){case"FeatureCollection":return o.features?o.features.map(ng(p,y)).join(""):"";case"Feature":return ng(p,y)(o);default:return ng(p,y)({type:"Feature",geometry:o,properties:{}})}}(r,a)),[["xmlns","http://www.opengis.net/kml/2.2"]]);var o}let ag=(()=>{class r{constructor(){this.downloadDone=new s.vpe}downloadData(o,p){const y=this.delStyleMeasure(p);console.log(y);const v=JSON.parse(JSON.stringify(y));switch(o){case"geojson":this.downloadObjectAsJson(v,"map_geojson");break;case"kml":this.downloadObjectAsKml(v,"map_kml")}}delStyleMeasure(o){return o.features.forEach((p,y)=>{delete p.styledetails,delete p.measurement}),o}downloadObjectAsKml(o,p){og(o),og(o,{name:p,description:"description"});const b=og(o,{documentName:"My List Of Markers",documentDescription:"One of the many places you are not I am"});var I="data:application/json;charset=utf-8,"+encodeURIComponent(b),M=document.createElement("a");M.setAttribute("href",I),M.setAttribute("download",p+".kml"),M.innerText=p,document.body.appendChild(M),M.click(),M.remove(),this.downloadDone.emit()}downloadObjectAsJson(o,p){var y="data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(o)),v=document.createElement("a");v.setAttribute("href",y),v.setAttribute("download",p+".geojson"),v.innerText=p,document.body.appendChild(v),v.click(),v.remove(),this.downloadDone.emit()}changeTypeMarkerToPoint(o){return o.features.forEach((p,y)=>{"marker"==p.geometry.type&&(o.features[y].geometry.type="Point")}),o}}return r.\u0275fac=function(o){return new(o||r)},r.\u0275prov=s.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();function Ly(r,a){1&r&&s._UZ(0,"mat-spinner",23)}function Dy(r,a){if(1&r){const o=s.EpF();s.TgZ(0,"ngx-monaco-editor",24),s.NdJ("ngModelChange",function(y){s.CHM(o);const v=s.oxw();return s.KtG(v.code=y)}),s.qZA()}if(2&r){const o=s.oxw();s.Q6J("options",o.editorOptions)("ngModel",o.code)}}let Oy=(()=>{class r{constructor(o,p,y){this.downloadDataService=o,this.dataShareService=p,this.snackbarService=y,this.editorOptions={theme:"vs-dark",language:"json",fontSize:16,minimap:{enabled:!1},fixedOverflowWidgets:!0},this.code="{}",this.dataSource={type:"FeatureCollection",features:[]},this.showDataTable=!0,this.tableLoaded=!0,this.downloadType="geojson"}ngOnInit(){this.dataShareService.getSourceData.subscribe(o=>{this.tableLoaded=!1,this.dataSource=o,this.code=JSON.stringify(this.dataSource,null,"\t"),setTimeout(()=>{this.tableLoaded=!0},0)}),this.getShowDataTableStatus()}copyToClipboard(){if(null==this.dataSource)this.snackbarService.openSnackbar("Please draw atleast one geometry","snackbar-err");else if(this.dataSource.features.length>0){let o=this.downloadDataService.changeTypeMarkerToPoint(JSON.parse(JSON.stringify({...this.dataSource})));navigator.clipboard.writeText(JSON.stringify(o)),this.snackbarService.openSnackbar("Copied to clipboard","snackbar-success")}else this.snackbarService.openSnackbar("Please draw atleast one geometry","snackbar-err")}getShowDataTableStatus(){this.dataShareService.getDataTableStatus.subscribe(o=>{this.showDataTable=o})}downloadTypeSelect(o){this.downloadType=o.target.value}downloadData(){if(this.dataSource)if(this.dataSource.features.length>0){let o=this.downloadDataService.changeTypeMarkerToPoint(JSON.parse(JSON.stringify({...this.dataSource})));this.downloadDataService.downloadData(this.downloadType,{...o})}else this.snackbarService.openSnackbar("Please draw atleast one geometry","snackbar-err");else this.snackbarService.openSnackbar("Please draw atleast one geometry","snackbar-err")}}return r.\u0275fac=function(o){return new(o||r)(s.Y36(ag),s.Y36(ge),s.Y36(tt))},r.\u0275cmp=s.Xpm({type:r,selectors:[["app-data-table"]],viewQuery:function(o,p){if(1&o&&s.Gf(gm,5),2&o){let y;s.iGM(y=s.CRH())&&(p.editor=y.first)}},decls:26,vars:4,consts:[[1,"data-table",3,"ngClass"],[1,"table-wrapper"],[1,"table-div"],[1,"download-div","d-flex","justify-content-between","pt-1"],["title","Select download type","aria-label","Default select example",1,"form-select",3,"change"],["selected","","value","geojson"],["value","kml"],["role","group",1,"btn-group"],["title","Download File Data",1,"btn","btn-outline",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-download"],["d","M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"],["d","M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"],["title","Copy to clipboard",1,"btn","btn-outline",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-clipboard"],["d","M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"],["d","M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"],[2,"height","calc(100% - 50px)"],[1,"p-flex","mt-2"],["class","p-flex","diameter","25","color","primary",4,"ngIf"],[3,"options","ngModel","ngModelChange",4,"ngIf"],[1,"toggler-btn"],["role","button",3,"click"],[1,"bg-primary","text-light",3,"ngClass"],["diameter","25","color","primary",1,"p-flex"],[3,"options","ngModel","ngModelChange"]],template:function(o,p){1&o&&(s.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"select",4),s.NdJ("change",function(v){return p.downloadTypeSelect(v)}),s.TgZ(5,"option",5),s._uU(6,"Geojson"),s.qZA(),s.TgZ(7,"option",6),s._uU(8,"Kml"),s.qZA()(),s.TgZ(9,"div",7)(10,"button",8),s.NdJ("click",function(){return p.downloadData()}),s.O4$(),s.TgZ(11,"svg",9),s._UZ(12,"path",10)(13,"path",11),s.qZA()(),s.kcU(),s.TgZ(14,"button",12),s.NdJ("click",function(){return p.copyToClipboard()}),s.O4$(),s.TgZ(15,"svg",13),s._UZ(16,"path",14)(17,"path",15),s.qZA()()()(),s.kcU(),s.TgZ(18,"div",16)(19,"div",17),s.YNc(20,Ly,1,0,"mat-spinner",18),s.qZA(),s.YNc(21,Dy,1,2,"ngx-monaco-editor",19),s.qZA()(),s.TgZ(22,"div",20)(23,"span",21),s.NdJ("click",function(){return p.showDataTable=!p.showDataTable}),s.TgZ(24,"mat-icon",22),s._uU(25,"keyboard_backspace"),s.qZA()()()()()),2&o&&(s.Q6J("ngClass",p.showDataTable?"data-table-show":"data-table-hide"),s.xp6(20),s.Q6J("ngIf",!p.tableLoaded),s.xp6(1),s.Q6J("ngIf",p.tableLoaded),s.xp6(3),s.Q6J("ngClass",p.showDataTable?"show-reverse-arrow":""))},dependencies:[dt.mk,dt.O5,rt.Hw,dm.Ou,lt.YN,lt.Kr,lt.JJ,lt.On,gm],styles:[".data-table[_ngcontent-%COMP%]{position:absolute;z-index:3;right:0;top:0;height:100%;background-color:#e2f2f0;transition:transform .5s}[_ngcontent-%COMP%]::-webkit-scrollbar{width:10px;height:10px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{background-color:#eff8ff}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#10CAF0;border-radius:10px}.data-table-hide[_ngcontent-%COMP%]{transform:translate(100%)}.data-table-show[_ngcontent-%COMP%]{transform:translate(0)}.download-div[_ngcontent-%COMP%]{position:sticky;top:0}.table-wrapper[_ngcontent-%COMP%]{position:relative;height:100%}.toggler-btn[_ngcontent-%COMP%]{position:absolute;top:50%;left:-50px}.toggler-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{height:35px;width:50px;display:flex;align-items:center;justify-content:center;border-radius:50px 0 0 50px}.table-div[_ngcontent-%COMP%]{height:100%;width:100%;overflow-x:hidden;overflow-y:auto;scrollbar-color:#10CAF0 #EFF8FF}.show-reverse-arrow[_ngcontent-%COMP%]{transform:scaleX(-1)}@media only screen and (max-width: 992px){.data-table[_ngcontent-%COMP%]{width:300px}}@media only screen and (min-width: 993px){.data-table[_ngcontent-%COMP%]{width:580px}}"]}),r})();var ky=St(529);let Ny=(()=>{class r{constructor(o){this.http=o,this.BASE_NOMINATIM_URL="https://nominatim.openstreetmap.org"}getGeocoderData(o){return this.http.get(`${this.BASE_NOMINATIM_URL}/search?q=${o}&format=geojson`)}reverseGeocodeData(o){return this.http.get(`${this.BASE_NOMINATIM_URL}/reverse?format=geojson&lat=${o.lat}&lon=${o.lng}`)}}return r.\u0275fac=function(o){return new(o||r)(s.LFG(ky.eN))},r.\u0275prov=s.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var Ry=St(266);function Fy(r,a){if(1&r){const o=s.EpF();s.TgZ(0,"div",5)(1,"div",6)(2,"input",7,8),s.NdJ("keyup",function(){s.CHM(o);const y=s.MAs(3),v=s.oxw();return s.KtG(v.getAddresSuggestion(y.value))})("keydown.enter",function(){s.CHM(o);const y=s.MAs(3),v=s.MAs(8);return s.oxw().getGeocode(y.value),s.KtG(v.reset)}),s.qZA(),s.TgZ(4,"button",9),s.NdJ("click",function(){s.CHM(o);const y=s.MAs(3);return s.oxw().clearGeocode(),s.KtG(y.value="")}),s._uU(5," X "),s.qZA()(),s.TgZ(6,"div",6)(7,"form",10,11),s.NdJ("keydown.enter",function(){s.CHM(o);const y=s.MAs(8),v=s.MAs(3);return s.oxw().getLngLat(y),s.KtG(v.value="")}),s._UZ(9,"input",12)(10,"input",13),s.qZA()()()}}function zy(r,a){if(1&r){const o=s.EpF();s.TgZ(0,"button",16),s.NdJ("click",function(){const v=s.CHM(o).$implicit,b=s.oxw(2);return s.KtG(b.showDataInMap(v))}),s.O4$(),s.TgZ(1,"svg",17),s._UZ(2,"path",18),s.qZA(),s.kcU(),s.TgZ(3,"span",19),s._uU(4),s.qZA()()}if(2&r){const o=a.$implicit;s.Q6J("matTooltip",o.properties.display_name),s.xp6(4),s.Oqu(o.properties.display_name)}}function By(r,a){if(1&r&&(s.TgZ(0,"div",14),s.YNc(1,zy,5,2,"button",15),s.qZA()),2&r){const o=s.oxw();s.xp6(1),s.Q6J("ngForOf",o.geocodeData)}}function Uy(r,a){if(1&r&&(s.TgZ(0,"div",20)(1,"div")(2,"span"),s._uU(3,"Display Name : "),s.qZA(),s.TgZ(4,"span"),s._uU(5),s.qZA()(),s.TgZ(6,"div")(7,"span"),s._uU(8,"Country : "),s.qZA(),s.TgZ(9,"span"),s._uU(10),s.qZA()(),s.TgZ(11,"div")(12,"span"),s._uU(13,"Country Code : "),s.qZA(),s.TgZ(14,"span"),s._uU(15),s.qZA()(),s.TgZ(16,"div")(17,"span"),s._uU(18,"County : "),s.qZA(),s.TgZ(19,"span"),s._uU(20),s.qZA()(),s.TgZ(21,"div")(22,"span"),s._uU(23,"Region : "),s.qZA(),s.TgZ(24,"span"),s._uU(25),s.qZA()(),s.TgZ(26,"div")(27,"span"),s._uU(28,"State : "),s.qZA(),s.TgZ(29,"span"),s._uU(30),s.qZA()(),s.TgZ(31,"div")(32,"span"),s._uU(33,"District : "),s.qZA(),s.TgZ(34,"span"),s._uU(35),s.qZA()(),s.TgZ(36,"div")(37,"span"),s._uU(38,"Village : "),s.qZA(),s.TgZ(39,"span"),s._uU(40),s.qZA()(),s.TgZ(41,"div")(42,"span"),s._uU(43,"City : "),s.qZA(),s.TgZ(44,"span"),s._uU(45),s.qZA()(),s.TgZ(46,"div")(47,"span"),s._uU(48,"House Number : "),s.qZA(),s.TgZ(49,"span"),s._uU(50),s.qZA()(),s.TgZ(51,"div")(52,"span"),s._uU(53,"Postcode : "),s.qZA(),s.TgZ(54,"span"),s._uU(55),s.qZA()(),s.TgZ(56,"div")(57,"span"),s._uU(58,"Road : "),s.qZA(),s.TgZ(59,"span"),s._uU(60),s.qZA()()()),2&r){const o=s.oxw();s.xp6(5),s.Oqu(o.reverseGeocodeData.properties.display_name),s.xp6(5),s.Oqu(o.reverseGeocodeData.properties.address.country),s.xp6(5),s.Oqu(o.reverseGeocodeData.properties.address.country_code),s.xp6(5),s.Oqu(o.reverseGeocodeData.properties.address.county),s.xp6(5),s.Oqu(o.reverseGeocodeData.properties.address.region),s.xp6(5),s.Oqu(o.reverseGeocodeData.properties.address.state),s.xp6(5),s.Oqu(o.reverseGeocodeData.properties.address.state_district),s.xp6(5),s.Oqu(o.reverseGeocodeData.properties.address.village),s.xp6(5),s.Oqu(o.reverseGeocodeData.properties.address.city),s.xp6(5),s.Oqu(o.reverseGeocodeData.properties.address.house_number),s.xp6(5),s.Oqu(o.reverseGeocodeData.properties.address.postcode),s.xp6(5),s.Oqu(o.reverseGeocodeData.properties.address.road)}}function qy(r,a){if(1&r){const o=s.EpF();s.TgZ(0,"div",21),s.NdJ("click",function(){s.CHM(o);const y=s.oxw();return s.KtG(y.showSearchDiv=!y.showSearchDiv)}),s.O4$(),s.TgZ(1,"svg",22),s._UZ(2,"path",23),s.qZA()()}}const Gy=function(){return{width:"400px"}},Vy=function(){return{width:"30px"}};let jy=(()=>{class r{constructor(o,p,y){this.geocoderService=o,this.mapService=p,this.snackbarService=y,this.showSearchDiv=!1}ngOnInit(){this.map=this.mapService.getMapData()?.map,this.marker=new Yt.Marker({color:"#9508c4",draggable:!1})}getAddresSuggestion(o){clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{this.getGeocode(o)},500)}getGeocode(o){this.reverseGeocodeData=void 0,this.lngLatForm&&this.lngLatForm.resetForm(),this.geocoderService.getGeocoderData(o).subscribe(p=>{p&&(0==p.features.length?""==o?this.geocodeData=p.features:this.snackbarService.openSnackbar("Error In Fetching Data","snackbar-err"):this.geocodeData=p.features)},p=>{this.snackbarService.openSnackbar("Error In Fetching Data","snackbar-err"),console.log(p)})}clearGeocode(){this.geocodeData=void 0,this.reverseGeocodeData=void 0,this.showSearchDiv=!1,this.marker.remove()}showDataInMap(o){this.map?.fitBounds(o.bbox),this.marker.setLngLat(o.geometry.coordinates).addTo(this.map)}showCoordinateOnMap(o){this.map.flyTo({center:o.geometry.coordinates,essential:!0,zoom:21}),this.marker.setLngLat(o.geometry.coordinates).addTo(this.map)}getLngLat(o){this.lngLatForm=o,this.reverseGeocode(o.value)}reverseGeocode(o){this.geocodeData=void 0,this.geocoderService.reverseGeocodeData(o).subscribe(p=>{p&&(p.error?this.snackbarService.openSnackbar("Error In Fetching Data","snackbar-err"):(this.reverseGeocodeData=p.features[0],console.log(p),this.showCoordinateOnMap(this.reverseGeocodeData)))},p=>{console.log(p)})}}return r.\u0275fac=function(o){return new(o||r)(s.Y36(Ny),s.Y36(Xf),s.Y36(tt))},r.\u0275cmp=s.Xpm({type:r,selectors:[["app-geocoder"]],decls:5,vars:7,consts:[["id","geocoder",3,"ngStyle"],["class","row m-0",4,"ngIf"],["class","row","class","list-group",4,"ngIf"],["class","row","class","reverse-geocode-data",4,"ngIf"],["matTooltip","Search Address","class","search-icon p-flex rounded shadow","role","button",3,"click",4,"ngIf"],[1,"row","m-0"],[1,"row","m-0","p-0"],["autocomplete","off","type","text","id","search-input","placeholder","\u5730\u5740\u67e5\u8be2",1,"col-11",3,"keyup","keydown.enter"],["searchValue",""],[1,"close-btn","col-1",3,"click"],["id","lngLatForm",1,"m-0","p-0",3,"keydown.enter"],["lngLatForm","ngForm"],["type","number","autocomplete","off","name","lng","ngModel","","placeholder","\u7ecf\u5ea6",1,"w-50"],["type","number","autocomplete","off","name","lat","ngModel","","placeholder","\u7eac\u5ea6",1,"w-50"],[1,"list-group"],["type","button","class","list-group-item list-group-item-action search-list-item",3,"matTooltip","click",4,"ngFor","ngForOf"],["type","button",1,"list-group-item","list-group-item-action","search-list-item",3,"matTooltip","click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-geo-alt-fill"],["d","M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10zm0-7a3 3 0 1 1 0-6 3 3 0 0 1 0 6z"],[1,"ms-2"],[1,"reverse-geocode-data"],["matTooltip","Search Address","role","button",1,"search-icon","p-flex","rounded","shadow",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-search"],["d","M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"]],template:function(o,p){1&o&&(s.TgZ(0,"div",0),s.YNc(1,Fy,11,0,"div",1),s.YNc(2,By,2,1,"div",2),s.YNc(3,Uy,61,12,"div",3),s.YNc(4,qy,3,0,"div",4),s.qZA()),2&o&&(s.Q6J("ngStyle",p.showSearchDiv?s.DdM(5,Gy):s.DdM(6,Vy)),s.xp6(1),s.Q6J("ngIf",p.showSearchDiv),s.xp6(1),s.Q6J("ngIf",p.geocodeData),s.xp6(1),s.Q6J("ngIf",p.reverseGeocodeData),s.xp6(1),s.Q6J("ngIf",!p.showSearchDiv))},dependencies:[dt.sg,dt.O5,dt.PC,Ry.gM,lt._Y,lt.Fj,lt.wV,lt.JJ,lt.JL,lt.On,lt.F],styles:["#search-input[_ngcontent-%COMP%]::placeholder{font-size:15px}#lngLatForm[_ngcontent-%COMP%] > input[_ngcontent-%COMP%]::placeholder{font-size:15px}#lngLatForm[_ngcontent-%COMP%] > input[_ngcontent-%COMP%]{height:10px;font-size:15px;padding:12px 15px}#lngLatForm[_ngcontent-%COMP%] > input[_ngcontent-%COMP%]:focus{outline:none}button[_ngcontent-%COMP%]{font-size:15px}.close-btn[_ngcontent-%COMP%]{background:transparent;border:.1px solid rebeccapurple}.close-btn[_ngcontent-%COMP%]:hover{background:transparent;border:.1px solid red;color:red}#geocoder[_ngcontent-%COMP%]{position:absolute;z-index:2;left:5px;top:5px}#search-input[_ngcontent-%COMP%]{height:10px;font-size:15px;padding:15px}#search-input[_ngcontent-%COMP%]:focus{outline:none}.search-icon[_ngcontent-%COMP%]{height:30px;background-color:#fff;border:1px solid black}.search-list-item[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.reverse-geocode-data[_ngcontent-%COMP%]{background-color:#fff;padding:10px}.reverse-geocode-data[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(1){font-weight:bolder}"]}),r})();function Zy(r,a){1&r&&s._UZ(0,"mat-progress-spinner",3)}let ym=(()=>{class r{constructor(o){this.mapService=o,this.mapDataEmit=new s.vpe,this.showSpinner=!0}set content(o){o&&(this.identityFeatureSideNavCompontent=o)}ngOnInit(){this.mapService.initializeDraw(),this.mapService.initializeMap("map"),this.mapService.addControlsOnMap(),this.map=this.mapService.getMapData().map,this.draw=this.mapService.getMapData().draw,this.mapDataEmit.emit({map:this.map,draw:this.draw}),this.handleSpinner()}handleSpinner(){this.map.on("load",()=>{this.mapService.addSourceFn()}),this.map.on("idle",()=>{this.showSpinner=!1}),this.map.on("zoom",()=>{this.showSpinner=!0}),this.map.on("dragpen",()=>{this.showSpinner=!0})}sendIdentityFeatureData(o){this.identityFeatureSideNavCompontent.showIdentity(o)}}return r.\u0275fac=function(o){return new(o||r)(s.Y36(Xf))},r.\u0275cmp=s.Xpm({type:r,selectors:[["app-map-common"]],viewQuery:function(o,p){if(1&o&&s.Gf(le,5),2&o){let y;s.iGM(y=s.CRH())&&(p.content=y.first)}},outputs:{mapDataEmit:"mapDataEmit"},decls:5,vars:2,consts:[["id","map"],[3,"map"],["class","spinner","color","warn","mode","indeterminate","diameter","50",4,"ngIf"],["color","warn","mode","indeterminate","diameter","50",1,"spinner"]],template:function(o,p){1&o&&(s.TgZ(0,"div",0),s._UZ(1,"app-identity-feature-side-nav",1)(2,"app-geocoder"),s.YNc(3,Zy,1,0,"mat-progress-spinner",2),s._UZ(4,"app-data-table"),s.qZA()),2&o&&(s.xp6(1),s.Q6J("map",p.map),s.xp6(2),s.Q6J("ngIf",p.showSpinner))},dependencies:[dt.O5,dm.Ou,Oy,le,jy],styles:["#map[_ngcontent-%COMP%]{height:100vh;width:100%;position:relative;top:0;left:0}.spinner[_ngcontent-%COMP%]{z-index:2;position:absolute;left:0;right:0;top:5%;margin:auto}"]}),r})();function Xy(r,a){if(1&r){const o=s.EpF();s.TgZ(0,"span",20),s.NdJ("click",function(){s.CHM(o);const y=s.oxw();return s.KtG(y.showAboutUs=!1)}),s.O4$(),s.TgZ(1,"svg",21),s._UZ(2,"path",22)(3,"path",23),s.qZA()()}}let Yy=(()=>{class r{constructor(o,p,y){this.mapService=o,this.dataShareService=p,this.styleService=y,this.currentMapStyle="streets",this.showAboutUs=!1}getRasterTile(o){return{version:8,sources:{"raster-tiles":{type:"raster",tiles:[o],tileSize:256,attribution:'Map tiles by <a target="_top" rel="noopener" href="http://stamen.com">Stamen Design</a>, under <a target="_top" rel="noopener" href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a target="_top" rel="noopener" href="http://openstreetmap.org">OpenStreetMap</a>, under <a target="_top" rel="noopener" href="http://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>'}},layers:[{id:"simple-tiles",type:"raster",source:"raster-tiles",minzoom:0,maxzoom:22}]}}ngOnInit(){this.dataShareService.getSourceData.subscribe(o=>{this.geo_json_main=o})}setMapStyle(o){switch(this.removeSourceAndLayer(),this.currentMapStyle=o,o){case"maplibre-default":this.map.setStyle("https://demotiles.maplibre.org/style.json");break;case"open-streets-map":this.map.setStyle(this.mapService.style);break;case"raster-tile":this.map.setStyle(this.getRasterTile("https://stamen-tiles.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.jpg"));break;case"wikimedia":this.map.setStyle(this.getRasterTile("https://maps.wikimedia.org/osm-intl/{z}/{x}/{y}.png"));break;case"satellite":this.map.setStyle("mapbox://styles/mapbox/satellite-streets-v12");break;case"streets":this.map.setStyle("mapbox://styles/mapbox/streets-v12")}setTimeout(()=>{this.addExistingSource()},1e3)}removeSourceAndLayer(){this.mapService.removeLayerFn(),this.mapService.removeSourceFn()}addExistingSource(){let o=0,p={...this.geo_json_main},y=JSON.parse(JSON.stringify(p));this.geo_json_main?(this.geo_json_main.features.forEach((v,b)=>{"marker"==v.geometry.type&&(y.features.splice(b-o,1),o++)}),this.mapService.addSourceFn(y),this.styleService.setDataOnMap(this.map,this.geo_json_main,!0,!1)):this.mapService.addSourceFn()}}return r.\u0275fac=function(o){return new(o||r)(s.Y36(Xf),s.Y36(ge),s.Y36(X))},r.\u0275cmp=s.Xpm({type:r,selectors:[["app-map-styles"]],inputs:{map:"map",draw:"draw"},decls:30,vars:2,consts:[["id","map-style"],["id","about",1,"text-center","text-light","bg-dark",2,"display","none",3,"ngClass"],[1,"border-bottom","border-3","border-primary","pointer"],[1,"mb-0",3,"click"],[3,"click",4,"ngIf"],["id","author-image",1,"mt-4"],[1,"mb-0"],[1,"px-3"],[1,"pt-2","pb-4"],["target","_blank","href","https://in.linkedin.com/in/pushpendra-sapkale-744125121?original_referer=https%3A%2F%2Fwww.google.com%2F"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-linkedin"],["d","M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z"],["href","mailto: dev.psapkale@gmail.com",1,"ms-3"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-google"],["d","M15.545 6.558a9.42 9.42 0 0 1 .139 1.626c0 2.434-.87 4.492-2.384 5.885h.002C11.978 15.292 10.158 16 8 16A8 8 0 1 1 8 0a7.689 7.689 0 0 1 5.352 2.082l-2.284 2.284A4.347 4.347 0 0 0 8 3.166c-2.087 0-3.86 1.408-4.492 3.304a4.792 4.792 0 0 0 0 3.063h.003c.635 1.893 2.405 3.301 4.492 3.301 1.078 0 2.004-.276 2.722-.764h-.003a3.702 3.702 0 0 0 1.599-2.431H8v-3.08h7.545z"],["target","_blank","href","https://www.instagram.com/pushpendr_a/",1,"ms-3"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-instagram"],["d","M8 0C5.829 0 5.556.01 4.703.048 3.85.088 3.269.222 2.76.42a3.917 3.917 0 0 0-1.417.923A3.927 3.927 0 0 0 .42 2.76C.222 3.268.087 3.85.048 4.7.01 5.555 0 5.827 0 8.001c0 2.172.01 2.444.048 3.297.04.852.174 1.433.372 1.942.205.526.478.972.923 1.417.444.445.89.719 1.416.923.51.198 1.09.333 1.942.372C5.555 15.99 5.827 16 8 16s2.444-.01 3.298-.048c.851-.04 1.434-.174 1.943-.372a3.916 3.916 0 0 0 1.416-.923c.445-.445.718-.891.923-1.417.197-.509.332-1.09.372-1.942C15.99 10.445 16 10.173 16 8s-.01-2.445-.048-3.299c-.04-.851-.175-1.433-.372-1.941a3.926 3.926 0 0 0-.923-1.417A3.911 3.911 0 0 0 13.24.42c-.51-.198-1.092-.333-1.943-.372C10.443.01 10.172 0 7.998 0h.003zm-.717 1.442h.718c2.136 0 2.389.007 3.232.046.78.035 1.204.166 1.486.275.373.145.64.319.92.599.28.28.453.546.598.92.11.281.24.705.275 1.485.039.843.047 1.096.047 3.231s-.008 2.389-.047 3.232c-.035.78-.166 1.203-.275 1.485a2.47 2.47 0 0 1-.599.919c-.28.28-.546.453-.92.598-.28.11-.704.24-1.485.276-.843.038-1.096.047-3.232.047s-2.39-.009-3.233-.047c-.78-.036-1.203-.166-1.485-.276a2.478 2.478 0 0 1-.92-.598 2.48 2.48 0 0 1-.6-.92c-.109-.281-.24-.705-.275-1.485-.038-.843-.046-1.096-.046-3.233 0-2.136.008-2.388.046-3.231.036-.78.166-1.204.276-1.486.145-.373.319-.64.599-.92.28-.28.546-.453.92-.598.282-.11.705-.24 1.485-.276.738-.034 1.024-.044 2.515-.045v.002zm4.988 1.328a.96.96 0 1 0 0 1.92.96.96 0 0 0 0-1.92zm-4.27 1.122a4.109 4.109 0 1 0 0 8.217 4.109 4.109 0 0 0 0-8.217zm0 1.441a2.667 2.667 0 1 1 0 5.334 2.667 2.667 0 0 1 0-5.334z"],["href","mailto: dev.psapkale@gmail.com",1,"text-info"],[1,"mb-2"],[3,"click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-x-circle","close-btn"],["d","M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"],["d","M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"]],template:function(o,p){1&o&&(s.TgZ(0,"div",0)(1,"div",1)(2,"header",2)(3,"h3",3),s.NdJ("click",function(){return p.showAboutUs=!p.showAboutUs}),s._uU(4,"About Us"),s.qZA(),s.YNc(5,Xy,4,0,"span",4),s.qZA(),s.TgZ(6,"div"),s._UZ(7,"div",5),s.TgZ(8,"h2",6),s._uU(9,"Pushpendra Sapkale"),s.qZA(),s.TgZ(10,"h4"),s._uU(11,"Full Stack Developer"),s.qZA(),s.TgZ(12,"p",7),s._uU(13," Creative and technical web developer, Post graduated in Master of computer application "),s.qZA(),s.TgZ(14,"div",8)(15,"a",9),s.O4$(),s.TgZ(16,"svg",10),s._UZ(17,"path",11),s.qZA()(),s.kcU(),s.TgZ(18,"a",12),s.O4$(),s.TgZ(19,"svg",13),s._UZ(20,"path",14),s.qZA()(),s.kcU(),s.TgZ(21,"a",15),s.O4$(),s.TgZ(22,"svg",16),s._UZ(23,"path",17),s.qZA()()(),s.kcU(),s.TgZ(24,"div"),s._uU(25," Email: "),s.TgZ(26,"a",18),s._uU(27,"dev.psapkale@gmail.com"),s.qZA()(),s.TgZ(28,"div",19),s._uU(29,"Developer of this tool"),s.qZA()()()()),2&o&&(s.xp6(1),s.Q6J("ngClass",p.showAboutUs?"show-about-us":"hide-about-us"),s.xp6(4),s.Q6J("ngIf",p.showAboutUs))},dependencies:[dt.mk,dt.O5],styles:["#map-style[_ngcontent-%COMP%]{position:absolute;bottom:0;width:100%}.active-map-style[_ngcontent-%COMP%]{background-color:#8b0000;color:#fff}.map-type[_ngcontent-%COMP%]{position:absolute;bottom:31px}#about[_ngcontent-%COMP%]{position:absolute;background-color:red;width:100%;z-index:1;transition:transform 1s linear}.hide-about-us[_ngcontent-%COMP%]{transform:translatey(-28px)}.show-about-us[_ngcontent-%COMP%]{transform:translatey(-100%)}header[_ngcontent-%COMP%]{position:relative}.close-btn[_ngcontent-%COMP%]{position:absolute;right:10px;top:7px}#author-image[_ngcontent-%COMP%]{background-image:url(Author.f3824a30f28c559e.jpeg);height:150px;width:100%;background-position:top;background-size:cover;clip-path:circle(28% at 50% 37%)}#about[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:wheat}"]}),r})(),Jy=(()=>{class r{constructor(){}ngOnInit(){}}return r.\u0275fac=function(o){return new(o||r)},r.\u0275cmp=s.Xpm({type:r,selectors:[["app-header"]],decls:6,vars:0,consts:[[1,"bg-info","header","p-2","fs-5","shadow-sm","p-flex"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-globe-americas","me-2"],["d","M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0ZM2.04 4.326c.325 1.329 2.532 2.54 3.717 3.19.48.263.793.434.743.484-.08.08-.162.158-.242.234-.416.396-.787.749-.758 1.266.035.634.618.824 1.214 1.017.577.188 1.168.38 1.286.983.082.417-.075.988-.22 1.52-.215.782-.406 1.48.22 1.48 1.5-.5 3.798-3.186 4-5 .138-1.243-2-2-3.5-2.5-.478-.16-.755.081-.99.284-.172.15-.322.279-.51.216-.445-.148-2.5-2-1.5-2.5.78-.39.952-.171 1.227.182.078.099.163.208.273.318.609.304.662-.132.723-.633.039-.322.081-.671.277-.867.434-.434 1.265-.791 2.028-1.12.712-.306 1.365-.587 1.579-.88A7 7 0 1 1 2.04 4.327Z"],[1,"sub-name"]],template:function(o,p){1&o&&(s.TgZ(0,"h2",0),s.O4$(),s.TgZ(1,"svg",1),s._UZ(2,"path",2),s.qZA(),s._uU(3," \u5728\u7ebfGeoJSON"),s.kcU(),s.TgZ(4,"sub",3),s._uU(5,"\u5de5\u5177"),s.qZA()())},styles:[".header[_ngcontent-%COMP%]{font-family:emoji}.sub-name[_ngcontent-%COMP%]{color:#8b0000;font-family:cursive}"]}),r})(),Hy=(()=>{class r{constructor(o,p,y,v,b){this.dialogRef=o,this.data=p,this.styleService=y,this.dataShareService=v,this.snackbarService=b}ngOnInit(){this.data&&(this.map=this.data.map)}uploadFile(o){this.uploadedFile=o.target.files[0];const p=new FileReader;p.readAsText(this.uploadedFile,"UTF-8"),p.onload=()=>{let y=this.setStyleOnUploadedFile(p.result.toString());this.uploadedJsonObj=this.setGeoJsonForOurTool(y),this.dataShareService.sendSourceData(this.uploadedJsonObj),this.styleService.setDataOnMap(this.map,this.uploadedJsonObj),this.snackbarService.openSnackbar("File uploaded successfully","snackbar-success"),this.dialogRef.close()},p.onerror=y=>{console.log(y),this.snackbarService.openSnackbar("Failed in uploading your flile please try again","snackbar-err")}}setGeoJsonForOurTool(o){return o.features.length>0&&o.features.forEach((p,y)=>{"Point"==p.geometry.type&&(o.features[y].geometry.type=void 0!==p.styledetails.styledata.markername||void 0!==p.styledetails.styledata.textname?"marker":"Point")}),o}setStyleOnUploadedFile(o){let p=0,y=JSON.parse(o),v=JSON.parse(JSON.stringify({...y})),b=JSON.parse(JSON.stringify({...v}));return v.features.forEach((I,M)=>{null==I.styledetails&&(null==I.id?(b.features[M].id="new_feature"+Number(Math.random()+p),b.features[M].properties={featureid:b.features[M].id},b.features[M].styledetails={id:b.features[M].id},b.features[M]=this.setStyleDetailsInFeature(b,M),p++):(b.features[M].properties={featureid:b.features[M].id},b.features[M].styledetails={id:b.features[M].id},b.features[M]=this.setStyleDetailsInFeature(b,M)))}),b}setStyleDetailsInFeature(o,p){let y=JSON.parse(JSON.stringify({...o}));switch(y.features[p].geometry.type){case"Polygon":y.features[p].styledetails={id:y.features[p].id,styledata:{fillcolor:"#10CAF0",fillopacity:.4,fillborderwidth:2,fillbordercolor:"#3b1513"}},y.features[p].measurement={squaremeters:Math.round(100*Ss(y))/100};break;case"Point":y.features[p].styledetails={id:y.features[p].id,styledata:{circleradius:6,circlecolor:"#B42222"}};break;case"LineString":y.features[p].styledetails={id:y.features[p].id,styledata:{linecolor:"#572d06",linewidth:2}},y.features[p].measurement={kilometers:Si(y)}}return y.features[p]}closeDialog(){this.dialogRef.close()}}return r.\u0275fac=function(o){return new(o||r)(s.Y36(ht.so),s.Y36(ht.WI),s.Y36(X),s.Y36(ge),s.Y36(tt))},r.\u0275cmp=s.Xpm({type:r,selectors:[["app-upload-data"]],decls:9,vars:0,consts:[[1,"p-flex","mb-3","upload-header"],["role","button",3,"click"],["type","file","name","","id","file","accept",".json, .geojson","multiple","false","width","30px",3,"change"],[1,"p-flex","mt-1","mb-3","text-primary"]],template:function(o,p){1&o&&(s.TgZ(0,"div")(1,"div",0)(2,"h2"),s._uU(3,"\u4e0a\u4f20\u6587\u4ef6"),s.qZA(),s.TgZ(4,"mat-icon",1),s.NdJ("click",function(){return p.closeDialog()}),s._uU(5,"close"),s.qZA()(),s.TgZ(6,"input",2),s.NdJ("change",function(v){return p.uploadFile(v)}),s.qZA(),s.TgZ(7,"div",3),s._uU(8,"size - 4 MB (MAX)"),s.qZA()())},dependencies:[rt.Hw],styles:["input[_ngcontent-%COMP%]{width:100%}.upload-header[_ngcontent-%COMP%]{position:relative}.upload-header[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{position:absolute;right:0;top:3px}"]}),r})();const Wy=["mouseTip"];function Ky(r,a){1&r&&s._UZ(0,"div")}function $y(r,a){1&r&&(s.TgZ(0,"div")(1,"h3",50),s._uU(2," * \u4f7f\u7528\u65cb\u8f6c\u6a21\u5f0f\u65f6\u8bf7\u4e0d\u8981\u62d6\u52a8\u6216\u7f16\u8f91\u70b9 "),s.qZA()())}let Qy=(()=>{class r{constructor(o,p,y,v,b,I,M){this.styleService=o,this.dataShareService=p,this.identityFeatureService=y,this.snackbarService=v,this.mapService=b,this.matDialog=I,this.downloadDataService=M,this.editModeGeoJsonCheck=0,this.canDeleteGeom=!1,this.layerEditMode=!1,this.geo_json_main={type:"FeatureCollection",features:[]},this.activeTool="simple-select",this.canDrawMarker=!1,this.drawContinuously=!1,this.showMapCursorTip=!1,this.mousePopUpMessage="Welcome to Your Map<br><sub>Please select any drawing type and enjoy !!</sub>",this.sendIdentityFeatureData=new s.vpe,this.isRotateModeActive=!1}ngOnInit(){}ngAfterViewInit(){this.drawDefinations(),this.dataShareService.initializeMapPopUp(),this.dataShareService.getSourceData.subscribe(o=>{this.geo_json_main=o}),this.mapService.getCircleFeature.subscribe(o=>{this.circlePolygonFeature=o}),this.map.on("click",o=>{this.canDrawMarker&&this.getCoordinates(o)})}drawDefinations(){this.map.on("draw.create",()=>this.getDrawSource("create")),this.map.on("draw.delete",()=>this.getDrawSource("delete")),this.map.on("draw.update",()=>this.getDrawSource("update")),this.setIdentityFeature()}setIdentityFeature(){this.map.on("click","YourMapSourceIdLineString",o=>{this.geomClickHandler(o)}),this.map.on("click","YourMapSourceIdPolygon",o=>{this.geomClickHandler(o)}),this.map.on("click","YourMapSourceIdPoint",o=>{this.geomClickHandler(o)}),this.setMouseEffectOnMap()}geomClickHandler(o){this.canDeleteGeom?this.deleteFeatureOnClick(o):"simple-select"==this.activeTool&&this.sendIdentityFeatureStatus(o)}deleteFeatureOnClick(o){let p={...this.geo_json_main};const y=o.features[0].properties.featureid;let v=p.features.findIndex(b=>b.id==y);p.features.splice(v,1),this.styleService.setDataOnMap(this.map,p),this.dataShareService.sendSourceData(p)}setMouseEffectOnMap(){this.map.on("mouseenter","YourMapSourceIdLineString",()=>{this.map.getCanvas().style.cursor="pointer"}),this.map.on("mouseenter","YourMapSourceIdPolygon",()=>{this.map.getCanvas().style.cursor="pointer"}),this.map.on("mouseenter","YourMapSourceIdPoint",()=>{this.map.getCanvas().style.cursor="pointer"}),this.map.on("mouseleave","YourMapSourceIdLineString",()=>{this.map.getCanvas().style.cursor=""}),this.map.on("mouseleave","YourMapSourceIdPolygon",()=>{this.map.getCanvas().style.cursor=""}),this.map.on("mouseleave","YourMapSourceIdPoint",()=>{this.map.getCanvas().style.cursor=""})}identityFeatureData(o){let p=Object.keys(o),y=[];return p.forEach(v=>{let b={name:"",value:""};b.name=v,b.value=o[v],y.push(b)}),y}sendIdentityFeatureStatus(o){this.showIdentityFeature(this.identityFeatureData(o.features[0].properties)),this.activeFeatureId=o.features[0].properties.featureid}showIdentityFeature(o){setTimeout(()=>{this.identityFeatureService.sendShowIdentityFeatureStatus(!1),setTimeout(()=>{this.identityFeatureService.sendShowIdentityFeatureStatus(!0),this.sendIdentityFeatureData.emit(o)},200)},0)}getDrawSource(o){if("create"==o&&(this.setGeoJsonMain(),this.styleService.setDataOnMap(this.map,this.geo_json_main),this.drawContinuously||(this.mousePopUpMessage="Welcome to Your Map<br><sub>Please select any drawing type and enjoy !!</sub>")),"update"==o&&this.layerEditMode&&this.editModeGeoJsonCheck++,this.sendDrawSourceData(),this.drawContinuously||this.canDeleteGeom){if("create"!==o)return;setTimeout(()=>{this.draw.changeMode(this.activeDrawMode)},0)}else setTimeout(()=>{this.afterDrawCreated()},0);this.showMapCursorTip&&this.mousePopupTurnOn()}setGeoJsonMain(){let p,o=this.draw.getAll();"draw_radius"==this.activeDrawMode?(p=this.circlePolygonFeature,p.id=this.draw.getAll().features[0].id,this.circlePolygonFeature=void 0):p=o.features[0],p&&(p.properties.featureid=o.features[0].id,p=this.setStyleDetails(p),this.geo_json_main.features.push(p),this.geo_json_main.features=this.getUniqueValue(),this.draw.deleteAll())}setStyleDetails(o){let p=o,y={fillcolor:"#10CAF0",fillopacity:.4,fillborderwidth:2,fillbordercolor:"#3b1513"},v={linecolor:"#572d06",linewidth:2};if("Polygon"==o.geometry.type){const C=Ss(o);p.styledetails={id:o.id,styledata:y},p.measurement={squaremeters:Math.round(100*C)/100}}if("Point"==o.geometry.type&&(this.drawCustomMarker?(p.styledetails=this.drawText?{id:o.id,styledata:{height:"20",width:"fit-content",color:"blue",textfontsize:"15",textname:"Edit Text"}}:{id:o.id,styledata:{height:"20",width:"20",markername:"marker"}},p.geometry.type="marker"):p.styledetails={id:o.id,styledata:{circleradius:6,circlecolor:"#B42222"}}),"LineString"==o.geometry.type){const C=Si(this.draw.getAll());p.styledetails={id:o.id,styledata:v},p.measurement={kilometers:C}}return p}getUniqueValue(){return this.geo_json_main.features.reduce(function(p,y){return p.filter(function(b){return b.id===y.id}).length>0||p.push(y),p},[])}afterDrawCreated(){this.activeTool=this.layerEditMode?"edit-mode":"simple-select"}getCoordinates(o){let p=o.lngLat.wrap();this.drawMarker([p.lng,p.lat])}drawMarker(o){this.marker=new Yt.Marker({draggable:!0}).setLngLat(o).addTo(this.map),this.drawContinuously||(this.handleMarker("deactive"),this.activeTool="simple-select")}startDraw(o){if(this.identityFeatureService.sendShowIdentityFeatureStatus(!1),this.layerEditMode)this.snackbarService.openSnackbar(this.isRotateModeActive?"Please turn off layer rotate mode to use this feature":"Please turn of edit layer to use this feature","snackbar-err");else{switch(this.activeTool=o,"marker"!==this.activeTool&&this.handleMarker("deactive"),this.drawCustomMarker=!1,"delete-tool"!==o&&(this.canDeleteGeom=!1,this.styleService.canDeleteMarker=!1),o){case"polygon":this.activeDrawMode="draw_polygon",this.draw.changeMode(this.activeDrawMode),this.mousePopUpMessage="Use mouse left click to drop polygon vertices on map and for stop use mouse double click";break;case"circle":this.activeDrawMode="draw_radius",this.draw.changeMode(this.activeDrawMode),this.mousePopUpMessage="Use mouse left click one time then drag mouse for set radius and use mouse left click to stop";break;case"line":this.activeDrawMode="draw_line_string",this.draw.changeMode(this.activeDrawMode),this.mousePopUpMessage="Use mouse left click to drop line vertices and for stop use mouse double click";break;case"freehand":this.activeDrawMode="draw_freehand",this.draw.changeMode(this.activeDrawMode),this.mousePopUpMessage="Hold mouse left click and drag mouse to draw freehand polygon like pencil sketch";break;case"points":this.activeDrawMode="draw_point",this.draw.changeMode(this.activeDrawMode),this.mousePopUpMessage="Use mouse left click to ploat point";break;case"marker":this.activeDrawMode="active",this.handleMarker(this.activeDrawMode),this.mousePopUpMessage="Use mouse left click and draw marker";break;case"square":this.activeDrawMode="draw_rectangle",this.draw.changeMode(this.activeDrawMode),this.mousePopUpMessage="Press mouse left click one time to start drawing freehand Square and for stop only use mouse left click once";break;case"freehand-line":this.activeDrawMode="draw_freehand_line",this.draw.changeMode(this.activeDrawMode),this.mousePopUpMessage="Hold mouse left click and draw on map like pencil skectch";break;case"custom-marker":this.drawCustomMarker=!0,this.drawText=!1,this.activeDrawMode="draw_point",this.draw.changeMode(this.activeDrawMode),this.mousePopUpMessage="Press mouse left click and add marker on map";break;case"add-text":this.drawCustomMarker=!0,this.drawText=!0,this.activeDrawMode="draw_point",this.draw.changeMode(this.activeDrawMode),this.mousePopUpMessage="Press mouse left click to add text on map";break;case"simple-select":this.activeDrawMode="simple_select",this.draw.changeMode(this.activeDrawMode),this.mousePopUpMessage="Welcome to Your Map<br><sub>Please select any drawing type and enjoy !!</sub>";break;case"delete-tool":this.draw.changeMode("simple_select"),this.canDeleteGeom=!0,this.styleService.canDeleteMarker=!0,this.mousePopUpMessage="Click on feature which you want to delte"}this.showMapCursorTip&&this.dataShareService.useMapPopUp(this.map,this.mousePopUpMessage,"color: gray; font-family: fantasy;")}}rotateModeHandler(){this.editModeHandler(),setTimeout(()=>{this.draw.changeMode("rotate_mode")},0),this.isRotateModeActive=!this.isRotateModeActive}editModeHandler(){if(this.layerEditMode=!this.layerEditMode,this.layerEditMode){this.activeTool="edit-mode",this.mousePopUpMessage="Click on feature to edit or drag it on map",this.showMapCursorTip&&this.dataShareService.useMapPopUp(this.map,this.mousePopUpMessage,"color: gray; font-family: fantasy;"),this.draw.changeMode("simple_select");let o=this.downloadDataService.changeTypeMarkerToPoint(JSON.parse(JSON.stringify({...this.geo_json_main})));this.styleService.deleteAllMarkers(),this.draw.add(o),this.map.getSource("YourMapSource").setData({type:"FeatureCollection",features:[]})}else this.activeTool="simple-select",this.geo_json_main=this.setGeoJsonForStopEditMode(),this.editModeGeoJsonCheck>0||this.isRotateModeActive?this.styleService.setDataOnMap(this.map,this.geo_json_main,!1):this.styleService.setDataOnMap(this.map,this.geo_json_main,!1,!1),this.dataShareService.sendSourceData(this.geo_json_main),this.draw.deleteAll(),this.stopDraw(),this.editModeGeoJsonCheck=0}changeTypeMarkerToPoint(o){return o.features.forEach((p,y)=>{"marker"==p.geometry.type&&(o.features[y].geometry.type="Point")}),o}setGeoJsonForStopEditMode(){let o=this.draw.getAll();return this.geo_json_main.features.forEach((p,y)=>{o.features.forEach((v,b)=>{v.id==p.id&&(this.geo_json_main.features[y].geometry.coordinates=o.features[b].geometry.coordinates)})}),this.geo_json_main}stopDraw(){this.activeTool="simple-select",this.showMapCursorTip&&(this.mousePopUpMessage="Welcome to Your Map<br><sub>Please select any drawing type and enjoy !!</sub>",this.dataShareService.useMapPopUp(this.map,this.mousePopUpMessage,"color: gray; font-family: fantasy;")),this.draw.changeMode("simple_select"),this.handleMarker("deactive"),this.canDeleteGeom=!1,this.styleService.canDeleteMarker=!1}handleMarker(o){"active"==o?(this.draw.trash(),this.canDrawMarker=!0):this.canDrawMarker=!1}getDrawContinousStatus(o){this.drawContinuously=o.checked,0==this.drawContinuously&&this.stopDraw()}getShowTipOnMouseStatus(o){o.checked?this.mousePopupTurnOn():this.mousePopupTurnOff()}mousePopupTurnOn(){this.showMapCursorTip=!0,this.dataShareService.useMapPopUp(this.map,this.mousePopUpMessage,"color: gray; font-family: fantasy;")}mousePopupTurnOff(){this.showMapCursorTip=!1,this.dataShareService.removeMapPopUp()}sendDrawSourceData(){this.dataShareService.sendSourceData(this.geo_json_main)}showDataTable(){this.dataShareService.sendShowDataTableStatus(!0),this.stopDraw()}addLabelHandler(o){if(1==o.checked){let p=this.downloadDataService.changeTypeMarkerToPoint(JSON.parse(JSON.stringify({...this.geo_json_main}))),y=this.changeTypePolygonToPoint(JSON.parse(JSON.stringify({...p})));this.mapService.addLabelFn(y),console.log(this.geo_json_main)}else this.mapService.removeLabelFn()}changeTypePolygonToPoint(o){let p={...o};return p.features.forEach((y,v)=>{if("Polygon"==y.geometry.type){let b=function fo(r,a){void 0===a&&(a={});var o=0,p=0,y=0;return Pn(r,function(v){o+=v[0],p+=v[1],y++},!0),or([o/y,p/y],a.properties)}(y);p.features[v].geometry=b.geometry}}),p}undo(){this.layerEditMode?this.snackbarService.openSnackbar("Please turn of edit layer to use undo","snackbar-err"):this.styleService.handleUndo()}redo(){this.layerEditMode?this.snackbarService.openSnackbar("Please turn of edit layer to use redo","snackbar-err"):this.styleService.handleRedo()}showUploadDialog(){this.matDialog.open(Hy,{width:"250px",data:{map:this.map},enterAnimationDuration:"200ms",exitAnimationDuration:"200ms"})}downloadData(){let o=JSON.parse(JSON.stringify({...this.geo_json_main}));this.downloadDataFinal(o,"geojson")}downloadDataFinal(o,p){o&&o.features.length>0?(o=this.downloadDataService.changeTypeMarkerToPoint(JSON.parse(JSON.stringify({...o}))),this.downloadDataService.downloadData(p,{...o})):this.snackbarService.openSnackbar("Please draw atleast one geometry","snackbar-err")}resetData(){this.draw.deleteAll(),this.stopDraw(),this.geo_json_main={type:"FeatureCollection",features:[]},this.dataShareService.sendSourceData(this.geo_json_main),this.mapService.removeLayerFn(),this.mapService.removeSourceFn(),this.styleService.deleteAllMarkers(),this.mapService.addSourceFn(),this.layerEditMode=!1,this.isRotateModeActive=!1}}return r.\u0275fac=function(o){return new(o||r)(s.Y36(X),s.Y36(ge),s.Y36(xt),s.Y36(tt),s.Y36(Xf),s.Y36(ht.uw),s.Y36(ag))},r.\u0275cmp=s.Xpm({type:r,selectors:[["app-draw-common"]],viewQuery:function(o,p){if(1&o&&s.Gf(Wy,5),2&o){let y;s.iGM(y=s.CRH())&&(p.mouseTip=y.first)}},inputs:{draw:"draw",map:"map"},outputs:{sendIdentityFeatureData:"sendIdentityFeatureData"},decls:67,vars:32,consts:[[1,"draw-main","px-3","pb-3"],["title","Hold mouse left click and drag mouse to draw freehand polygon like pencil sketch",1,"border","p-2","draw-tool","p-flex",3,"disabled","ngClass","click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-pen"],["d","m13.498.795.149-.149a1.207 1.207 0 1 1 1.707 1.708l-.149.148a1.5 1.5 0 0 1-.059 2.059L4.854 14.854a.5.5 0 0 1-.233.131l-4 1a.5.5 0 0 1-.606-.606l1-4a.5.5 0 0 1 .131-.232l9.642-9.642a.5.5 0 0 0-.642.056L6.854 4.854a.5.5 0 1 1-.708-.708L9.44.854A1.5 1.5 0 0 1 11.5.796a1.5 1.5 0 0 1 1.998-.001zm-.644.766a.5.5 0 0 0-.707 0L1.95 11.756l-.764 3.057 3.057-.764L14.44 3.854a.5.5 0 0 0 0-.708l-1.585-1.585z"],["title","Use mouse left click to drop polygon vertices on map and for stop use mouse double click",1,"border","p-2","draw-tool","p-flex",3,"disabled","ngClass","click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-pentagon"],["d","M7.685 1.545a.5.5 0 0 1 .63 0l6.263 5.088a.5.5 0 0 1 .161.539l-2.362 7.479a.5.5 0 0 1-.476.349H4.099a.5.5 0 0 1-.476-.35L1.26 7.173a.5.5 0 0 1 .161-.54l6.263-5.087Zm8.213 5.28a.5.5 0 0 0-.162-.54L8.316.257a.5.5 0 0 0-.631 0L.264 6.286a.5.5 0 0 0-.162.538l2.788 8.827a.5.5 0 0 0 .476.349h9.268a.5.5 0 0 0 .476-.35l2.788-8.826Z"],["title","Press mouse left click once to start drawing freehand Square and for stop only use mouse left click once",1,"border","p-2","draw-tool","p-flex",3,"disabled","ngClass","click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-square"],["d","M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"],["title","Use mouse left click once then drag mouse for set radius then use mouse left click to stop",1,"border","p-2","draw-tool","p-flex",3,"disabled","ngClass","click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-circle"],["d","M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"],["title","Use mouse left click to drop line vertices and for stop use mouse double click",1,"border","p-2","draw-tool","p-flex",3,"disabled","ngClass","click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-dash-lg"],["fill-rule","evenodd","d","M2 8a.5.5 0 0 1 .5-.5h11a.5.5 0 0 1 0 1h-11A.5.5 0 0 1 2 8Z"],["title","Hold mouse left click and draw freehand line like pencil sketch",1,"border","p-2","draw-tool","p-flex",3,"disabled","ngClass","click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-pencil"],["d","M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207 11.207 2.5zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293l6.5-6.5zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z"],["title","Press mouse left click and add marker on map",1,"border","p-2","draw-tool","p-flex",3,"disabled","ngClass","click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-geo-alt"],["d","M12.166 8.94c-.524 1.062-1.234 2.12-1.96 3.07A31.493 31.493 0 0 1 8 14.58a31.481 31.481 0 0 1-2.206-2.57c-.726-.95-1.436-2.008-1.96-3.07C3.304 7.867 3 6.862 3 6a5 5 0 0 1 10 0c0 .862-.305 1.867-.834 2.94zM8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10z"],["d","M8 8a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm0 1a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"],["title","Draw points",1,"border","p-2","draw-tool","p-flex",3,"disabled","ngClass","click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-circle-fill"],["cx","8","cy","8","r","8"],["title","Press mouse left click to add text on map then use click to customize it",1,"border","p-2","draw-tool","p-flex",3,"disabled","ngClass","click"],[1,"draw-main","px-3","mb-3"],["title","Simple select mode",1,"border","p-2","draw-tool","p-flex",3,"disabled","ngClass","click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-hand-index-thumb-fill"],["d","M8.5 1.75v2.716l.047-.002c.312-.012.742-.016 1.051.046.28.056.543.18.738.288.273.152.456.385.56.642l.132-.012c.312-.024.794-.038 1.158.108.37.148.689.487.88.716.075.09.141.175.195.248h.582a2 2 0 0 1 1.99 2.199l-.272 2.715a3.5 3.5 0 0 1-.444 1.389l-1.395 2.441A1.5 1.5 0 0 1 12.42 16H6.118a1.5 1.5 0 0 1-1.342-.83l-1.215-2.43L1.07 8.589a1.517 1.517 0 0 1 2.373-1.852L5 8.293V1.75a1.75 1.75 0 0 1 3.5 0z"],["title","Undo changes",1,"border","p-2","draw-tool","p-flex",3,"disabled","click"],["title","Redo changes",1,"border","p-2","draw-tool","p-flex",3,"disabled","click"],["title","Delete features",1,"border","p-2","draw-tool","p-flex",3,"disabled","ngClass","click"],["title","Click on feature to edit or drag it on map",1,"border","py-2","draw-tool","p-flex",3,"disabled","ngClass","click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-pencil-square"],["d","M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"],["fill-rule","evenodd","d","M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"],["title","Rotate features on map holding mouse left click",1,"border","py-2","draw-tool","p-flex",3,"disabled","ngClass","click"],[1,"px-3","toggle-div"],["color","primary",1,"d-block",3,"change"],[4,"ngIf"],[1,"d-flex","justify-content-center"],[1,"mt-3","btn","btn-sm","btn-danger","me-1",3,"click"],[1,"mt-3","btn","btn-sm","btn-warning","me-1",3,"disabled","click"],[1,"mt-3","btn","btn-sm","btn-success","d-flex","align-items-center",3,"disabled","click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-download"],["d","M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"],["d","M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"],[1,"ms-1"],[1,"alert","alert-danger","text-dark","mt-3","p-2","text-center","border","border-danger","shadow-sm",2,"font-size","15px","line-height","15px"]],template:function(o,p){1&o&&(s.TgZ(0,"div",0)(1,"button",1),s.NdJ("click",function(){return p.startDraw("freehand")}),s.O4$(),s.TgZ(2,"svg",2),s._UZ(3,"path",3),s.qZA()(),s.kcU(),s.TgZ(4,"button",4),s.NdJ("click",function(){return p.startDraw("polygon")}),s.O4$(),s.TgZ(5,"svg",5),s._UZ(6,"path",6),s.qZA()(),s.kcU(),s.TgZ(7,"button",7),s.NdJ("click",function(){return p.startDraw("square")}),s.O4$(),s.TgZ(8,"svg",8),s._UZ(9,"path",9),s.qZA()(),s.kcU(),s.TgZ(10,"button",10),s.NdJ("click",function(){return p.startDraw("circle")}),s.O4$(),s.TgZ(11,"svg",11),s._UZ(12,"path",12),s.qZA()(),s.kcU(),s.TgZ(13,"button",13),s.NdJ("click",function(){return p.startDraw("line")}),s.O4$(),s.TgZ(14,"svg",14),s._UZ(15,"path",15),s.qZA()(),s.kcU(),s.TgZ(16,"button",16),s.NdJ("click",function(){return p.startDraw("freehand-line")}),s.O4$(),s.TgZ(17,"svg",17),s._UZ(18,"path",18),s.qZA()(),s.kcU(),s.TgZ(19,"button",19),s.NdJ("click",function(){return p.startDraw("custom-marker")}),s.O4$(),s.TgZ(20,"svg",20),s._UZ(21,"path",21)(22,"path",22),s.qZA()(),s.kcU(),s.TgZ(23,"button",23),s.NdJ("click",function(){return p.startDraw("points")}),s.O4$(),s.TgZ(24,"svg",24),s._UZ(25,"circle",25),s.qZA()(),s.kcU(),s.TgZ(26,"button",26),s.NdJ("click",function(){return p.startDraw("add-text")}),s.TgZ(27,"mat-icon"),s._uU(28," text_fields"),s.qZA()()(),s._UZ(29,"br"),s.TgZ(30,"div",27)(31,"button",28),s.NdJ("click",function(){return p.startDraw("simple-select")}),s.O4$(),s.TgZ(32,"svg",29),s._UZ(33,"path",30),s.qZA()(),s.kcU(),s.TgZ(34,"button",31),s.NdJ("click",function(){return p.undo()}),s.TgZ(35,"mat-icon"),s._uU(36,"undo"),s.qZA()(),s.TgZ(37,"button",32),s.NdJ("click",function(){return p.redo()}),s.TgZ(38,"mat-icon"),s._uU(39,"redo"),s.qZA()(),s.TgZ(40,"button",33),s.NdJ("click",function(){return p.startDraw("delete-tool")}),s.TgZ(41,"mat-icon"),s._uU(42,"delete_sweep"),s.qZA()(),s.TgZ(43,"button",34),s.NdJ("click",function(){return p.editModeHandler()}),s.O4$(),s.TgZ(44,"svg",35),s._UZ(45,"path",36)(46,"path",37),s.qZA()(),s.kcU(),s.TgZ(47,"button",38),s.NdJ("click",function(){return p.rotateModeHandler()}),s.TgZ(48,"mat-icon"),s._uU(49,"rotate_left"),s.qZA()()(),s.TgZ(50,"div",39)(51,"mat-slide-toggle",40),s.NdJ("change",function(v){return p.getDrawContinousStatus(v)}),s._uU(52,"\u8fde\u7eed\u7ed8\u5236 "),s.qZA()(),s.YNc(53,Ky,1,0,"div",41),s.YNc(54,$y,3,0,"div",41),s.TgZ(55,"div",42)(56,"button",43),s.NdJ("click",function(){return p.resetData()}),s._uU(57," \u91cd\u7f6e "),s.qZA()(),s.TgZ(58,"div",42)(59,"button",44),s.NdJ("click",function(){return p.showUploadDialog()}),s._uU(60," \u4e0a\u4f20 "),s.qZA(),s.TgZ(61,"button",45),s.NdJ("click",function(){return p.downloadData()}),s.O4$(),s.TgZ(62,"svg",46),s._UZ(63,"path",47)(64,"path",48),s.qZA(),s.kcU(),s.TgZ(65,"span",49),s._uU(66,"\u4e0b\u8f7d"),s.qZA()()()),2&o&&(s.xp6(1),s.Q6J("disabled",p.layerEditMode||p.isRotateModeActive)("ngClass","freehand"==p.activeTool?"active-tool":""),s.xp6(3),s.Q6J("disabled",p.layerEditMode||p.isRotateModeActive)("ngClass","polygon"==p.activeTool?"active-tool":""),s.xp6(3),s.Q6J("disabled",p.layerEditMode||p.isRotateModeActive)("ngClass","square"==p.activeTool?"active-tool":""),s.xp6(3),s.Q6J("disabled",p.layerEditMode||p.isRotateModeActive)("ngClass","circle"==p.activeTool?"active-tool":""),s.xp6(3),s.Q6J("disabled",p.layerEditMode||p.isRotateModeActive)("ngClass","line"==p.activeTool?"active-tool":""),s.xp6(3),s.Q6J("disabled",p.layerEditMode||p.isRotateModeActive)("ngClass","freehand-line"==p.activeTool?"active-tool":""),s.xp6(3),s.Q6J("disabled",p.layerEditMode||p.isRotateModeActive)("ngClass","custom-marker"==p.activeTool?"active-tool":""),s.xp6(4),s.Q6J("disabled",p.layerEditMode||p.isRotateModeActive)("ngClass","points"==p.activeTool?"active-tool":""),s.xp6(3),s.Q6J("disabled",p.layerEditMode||p.isRotateModeActive)("ngClass","add-text"==p.activeTool?"active-tool":""),s.xp6(5),s.Q6J("disabled",p.layerEditMode||p.isRotateModeActive)("ngClass","simple-select"==p.activeTool?"active-tool":""),s.xp6(3),s.Q6J("disabled",p.layerEditMode||p.isRotateModeActive),s.xp6(3),s.Q6J("disabled",p.layerEditMode||p.isRotateModeActive),s.xp6(3),s.Q6J("disabled",p.layerEditMode||p.isRotateModeActive)("ngClass","delete-tool"==p.activeTool?"active-tool":""),s.xp6(3),s.Q6J("disabled",p.isRotateModeActive||0==p.geo_json_main.features.length)("ngClass","edit-mode"!=p.activeTool||p.isRotateModeActive?"":"active-tool"),s.xp6(4),s.Q6J("disabled",p.layerEditMode&&!p.isRotateModeActive||0==p.geo_json_main.features.length)("ngClass",p.isRotateModeActive?"active-tool":""),s.xp6(6),s.Q6J("ngIf","custom-marker"==p.activeTool||"add-text"==p.activeTool),s.xp6(1),s.Q6J("ngIf",p.isRotateModeActive),s.xp6(5),s.Q6J("disabled",p.layerEditMode||p.isRotateModeActive),s.xp6(2),s.Q6J("disabled",0==p.geo_json_main.features.length||p.layerEditMode||p.isRotateModeActive))},dependencies:[dt.mk,dt.O5,rt.Hw,H.Rr],styles:[".draw-tool[_ngcontent-%COMP%]{cursor:pointer}.active-tool[_ngcontent-%COMP%]{background:#0DCAF0!important;color:#fff}.draw-main[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto auto;text-align:center;column-gap:10px;row-gap:10px}.draw-main[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:#FFFFFF;height:50px}"]}),r})(),tv=(()=>{class r{constructor(){this.sendIdentityFeatureData=new s.vpe}ngOnInit(){}sendIdentityFeatureDataFn(o){this.sendIdentityFeatureData.emit(o)}}return r.\u0275fac=function(o){return new(o||r)},r.\u0275cmp=s.Xpm({type:r,selectors:[["app-create-data"]],inputs:{map:"map",draw:"draw"},outputs:{sendIdentityFeatureData:"sendIdentityFeatureData"},decls:1,vars:2,consts:[[3,"map","draw","sendIdentityFeatureData"]],template:function(o,p){1&o&&(s.TgZ(0,"app-draw-common",0),s.NdJ("sendIdentityFeatureData",function(v){return p.sendIdentityFeatureDataFn(v)}),s.qZA()),2&o&&s.Q6J("map",p.map)("draw",p.draw)},dependencies:[Qy]}),r})();const ev=[{path:"",component:(()=>{class r{constructor(o,p){this.dataShareService=o,this.downloadDataService=p,this.showGeocoder=!1,this.temp_geo_json_main={type:"FeatureCollection",features:[]}}showMessage(o){0!==this.temp_geo_json_main.features.length&&(o.returnValue="Your data will be lost!")}set content(o){o&&(this.mapCommonComponent=o)}ngOnInit(){this.dataShareService.getSourceData.subscribe(o=>{this.temp_geo_json_main=o}),this.downloadDataService.downloadDone.subscribe(o=>{this.temp_geo_json_main={type:"FeatureCollection",features:[]}})}getMapData(o){this.map=o.map,this.draw=o.draw}sendIdentityFeatureDataFn(o){this.mapCommonComponent.sendIdentityFeatureData(o)}}return r.\u0275fac=function(o){return new(o||r)(s.Y36(ge),s.Y36(ag))},r.\u0275cmp=s.Xpm({type:r,selectors:[["app-home"]],viewQuery:function(o,p){if(1&o&&s.Gf(ym,5),2&o){let y;s.iGM(y=s.CRH())&&(p.content=y.first)}},hostBindings:function(o,p){1&o&&s.NdJ("beforeunload",function(v){return p.showMessage(v)},!1,s.Jf7)},decls:7,vars:4,consts:[[1,"main-div"],[1,"map-wrapper"],[3,"mapDataEmit"],[1,"border-end","border-dark","side-nav-wrapper"],[3,"map","draw","sendIdentityFeatureData"],[3,"map","draw"]],template:function(o,p){1&o&&(s.TgZ(0,"div",0)(1,"div",1)(2,"app-map-common",2),s.NdJ("mapDataEmit",function(v){return p.getMapData(v)}),s.qZA()(),s.TgZ(3,"div",3),s._UZ(4,"app-header"),s.TgZ(5,"app-create-data",4),s.NdJ("sendIdentityFeatureData",function(v){return p.sendIdentityFeatureDataFn(v)}),s.qZA(),s._UZ(6,"app-map-styles",5),s.qZA()()),2&o&&(s.xp6(5),s.Q6J("map",p.map)("draw",p.draw),s.xp6(1),s.Q6J("map",p.map)("draw",p.draw))},dependencies:[ym,Yy,Jy,tv],styles:[".main-div[_ngcontent-%COMP%]{width:100%;height:100vh;display:flex;flex-direction:row-reverse}.map-wrapper[_ngcontent-%COMP%]{height:100vh;width:100%}.side-nav-wrapper[_ngcontent-%COMP%]{position:relative;width:300px;overflow:hidden;background-color:#e2f2f0}"]}),r})()}];let rv=(()=>{class r{}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=s.oAB({type:r}),r.\u0275inj=s.cJS({imports:[Tt.Bz.forChild(ev),Tt.Bz]}),r})();const nv=[];let iv=(()=>{class r{}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=s.oAB({type:r}),r.\u0275inj=s.cJS({imports:[Tt.Bz.forChild(nv),Tt.Bz]}),r})();var sg=St(8147);const ov=[];let av=(()=>{class r{}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=s.oAB({type:r}),r.\u0275inj=s.cJS({imports:[Tt.Bz.forChild(ov),Tt.Bz]}),r})(),vm=(()=>{class r{}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=s.oAB({type:r}),r.\u0275inj=s.cJS({imports:[dt.ez,av,sg.i,lt.UX,lt.u5,Z.e4,Ty]}),r})(),sv=(()=>{class r{}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=s.oAB({type:r}),r.\u0275inj=s.cJS({imports:[dt.ez,iv,sg.i,lt.u5,vm]}),r})(),uv=(()=>{class r{}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=s.oAB({type:r}),r.\u0275inj=s.cJS({imports:[dt.ez,rv,sv,sg.i,vm]}),r})()},1503:(tr,he,St)=>{"use strict";var Tt=St(9626);function s(lt){var ht=[1/0,1/0,-1/0,-1/0];return Tt.coordEach(lt,function(Lt){ht[0]>Lt[0]&&(ht[0]=Lt[0]),ht[1]>Lt[1]&&(ht[1]=Lt[1]),ht[2]<Lt[0]&&(ht[2]=Lt[0]),ht[3]<Lt[1]&&(ht[3]=Lt[1])}),ht}s.default=s,he.Z=s},5427:(tr,he,St)=>{"use strict";var Tt=St(9626),s=St(8275);he.Z=function lt(ht,Lt){void 0===Lt&&(Lt={});var Nt=0,$t=0,qt=0;return Tt.coordEach(ht,function(_e){Nt+=_e[0],$t+=_e[1],qt++},!0),s.point([Nt/qt,$t/qt],Lt.properties)}},9814:(tr,he,St)=>{"use strict";var Tt=St(8275),s=St(8418);he.Z=function lt(ht,Lt,Nt,$t){void 0===$t&&($t={});var qt=s.getCoord(ht),_e=Tt.degreesToRadians(qt[0]),yt=Tt.degreesToRadians(qt[1]),xt=Tt.degreesToRadians(Nt),Yt=Tt.lengthToRadians(Lt,$t.units),ge=Math.asin(Math.sin(yt)*Math.cos(Yt)+Math.cos(yt)*Math.sin(Yt)*Math.cos(xt)),Z=_e+Math.atan2(Math.sin(xt)*Math.sin(Yt)*Math.cos(yt),Math.cos(Yt)-Math.sin(yt)*Math.sin(ge)),it=Tt.radiansToDegrees(Z),$=Tt.radiansToDegrees(ge);return Tt.point([it,$],$t.properties)}},2777:(tr,he,St)=>{"use strict";var Tt=St(8418),s=St(8275);he.Z=function lt(ht,Lt,Nt){void 0===Nt&&(Nt={});var $t=Tt.getCoord(ht),qt=Tt.getCoord(Lt),_e=s.degreesToRadians(qt[1]-$t[1]),yt=s.degreesToRadians(qt[0]-$t[0]),xt=s.degreesToRadians($t[1]),Yt=s.degreesToRadians(qt[1]),ge=Math.pow(Math.sin(_e/2),2)+Math.pow(Math.sin(yt/2),2)*Math.cos(xt)*Math.cos(Yt);return s.radiansToLength(2*Math.atan2(Math.sqrt(ge),Math.sqrt(1-ge)),Nt.units)}},8275:(tr,he)=>{"use strict";function St(Ct,kt,gt){void 0===gt&&(gt={});var Fe={type:"Feature"};return(0===gt.id||gt.id)&&(Fe.id=gt.id),gt.bbox&&(Fe.bbox=gt.bbox),Fe.properties=kt||{},Fe.geometry=Ct,Fe}function Tt(Ct,kt,gt){if(void 0===gt&&(gt={}),!Ct)throw new Error("coordinates is required");if(!Array.isArray(Ct))throw new Error("coordinates must be an Array");if(Ct.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!et(Ct[0])||!et(Ct[1]))throw new Error("coordinates must contain numbers");return St({type:"Point",coordinates:Ct},kt,gt)}function lt(Ct,kt,gt){void 0===gt&&(gt={});for(var Fe=0,Ie=Ct;Fe<Ie.length;Fe++){var It=Ie[Fe];if(It.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var pe=0;pe<It[It.length-1].length;pe++)if(It[It.length-1][pe]!==It[0][pe])throw new Error("First and last Position are not equivalent.")}return St({type:"Polygon",coordinates:Ct},kt,gt)}function Lt(Ct,kt,gt){if(void 0===gt&&(gt={}),Ct.length<2)throw new Error("coordinates must be an array of two or more positions");return St({type:"LineString",coordinates:Ct},kt,gt)}function $t(Ct,kt){void 0===kt&&(kt={});var gt={type:"FeatureCollection"};return kt.id&&(gt.id=kt.id),kt.bbox&&(gt.bbox=kt.bbox),gt.features=Ct,gt}function qt(Ct,kt,gt){return void 0===gt&&(gt={}),St({type:"MultiLineString",coordinates:Ct},kt,gt)}function _e(Ct,kt,gt){return void 0===gt&&(gt={}),St({type:"MultiPoint",coordinates:Ct},kt,gt)}function yt(Ct,kt,gt){return void 0===gt&&(gt={}),St({type:"MultiPolygon",coordinates:Ct},kt,gt)}function ge(Ct,kt){void 0===kt&&(kt="kilometers");var gt=he.factors[kt];if(!gt)throw new Error(kt+" units is invalid");return Ct*gt}function Z(Ct,kt){void 0===kt&&(kt="kilometers");var gt=he.factors[kt];if(!gt)throw new Error(kt+" units is invalid");return Ct/gt}function tt(Ct){return Ct%(2*Math.PI)*180/Math.PI}function et(Ct){return!isNaN(Ct)&&null!==Ct&&!Array.isArray(Ct)}Object.defineProperty(he,"__esModule",{value:!0}),he.earthRadius=6371008.8,he.factors={centimeters:100*he.earthRadius,centimetres:100*he.earthRadius,degrees:he.earthRadius/111325,feet:3.28084*he.earthRadius,inches:39.37*he.earthRadius,kilometers:he.earthRadius/1e3,kilometres:he.earthRadius/1e3,meters:he.earthRadius,metres:he.earthRadius,miles:he.earthRadius/1609.344,millimeters:1e3*he.earthRadius,millimetres:1e3*he.earthRadius,nauticalmiles:he.earthRadius/1852,radians:1,yards:1.0936*he.earthRadius},he.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/he.earthRadius,yards:1.0936133},he.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},he.feature=St,he.geometry=function dt(Ct,kt,gt){switch(void 0===gt&&(gt={}),Ct){case"Point":return Tt(kt).geometry;case"LineString":return Lt(kt).geometry;case"Polygon":return lt(kt).geometry;case"MultiPoint":return _e(kt).geometry;case"MultiLineString":return qt(kt).geometry;case"MultiPolygon":return yt(kt).geometry;default:throw new Error(Ct+" is invalid")}},he.point=Tt,he.points=function s(Ct,kt,gt){return void 0===gt&&(gt={}),$t(Ct.map(function(Fe){return Tt(Fe,kt)}),gt)},he.polygon=lt,he.polygons=function ht(Ct,kt,gt){return void 0===gt&&(gt={}),$t(Ct.map(function(Fe){return lt(Fe,kt)}),gt)},he.lineString=Lt,he.lineStrings=function Nt(Ct,kt,gt){return void 0===gt&&(gt={}),$t(Ct.map(function(Fe){return Lt(Fe,kt)}),gt)},he.featureCollection=$t,he.multiLineString=qt,he.multiPoint=_e,he.multiPolygon=yt,he.geometryCollection=function xt(Ct,kt,gt){return void 0===gt&&(gt={}),St({type:"GeometryCollection",geometries:Ct},kt,gt)},he.round=function Yt(Ct,kt){if(void 0===kt&&(kt=0),kt&&!(kt>=0))throw new Error("precision must be a positive number");var gt=Math.pow(10,kt||0);return Math.round(Ct*gt)/gt},he.radiansToLength=ge,he.lengthToRadians=Z,he.lengthToDegrees=function it(Ct,kt){return tt(Z(Ct,kt))},he.bearingToAzimuth=function $(Ct){var kt=Ct%360;return kt<0&&(kt+=360),kt},he.radiansToDegrees=tt,he.degreesToRadians=function X(Ct){return Ct%360*Math.PI/180},he.convertLength=function rt(Ct,kt,gt){if(void 0===kt&&(kt="kilometers"),void 0===gt&&(gt="kilometers"),!(Ct>=0))throw new Error("length must be a positive number");return ge(Z(Ct,kt),gt)},he.convertArea=function H(Ct,kt,gt){if(void 0===kt&&(kt="meters"),void 0===gt&&(gt="kilometers"),!(Ct>=0))throw new Error("area must be a positive number");var Fe=he.areaFactors[kt];if(!Fe)throw new Error("invalid original units");var Ie=he.areaFactors[gt];if(!Ie)throw new Error("invalid final units");return Ct/Fe*Ie},he.isNumber=et,he.isObject=function at(Ct){return!!Ct&&Ct.constructor===Object},he.validateBBox=function j(Ct){if(!Ct)throw new Error("bbox is required");if(!Array.isArray(Ct))throw new Error("bbox must be an Array");if(4!==Ct.length&&6!==Ct.length)throw new Error("bbox must be an Array of 4 or 6 numbers");Ct.forEach(function(kt){if(!et(kt))throw new Error("bbox must only contain numbers")})},he.validateId=function Wt(Ct){if(!Ct)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof Ct))throw new Error("id must be a number or a string")}},8418:(tr,he,St)=>{"use strict";Object.defineProperty(he,"__esModule",{value:!0});var dt=St(8275);he.getCoord=function Tt(_e){if(!_e)throw new Error("coord is required");if(!Array.isArray(_e)){if("Feature"===_e.type&&null!==_e.geometry&&"Point"===_e.geometry.type)return _e.geometry.coordinates;if("Point"===_e.type)return _e.coordinates}if(Array.isArray(_e)&&_e.length>=2&&!Array.isArray(_e[0])&&!Array.isArray(_e[1]))return _e;throw new Error("coord must be GeoJSON Point or an Array of numbers")},he.getCoords=function s(_e){if(Array.isArray(_e))return _e;if("Feature"===_e.type){if(null!==_e.geometry)return _e.geometry.coordinates}else if(_e.coordinates)return _e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")},he.containsNumber=function lt(_e){if(_e.length>1&&dt.isNumber(_e[0])&&dt.isNumber(_e[1]))return!0;if(Array.isArray(_e[0])&&_e[0].length)return lt(_e[0]);throw new Error("coordinates must only contain numbers")},he.geojsonType=function ht(_e,yt,xt){if(!yt||!xt)throw new Error("type and name required");if(!_e||_e.type!==yt)throw new Error("Invalid input to "+xt+": must be a "+yt+", given "+_e.type)},he.featureOf=function Lt(_e,yt,xt){if(!_e)throw new Error("No feature passed");if(!xt)throw new Error(".featureOf() requires a name");if(!_e||"Feature"!==_e.type||!_e.geometry)throw new Error("Invalid input to "+xt+", Feature with geometry required");if(!_e.geometry||_e.geometry.type!==yt)throw new Error("Invalid input to "+xt+": must be a "+yt+", given "+_e.geometry.type)},he.collectionOf=function Nt(_e,yt,xt){if(!_e)throw new Error("No featureCollection passed");if(!xt)throw new Error(".collectionOf() requires a name");if(!_e||"FeatureCollection"!==_e.type)throw new Error("Invalid input to "+xt+", FeatureCollection required");for(var Yt=0,ge=_e.features;Yt<ge.length;Yt++){var Z=ge[Yt];if(!Z||"Feature"!==Z.type||!Z.geometry)throw new Error("Invalid input to "+xt+", Feature with geometry required");if(!Z.geometry||Z.geometry.type!==yt)throw new Error("Invalid input to "+xt+": must be a "+yt+", given "+Z.geometry.type)}},he.getGeom=function $t(_e){return"Feature"===_e.type?_e.geometry:_e},he.getType=function qt(_e,yt){return"FeatureCollection"===_e.type?"FeatureCollection":"GeometryCollection"===_e.type?"GeometryCollection":"Feature"===_e.type&&null!==_e.geometry?_e.geometry.type:_e.type}},9626:(tr,he,St)=>{"use strict";Object.defineProperty(he,"__esModule",{value:!0});var dt=St(8275);function Tt(X,rt,H){if(null!==X)for(var et,at,j,Wt,Ct,kt,gt,It,Fe=0,Ie=0,pe=X.type,Pt="FeatureCollection"===pe,te="Feature"===pe,le=Pt?X.features.length:1,Ot=0;Ot<le;Ot++){Ct=(It=!!(gt=Pt?X.features[Ot].geometry:te?X.geometry:X)&&"GeometryCollection"===gt.type)?gt.geometries.length:1;for(var Ue=0;Ue<Ct;Ue++){var ze=0,ar=0;if(null!==(Wt=It?gt.geometries[Ue]:gt)){kt=Wt.coordinates;var Me=Wt.type;switch(Fe=!H||"Polygon"!==Me&&"MultiPolygon"!==Me?0:1,Me){case null:break;case"Point":if(!1===rt(kt,Ie,Ot,ze,ar))return!1;Ie++,ze++;break;case"LineString":case"MultiPoint":for(et=0;et<kt.length;et++){if(!1===rt(kt[et],Ie,Ot,ze,ar))return!1;Ie++,"MultiPoint"===Me&&ze++}"LineString"===Me&&ze++;break;case"Polygon":case"MultiLineString":for(et=0;et<kt.length;et++){for(at=0;at<kt[et].length-Fe;at++){if(!1===rt(kt[et][at],Ie,Ot,ze,ar))return!1;Ie++}"MultiLineString"===Me&&ze++,"Polygon"===Me&&ar++}"Polygon"===Me&&ze++;break;case"MultiPolygon":for(et=0;et<kt.length;et++){for(ar=0,at=0;at<kt[et].length;at++){for(j=0;j<kt[et][at].length-Fe;j++){if(!1===rt(kt[et][at][j],Ie,Ot,ze,ar))return!1;Ie++}ar++}ze++}break;case"GeometryCollection":for(et=0;et<Wt.geometries.length;et++)if(!1===Tt(Wt.geometries[et],rt,H))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function lt(X,rt){var H;switch(X.type){case"FeatureCollection":for(H=0;H<X.features.length&&!1!==rt(X.features[H].properties,H);H++);break;case"Feature":rt(X.properties,0)}}function Lt(X,rt){if("Feature"===X.type)rt(X,0);else if("FeatureCollection"===X.type)for(var H=0;H<X.features.length&&!1!==rt(X.features[H],H);H++);}function qt(X,rt){var H,et,at,j,Wt,Ct,kt,gt,Fe,Ie,It=0,pe="FeatureCollection"===X.type,Pt="Feature"===X.type,te=pe?X.features.length:1;for(H=0;H<te;H++){for(gt=pe?X.features[H].properties:Pt?X.properties:{},Fe=pe?X.features[H].bbox:Pt?X.bbox:void 0,Ie=pe?X.features[H].id:Pt?X.id:void 0,Wt=(kt=!!(Ct=pe?X.features[H].geometry:Pt?X.geometry:X)&&"GeometryCollection"===Ct.type)?Ct.geometries.length:1,at=0;at<Wt;at++)if(null!==(j=kt?Ct.geometries[at]:Ct))switch(j.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===rt(j,It,gt,Fe,Ie))return!1;break;case"GeometryCollection":for(et=0;et<j.geometries.length;et++)if(!1===rt(j.geometries[et],It,gt,Fe,Ie))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===rt(null,It,gt,Fe,Ie))return!1;It++}}function yt(X,rt){qt(X,function(H,et,at,j,Wt){var kt,Ct=null===H?null:H.type;switch(Ct){case null:case"Point":case"LineString":case"Polygon":return!1!==rt(dt.feature(H,at,{bbox:j,id:Wt}),et,0)&&void 0}switch(Ct){case"MultiPoint":kt="Point";break;case"MultiLineString":kt="LineString";break;case"MultiPolygon":kt="Polygon"}for(var gt=0;gt<H.coordinates.length;gt++)if(!1===rt(dt.feature({type:kt,coordinates:H.coordinates[gt]},at),et,gt))return!1})}function Yt(X,rt){yt(X,function(H,et,at){var j=0;if(H.geometry){var Wt=H.geometry.type;if("Point"!==Wt&&"MultiPoint"!==Wt){var Ct,kt=0,gt=0,Fe=0;if(!1===Tt(H,function(Ie,It,pe,Pt,te){if(void 0===Ct||et>kt||Pt>gt||te>Fe)return Ct=Ie,kt=et,gt=Pt,Fe=te,void(j=0);var le=dt.lineString([Ct,Ie],H.properties);if(!1===rt(le,et,at,te,j))return!1;j++,Ct=Ie}))return!1}}})}function Z(X,rt){if(!X)throw new Error("geojson is required");yt(X,function(H,et,at){if(null!==H.geometry){var Wt=H.geometry.coordinates;switch(H.geometry.type){case"LineString":if(!1===rt(H,et,at,0,0))return!1;break;case"Polygon":for(var Ct=0;Ct<Wt.length;Ct++)if(!1===rt(dt.lineString(Wt[Ct],H.properties),et,at,Ct))return!1}}})}he.coordAll=function $t(X){var rt=[];return Tt(X,function(H){rt.push(H)}),rt},he.coordEach=Tt,he.coordReduce=function s(X,rt,H,et){var at=H;return Tt(X,function(j,Wt,Ct,kt,gt){at=0===Wt&&void 0===H?j:rt(at,j,Wt,Ct,kt,gt)},et),at},he.featureEach=Lt,he.featureReduce=function Nt(X,rt,H){var et=H;return Lt(X,function(at,j){et=0===j&&void 0===H?at:rt(et,at,j)}),et},he.findPoint=function tt(X,rt){if(!dt.isObject(rt=rt||{}))throw new Error("options is invalid");var Ct,H=rt.featureIndex||0,et=rt.multiFeatureIndex||0,at=rt.geometryIndex||0,j=rt.coordIndex||0,Wt=rt.properties;switch(X.type){case"FeatureCollection":H<0&&(H=X.features.length+H),Wt=Wt||X.features[H].properties,Ct=X.features[H].geometry;break;case"Feature":Wt=Wt||X.properties,Ct=X.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":Ct=X;break;default:throw new Error("geojson is invalid")}if(null===Ct)return null;var kt=Ct.coordinates;switch(Ct.type){case"Point":return dt.point(kt,Wt,rt);case"MultiPoint":return et<0&&(et=kt.length+et),dt.point(kt[et],Wt,rt);case"LineString":return j<0&&(j=kt.length+j),dt.point(kt[j],Wt,rt);case"Polygon":return at<0&&(at=kt.length+at),j<0&&(j=kt[at].length+j),dt.point(kt[at][j],Wt,rt);case"MultiLineString":return et<0&&(et=kt.length+et),j<0&&(j=kt[et].length+j),dt.point(kt[et][j],Wt,rt);case"MultiPolygon":return et<0&&(et=kt.length+et),at<0&&(at=kt[et].length+at),j<0&&(j=kt[et][at].length-j),dt.point(kt[et][at][j],Wt,rt)}throw new Error("geojson is invalid")},he.findSegment=function $(X,rt){if(!dt.isObject(rt=rt||{}))throw new Error("options is invalid");var Ct,H=rt.featureIndex||0,et=rt.multiFeatureIndex||0,at=rt.geometryIndex||0,j=rt.segmentIndex||0,Wt=rt.properties;switch(X.type){case"FeatureCollection":H<0&&(H=X.features.length+H),Wt=Wt||X.features[H].properties,Ct=X.features[H].geometry;break;case"Feature":Wt=Wt||X.properties,Ct=X.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":Ct=X;break;default:throw new Error("geojson is invalid")}if(null===Ct)return null;var kt=Ct.coordinates;switch(Ct.type){case"Point":case"MultiPoint":return null;case"LineString":return j<0&&(j=kt.length+j-1),dt.lineString([kt[j],kt[j+1]],Wt,rt);case"Polygon":return at<0&&(at=kt.length+at),j<0&&(j=kt[at].length+j-1),dt.lineString([kt[at][j],kt[at][j+1]],Wt,rt);case"MultiLineString":return et<0&&(et=kt.length+et),j<0&&(j=kt[et].length+j-1),dt.lineString([kt[et][j],kt[et][j+1]],Wt,rt);case"MultiPolygon":return et<0&&(et=kt.length+et),at<0&&(at=kt[et].length+at),j<0&&(j=kt[et][at].length-j-1),dt.lineString([kt[et][at][j],kt[et][at][j+1]],Wt,rt)}throw new Error("geojson is invalid")},he.flattenEach=yt,he.flattenReduce=function xt(X,rt,H){var et=H;return yt(X,function(at,j,Wt){et=0===j&&0===Wt&&void 0===H?at:rt(et,at,j,Wt)}),et},he.geomEach=qt,he.geomReduce=function _e(X,rt,H){var et=H;return qt(X,function(at,j,Wt,Ct,kt){et=0===j&&void 0===H?at:rt(et,at,j,Wt,Ct,kt)}),et},he.lineEach=Z,he.lineReduce=function it(X,rt,H){var et=H;return Z(X,function(at,j,Wt,Ct){et=0===j&&void 0===H?at:rt(et,at,j,Wt,Ct)}),et},he.propEach=lt,he.propReduce=function ht(X,rt,H){var et=H;return lt(X,function(at,j){et=0===j&&void 0===H?at:rt(et,at,j)}),et},he.segmentEach=Yt,he.segmentReduce=function ge(X,rt,H){var et=H,at=!1;return Yt(X,function(j,Wt,Ct,kt,gt){et=!1===at&&void 0===H?j:rt(et,j,Wt,Ct,kt,gt),at=!0}),et}},5834:(tr,he,St)=>{"use strict";var dt=St(5203),Tt=St(5685),s=Tt(dt("String.prototype.indexOf"));tr.exports=function(ht,Lt){var Nt=dt(ht,!!Lt);return"function"==typeof Nt&&s(ht,".prototype.")>-1?Tt(Nt):Nt}},5685:(tr,he,St)=>{"use strict";var dt=St(4444),Tt=St(5203),s=Tt("%Function.prototype.apply%"),lt=Tt("%Function.prototype.call%"),ht=Tt("%Reflect.apply%",!0)||dt.call(lt,s),Lt=Tt("%Object.getOwnPropertyDescriptor%",!0),Nt=Tt("%Object.defineProperty%",!0),$t=Tt("%Math.max%");if(Nt)try{Nt({},"a",{value:1})}catch{Nt=null}tr.exports=function(yt){var xt=ht(dt,lt,arguments);if(Lt&&Nt){var Yt=Lt(xt,"length");Yt.configurable&&Nt(xt,"length",{value:1+$t(0,yt.length-(arguments.length-1))})}return xt};var qt=function(){return ht(dt,s,arguments)};Nt?Nt(tr.exports,"apply",{value:qt}):tr.exports.apply=qt},1335:(tr,he,St)=>{"use strict";var dt=St(3156),Tt=St(7253),s=St(3870),lt=St(7563).orient2d;function ht(H,et,at){et=Math.max(0,void 0===et?2:et),at=at||0;var j=function ge(H){for(var et=H[0],at=H[0],j=H[0],Wt=H[0],Ct=0;Ct<H.length;Ct++){var kt=H[Ct];kt[0]<et[0]&&(et=kt),kt[0]>j[0]&&(j=kt),kt[1]<at[1]&&(at=kt),kt[1]>Wt[1]&&(Wt=kt)}var gt=[et,at,j,Wt],Fe=gt.slice();for(Ct=0;Ct<H.length;Ct++)s(H[Ct],gt)||Fe.push(H[Ct]);return function rt(H){H.sort(X);for(var et=[],at=0;at<H.length;at++){for(;et.length>=2&&yt(et[et.length-2],et[et.length-1],H[at])<=0;)et.pop();et.push(H[at])}for(var j=[],Wt=H.length-1;Wt>=0;Wt--){for(;j.length>=2&&yt(j[j.length-2],j[j.length-1],H[Wt])<=0;)j.pop();j.push(H[Wt])}return j.pop(),et.pop(),et.concat(j)}(Fe)}(H),Wt=new dt(16);Wt.toBBox=function(ar){return{minX:ar[0],minY:ar[1],maxX:ar[0],maxY:ar[1]}},Wt.compareMinX=function(ar,Me){return ar[0]-Me[0]},Wt.compareMinY=function(ar,Me){return ar[1]-Me[1]},Wt.load(H);for(var gt,Ct=[],kt=0;kt<j.length;kt++){var Fe=j[kt];Wt.remove(Fe),gt=Z(Fe,gt),Ct.push(gt)}var Ie=new dt(16);for(kt=0;kt<Ct.length;kt++)Ie.insert(Yt(Ct[kt]));for(var It=et*et,pe=at*at;Ct.length;){var Pt=Ct.shift(),te=Pt.p,le=Pt.next.p,Ot=it(te,le);if(!(Ot<pe)){var Ue=Ot/It;(Fe=Lt(Wt,Pt.prev.p,te,le,Pt.next.next.p,Ue,Ie))&&Math.min(it(Fe,te),it(Fe,le))<=Ue&&(Ct.push(Pt),Ct.push(Z(Fe,Pt)),Wt.remove(Fe),Ie.remove(Pt),Ie.insert(Yt(Pt)),Ie.insert(Yt(Pt.next)))}}Pt=gt;var ze=[];do{ze.push(Pt.p),Pt=Pt.next}while(Pt!==gt);return ze.push(Pt.p),ze}function Lt(H,et,at,j,Wt,Ct,kt){for(var gt=new Tt([],Nt),Fe=H.data;Fe;){for(var Ie=0;Ie<Fe.children.length;Ie++){var It=Fe.children[Ie],pe=Fe.leaf?$(It,at,j):$t(at,j,It);pe>Ct||gt.push({node:It,dist:pe})}for(;gt.length&&!gt.peek().node.children;){var Pt=gt.pop(),te=Pt.node,le=$(te,et,at),Ot=$(te,j,Wt);if(Pt.dist<le&&Pt.dist<Ot&&_e(at,te,kt)&&_e(j,te,kt))return te}(Fe=gt.pop())&&(Fe=Fe.node)}return null}function Nt(H,et){return H.dist-et.dist}function $t(H,et,at){if(qt(H,at)||qt(et,at))return 0;var j=tt(H[0],H[1],et[0],et[1],at.minX,at.minY,at.maxX,at.minY);if(0===j)return 0;var Wt=tt(H[0],H[1],et[0],et[1],at.minX,at.minY,at.minX,at.maxY);if(0===Wt)return 0;var Ct=tt(H[0],H[1],et[0],et[1],at.maxX,at.minY,at.maxX,at.maxY);if(0===Ct)return 0;var kt=tt(H[0],H[1],et[0],et[1],at.minX,at.maxY,at.maxX,at.maxY);return 0===kt?0:Math.min(j,Wt,Ct,kt)}function qt(H,et){return H[0]>=et.minX&&H[0]<=et.maxX&&H[1]>=et.minY&&H[1]<=et.maxY}function _e(H,et,at){for(var j=Math.min(H[0],et[0]),Wt=Math.min(H[1],et[1]),Ct=Math.max(H[0],et[0]),kt=Math.max(H[1],et[1]),gt=at.search({minX:j,minY:Wt,maxX:Ct,maxY:kt}),Fe=0;Fe<gt.length;Fe++)if(xt(gt[Fe].p,gt[Fe].next.p,H,et))return!1;return!0}function yt(H,et,at){return lt(H[0],H[1],et[0],et[1],at[0],at[1])}function xt(H,et,at,j){return H!==j&&et!==at&&yt(H,et,at)>0!=yt(H,et,j)>0&&yt(at,j,H)>0!=yt(at,j,et)>0}function Yt(H){var et=H.p,at=H.next.p;return H.minX=Math.min(et[0],at[0]),H.minY=Math.min(et[1],at[1]),H.maxX=Math.max(et[0],at[0]),H.maxY=Math.max(et[1],at[1]),H}function Z(H,et){var at={p:H,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return et?(at.next=et.next,at.prev=et,et.next.prev=at,et.next=at):(at.prev=at,at.next=at),at}function it(H,et){var at=H[0]-et[0],j=H[1]-et[1];return at*at+j*j}function $(H,et,at){var j=et[0],Wt=et[1],Ct=at[0]-j,kt=at[1]-Wt;if(0!==Ct||0!==kt){var gt=((H[0]-j)*Ct+(H[1]-Wt)*kt)/(Ct*Ct+kt*kt);gt>1?(j=at[0],Wt=at[1]):gt>0&&(j+=Ct*gt,Wt+=kt*gt)}return(Ct=H[0]-j)*Ct+(kt=H[1]-Wt)*kt}function tt(H,et,at,j,Wt,Ct,kt,gt){var Mr,lr,kr,Xr,Fe=at-H,Ie=j-et,It=kt-Wt,pe=gt-Ct,Pt=H-Wt,te=et-Ct,le=Fe*Fe+Ie*Ie,Ot=Fe*It+Ie*pe,Ue=It*It+pe*pe,ze=Fe*Pt+Ie*te,ar=It*Pt+pe*te,Me=le*Ue-Ot*Ot,Sr=Me,qe=Me;0===Me?(lr=0,Sr=1,Xr=ar,qe=Ue):(Xr=le*ar-Ot*ze,(lr=Ot*ar-Ue*ze)<0?(lr=0,Xr=ar,qe=Ue):lr>Sr&&(lr=Sr,Xr=ar+Ot,qe=Ue)),Xr<0?(Xr=0,-ze<0?lr=0:-ze>le?lr=Sr:(lr=-ze,Sr=le)):Xr>qe&&(Xr=qe,-ze+Ot<0?lr=0:-ze+Ot>le?lr=Sr:(lr=-ze+Ot,Sr=le));var Ve=(1-(kr=0===Xr?0:Xr/qe))*Wt+kr*kt-((1-(Mr=0===lr?0:lr/Sr))*H+Mr*at),Kt=(1-kr)*Ct+kr*gt-((1-Mr)*et+Mr*j);return Ve*Ve+Kt*Kt}function X(H,et){return H[0]===et[0]?H[1]-et[1]:H[0]-et[0]}Tt.default&&(Tt=Tt.default),tr.exports=ht,tr.exports.default=ht},3156:function(tr){tr.exports=function(){"use strict";function he(Z,it,$,tt,X){!function rt(H,et,at,j,Wt){for(;j>at;){if(j-at>600){var Ct=j-at+1,kt=et-at+1,gt=Math.log(Ct),Fe=.5*Math.exp(2*gt/3),Ie=.5*Math.sqrt(gt*Fe*(Ct-Fe)/Ct)*(kt-Ct/2<0?-1:1);rt(H,et,Math.max(at,Math.floor(et-kt*Fe/Ct+Ie)),Math.min(j,Math.floor(et+(Ct-kt)*Fe/Ct+Ie)),Wt)}var Pt=H[et],te=at,le=j;for(St(H,at,et),Wt(H[j],Pt)>0&&St(H,at,j);te<le;){for(St(H,te,le),te++,le--;Wt(H[te],Pt)<0;)te++;for(;Wt(H[le],Pt)>0;)le--}0===Wt(H[at],Pt)?St(H,at,le):St(H,++le,j),le<=et&&(at=le+1),et<=le&&(j=le-1)}}(Z,it,$||0,tt||Z.length-1,X||dt)}function St(Z,it,$){var tt=Z[it];Z[it]=Z[$],Z[$]=tt}function dt(Z,it){return Z<it?-1:Z>it?1:0}var Tt=function(Z){void 0===Z&&(Z=9),this._maxEntries=Math.max(4,Z),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function s(Z,it,$){if(!$)return it.indexOf(Z);for(var tt=0;tt<it.length;tt++)if($(Z,it[tt]))return tt;return-1}function lt(Z,it){ht(Z,0,Z.children.length,it,Z)}function ht(Z,it,$,tt,X){X||(X=Yt(null)),X.minX=1/0,X.minY=1/0,X.maxX=-1/0,X.maxY=-1/0;for(var rt=it;rt<$;rt++){var H=Z.children[rt];Lt(X,Z.leaf?tt(H):H)}return X}function Lt(Z,it){return Z.minX=Math.min(Z.minX,it.minX),Z.minY=Math.min(Z.minY,it.minY),Z.maxX=Math.max(Z.maxX,it.maxX),Z.maxY=Math.max(Z.maxY,it.maxY),Z}function Nt(Z,it){return Z.minX-it.minX}function $t(Z,it){return Z.minY-it.minY}function qt(Z){return(Z.maxX-Z.minX)*(Z.maxY-Z.minY)}function _e(Z){return Z.maxX-Z.minX+(Z.maxY-Z.minY)}function yt(Z,it){return Z.minX<=it.minX&&Z.minY<=it.minY&&it.maxX<=Z.maxX&&it.maxY<=Z.maxY}function xt(Z,it){return it.minX<=Z.maxX&&it.minY<=Z.maxY&&it.maxX>=Z.minX&&it.maxY>=Z.minY}function Yt(Z){return{children:Z,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function ge(Z,it,$,tt,X){for(var rt=[it,$];rt.length;)if(!(($=rt.pop())-(it=rt.pop())<=tt)){var H=it+Math.ceil(($-it)/tt/2)*tt;he(Z,H,it,$,X),rt.push(it,H,H,$)}}return Tt.prototype.all=function(){return this._all(this.data,[])},Tt.prototype.search=function(Z){var it=this.data,$=[];if(!xt(Z,it))return $;for(var tt=this.toBBox,X=[];it;){for(var rt=0;rt<it.children.length;rt++){var H=it.children[rt],et=it.leaf?tt(H):H;xt(Z,et)&&(it.leaf?$.push(H):yt(Z,et)?this._all(H,$):X.push(H))}it=X.pop()}return $},Tt.prototype.collides=function(Z){var it=this.data;if(!xt(Z,it))return!1;for(var $=[];it;){for(var tt=0;tt<it.children.length;tt++){var X=it.children[tt],rt=it.leaf?this.toBBox(X):X;if(xt(Z,rt)){if(it.leaf||yt(Z,rt))return!0;$.push(X)}}it=$.pop()}return!1},Tt.prototype.load=function(Z){if(!Z||!Z.length)return this;if(Z.length<this._minEntries){for(var it=0;it<Z.length;it++)this.insert(Z[it]);return this}var $=this._build(Z.slice(),0,Z.length-1,0);if(this.data.children.length)if(this.data.height===$.height)this._splitRoot(this.data,$);else{if(this.data.height<$.height){var tt=this.data;this.data=$,$=tt}this._insert($,this.data.height-$.height-1,!0)}else this.data=$;return this},Tt.prototype.insert=function(Z){return Z&&this._insert(Z,this.data.height-1),this},Tt.prototype.clear=function(){return this.data=Yt([]),this},Tt.prototype.remove=function(Z,it){if(!Z)return this;for(var $,tt,X,rt=this.data,H=this.toBBox(Z),et=[],at=[];rt||et.length;){if(rt||(rt=et.pop(),tt=et[et.length-1],$=at.pop(),X=!0),rt.leaf){var j=s(Z,rt.children,it);if(-1!==j)return rt.children.splice(j,1),et.push(rt),this._condense(et),this}X||rt.leaf||!yt(rt,H)?tt?($++,rt=tt.children[$],X=!1):rt=null:(et.push(rt),at.push($),$=0,tt=rt,rt=rt.children[0])}return this},Tt.prototype.toBBox=function(Z){return Z},Tt.prototype.compareMinX=function(Z,it){return Z.minX-it.minX},Tt.prototype.compareMinY=function(Z,it){return Z.minY-it.minY},Tt.prototype.toJSON=function(){return this.data},Tt.prototype.fromJSON=function(Z){return this.data=Z,this},Tt.prototype._all=function(Z,it){for(var $=[];Z;)Z.leaf?it.push.apply(it,Z.children):$.push.apply($,Z.children),Z=$.pop();return it},Tt.prototype._build=function(Z,it,$,tt){var X,rt=$-it+1,H=this._maxEntries;if(rt<=H)return lt(X=Yt(Z.slice(it,$+1)),this.toBBox),X;tt||(tt=Math.ceil(Math.log(rt)/Math.log(H)),H=Math.ceil(rt/Math.pow(H,tt-1))),(X=Yt([])).leaf=!1,X.height=tt;var et=Math.ceil(rt/H),at=et*Math.ceil(Math.sqrt(H));ge(Z,it,$,at,this.compareMinX);for(var j=it;j<=$;j+=at){var Wt=Math.min(j+at-1,$);ge(Z,j,Wt,et,this.compareMinY);for(var Ct=j;Ct<=Wt;Ct+=et){var kt=Math.min(Ct+et-1,Wt);X.children.push(this._build(Z,Ct,kt,tt-1))}}return lt(X,this.toBBox),X},Tt.prototype._chooseSubtree=function(Z,it,$,tt){for(;tt.push(it),!it.leaf&&tt.length-1!==$;){for(var X=1/0,rt=1/0,H=void 0,et=0;et<it.children.length;et++){var at=it.children[et],j=qt(at),Wt=(Ct=Z,kt=at,(Math.max(kt.maxX,Ct.maxX)-Math.min(kt.minX,Ct.minX))*(Math.max(kt.maxY,Ct.maxY)-Math.min(kt.minY,Ct.minY))-j);Wt<rt?(rt=Wt,X=j<X?j:X,H=at):Wt===rt&&j<X&&(X=j,H=at)}it=H||it.children[0]}var Ct,kt;return it},Tt.prototype._insert=function(Z,it,$){var tt=$?Z:this.toBBox(Z),X=[],rt=this._chooseSubtree(tt,this.data,it,X);for(rt.children.push(Z),Lt(rt,tt);it>=0&&X[it].children.length>this._maxEntries;)this._split(X,it),it--;this._adjustParentBBoxes(tt,X,it)},Tt.prototype._split=function(Z,it){var $=Z[it],tt=$.children.length,X=this._minEntries;this._chooseSplitAxis($,X,tt);var rt=this._chooseSplitIndex($,X,tt),H=Yt($.children.splice(rt,$.children.length-rt));H.height=$.height,H.leaf=$.leaf,lt($,this.toBBox),lt(H,this.toBBox),it?Z[it-1].children.push(H):this._splitRoot($,H)},Tt.prototype._splitRoot=function(Z,it){this.data=Yt([Z,it]),this.data.height=Z.height+1,this.data.leaf=!1,lt(this.data,this.toBBox)},Tt.prototype._chooseSplitIndex=function(Z,it,$){for(var tt,X,rt,H,et,at,j,Wt=1/0,Ct=1/0,kt=it;kt<=$-it;kt++){var gt=ht(Z,0,kt,this.toBBox),Fe=ht(Z,kt,$,this.toBBox),Ie=(X=gt,rt=Fe,void 0,void 0,void 0,void 0,H=Math.max(X.minX,rt.minX),et=Math.max(X.minY,rt.minY),at=Math.min(X.maxX,rt.maxX),j=Math.min(X.maxY,rt.maxY),Math.max(0,at-H)*Math.max(0,j-et)),It=qt(gt)+qt(Fe);Ie<Wt?(Wt=Ie,tt=kt,Ct=It<Ct?It:Ct):Ie===Wt&&It<Ct&&(Ct=It,tt=kt)}return tt||$-it},Tt.prototype._chooseSplitAxis=function(Z,it,$){var tt=Z.leaf?this.compareMinX:Nt,X=Z.leaf?this.compareMinY:$t;this._allDistMargin(Z,it,$,tt)<this._allDistMargin(Z,it,$,X)&&Z.children.sort(tt)},Tt.prototype._allDistMargin=function(Z,it,$,tt){Z.children.sort(tt);for(var X=this.toBBox,rt=ht(Z,0,it,X),H=ht(Z,$-it,$,X),et=_e(rt)+_e(H),at=it;at<$-it;at++){var j=Z.children[at];Lt(rt,Z.leaf?X(j):j),et+=_e(rt)}for(var Wt=$-it-1;Wt>=it;Wt--){var Ct=Z.children[Wt];Lt(H,Z.leaf?X(Ct):Ct),et+=_e(H)}return et},Tt.prototype._adjustParentBBoxes=function(Z,it,$){for(var tt=$;tt>=0;tt--)Lt(it[tt],Z)},Tt.prototype._condense=function(Z){for(var it=Z.length-1,$=void 0;it>=0;it--)0===Z[it].children.length?it>0?($=Z[it-1].children).splice($.indexOf(Z[it]),1):this.clear():lt(Z[it],this.toBBox)},Tt}()},6952:(tr,he,St)=>{var dt=St(1356),Tt=St(3407),s=St(2e3),lt=St(2342),ht=St(9235),Lt=St(2374),Nt=Date.prototype.getTime;function qt(xt){return null==xt}function _e(xt){return!(!xt||"object"!=typeof xt||"number"!=typeof xt.length||"function"!=typeof xt.copy||"function"!=typeof xt.slice||xt.length>0&&"number"!=typeof xt[0])}tr.exports=function $t(xt,Yt,ge){var Z=ge||{};return!!(Z.strict?s(xt,Yt):xt===Yt)||(!xt||!Yt||"object"!=typeof xt&&"object"!=typeof Yt?Z.strict?s(xt,Yt):xt==Yt:function yt(xt,Yt,ge){var Z,it;if(typeof xt!=typeof Yt||qt(xt)||qt(Yt)||xt.prototype!==Yt.prototype||Tt(xt)!==Tt(Yt))return!1;var $=lt(xt),tt=lt(Yt);if($!==tt)return!1;if($||tt)return xt.source===Yt.source&&ht(xt)===ht(Yt);if(Lt(xt)&&Lt(Yt))return Nt.call(xt)===Nt.call(Yt);var X=_e(xt),rt=_e(Yt);if(X!==rt)return!1;if(X||rt){if(xt.length!==Yt.length)return!1;for(Z=0;Z<xt.length;Z++)if(xt[Z]!==Yt[Z])return!1;return!0}if(typeof xt!=typeof Yt)return!1;try{var H=dt(xt),et=dt(Yt)}catch{return!1}if(H.length!==et.length)return!1;for(H.sort(),et.sort(),Z=H.length-1;Z>=0;Z--)if(H[Z]!=et[Z])return!1;for(Z=H.length-1;Z>=0;Z--)if(!$t(xt[it=H[Z]],Yt[it],ge))return!1;return!0}(xt,Yt,Z))}},2358:(tr,he,St)=>{"use strict";var dt=St(1356),Tt="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),s=Object.prototype.toString,lt=Array.prototype.concat,ht=Object.defineProperty,Nt=St(7027)(),$t=ht&&Nt,qt=function(yt,xt,Yt,ge){xt in yt&&(!function(yt){return"function"==typeof yt&&"[object Function]"===s.call(yt)}(ge)||!ge())||($t?ht(yt,xt,{configurable:!0,enumerable:!1,value:Yt,writable:!0}):yt[xt]=Yt)},_e=function(yt,xt){var Yt=arguments.length>2?arguments[2]:{},ge=dt(xt);Tt&&(ge=lt.call(ge,Object.getOwnPropertySymbols(xt)));for(var Z=0;Z<ge.length;Z+=1)qt(yt,ge[Z],xt[ge[Z]],Yt[ge[Z]])};_e.supportsDescriptors=!!$t,tr.exports=_e},1817:tr=>{function he(St,dt,Tt,s){this.dataset=[],this.epsilon=1,this.minPts=2,this.distance=this._euclideanDistance,this.clusters=[],this.noise=[],this._visited=[],this._assigned=[],this._datasetLength=0,this._init(St,dt,Tt,s)}he.prototype.run=function(St,dt,Tt,s){this._init(St,dt,Tt,s);for(var lt=0;lt<this._datasetLength;lt++)if(1!==this._visited[lt]){this._visited[lt]=1;var ht=this._regionQuery(lt);if(ht.length<this.minPts)this.noise.push(lt);else{var Lt=this.clusters.length;this.clusters.push([]),this._addToCluster(lt,Lt),this._expandCluster(Lt,ht)}}return this.clusters},he.prototype._init=function(St,dt,Tt,s){if(St){if(!(St instanceof Array))throw Error("Dataset must be of type array, "+typeof St+" given");this.dataset=St,this.clusters=[],this.noise=[],this._datasetLength=St.length,this._visited=new Array(this._datasetLength),this._assigned=new Array(this._datasetLength)}dt&&(this.epsilon=dt),Tt&&(this.minPts=Tt),s&&(this.distance=s)},he.prototype._expandCluster=function(St,dt){for(var Tt=0;Tt<dt.length;Tt++){var s=dt[Tt];if(1!==this._visited[s]){this._visited[s]=1;var lt=this._regionQuery(s);lt.length>=this.minPts&&(dt=this._mergeArrays(dt,lt))}1!==this._assigned[s]&&this._addToCluster(s,St)}},he.prototype._addToCluster=function(St,dt){this.clusters[dt].push(St),this._assigned[St]=1},he.prototype._regionQuery=function(St){for(var dt=[],Tt=0;Tt<this._datasetLength;Tt++)this.distance(this.dataset[St],this.dataset[Tt])<this.epsilon&&dt.push(Tt);return dt},he.prototype._mergeArrays=function(St,dt){for(var Tt=dt.length,s=0;s<Tt;s++){var lt=dt[s];St.indexOf(lt)<0&&St.push(lt)}return St},he.prototype._euclideanDistance=function(St,dt){for(var Tt=0,s=Math.min(St.length,dt.length);s--;)Tt+=(St[s]-dt[s])*(St[s]-dt[s]);return Math.sqrt(Tt)},tr.exports&&(tr.exports=he)},4273:tr=>{function he(St,dt,Tt){this.k=3,this.dataset=[],this.assignments=[],this.centroids=[],this.init(St,dt,Tt)}he.prototype.init=function(St,dt,Tt){this.assignments=[],this.centroids=[],typeof St<"u"&&(this.dataset=St),typeof dt<"u"&&(this.k=dt),typeof Tt<"u"&&(this.distance=Tt)},he.prototype.run=function(St,dt){this.init(St,dt);for(var Tt=this.dataset.length,s=0;s<this.k;s++)this.centroids[s]=this.randomCentroid();for(var lt=!0;lt;){lt=this.assign();for(var ht=0;ht<this.k;ht++){for(var Lt=new Array(_e),Nt=0,$t=0;$t<_e;$t++)Lt[$t]=0;for(var qt=0;qt<Tt;qt++){var _e=this.dataset[qt].length;if(ht===this.assignments[qt]){for($t=0;$t<_e;$t++)Lt[$t]+=this.dataset[qt][$t];Nt++}}if(Nt>0){for($t=0;$t<_e;$t++)Lt[$t]/=Nt;this.centroids[ht]=Lt}else this.centroids[ht]=this.randomCentroid(),lt=!0}}return this.getClusters()},he.prototype.randomCentroid=function(){var dt,Tt,St=this.dataset.length-1;do{Tt=Math.round(Math.random()*St),dt=this.dataset[Tt]}while(this.centroids.indexOf(dt)>=0);return dt},he.prototype.assign=function(){for(var Tt,St=!1,dt=this.dataset.length,s=0;s<dt;s++)(Tt=this.argmin(this.dataset[s],this.centroids,this.distance))!=this.assignments[s]&&(this.assignments[s]=Tt,St=!0);return St},he.prototype.getClusters=function(){for(var dt,St=new Array(this.k),Tt=0;Tt<this.assignments.length;Tt++)typeof St[dt=this.assignments[Tt]]>"u"&&(St[dt]=[]),St[dt].push(Tt);return St},he.prototype.argmin=function(St,dt,Tt){for(var Lt,s=Number.MAX_VALUE,lt=0,ht=dt.length,Nt=0;Nt<ht;Nt++)(Lt=Tt(St,dt[Nt]))<s&&(s=Lt,lt=Nt);return lt},he.prototype.distance=function(St,dt){for(var Tt=0,s=Math.min(St.length,dt.length);s--;){var lt=St[s]-dt[s];Tt+=lt*lt}return Math.sqrt(Tt)},tr.exports&&(tr.exports=he)},8680:(tr,he,St)=>{if(tr.exports)var dt=St(8759);function Tt(s,lt,ht,Lt){this.epsilon=1,this.minPts=1,this.distance=this._euclideanDistance,this._reachability=[],this._processed=[],this._coreDistance=0,this._orderedList=[],this._init(s,lt,ht,Lt)}Tt.prototype.run=function(s,lt,ht,Lt){this._init(s,lt,ht,Lt);for(var Nt=0,$t=this.dataset.length;Nt<$t;Nt++)if(1!==this._processed[Nt]){this._processed[Nt]=1,this.clusters.push([Nt]);var qt=this.clusters.length-1;this._orderedList.push(Nt);var _e=new dt(null,null,"asc"),yt=this._regionQuery(Nt);void 0!==this._distanceToCore(Nt)&&(this._updateQueue(Nt,yt,_e),this._expandCluster(qt,_e))}return this.clusters},Tt.prototype.getReachabilityPlot=function(){for(var s=[],lt=0,ht=this._orderedList.length;lt<ht;lt++){var Lt=this._orderedList[lt];s.push([Lt,this._reachability[Lt]])}return s},Tt.prototype._init=function(s,lt,ht,Lt){if(s){if(!(s instanceof Array))throw Error("Dataset must be of type array, "+typeof s+" given");this.dataset=s,this.clusters=[],this._reachability=new Array(this.dataset.length),this._processed=new Array(this.dataset.length),this._coreDistance=0,this._orderedList=[]}lt&&(this.epsilon=lt),ht&&(this.minPts=ht),Lt&&(this.distance=Lt)},Tt.prototype._updateQueue=function(s,lt,ht){var Lt=this;this._coreDistance=this._distanceToCore(s),lt.forEach(function(Nt){if(void 0===Lt._processed[Nt]){var $t=Lt.distance(Lt.dataset[s],Lt.dataset[Nt]),qt=Math.max(Lt._coreDistance,$t);void 0===Lt._reachability[Nt]?(Lt._reachability[Nt]=qt,ht.insert(Nt,qt)):qt<Lt._reachability[Nt]&&(Lt._reachability[Nt]=qt,ht.remove(Nt),ht.insert(Nt,qt))}})},Tt.prototype._expandCluster=function(s,lt){for(var ht=lt.getElements(),Lt=0,Nt=ht.length;Lt<Nt;Lt++){var $t=ht[Lt];if(void 0===this._processed[$t]){var qt=this._regionQuery($t);this._processed[$t]=1,this.clusters[s].push($t),this._orderedList.push($t),void 0!==this._distanceToCore($t)&&(this._updateQueue($t,qt,lt),this._expandCluster(s,lt))}}},Tt.prototype._distanceToCore=function(s){for(var lt=this.epsilon,ht=0;ht<lt;ht++)if(this._regionQuery(s,ht).length>=this.minPts)return ht},Tt.prototype._regionQuery=function(s,lt){lt=lt||this.epsilon;for(var ht=[],Lt=0,Nt=this.dataset.length;Lt<Nt;Lt++)this.distance(this.dataset[s],this.dataset[Lt])<lt&&ht.push(Lt);return ht},Tt.prototype._euclideanDistance=function(s,lt){for(var ht=0,Lt=Math.min(s.length,lt.length);Lt--;)ht+=(s[Lt]-lt[Lt])*(s[Lt]-lt[Lt]);return Math.sqrt(ht)},tr.exports&&(tr.exports=Tt)},8759:tr=>{function he(St,dt,Tt){this._queue=[],this._priorities=[],this._sorting="desc",this._init(St,dt,Tt)}he.prototype.insert=function(St,dt){for(var Tt=this._queue.length,s=Tt;s--;){var lt=this._priorities[s];"desc"===this._sorting?dt>lt&&(Tt=s):dt<lt&&(Tt=s)}this._insertAt(St,dt,Tt)},he.prototype.remove=function(St){for(var dt=this._queue.length;dt--;)if(St===this._queue[dt]){this._queue.splice(dt,1),this._priorities.splice(dt,1);break}},he.prototype.forEach=function(St){this._queue.forEach(St)},he.prototype.getElements=function(){return this._queue},he.prototype.getElementPriority=function(St){return this._priorities[St]},he.prototype.getPriorities=function(){return this._priorities},he.prototype.getElementsWithPriorities=function(){for(var St=[],dt=0,Tt=this._queue.length;dt<Tt;dt++)St.push([this._queue[dt],this._priorities[dt]]);return St},he.prototype._init=function(St,dt,Tt){if(St&&dt){if(this._queue=[],this._priorities=[],St.length!==dt.length)throw new Error("Arrays must have the same length");for(var s=0;s<St.length;s++)this.insert(St[s],dt[s])}Tt&&(this._sorting=Tt)},he.prototype._insertAt=function(St,dt,Tt){this._queue.length===Tt?(this._queue.push(St),this._priorities.push(dt)):(this._queue.splice(Tt,0,St),this._priorities.splice(Tt,0,dt))},tr.exports&&(tr.exports=he)},7470:(tr,he,St)=>{tr.exports&&(tr.exports={DBSCAN:St(1817),KMEANS:St(4273),OPTICS:St(8680),PriorityQueue:St(8759)})},5469:tr=>{"use strict";function he(It,pe,Pt){Pt=Pt||2;var ze,ar,Me,Mr,lr,kr,Xr,te=pe&&pe.length,le=te?pe[0]*Pt:It.length,Ot=St(It,0,le,Pt,!0),Ue=[];if(!Ot||Ot.next===Ot.prev)return Ue;if(te&&(Ot=function Nt(It,pe,Pt,te){var Ot,Ue,Me,le=[];for(Ot=0,Ue=pe.length;Ot<Ue;Ot++)(Me=St(It,pe[Ot]*te,Ot<Ue-1?pe[Ot+1]*te:It.length,te,!1))===Me.next&&(Me.steiner=!0),le.push(Z(Me));for(le.sort($t),Ot=0;Ot<le.length;Ot++)Pt=qt(le[Ot],Pt);return Pt}(It,pe,Ot,Pt)),It.length>80*Pt){ze=Me=It[0],ar=Mr=It[1];for(var Sr=Pt;Sr<le;Sr+=Pt)(lr=It[Sr])<ze&&(ze=lr),(kr=It[Sr+1])<ar&&(ar=kr),lr>Me&&(Me=lr),kr>Mr&&(Mr=kr);Xr=0!==(Xr=Math.max(Me-ze,Mr-ar))?32767/Xr:0}return Tt(Ot,Ue,Pt,ze,ar,Xr,0),Ue}function St(It,pe,Pt,te,le){var Ot,Ue;if(le===Ie(It,pe,Pt,te)>0)for(Ot=pe;Ot<Pt;Ot+=te)Ue=kt(Ot,It[Ot],It[Ot+1],Ue);else for(Ot=Pt-te;Ot>=pe;Ot-=te)Ue=kt(Ot,It[Ot],It[Ot+1],Ue);return Ue&&X(Ue,Ue.next)&&(gt(Ue),Ue=Ue.next),Ue}function dt(It,pe){if(!It)return It;pe||(pe=It);var te,Pt=It;do{if(te=!1,Pt.steiner||!X(Pt,Pt.next)&&0!==tt(Pt.prev,Pt,Pt.next))Pt=Pt.next;else{if(gt(Pt),(Pt=pe=Pt.prev)===Pt.next)break;te=!0}}while(te||Pt!==pe);return pe}function Tt(It,pe,Pt,te,le,Ot,Ue){if(It){!Ue&&Ot&&function xt(It,pe,Pt,te){var le=It;do{0===le.z&&(le.z=ge(le.x,le.y,pe,Pt,te)),le.prevZ=le.prev,le.nextZ=le.next,le=le.next}while(le!==It);le.prevZ.nextZ=null,le.prevZ=null,function Yt(It){var pe,Pt,te,le,Ot,Ue,ze,ar,Me=1;do{for(Pt=It,It=null,Ot=null,Ue=0;Pt;){for(Ue++,te=Pt,ze=0,pe=0;pe<Me&&(ze++,te=te.nextZ);pe++);for(ar=Me;ze>0||ar>0&&te;)0!==ze&&(0===ar||!te||Pt.z<=te.z)?(le=Pt,Pt=Pt.nextZ,ze--):(le=te,te=te.nextZ,ar--),Ot?Ot.nextZ=le:It=le,le.prevZ=Ot,Ot=le;Pt=te}Ot.nextZ=null,Me*=2}while(Ue>1)}(le)}(It,te,le,Ot);for(var ar,Me,ze=It;It.prev!==It.next;)if(ar=It.prev,Me=It.next,Ot?lt(It,te,le,Ot):s(It))pe.push(ar.i/Pt|0),pe.push(It.i/Pt|0),pe.push(Me.i/Pt|0),gt(It),It=Me.next,ze=Me.next;else if((It=Me)===ze){Ue?1===Ue?Tt(It=ht(dt(It),pe,Pt),pe,Pt,te,le,Ot,2):2===Ue&&Lt(It,pe,Pt,te,le,Ot):Tt(dt(It),pe,Pt,te,le,Ot,1);break}}}function s(It){var pe=It.prev,Pt=It,te=It.next;if(tt(pe,Pt,te)>=0)return!1;for(var le=pe.x,Ot=Pt.x,Ue=te.x,ze=pe.y,ar=Pt.y,Me=te.y,Mr=le<Ot?le<Ue?le:Ue:Ot<Ue?Ot:Ue,lr=ze<ar?ze<Me?ze:Me:ar<Me?ar:Me,kr=le>Ot?le>Ue?le:Ue:Ot>Ue?Ot:Ue,Xr=ze>ar?ze>Me?ze:Me:ar>Me?ar:Me,Sr=te.next;Sr!==pe;){if(Sr.x>=Mr&&Sr.x<=kr&&Sr.y>=lr&&Sr.y<=Xr&&it(le,ze,Ot,ar,Ue,Me,Sr.x,Sr.y)&&tt(Sr.prev,Sr,Sr.next)>=0)return!1;Sr=Sr.next}return!0}function lt(It,pe,Pt,te){var le=It.prev,Ot=It,Ue=It.next;if(tt(le,Ot,Ue)>=0)return!1;for(var ze=le.x,ar=Ot.x,Me=Ue.x,Mr=le.y,lr=Ot.y,kr=Ue.y,Xr=ze<ar?ze<Me?ze:Me:ar<Me?ar:Me,Sr=Mr<lr?Mr<kr?Mr:kr:lr<kr?lr:kr,qe=ze>ar?ze>Me?ze:Me:ar>Me?ar:Me,ti=Mr>lr?Mr>kr?Mr:kr:lr>kr?lr:kr,vn=ge(Xr,Sr,pe,Pt,te),Un=ge(qe,ti,pe,Pt,te),ae=It.prevZ,Ve=It.nextZ;ae&&ae.z>=vn&&Ve&&Ve.z<=Un;){if(ae.x>=Xr&&ae.x<=qe&&ae.y>=Sr&&ae.y<=ti&&ae!==le&&ae!==Ue&&it(ze,Mr,ar,lr,Me,kr,ae.x,ae.y)&&tt(ae.prev,ae,ae.next)>=0||(ae=ae.prevZ,Ve.x>=Xr&&Ve.x<=qe&&Ve.y>=Sr&&Ve.y<=ti&&Ve!==le&&Ve!==Ue&&it(ze,Mr,ar,lr,Me,kr,Ve.x,Ve.y)&&tt(Ve.prev,Ve,Ve.next)>=0))return!1;Ve=Ve.nextZ}for(;ae&&ae.z>=vn;){if(ae.x>=Xr&&ae.x<=qe&&ae.y>=Sr&&ae.y<=ti&&ae!==le&&ae!==Ue&&it(ze,Mr,ar,lr,Me,kr,ae.x,ae.y)&&tt(ae.prev,ae,ae.next)>=0)return!1;ae=ae.prevZ}for(;Ve&&Ve.z<=Un;){if(Ve.x>=Xr&&Ve.x<=qe&&Ve.y>=Sr&&Ve.y<=ti&&Ve!==le&&Ve!==Ue&&it(ze,Mr,ar,lr,Me,kr,Ve.x,Ve.y)&&tt(Ve.prev,Ve,Ve.next)>=0)return!1;Ve=Ve.nextZ}return!0}function ht(It,pe,Pt){var te=It;do{var le=te.prev,Ot=te.next.next;!X(le,Ot)&&rt(le,te,te.next,Ot)&&j(le,Ot)&&j(Ot,le)&&(pe.push(le.i/Pt|0),pe.push(te.i/Pt|0),pe.push(Ot.i/Pt|0),gt(te),gt(te.next),te=It=Ot),te=te.next}while(te!==It);return dt(te)}function Lt(It,pe,Pt,te,le,Ot){var Ue=It;do{for(var ze=Ue.next.next;ze!==Ue.prev;){if(Ue.i!==ze.i&&$(Ue,ze)){var ar=Ct(Ue,ze);return Ue=dt(Ue,Ue.next),ar=dt(ar,ar.next),Tt(Ue,pe,Pt,te,le,Ot,0),void Tt(ar,pe,Pt,te,le,Ot,0)}ze=ze.next}Ue=Ue.next}while(Ue!==It)}function $t(It,pe){return It.x-pe.x}function qt(It,pe){var Pt=function _e(It,pe){var Ue,Pt=pe,te=It.x,le=It.y,Ot=-1/0;do{if(le<=Pt.y&&le>=Pt.next.y&&Pt.next.y!==Pt.y){var ze=Pt.x+(le-Pt.y)*(Pt.next.x-Pt.x)/(Pt.next.y-Pt.y);if(ze<=te&&ze>Ot&&(Ot=ze,Ue=Pt.x<Pt.next.x?Pt:Pt.next,ze===te))return Ue}Pt=Pt.next}while(Pt!==pe);if(!Ue)return null;var kr,ar=Ue,Me=Ue.x,Mr=Ue.y,lr=1/0;Pt=Ue;do{te>=Pt.x&&Pt.x>=Me&&te!==Pt.x&&it(le<Mr?te:Ot,le,Me,Mr,le<Mr?Ot:te,le,Pt.x,Pt.y)&&(kr=Math.abs(le-Pt.y)/(te-Pt.x),j(Pt,It)&&(kr<lr||kr===lr&&(Pt.x>Ue.x||Pt.x===Ue.x&&yt(Ue,Pt)))&&(Ue=Pt,lr=kr)),Pt=Pt.next}while(Pt!==ar);return Ue}(It,pe);if(!Pt)return pe;var te=Ct(Pt,It);return dt(te,te.next),dt(Pt,Pt.next)}function yt(It,pe){return tt(It.prev,It,pe.prev)<0&&tt(pe.next,It,It.next)<0}function ge(It,pe,Pt,te,le){return(It=1431655765&((It=858993459&((It=252645135&((It=16711935&((It=(It-Pt)*le|0)|It<<8))|It<<4))|It<<2))|It<<1))|(pe=1431655765&((pe=858993459&((pe=252645135&((pe=16711935&((pe=(pe-te)*le|0)|pe<<8))|pe<<4))|pe<<2))|pe<<1))<<1}function Z(It){var pe=It,Pt=It;do{(pe.x<Pt.x||pe.x===Pt.x&&pe.y<Pt.y)&&(Pt=pe),pe=pe.next}while(pe!==It);return Pt}function it(It,pe,Pt,te,le,Ot,Ue,ze){return(le-Ue)*(pe-ze)>=(It-Ue)*(Ot-ze)&&(It-Ue)*(te-ze)>=(Pt-Ue)*(pe-ze)&&(Pt-Ue)*(Ot-ze)>=(le-Ue)*(te-ze)}function $(It,pe){return It.next.i!==pe.i&&It.prev.i!==pe.i&&!function at(It,pe){var Pt=It;do{if(Pt.i!==It.i&&Pt.next.i!==It.i&&Pt.i!==pe.i&&Pt.next.i!==pe.i&&rt(Pt,Pt.next,It,pe))return!0;Pt=Pt.next}while(Pt!==It);return!1}(It,pe)&&(j(It,pe)&&j(pe,It)&&function Wt(It,pe){var Pt=It,te=!1,le=(It.x+pe.x)/2,Ot=(It.y+pe.y)/2;do{Pt.y>Ot!=Pt.next.y>Ot&&Pt.next.y!==Pt.y&&le<(Pt.next.x-Pt.x)*(Ot-Pt.y)/(Pt.next.y-Pt.y)+Pt.x&&(te=!te),Pt=Pt.next}while(Pt!==It);return te}(It,pe)&&(tt(It.prev,It,pe.prev)||tt(It,pe.prev,pe))||X(It,pe)&&tt(It.prev,It,It.next)>0&&tt(pe.prev,pe,pe.next)>0)}function tt(It,pe,Pt){return(pe.y-It.y)*(Pt.x-pe.x)-(pe.x-It.x)*(Pt.y-pe.y)}function X(It,pe){return It.x===pe.x&&It.y===pe.y}function rt(It,pe,Pt,te){var le=et(tt(It,pe,Pt)),Ot=et(tt(It,pe,te)),Ue=et(tt(Pt,te,It)),ze=et(tt(Pt,te,pe));return!!(le!==Ot&&Ue!==ze||0===le&&H(It,Pt,pe)||0===Ot&&H(It,te,pe)||0===Ue&&H(Pt,It,te)||0===ze&&H(Pt,pe,te))}function H(It,pe,Pt){return pe.x<=Math.max(It.x,Pt.x)&&pe.x>=Math.min(It.x,Pt.x)&&pe.y<=Math.max(It.y,Pt.y)&&pe.y>=Math.min(It.y,Pt.y)}function et(It){return It>0?1:It<0?-1:0}function j(It,pe){return tt(It.prev,It,It.next)<0?tt(It,pe,It.next)>=0&&tt(It,It.prev,pe)>=0:tt(It,pe,It.prev)<0||tt(It,It.next,pe)<0}function Ct(It,pe){var Pt=new Fe(It.i,It.x,It.y),te=new Fe(pe.i,pe.x,pe.y),le=It.next,Ot=pe.prev;return It.next=pe,pe.prev=It,Pt.next=le,le.prev=Pt,te.next=Pt,Pt.prev=te,Ot.next=te,te.prev=Ot,te}function kt(It,pe,Pt,te){var le=new Fe(It,pe,Pt);return te?(le.next=te.next,le.prev=te,te.next.prev=le,te.next=le):(le.prev=le,le.next=le),le}function gt(It){It.next.prev=It.prev,It.prev.next=It.next,It.prevZ&&(It.prevZ.nextZ=It.nextZ),It.nextZ&&(It.nextZ.prevZ=It.prevZ)}function Fe(It,pe,Pt){this.i=It,this.x=pe,this.y=Pt,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Ie(It,pe,Pt,te){for(var le=0,Ot=pe,Ue=Pt-te;Ot<Pt;Ot+=te)le+=(It[Ue]-It[Ot])*(It[Ot+1]+It[Ue+1]),Ue=Ot;return le}tr.exports=he,tr.exports.default=he,he.deviation=function(It,pe,Pt,te){var le=pe&&pe.length,Ue=Math.abs(Ie(It,0,le?pe[0]*Pt:It.length,Pt));if(le)for(var ze=0,ar=pe.length;ze<ar;ze++)Ue-=Math.abs(Ie(It,pe[ze]*Pt,ze<ar-1?pe[ze+1]*Pt:It.length,Pt));var lr=0;for(ze=0;ze<te.length;ze+=3){var kr=te[ze]*Pt,Xr=te[ze+1]*Pt,Sr=te[ze+2]*Pt;lr+=Math.abs((It[kr]-It[Sr])*(It[Xr+1]-It[kr+1])-(It[kr]-It[Xr])*(It[Sr+1]-It[kr+1]))}return 0===Ue&&0===lr?0:Math.abs((lr-Ue)/Ue)},he.flatten=function(It){for(var pe=It[0][0].length,Pt={vertices:[],holes:[],dimensions:pe},te=0,le=0;le<It.length;le++){for(var Ot=0;Ot<It[le].length;Ot++)for(var Ue=0;Ue<pe;Ue++)Pt.vertices.push(It[le][Ot][Ue]);le>0&&Pt.holes.push(te+=It[le-1].length)}return Pt}},9069:tr=>{"use strict";var dt,he="object"==typeof Reflect?Reflect:null,St=he&&"function"==typeof he.apply?he.apply:function(rt,H,et){return Function.prototype.apply.call(rt,H,et)};dt=he&&"function"==typeof he.ownKeys?he.ownKeys:Object.getOwnPropertySymbols?function(rt){return Object.getOwnPropertyNames(rt).concat(Object.getOwnPropertySymbols(rt))}:function(rt){return Object.getOwnPropertyNames(rt)};var s=Number.isNaN||function(rt){return rt!=rt};function lt(){lt.init.call(this)}tr.exports=lt,tr.exports.once=function it(X,rt){return new Promise(function(H,et){function at(Wt){X.removeListener(rt,j),et(Wt)}function j(){"function"==typeof X.removeListener&&X.removeListener("error",at),H([].slice.call(arguments))}tt(X,rt,j,{once:!0}),"error"!==rt&&function $(X,rt,H){"function"==typeof X.on&&tt(X,"error",rt,H)}(X,at,{once:!0})})},lt.EventEmitter=lt,lt.prototype._events=void 0,lt.prototype._eventsCount=0,lt.prototype._maxListeners=void 0;var ht=10;function Lt(X){if("function"!=typeof X)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof X)}function Nt(X){return void 0===X._maxListeners?lt.defaultMaxListeners:X._maxListeners}function $t(X,rt,H,et){var at,j,Wt;if(Lt(H),void 0===(j=X._events)?(j=X._events=Object.create(null),X._eventsCount=0):(void 0!==j.newListener&&(X.emit("newListener",rt,H.listener?H.listener:H),j=X._events),Wt=j[rt]),void 0===Wt)Wt=j[rt]=H,++X._eventsCount;else if("function"==typeof Wt?Wt=j[rt]=et?[H,Wt]:[Wt,H]:et?Wt.unshift(H):Wt.push(H),(at=Nt(X))>0&&Wt.length>at&&!Wt.warned){Wt.warned=!0;var Ct=new Error("Possible EventEmitter memory leak detected. "+Wt.length+" "+String(rt)+" listeners added. Use emitter.setMaxListeners() to increase limit");Ct.name="MaxListenersExceededWarning",Ct.emitter=X,Ct.type=rt,Ct.count=Wt.length,function Tt(X){console&&console.warn&&console.warn(X)}(Ct)}return X}function qt(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _e(X,rt,H){var et={fired:!1,wrapFn:void 0,target:X,type:rt,listener:H},at=qt.bind(et);return at.listener=H,et.wrapFn=at,at}function yt(X,rt,H){var et=X._events;if(void 0===et)return[];var at=et[rt];return void 0===at?[]:"function"==typeof at?H?[at.listener||at]:[at]:H?function Z(X){for(var rt=new Array(X.length),H=0;H<rt.length;++H)rt[H]=X[H].listener||X[H];return rt}(at):Yt(at,at.length)}function xt(X){var rt=this._events;if(void 0!==rt){var H=rt[X];if("function"==typeof H)return 1;if(void 0!==H)return H.length}return 0}function Yt(X,rt){for(var H=new Array(rt),et=0;et<rt;++et)H[et]=X[et];return H}function tt(X,rt,H,et){if("function"==typeof X.on)et.once?X.once(rt,H):X.on(rt,H);else{if("function"!=typeof X.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof X);X.addEventListener(rt,function at(j){et.once&&X.removeEventListener(rt,at),H(j)})}}Object.defineProperty(lt,"defaultMaxListeners",{enumerable:!0,get:function(){return ht},set:function(X){if("number"!=typeof X||X<0||s(X))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+X+".");ht=X}}),lt.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},lt.prototype.setMaxListeners=function(rt){if("number"!=typeof rt||rt<0||s(rt))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+rt+".");return this._maxListeners=rt,this},lt.prototype.getMaxListeners=function(){return Nt(this)},lt.prototype.emit=function(rt){for(var H=[],et=1;et<arguments.length;et++)H.push(arguments[et]);var at="error"===rt,j=this._events;if(void 0!==j)at=at&&void 0===j.error;else if(!at)return!1;if(at){var Wt;if(H.length>0&&(Wt=H[0]),Wt instanceof Error)throw Wt;var Ct=new Error("Unhandled error."+(Wt?" ("+Wt.message+")":""));throw Ct.context=Wt,Ct}var kt=j[rt];if(void 0===kt)return!1;if("function"==typeof kt)St(kt,this,H);else{var gt=kt.length,Fe=Yt(kt,gt);for(et=0;et<gt;++et)St(Fe[et],this,H)}return!0},lt.prototype.on=lt.prototype.addListener=function(rt,H){return $t(this,rt,H,!1)},lt.prototype.prependListener=function(rt,H){return $t(this,rt,H,!0)},lt.prototype.once=function(rt,H){return Lt(H),this.on(rt,_e(this,rt,H)),this},lt.prototype.prependOnceListener=function(rt,H){return Lt(H),this.prependListener(rt,_e(this,rt,H)),this},lt.prototype.off=lt.prototype.removeListener=function(rt,H){var et,at,j,Wt,Ct;if(Lt(H),void 0===(at=this._events))return this;if(void 0===(et=at[rt]))return this;if(et===H||et.listener===H)0==--this._eventsCount?this._events=Object.create(null):(delete at[rt],at.removeListener&&this.emit("removeListener",rt,et.listener||H));else if("function"!=typeof et){for(j=-1,Wt=et.length-1;Wt>=0;Wt--)if(et[Wt]===H||et[Wt].listener===H){Ct=et[Wt].listener,j=Wt;break}if(j<0)return this;0===j?et.shift():function ge(X,rt){for(;rt+1<X.length;rt++)X[rt]=X[rt+1];X.pop()}(et,j),1===et.length&&(at[rt]=et[0]),void 0!==at.removeListener&&this.emit("removeListener",rt,Ct||H)}return this},lt.prototype.removeAllListeners=function(rt){var H,et,at;if(void 0===(et=this._events))return this;if(void 0===et.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==et[rt]&&(0==--this._eventsCount?this._events=Object.create(null):delete et[rt]),this;if(0===arguments.length){var Wt,j=Object.keys(et);for(at=0;at<j.length;++at)"removeListener"!==(Wt=j[at])&&this.removeAllListeners(Wt);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(H=et[rt]))this.removeListener(rt,H);else if(void 0!==H)for(at=H.length-1;at>=0;at--)this.removeListener(rt,H[at]);return this},lt.prototype.listeners=function(rt){return yt(this,rt,!0)},lt.prototype.rawListeners=function(rt){return yt(this,rt,!1)},lt.listenerCount=function(X,rt){return"function"==typeof X.listenerCount?X.listenerCount(rt):xt.call(X,rt)},lt.prototype.listenerCount=xt,lt.prototype.eventNames=function(){return this._eventsCount>0?dt(this._events):[]}},3457:tr=>{"use strict";var he="Function.prototype.bind called on incompatible ",St=Array.prototype.slice,dt=Object.prototype.toString,Tt="[object Function]";tr.exports=function(lt){var ht=this;if("function"!=typeof ht||dt.call(ht)!==Tt)throw new TypeError(he+ht);for(var Nt,Lt=St.call(arguments,1),$t=function(){if(this instanceof Nt){var Yt=ht.apply(this,Lt.concat(St.call(arguments)));return Object(Yt)===Yt?Yt:this}return ht.apply(lt,Lt.concat(St.call(arguments)))},qt=Math.max(0,ht.length-Lt.length),_e=[],yt=0;yt<qt;yt++)_e.push("$"+yt);if(Nt=Function("binder","return function ("+_e.join(",")+"){ return binder.apply(this,arguments); }")($t),ht.prototype){var xt=function(){};xt.prototype=ht.prototype,Nt.prototype=new xt,xt.prototype=null}return Nt}},4444:(tr,he,St)=>{"use strict";var dt=St(3457);tr.exports=Function.prototype.bind||dt},9582:tr=>{"use strict";var he=function(){return"string"==typeof function(){}.name},St=Object.getOwnPropertyDescriptor;if(St)try{St([],"length")}catch{St=null}he.functionsHaveConfigurableNames=function(){if(!he()||!St)return!1;var s=St(function(){},"name");return!!s&&!!s.configurable};var dt=Function.prototype.bind;he.boundFunctionsHaveNames=function(){return he()&&"function"==typeof dt&&""!==function(){}.bind().name},tr.exports=he},5013:(tr,he,St)=>{var dt=St(6952),Tt=function(Lt){this.precision=Lt&&Lt.precision?Lt.precision:17,this.direction=!(!Lt||!Lt.direction)&&Lt.direction,this.pseudoNode=!(!Lt||!Lt.pseudoNode)&&Lt.pseudoNode,this.objectComparator=Lt&&Lt.objectComparator?Lt.objectComparator:ht};function s(Lt){return Lt.coordinates.map(function(Nt){return{type:Lt.type.replace("Multi",""),coordinates:Nt}})}function lt(Lt,Nt){return Lt.hasOwnProperty("coordinates")?Lt.coordinates.length===Nt.coordinates.length:Lt.length===Nt.length}function ht(Lt,Nt){return dt(Lt,Nt,{strict:!0})}Tt.prototype.compare=function(Lt,Nt){if(Lt.type!==Nt.type||!lt(Lt,Nt))return!1;switch(Lt.type){case"Point":return this.compareCoord(Lt.coordinates,Nt.coordinates);case"LineString":return this.compareLine(Lt.coordinates,Nt.coordinates,0,!1);case"Polygon":return this.comparePolygon(Lt,Nt);case"Feature":return this.compareFeature(Lt,Nt);default:if(0===Lt.type.indexOf("Multi")){var $t=this,qt=s(Lt),_e=s(Nt);return qt.every(function(yt){return this.some(function(xt){return $t.compare(yt,xt)})},_e)}}return!1},Tt.prototype.compareCoord=function(Lt,Nt){if(Lt.length!==Nt.length)return!1;for(var $t=0;$t<Lt.length;$t++)if(Lt[$t].toFixed(this.precision)!==Nt[$t].toFixed(this.precision))return!1;return!0},Tt.prototype.compareLine=function(Lt,Nt,$t,qt){if(!lt(Lt,Nt))return!1;var _e=this.pseudoNode?Lt:this.removePseudo(Lt),yt=this.pseudoNode?Nt:this.removePseudo(Nt);if(!qt||this.compareCoord(_e[0],yt[0])||(yt=this.fixStartIndex(yt,_e))){var xt=this.compareCoord(_e[$t],yt[$t]);return this.direction||xt?this.comparePath(_e,yt):!!this.compareCoord(_e[$t],yt[yt.length-(1+$t)])&&this.comparePath(_e.slice().reverse(),yt)}},Tt.prototype.fixStartIndex=function(Lt,Nt){for(var $t,qt=-1,_e=0;_e<Lt.length;_e++)if(this.compareCoord(Lt[_e],Nt[0])){qt=_e;break}return qt>=0&&($t=[].concat(Lt.slice(qt,Lt.length),Lt.slice(1,qt+1))),$t},Tt.prototype.comparePath=function(Lt,Nt){var $t=this;return Lt.every(function(qt,_e){return $t.compareCoord(qt,this[_e])},Nt)},Tt.prototype.comparePolygon=function(Lt,Nt){if(this.compareLine(Lt.coordinates[0],Nt.coordinates[0],1,!0)){var $t=Lt.coordinates.slice(1,Lt.coordinates.length),qt=Nt.coordinates.slice(1,Nt.coordinates.length),_e=this;return $t.every(function(yt){return this.some(function(xt){return _e.compareLine(yt,xt,1,!0)})},qt)}return!1},Tt.prototype.compareFeature=function(Lt,Nt){return!(Lt.id!==Nt.id||!this.objectComparator(Lt.properties,Nt.properties)||!this.compareBBox(Lt,Nt))&&this.compare(Lt.geometry,Nt.geometry)},Tt.prototype.compareBBox=function(Lt,Nt){return!!(!Lt.bbox&&!Nt.bbox||Lt.bbox&&Nt.bbox&&this.compareCoord(Lt.bbox,Nt.bbox))},Tt.prototype.removePseudo=function(Lt){return Lt},tr.exports=Tt},5406:(tr,he,St)=>{var dt=St(7192),Tt=St(8275),s=St(9626),lt=St(1503).Z,ht=s.featureEach,$t=Tt.featureCollection;function qt(_e){var yt=new dt(_e);return yt.insert=function(xt){if("Feature"!==xt.type)throw new Error("invalid feature");return xt.bbox=xt.bbox?xt.bbox:lt(xt),dt.prototype.insert.call(this,xt)},yt.load=function(xt){var Yt=[];return Array.isArray(xt)?xt.forEach(function(ge){if("Feature"!==ge.type)throw new Error("invalid features");ge.bbox=ge.bbox?ge.bbox:lt(ge),Yt.push(ge)}):ht(xt,function(ge){if("Feature"!==ge.type)throw new Error("invalid features");ge.bbox=ge.bbox?ge.bbox:lt(ge),Yt.push(ge)}),dt.prototype.load.call(this,Yt)},yt.remove=function(xt,Yt){if("Feature"!==xt.type)throw new Error("invalid feature");return xt.bbox=xt.bbox?xt.bbox:lt(xt),dt.prototype.remove.call(this,xt,Yt)},yt.clear=function(){return dt.prototype.clear.call(this)},yt.search=function(xt){var Yt=dt.prototype.search.call(this,this.toBBox(xt));return $t(Yt)},yt.collides=function(xt){return dt.prototype.collides.call(this,this.toBBox(xt))},yt.all=function(){var xt=dt.prototype.all.call(this);return $t(xt)},yt.toJSON=function(){return dt.prototype.toJSON.call(this)},yt.fromJSON=function(xt){return dt.prototype.fromJSON.call(this,xt)},yt.toBBox=function(xt){var Yt;if(xt.bbox)Yt=xt.bbox;else if(Array.isArray(xt)&&4===xt.length)Yt=xt;else if(Array.isArray(xt)&&6===xt.length)Yt=[xt[0],xt[1],xt[3],xt[4]];else if("Feature"===xt.type)Yt=lt(xt);else{if("FeatureCollection"!==xt.type)throw new Error("invalid geojson");Yt=lt(xt)}return{minX:Yt[0],minY:Yt[1],maxX:Yt[2],maxY:Yt[3]}},yt}tr.exports=qt,tr.exports.default=qt},7192:function(tr){tr.exports=function(){"use strict";function he(Z,it,$,tt,X){!function rt(H,et,at,j,Wt){for(;j>at;){if(j-at>600){var Ct=j-at+1,kt=et-at+1,gt=Math.log(Ct),Fe=.5*Math.exp(2*gt/3),Ie=.5*Math.sqrt(gt*Fe*(Ct-Fe)/Ct)*(kt-Ct/2<0?-1:1);rt(H,et,Math.max(at,Math.floor(et-kt*Fe/Ct+Ie)),Math.min(j,Math.floor(et+(Ct-kt)*Fe/Ct+Ie)),Wt)}var Pt=H[et],te=at,le=j;for(St(H,at,et),Wt(H[j],Pt)>0&&St(H,at,j);te<le;){for(St(H,te,le),te++,le--;Wt(H[te],Pt)<0;)te++;for(;Wt(H[le],Pt)>0;)le--}0===Wt(H[at],Pt)?St(H,at,le):St(H,++le,j),le<=et&&(at=le+1),et<=le&&(j=le-1)}}(Z,it,$||0,tt||Z.length-1,X||dt)}function St(Z,it,$){var tt=Z[it];Z[it]=Z[$],Z[$]=tt}function dt(Z,it){return Z<it?-1:Z>it?1:0}var Tt=function(Z){void 0===Z&&(Z=9),this._maxEntries=Math.max(4,Z),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function s(Z,it,$){if(!$)return it.indexOf(Z);for(var tt=0;tt<it.length;tt++)if($(Z,it[tt]))return tt;return-1}function lt(Z,it){ht(Z,0,Z.children.length,it,Z)}function ht(Z,it,$,tt,X){X||(X=Yt(null)),X.minX=1/0,X.minY=1/0,X.maxX=-1/0,X.maxY=-1/0;for(var rt=it;rt<$;rt++){var H=Z.children[rt];Lt(X,Z.leaf?tt(H):H)}return X}function Lt(Z,it){return Z.minX=Math.min(Z.minX,it.minX),Z.minY=Math.min(Z.minY,it.minY),Z.maxX=Math.max(Z.maxX,it.maxX),Z.maxY=Math.max(Z.maxY,it.maxY),Z}function Nt(Z,it){return Z.minX-it.minX}function $t(Z,it){return Z.minY-it.minY}function qt(Z){return(Z.maxX-Z.minX)*(Z.maxY-Z.minY)}function _e(Z){return Z.maxX-Z.minX+(Z.maxY-Z.minY)}function yt(Z,it){return Z.minX<=it.minX&&Z.minY<=it.minY&&it.maxX<=Z.maxX&&it.maxY<=Z.maxY}function xt(Z,it){return it.minX<=Z.maxX&&it.minY<=Z.maxY&&it.maxX>=Z.minX&&it.maxY>=Z.minY}function Yt(Z){return{children:Z,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function ge(Z,it,$,tt,X){for(var rt=[it,$];rt.length;)if(!(($=rt.pop())-(it=rt.pop())<=tt)){var H=it+Math.ceil(($-it)/tt/2)*tt;he(Z,H,it,$,X),rt.push(it,H,H,$)}}return Tt.prototype.all=function(){return this._all(this.data,[])},Tt.prototype.search=function(Z){var it=this.data,$=[];if(!xt(Z,it))return $;for(var tt=this.toBBox,X=[];it;){for(var rt=0;rt<it.children.length;rt++){var H=it.children[rt],et=it.leaf?tt(H):H;xt(Z,et)&&(it.leaf?$.push(H):yt(Z,et)?this._all(H,$):X.push(H))}it=X.pop()}return $},Tt.prototype.collides=function(Z){var it=this.data;if(!xt(Z,it))return!1;for(var $=[];it;){for(var tt=0;tt<it.children.length;tt++){var X=it.children[tt],rt=it.leaf?this.toBBox(X):X;if(xt(Z,rt)){if(it.leaf||yt(Z,rt))return!0;$.push(X)}}it=$.pop()}return!1},Tt.prototype.load=function(Z){if(!Z||!Z.length)return this;if(Z.length<this._minEntries){for(var it=0;it<Z.length;it++)this.insert(Z[it]);return this}var $=this._build(Z.slice(),0,Z.length-1,0);if(this.data.children.length)if(this.data.height===$.height)this._splitRoot(this.data,$);else{if(this.data.height<$.height){var tt=this.data;this.data=$,$=tt}this._insert($,this.data.height-$.height-1,!0)}else this.data=$;return this},Tt.prototype.insert=function(Z){return Z&&this._insert(Z,this.data.height-1),this},Tt.prototype.clear=function(){return this.data=Yt([]),this},Tt.prototype.remove=function(Z,it){if(!Z)return this;for(var $,tt,X,rt=this.data,H=this.toBBox(Z),et=[],at=[];rt||et.length;){if(rt||(rt=et.pop(),tt=et[et.length-1],$=at.pop(),X=!0),rt.leaf){var j=s(Z,rt.children,it);if(-1!==j)return rt.children.splice(j,1),et.push(rt),this._condense(et),this}X||rt.leaf||!yt(rt,H)?tt?($++,rt=tt.children[$],X=!1):rt=null:(et.push(rt),at.push($),$=0,tt=rt,rt=rt.children[0])}return this},Tt.prototype.toBBox=function(Z){return Z},Tt.prototype.compareMinX=function(Z,it){return Z.minX-it.minX},Tt.prototype.compareMinY=function(Z,it){return Z.minY-it.minY},Tt.prototype.toJSON=function(){return this.data},Tt.prototype.fromJSON=function(Z){return this.data=Z,this},Tt.prototype._all=function(Z,it){for(var $=[];Z;)Z.leaf?it.push.apply(it,Z.children):$.push.apply($,Z.children),Z=$.pop();return it},Tt.prototype._build=function(Z,it,$,tt){var X,rt=$-it+1,H=this._maxEntries;if(rt<=H)return lt(X=Yt(Z.slice(it,$+1)),this.toBBox),X;tt||(tt=Math.ceil(Math.log(rt)/Math.log(H)),H=Math.ceil(rt/Math.pow(H,tt-1))),(X=Yt([])).leaf=!1,X.height=tt;var et=Math.ceil(rt/H),at=et*Math.ceil(Math.sqrt(H));ge(Z,it,$,at,this.compareMinX);for(var j=it;j<=$;j+=at){var Wt=Math.min(j+at-1,$);ge(Z,j,Wt,et,this.compareMinY);for(var Ct=j;Ct<=Wt;Ct+=et){var kt=Math.min(Ct+et-1,Wt);X.children.push(this._build(Z,Ct,kt,tt-1))}}return lt(X,this.toBBox),X},Tt.prototype._chooseSubtree=function(Z,it,$,tt){for(;tt.push(it),!it.leaf&&tt.length-1!==$;){for(var X=1/0,rt=1/0,H=void 0,et=0;et<it.children.length;et++){var at=it.children[et],j=qt(at),Wt=(Ct=Z,kt=at,(Math.max(kt.maxX,Ct.maxX)-Math.min(kt.minX,Ct.minX))*(Math.max(kt.maxY,Ct.maxY)-Math.min(kt.minY,Ct.minY))-j);Wt<rt?(rt=Wt,X=j<X?j:X,H=at):Wt===rt&&j<X&&(X=j,H=at)}it=H||it.children[0]}var Ct,kt;return it},Tt.prototype._insert=function(Z,it,$){var tt=$?Z:this.toBBox(Z),X=[],rt=this._chooseSubtree(tt,this.data,it,X);for(rt.children.push(Z),Lt(rt,tt);it>=0&&X[it].children.length>this._maxEntries;)this._split(X,it),it--;this._adjustParentBBoxes(tt,X,it)},Tt.prototype._split=function(Z,it){var $=Z[it],tt=$.children.length,X=this._minEntries;this._chooseSplitAxis($,X,tt);var rt=this._chooseSplitIndex($,X,tt),H=Yt($.children.splice(rt,$.children.length-rt));H.height=$.height,H.leaf=$.leaf,lt($,this.toBBox),lt(H,this.toBBox),it?Z[it-1].children.push(H):this._splitRoot($,H)},Tt.prototype._splitRoot=function(Z,it){this.data=Yt([Z,it]),this.data.height=Z.height+1,this.data.leaf=!1,lt(this.data,this.toBBox)},Tt.prototype._chooseSplitIndex=function(Z,it,$){for(var tt,X,rt,H,et,at,j,Wt=1/0,Ct=1/0,kt=it;kt<=$-it;kt++){var gt=ht(Z,0,kt,this.toBBox),Fe=ht(Z,kt,$,this.toBBox),Ie=(X=gt,rt=Fe,void 0,void 0,void 0,void 0,H=Math.max(X.minX,rt.minX),et=Math.max(X.minY,rt.minY),at=Math.min(X.maxX,rt.maxX),j=Math.min(X.maxY,rt.maxY),Math.max(0,at-H)*Math.max(0,j-et)),It=qt(gt)+qt(Fe);Ie<Wt?(Wt=Ie,tt=kt,Ct=It<Ct?It:Ct):Ie===Wt&&It<Ct&&(Ct=It,tt=kt)}return tt||$-it},Tt.prototype._chooseSplitAxis=function(Z,it,$){var tt=Z.leaf?this.compareMinX:Nt,X=Z.leaf?this.compareMinY:$t;this._allDistMargin(Z,it,$,tt)<this._allDistMargin(Z,it,$,X)&&Z.children.sort(tt)},Tt.prototype._allDistMargin=function(Z,it,$,tt){Z.children.sort(tt);for(var X=this.toBBox,rt=ht(Z,0,it,X),H=ht(Z,$-it,$,X),et=_e(rt)+_e(H),at=it;at<$-it;at++){var j=Z.children[at];Lt(rt,Z.leaf?X(j):j),et+=_e(rt)}for(var Wt=$-it-1;Wt>=it;Wt--){var Ct=Z.children[Wt];Lt(H,Z.leaf?X(Ct):Ct),et+=_e(H)}return et},Tt.prototype._adjustParentBBoxes=function(Z,it,$){for(var tt=$;tt>=0;tt--)Lt(it[tt],Z)},Tt.prototype._condense=function(Z){for(var it=Z.length-1,$=void 0;it>=0;it--)0===Z[it].children.length?it>0?($=Z[it-1].children).splice($.indexOf(Z[it]),1):this.clear():lt(Z[it],this.toBBox)},Tt}()},5203:(tr,he,St)=>{"use strict";var dt,Tt=SyntaxError,s=Function,lt=TypeError,ht=function(gt){try{return s('"use strict"; return ('+gt+").constructor;")()}catch{}},Lt=Object.getOwnPropertyDescriptor;if(Lt)try{Lt({},"")}catch{Lt=null}var Nt=function(){throw new lt},$t=Lt?function(){try{return Nt}catch{try{return Lt(arguments,"callee").get}catch{return Nt}}}():Nt,qt=St(2969)(),_e=Object.getPrototypeOf||function(gt){return gt.__proto__},yt={},xt=typeof Uint8Array>"u"?dt:_e(Uint8Array),Yt={"%AggregateError%":typeof AggregateError>"u"?dt:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?dt:ArrayBuffer,"%ArrayIteratorPrototype%":qt?_e([][Symbol.iterator]()):dt,"%AsyncFromSyncIteratorPrototype%":dt,"%AsyncFunction%":yt,"%AsyncGenerator%":yt,"%AsyncGeneratorFunction%":yt,"%AsyncIteratorPrototype%":yt,"%Atomics%":typeof Atomics>"u"?dt:Atomics,"%BigInt%":typeof BigInt>"u"?dt:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?dt:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?dt:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?dt:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?dt:Float32Array,"%Float64Array%":typeof Float64Array>"u"?dt:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?dt:FinalizationRegistry,"%Function%":s,"%GeneratorFunction%":yt,"%Int8Array%":typeof Int8Array>"u"?dt:Int8Array,"%Int16Array%":typeof Int16Array>"u"?dt:Int16Array,"%Int32Array%":typeof Int32Array>"u"?dt:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":qt?_e(_e([][Symbol.iterator]())):dt,"%JSON%":"object"==typeof JSON?JSON:dt,"%Map%":typeof Map>"u"?dt:Map,"%MapIteratorPrototype%":typeof Map>"u"||!qt?dt:_e((new Map)[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?dt:Promise,"%Proxy%":typeof Proxy>"u"?dt:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?dt:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?dt:Set,"%SetIteratorPrototype%":typeof Set>"u"||!qt?dt:_e((new Set)[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?dt:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":qt?_e(""[Symbol.iterator]()):dt,"%Symbol%":qt?Symbol:dt,"%SyntaxError%":Tt,"%ThrowTypeError%":$t,"%TypedArray%":xt,"%TypeError%":lt,"%Uint8Array%":typeof Uint8Array>"u"?dt:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?dt:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?dt:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?dt:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?dt:WeakMap,"%WeakRef%":typeof WeakRef>"u"?dt:WeakRef,"%WeakSet%":typeof WeakSet>"u"?dt:WeakSet};try{null.error}catch(gt){var ge=_e(_e(gt));Yt["%Error.prototype%"]=ge}var Z=function gt(Fe){var Ie;if("%AsyncFunction%"===Fe)Ie=ht("async function () {}");else if("%GeneratorFunction%"===Fe)Ie=ht("function* () {}");else if("%AsyncGeneratorFunction%"===Fe)Ie=ht("async function* () {}");else if("%AsyncGenerator%"===Fe){var It=gt("%AsyncGeneratorFunction%");It&&(Ie=It.prototype)}else if("%AsyncIteratorPrototype%"===Fe){var pe=gt("%AsyncGenerator%");pe&&(Ie=_e(pe.prototype))}return Yt[Fe]=Ie,Ie},it={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},$=St(4444),tt=St(3164),X=$.call(Function.call,Array.prototype.concat),rt=$.call(Function.apply,Array.prototype.splice),H=$.call(Function.call,String.prototype.replace),et=$.call(Function.call,String.prototype.slice),at=$.call(Function.call,RegExp.prototype.exec),j=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Wt=/\\(\\)?/g,Ct=function(Fe){var Ie=et(Fe,0,1),It=et(Fe,-1);if("%"===Ie&&"%"!==It)throw new Tt("invalid intrinsic syntax, expected closing `%`");if("%"===It&&"%"!==Ie)throw new Tt("invalid intrinsic syntax, expected opening `%`");var pe=[];return H(Fe,j,function(Pt,te,le,Ot){pe[pe.length]=le?H(Ot,Wt,"$1"):te||Pt}),pe},kt=function(Fe,Ie){var pe,It=Fe;if(tt(it,It)&&(It="%"+(pe=it[It])[0]+"%"),tt(Yt,It)){var Pt=Yt[It];if(Pt===yt&&(Pt=Z(It)),typeof Pt>"u"&&!Ie)throw new lt("intrinsic "+Fe+" exists, but is not available. Please file an issue!");return{alias:pe,name:It,value:Pt}}throw new Tt("intrinsic "+Fe+" does not exist!")};tr.exports=function(Fe,Ie){if("string"!=typeof Fe||0===Fe.length)throw new lt("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof Ie)throw new lt('"allowMissing" argument must be a boolean');if(null===at(/^%?[^%]*%?$/,Fe))throw new Tt("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var It=Ct(Fe),pe=It.length>0?It[0]:"",Pt=kt("%"+pe+"%",Ie),te=Pt.name,le=Pt.value,Ot=!1,Ue=Pt.alias;Ue&&(pe=Ue[0],rt(It,X([0,1],Ue)));for(var ze=1,ar=!0;ze<It.length;ze+=1){var Me=It[ze],Mr=et(Me,0,1),lr=et(Me,-1);if(('"'===Mr||"'"===Mr||"`"===Mr||'"'===lr||"'"===lr||"`"===lr)&&Mr!==lr)throw new Tt("property names with quotes must have matching quotes");if(("constructor"===Me||!ar)&&(Ot=!0),tt(Yt,te="%"+(pe+="."+Me)+"%"))le=Yt[te];else if(null!=le){if(!(Me in le)){if(!Ie)throw new lt("base intrinsic for "+Fe+" exists, but the property is not available.");return}if(Lt&&ze+1>=It.length){var kr=Lt(le,Me);le=(ar=!!kr)&&"get"in kr&&!("originalValue"in kr.get)?kr.get:le[Me]}else ar=tt(le,Me),le=le[Me];ar&&!Ot&&(Yt[te]=le)}}return le}},7027:(tr,he,St)=>{"use strict";var Tt=St(5203)("%Object.defineProperty%",!0),s=function(){if(Tt)try{return Tt({},"a",{value:1}),!0}catch{return!1}return!1};s.hasArrayLengthDefineBug=function(){if(!s())return null;try{return 1!==Tt([],"length",{value:1}).length}catch{return!0}},tr.exports=s},2969:(tr,he,St)=>{"use strict";var dt=typeof Symbol<"u"&&Symbol,Tt=St(1983);tr.exports=function(){return"function"==typeof dt&&"function"==typeof Symbol&&"symbol"==typeof dt("foo")&&"symbol"==typeof Symbol("bar")&&Tt()}},1983:tr=>{"use strict";tr.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var St={},dt=Symbol("test"),Tt=Object(dt);if("string"==typeof dt||"[object Symbol]"!==Object.prototype.toString.call(dt)||"[object Symbol]"!==Object.prototype.toString.call(Tt))return!1;for(dt in St[dt]=42,St)return!1;if("function"==typeof Object.keys&&0!==Object.keys(St).length||"function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(St).length)return!1;var lt=Object.getOwnPropertySymbols(St);if(1!==lt.length||lt[0]!==dt||!Object.prototype.propertyIsEnumerable.call(St,dt))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var ht=Object.getOwnPropertyDescriptor(St,dt);if(42!==ht.value||!0!==ht.enumerable)return!1}return!0}},6259:(tr,he,St)=>{"use strict";var dt=St(1983);tr.exports=function(){return dt()&&!!Symbol.toStringTag}},3164:(tr,he,St)=>{"use strict";var dt=St(4444);tr.exports=dt.call(Function.call,Object.prototype.hasOwnProperty)},3407:(tr,he,St)=>{"use strict";var dt=St(6259)(),s=St(5834)("Object.prototype.toString"),lt=function($t){return!(dt&&$t&&"object"==typeof $t&&Symbol.toStringTag in $t)&&"[object Arguments]"===s($t)},ht=function($t){return!!lt($t)||null!==$t&&"object"==typeof $t&&"number"==typeof $t.length&&$t.length>=0&&"[object Array]"!==s($t)&&"[object Function]"===s($t.callee)},Lt=function(){return lt(arguments)}();lt.isLegacyArguments=ht,tr.exports=Lt?lt:ht},2374:(tr,he,St)=>{"use strict";var dt=Date.prototype.getDay,s=Object.prototype.toString,ht=St(6259)();tr.exports=function(Nt){return"object"==typeof Nt&&null!==Nt&&(ht?function(Nt){try{return dt.call(Nt),!0}catch{return!1}}(Nt):"[object Date]"===s.call(Nt))}},2342:(tr,he,St)=>{"use strict";var s,lt,ht,Lt,dt=St(5834),Tt=St(6259)();if(Tt){s=dt("Object.prototype.hasOwnProperty"),lt=dt("RegExp.prototype.exec"),ht={};var Nt=function(){throw ht};Lt={toString:Nt,valueOf:Nt},"symbol"==typeof Symbol.toPrimitive&&(Lt[Symbol.toPrimitive]=Nt)}var $t=dt("Object.prototype.toString"),qt=Object.getOwnPropertyDescriptor;tr.exports=Tt?function(xt){if(!xt||"object"!=typeof xt)return!1;var Yt=qt(xt,"lastIndex");if(!Yt||!s(Yt,"value"))return!1;try{lt(xt,Lt)}catch(Z){return Z===ht}}:function(xt){return!(!xt||"object"!=typeof xt&&"function"!=typeof xt)&&"[object RegExp]"===$t(xt)}},6151:(tr,he)=>{"use strict";he.Z={onSetup:function(lt){var ht=this.newFeature({type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[]]}});return this.addFeature(ht),this.clearSelectedFeatures(),function(lt){setTimeout(function(){!lt.map||!lt.map.doubleClickZoom||lt.map.doubleClickZoom.disable()},0)}(this),this.updateUIClasses({mouse:"add"}),this.setActionableState({trash:!0}),{rectangle:ht}},onTap:function(lt,ht){lt.startPoint&&this.onMouseMove(lt,ht),this.onClick(lt,ht)},onClick:function(lt,ht){lt.startPoint&&lt.startPoint[0]!==ht.lngLat.lng&&lt.startPoint[1]!==ht.lngLat.lat&&(this.updateUIClasses({mouse:"pointer"}),lt.endPoint=[ht.lngLat.lng,ht.lngLat.lat],this.changeMode("simple_select",{featuresId:lt.rectangle.id})),lt.startPoint=[ht.lngLat.lng,ht.lngLat.lat]},onMouseMove:function(lt,ht){lt.startPoint&&(lt.rectangle.updateCoordinate("0.0",lt.startPoint[0],lt.startPoint[1]),lt.rectangle.updateCoordinate("0.1",ht.lngLat.lng,lt.startPoint[1]),lt.rectangle.updateCoordinate("0.2",ht.lngLat.lng,ht.lngLat.lat),lt.rectangle.updateCoordinate("0.3",lt.startPoint[0],ht.lngLat.lat),lt.rectangle.updateCoordinate("0.4",lt.startPoint[0],lt.startPoint[1]))},onKeyUp:function(lt,ht){if(27===ht.keyCode)return this.changeMode("simple_select")},onStop:function(lt){(function(lt){setTimeout(function(){!lt.map||!lt.map.doubleClickZoom||!lt._ctx||!lt._ctx.store||!lt._ctx.store.getInitialConfigValue||!lt._ctx.store.getInitialConfigValue("doubleClickZoom")||lt.map.doubleClickZoom.enable()},0)})(this),this.updateUIClasses({mouse:"none"}),this.activateUIButton(),void 0!==this.getFeature(lt.rectangle.id)&&(lt.rectangle.removeCoordinate("0.4"),lt.rectangle.isValid()?this.map.fire("draw.create",{features:[lt.rectangle.toGeoJSON()]}):(this.deleteFeature([lt.rectangle.id],{silent:!0}),this.changeMode("simple_select",{},{silent:!0})))},toDisplayFeatures:function(lt,ht,Lt){var Nt=ht.properties.id===lt.rectangle.id;return ht.properties.active=Nt?"true":"false",Nt?lt.startPoint?Lt(ht):void 0:Lt(ht)},onTrash:function(lt){this.deleteFeature([lt.rectangle.id],{silent:!0}),this.changeMode("simple_select")}}},9990:(tr,he,St)=>{const dt=St(2777).Z,Tt=St(5427).Z,s=St(2586).Z,lt=St(9814).Z,Lt=new(St(9069));tr.exports={rotatestart:function($t,qt){},rotating:function($t,qt,_e){},rotateend:function($t){},onSetup:function($t){var qt={};return Lt.addListener("rotatestart",function(){this.rotatestart(qt.selectedFeature,qt.originalCenter)}.bind(this)),Lt.addListener("rotating",function(){this.rotating(qt.selectedFeature,qt.originalCenter,qt.lastMouseDownLngLat)}.bind(this)),Lt.addListener("rotateend",function(){this.rotateend(qt.selectedFeature,qt.lastMouseDownLngLat)}.bind(this)),qt.selectedFeature=$t.selectedFeature||!1,qt.lastMouseDownLngLat=!1,qt.originalCenter=!1,qt.mode="rotate",qt},onMouseDown:function($t,qt){return qt.featureTarget&&this._ctx.api.get(qt.featureTarget.properties.id)&&(qt.target.dragPan.disable(),$t.selectedFeature=this._ctx.api.get(qt.featureTarget.properties.id),$t.originalCenter=Tt(qt.featureTarget),$t.originalFeature=qt.featureTarget,Lt.emit("rotatestart")),$t},toDisplayFeatures:function($t,qt,_e){_e(qt)},onDrag:function($t,qt){if($t.selectedFeature&&$t.mode&&"rotate"===$t.mode){$t.lastMouseDownLngLat={lng:qt.lngLat.lng,lat:qt.lngLat.lat};var _e=s($t.originalCenter,[qt.lngLat.lng,qt.lngLat.lat]),yt=[];switch($t.originalFeature.properties["meta:type"]){case"Point":break;case"LineString":$t.originalFeature.geometry.coordinates.forEach(function(it,$){var tt=dt($t.originalCenter,it),X=s($t.originalCenter,it),rt=lt($t.originalCenter,tt,X+_e);yt.push(rt.geometry.coordinates)});break;case"Polygon":var xt=[];$t.originalFeature.geometry.coordinates[0].forEach(function(it,$){var tt=dt($t.originalCenter,it),X=s($t.originalCenter,it),rt=lt($t.originalCenter,tt,X+_e);xt.push(rt.geometry.coordinates)}),yt.push(xt);break;case"MultiLineString":var Yt=[];$t.originalFeature.geometry.coordinates.forEach(function(it,$){var tt=[];it.forEach(function(X,rt){var H=dt($t.originalCenter,X),et=s($t.originalCenter,X),at=lt($t.originalCenter,H,et+_e);tt.push(at.geometry.coordinates)}),Yt.push(tt)}),yt=Yt;break;case"MultiPolygon":Yt=[],$t.originalFeature.geometry.coordinates.forEach(function(it,$){var tt=[];it.forEach(function(X,rt){var H=[];X.forEach(function(et,at){var j=dt($t.originalCenter,et),Wt=s($t.originalCenter,et),Ct=lt($t.originalCenter,j,Wt+_e);H.push(Ct.geometry.coordinates)}),tt.push(H)}),Yt.push(tt)}),yt=Yt;break;default:return}Lt.emit("rotating");var ge=$t.selectedFeature;ge.geometry.coordinates=yt,this._ctx.api.add(ge)}},onMouseUp:function($t,qt){return qt.target.dragPan.enable(),Lt.emit("rotateend"),$t.selectedFeature=!1,$t.lastMouseDownLngLat=!1,$t.originalCenter=!1,$t}}},2586:(tr,he,St)=>{"use strict";function j(ae){if(null==ae)throw new Error("degrees is required");return ae%360*Math.PI/180}function ze(ae){if(!ae)throw new Error("coord is required");if("Feature"===ae.type&&null!==ae.geometry&&"Point"===ae.geometry.type)return ae.geometry.coordinates;if("Point"===ae.type)return ae.coordinates;if(Array.isArray(ae)&&ae.length>=2&&void 0===ae[0].length&&void 0===ae[1].length)return ae;throw new Error("coord must be GeoJSON Point or an Array of numbers")}St.d(he,{Z:()=>Un});const Un=function ti(ae,Ve,Kt){if(!function gt(ae){return!!ae&&ae.constructor===Object}(Kt=Kt||{}))throw new Error("options is invalid");if(!0===Kt.final)return function vn(ae,Ve){return(ti(Ve,ae)+180)%360}(ae,Ve);var nt=ze(ae),ot=ze(Ve),Rt=j(nt[0]),ce=j(ot[0]),De=j(nt[1]),Qe=j(ot[1]),nr=Math.sin(ce-Rt)*Math.cos(Qe),Xe=Math.cos(De)*Math.sin(Qe)-Math.sin(De)*Math.cos(Qe)*Math.cos(ce-Rt);return function at(ae){if(null==ae)throw new Error("radians is required");return ae%(2*Math.PI)*180/Math.PI}(Math.atan2(nr,Xe))}},4987:function(tr){tr.exports=function(){"use strict";var he,St,dt;function Tt(s,lt){if(he)if(St){var ht="var sharedChunk = {}; ("+he+")(sharedChunk); ("+St+")(sharedChunk);",Lt={};he(Lt),dt=lt(Lt),typeof window<"u"&&(dt.workerUrl=window.URL.createObjectURL(new Blob([ht],{type:"text/javascript"})))}else St=lt;else he=lt}return Tt(0,function(s){function lt(t,n){return t(n={exports:{}},n.exports),n.exports}var ht=Lt;function Lt(t,n,u,g){this.cx=3*t,this.bx=3*(u-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(g-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=g,this.p2x=u,this.p2y=g}Lt.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},Lt.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},Lt.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},Lt.prototype.solveCurveX=function(t,n){var u,g,_,w,S;for(void 0===n&&(n=1e-6),_=t,S=0;S<8;S++){if(w=this.sampleCurveX(_)-t,Math.abs(w)<n)return _;var D=this.sampleCurveDerivativeX(_);if(Math.abs(D)<1e-6)break;_-=w/D}if((_=t)<(u=0))return u;if(_>(g=1))return g;for(;u<g;){if(w=this.sampleCurveX(_),Math.abs(w-t)<n)return _;t>w?u=_:g=_,_=.5*(g-u)+u}return _},Lt.prototype.solve=function(t,n){return this.sampleCurveY(this.solveCurveX(t,n))};var Nt=$t;function $t(t,n){this.x=t,this.y=n}$t.prototype={clone:function(){return new $t(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,n){return this.clone()._rotateAround(t,n)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var n=t.x-this.x,u=t.y-this.y;return n*n+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,n){return Math.atan2(this.x*n-this.y*t,this.x*t+this.y*n)},_matMult:function(t){var n=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=n,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var n=Math.cos(t),u=Math.sin(t),g=u*this.x+n*this.y;return this.x=n*this.x-u*this.y,this.y=g,this},_rotateAround:function(t,n){var u=Math.cos(t),g=Math.sin(t),_=n.y+g*(this.x-n.x)+u*(this.y-n.y);return this.x=n.x+u*(this.x-n.x)-g*(this.y-n.y),this.y=_,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},$t.convert=function(t){return t instanceof $t?t:Array.isArray(t)?new $t(t[0],t[1]):t};var qt=typeof self<"u"?self:{},_e=Math.pow(2,53)-1;function yt(t,n,u,g){var _=new ht(t,n,u,g);return function(w){return _.solve(w)}}var xt=yt(.25,.1,.25,1);function Yt(t,n,u){return Math.min(u,Math.max(n,t))}function ge(t,n,u){var g=u-n,_=((t-n)%g+g)%g+n;return _===n?u:_}function Z(t){for(var n=[],u=arguments.length-1;u-- >0;)n[u]=arguments[u+1];for(var g=0,_=n;g<_.length;g+=1){var w=_[g];for(var S in w)t[S]=w[S]}return t}var it=1;function $(){return it++}function tt(){return function t(n){return n?(n^16*Math.random()>>n/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function X(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function rt(t,n){t.forEach(function(u){n[u]&&(n[u]=n[u].bind(n))})}function H(t,n){return-1!==t.indexOf(n,t.length-n.length)}function et(t,n,u){var g={};for(var _ in t)g[_]=n.call(u||this,t[_],_,t);return g}function at(t,n,u){var g={};for(var _ in t)n.call(u||this,t[_],_,t)&&(g[_]=t[_]);return g}function j(t){return Array.isArray(t)?t.map(j):"object"==typeof t&&t?et(t,j):t}var Wt={};function Ct(t){Wt[t]||(typeof console<"u"&&console.warn(t),Wt[t]=!0)}function kt(t,n,u){return(u.y-t.y)*(n.x-t.x)>(n.y-t.y)*(u.x-t.x)}function gt(t){for(var n=0,u=0,g=t.length,_=g-1,w=void 0,S=void 0;u<g;_=u++)n+=((S=t[_]).x-(w=t[u]).x)*(w.y+S.y);return n}function Fe(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Ie(t){var n={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(g,_,w,S){var D=w||S;return n[_]=!D||D.toLowerCase(),""}),n["max-age"]){var u=parseInt(n["max-age"],10);isNaN(u)?delete n["max-age"]:n["max-age"]=u}return n}var It=null;function pe(t){if(null==It){var n=t.navigator?t.navigator.userAgent:null;It=!!t.safari||!(!n||!(/\b(iPad|iPhone|iPod)\b/.test(n)||n.match("Safari")&&!n.match("Chrome")))}return It}function Pt(t){try{var n=qt[t];return n.setItem("_mapbox_test_",1),n.removeItem("_mapbox_test_"),!0}catch{return!1}}var te,le,Ot,Ue,ze=qt.performance&&qt.performance.now?qt.performance.now.bind(qt.performance):Date.now.bind(Date),ar=qt.requestAnimationFrame||qt.mozRequestAnimationFrame||qt.webkitRequestAnimationFrame||qt.msRequestAnimationFrame,Me=qt.cancelAnimationFrame||qt.mozCancelAnimationFrame||qt.webkitCancelAnimationFrame||qt.msCancelAnimationFrame,Mr={now:ze,frame:function(t){var n=ar(t);return{cancel:function(){return Me(n)}}},getImageData:function(t,n){void 0===n&&(n=0);var u=qt.document.createElement("canvas"),g=u.getContext("2d");if(!g)throw new Error("failed to create canvas 2d context");return u.width=t.width,u.height=t.height,g.drawImage(t,0,0,t.width,t.height),g.getImageData(-n,-n,t.width+2*n,t.height+2*n)},resolveURL:function(t){return te||(te=qt.document.createElement("a")),te.href=t,te.href},hardwareConcurrency:qt.navigator&&qt.navigator.hardwareConcurrency||4,get devicePixelRatio(){return qt.devicePixelRatio},get prefersReducedMotion(){return!!qt.matchMedia&&(null==le&&(le=qt.matchMedia("(prefers-reduced-motion: reduce)")),le.matches)}},lr={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},kr={supported:!1,testSupport:function(t){!Xr&&Ue&&(Sr?qe(t):Ot=t)}},Xr=!1,Sr=!1;function qe(t){var n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,Ue),t.isContextLost())return;kr.supported=!0}catch{}t.deleteTexture(n),Xr=!0}qt.document&&((Ue=qt.document.createElement("img")).onload=function(){Ot&&qe(Ot),Ot=null,Sr=!0},Ue.onerror=function(){Xr=!0,Ot=null},Ue.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var ti="01",vn=function(t,n){this._transformRequestFn=t,this._customAccessToken=n,this._createSkuToken()};function Un(t){return 0===t.indexOf("mapbox:")}vn.prototype._createSkuToken=function(){var t=function(){for(var n="",u=0;u<10;u++)n+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ti,n].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt},vn.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},vn.prototype.transformRequest=function(t,n){return this._transformRequestFn&&this._transformRequestFn(t,n)||{url:t}},vn.prototype.normalizeStyleURL=function(t,n){if(!Un(t))return t;var u=st(t);return u.path="/styles/v1"+u.path,this._makeAPIURL(u,this._customAccessToken||n)},vn.prototype.normalizeGlyphsURL=function(t,n){if(!Un(t))return t;var u=st(t);return u.path="/fonts/v1"+u.path,this._makeAPIURL(u,this._customAccessToken||n)},vn.prototype.normalizeSourceURL=function(t,n){if(!Un(t))return t;var u=st(t);return u.path="/v4/"+u.authority+".json",u.params.push("secure"),this._makeAPIURL(u,this._customAccessToken||n)},vn.prototype.normalizeSpriteURL=function(t,n,u,g){var _=st(t);return Un(t)?(_.path="/styles/v1"+_.path+"/sprite"+n+u,this._makeAPIURL(_,this._customAccessToken||g)):(_.path+=""+n+u,nt(_))},vn.prototype.normalizeTileURL=function(t,n){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!Un(t))return t;var u=st(t);u.path=u.path.replace(/(\.(png|jpg)\d*)(?=$)/,(Mr.devicePixelRatio>=2||512===n?"@2x":"")+(kr.supported?".webp":"$1")),u.path=u.path.replace(/^.+\/v4\//,"/"),u.path="/v4"+u.path;var g=this._customAccessToken||function(_){for(var w=0,S=_;w<S.length;w+=1){var D=S[w].match(/^access_token=(.*)$/);if(D)return D[1]}return null}(u.params)||lr.ACCESS_TOKEN;return lr.REQUIRE_ACCESS_TOKEN&&g&&this._skuToken&&u.params.push("sku="+this._skuToken),this._makeAPIURL(u,g)},vn.prototype.canonicalizeTileURL=function(t,n){var u=st(t);if(!u.path.match(/(^\/v4\/)/)||!u.path.match(/\.[\w]+$/))return t;var g="mapbox://tiles/";g+=u.path.replace("/v4/","");var _=u.params;return n&&(_=_.filter(function(w){return!w.match(/^access_token=/)})),_.length&&(g+="?"+_.join("&")),g},vn.prototype.canonicalizeTileset=function(t,n){for(var u=!!n&&Un(n),g=[],_=0,w=t.tiles||[];_<w.length;_+=1){var S=w[_];Ve(S)?g.push(this.canonicalizeTileURL(S,u)):g.push(S)}return g},vn.prototype._makeAPIURL=function(t,n){var u="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",g=st(lr.API_URL);if(t.protocol=g.protocol,t.authority=g.authority,"http"===t.protocol){var _=t.params.indexOf("secure");_>=0&&t.params.splice(_,1)}if("/"!==g.path&&(t.path=""+g.path+t.path),!lr.REQUIRE_ACCESS_TOKEN)return nt(t);if(!(n=n||lr.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+u);if("s"===n[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+u);return t.params=t.params.filter(function(w){return-1===w.indexOf("access_token")}),t.params.push("access_token="+n),nt(t)},vn.prototype.setTransformRequest=function(t){this._transformRequestFn=t};var ae=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Ve(t){return ae.test(t)}var Kt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function st(t){var n=t.match(Kt);if(!n)throw new Error("Unable to parse URL object");return{protocol:n[1],authority:n[2],path:n[3]||"/",params:n[4]?n[4].split("&"):[]}}function nt(t){var n=t.params.length?"?"+t.params.join("&"):"";return t.protocol+"://"+t.authority+t.path+n}function ot(t){if(!t)return null;var n=t.split(".");if(!n||3!==n.length)return null;try{return JSON.parse(decodeURIComponent(qt.atob(n[1]).split("").map(function(u){return"%"+("00"+u.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var Rt=function(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Rt.prototype.getStorageKey=function(t){var n,u=ot(lr.ACCESS_TOKEN);return n=u&&u.u?qt.btoa(encodeURIComponent(u.u).replace(/%([0-9A-F]{2})/g,function(g,_){return String.fromCharCode(Number("0x"+_))})):lr.ACCESS_TOKEN||"",t?"mapbox.eventData."+t+":"+n:"mapbox.eventData:"+n},Rt.prototype.fetchEventData=function(){var t=Pt("localStorage"),n=this.getStorageKey(),u=this.getStorageKey("uuid");if(t)try{var g=qt.localStorage.getItem(n);g&&(this.eventData=JSON.parse(g));var _=qt.localStorage.getItem(u);_&&(this.anonId=_)}catch{Ct("Unable to read from LocalStorage")}},Rt.prototype.saveEventData=function(){var t=Pt("localStorage"),n=this.getStorageKey(),u=this.getStorageKey("uuid");if(t)try{qt.localStorage.setItem(u,this.anonId),Object.keys(this.eventData).length>=1&&qt.localStorage.setItem(n,JSON.stringify(this.eventData))}catch{Ct("Unable to write to LocalStorage")}},Rt.prototype.processRequests=function(t){},Rt.prototype.postEvent=function(t,n,u,g){var _=this;if(lr.EVENTS_URL){var w=st(lr.EVENTS_URL);w.params.push("access_token="+(g||lr.ACCESS_TOKEN||""));var S={event:this.type,created:new Date(t).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.15.3",skuId:ti,userId:this.anonId},D=n?Z(S,n):S,z={url:nt(w),headers:{"Content-Type":"text/plain"},body:JSON.stringify([D])};this.pendingRequest=Y(z,function(q){_.pendingRequest=null,u(q),_.saveEventData(),_.processRequests(g)})}},Rt.prototype.queueRequest=function(t,n){this.queue.push(t),this.processRequests(n)};var ce,De,Qe=function(t){function n(){t.call(this,"map.load"),this.success={},this.skuToken=""}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.postMapLoadEvent=function(u,g,_,w){this.skuToken=_,(lr.EVENTS_URL&&w||lr.ACCESS_TOKEN&&Array.isArray(u)&&u.some(function(S){return Un(S)||Ve(S)}))&&this.queueRequest({id:g,timestamp:Date.now()},w)},n.prototype.processRequests=function(u){var g=this;if(!this.pendingRequest&&0!==this.queue.length){var _=this.queue.shift(),w=_.id,S=_.timestamp;w&&this.success[w]||(this.anonId||this.fetchEventData(),X(this.anonId)||(this.anonId=tt()),this.postEvent(S,{skuToken:this.skuToken},function(D){D||w&&(g.success[w]=!0)},u))}},n}(Rt),nr=new(function(t){function n(u){t.call(this,"appUserTurnstile"),this._customAccessToken=u}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.postTurnstileEvent=function(u,g){lr.EVENTS_URL&&lr.ACCESS_TOKEN&&Array.isArray(u)&&u.some(function(_){return Un(_)||Ve(_)})&&this.queueRequest(Date.now(),g)},n.prototype.processRequests=function(u){var g=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var _=ot(lr.ACCESS_TOKEN),w=_?_.u:lr.ACCESS_TOKEN,S=w!==this.eventData.tokenU;X(this.anonId)||(this.anonId=tt(),S=!0);var D=this.queue.shift();if(this.eventData.lastSuccess){var z=new Date(this.eventData.lastSuccess),q=new Date(D),G=(D-this.eventData.lastSuccess)/864e5;S=S||G>=1||G<-1||z.getDate()!==q.getDate()}else S=!0;if(!S)return this.processRequests();this.postEvent(D,{"enabled.telemetry":!1},function(J){J||(g.eventData.lastSuccess=D,g.eventData.tokenU=w)},u)}},n}(Rt)),Xe=nr.postTurnstileEvent.bind(nr),pn=new Qe,Kr=pn.postMapLoadEvent.bind(pn),pr=500,un=50;function ei(){qt.caches&&!ce&&(ce=qt.caches.open("mapbox-tiles"))}function Kn(t){var n=t.indexOf("?");return n<0?t:t.slice(0,n)}var Gn,Mn=1/0;function on(){return null==Gn&&(Gn=qt.OffscreenCanvas&&new qt.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof qt.createImageBitmap),Gn}var bi={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(bi);var To=function(t){function n(u,g,_){401===g&&Ve(_)&&(u+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),t.call(this,u),this.status=g,this.url=_,this.name=this.constructor.name,this.message=u}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},n}(Error),oa=Fe()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===qt.location.protocol?qt.parent:qt).location.href};function gi(t,n){var u,g=new qt.AbortController,_=new qt.Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,referrer:oa(),signal:g.signal}),w=!1,S=!1,D=(u=_.url).indexOf("sku=")>0&&Ve(u);"json"===t.type&&_.headers.set("Accept","application/json");var z=function(G,J,ut){if(!S){if(G&&"SecurityError"!==G.message&&Ct(G),J&&ut)return q(J);var mt=Date.now();qt.fetch(_).then(function(zt){if(zt.ok){var Vt=D?zt.clone():null;return q(zt,Vt,mt)}return n(new To(zt.statusText,zt.status,t.url))}).catch(function(zt){20!==zt.code&&n(new Error(zt.message))})}},q=function(G,J,ut){("arrayBuffer"===t.type?G.arrayBuffer():"json"===t.type?G.json():G.text()).then(function(mt){S||(J&&ut&&function(zt,Vt,fe){if(ei(),ce){var ne={status:Vt.status,statusText:Vt.statusText,headers:new qt.Headers};Vt.headers.forEach(function(Ce,Re){return ne.headers.set(Re,Ce)});var Ee=Ie(Vt.headers.get("Cache-Control")||"");Ee["no-store"]||(Ee["max-age"]&&ne.headers.set("Expires",new Date(fe+1e3*Ee["max-age"]).toUTCString()),new Date(ne.headers.get("Expires")).getTime()-fe<42e4||function(Ce,Re){if(void 0===De)try{new Response(new ReadableStream),De=!0}catch{De=!1}De?Re(Ce.body):Ce.blob().then(Re)}(Vt,function(Ce){var Re=new qt.Response(Ce,ne);ei(),ce&&ce.then(function(Be){return Be.put(Kn(zt.url),Re)}).catch(function(Be){return Ct(Be.message)})}))}}(_,J,ut),w=!0,n(null,mt,G.headers.get("Cache-Control"),G.headers.get("Expires")))}).catch(function(mt){S||n(new Error(mt.message))})};return D?function(G,J){if(ei(),!ce)return J(null);var ut=Kn(G.url);ce.then(function(mt){mt.match(ut).then(function(zt){var Vt=function(fe){if(!fe)return!1;var ne=new Date(fe.headers.get("Expires")||0),Ee=Ie(fe.headers.get("Cache-Control")||"");return ne>Date.now()&&!Ee["no-cache"]}(zt);mt.delete(ut),Vt&&mt.put(ut,zt.clone()),J(null,zt,Vt)}).catch(J)}).catch(J)}(_,z):z(null,null),{cancel:function(){S=!0,w||g.abort()}}}var vo,On,or=function(t,n){if(/:\/\//.test(t.url)&&!/^https?:|^file:/.test(t.url)){if(Fe()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,n);if(!Fe()){var u=t.url.substring(0,t.url.indexOf("://"));return(lr.REGISTERED_PROTOCOLS[u]||gi)(t,n)}}if(!(/^file:/.test(g=t.url)||/^file:/.test(oa())&&!/^\w+:/.test(g))){if(qt.fetch&&qt.Request&&qt.AbortController&&qt.Request.prototype.hasOwnProperty("signal"))return gi(t,n);if(Fe()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,n,void 0,!0)}var g;return function(_,w){var S=new qt.XMLHttpRequest;for(var D in S.open(_.method||"GET",_.url,!0),"arrayBuffer"===_.type&&(S.responseType="arraybuffer"),_.headers)S.setRequestHeader(D,_.headers[D]);return"json"===_.type&&(S.responseType="text",S.setRequestHeader("Accept","application/json")),S.withCredentials="include"===_.credentials,S.onerror=function(){w(new Error(S.statusText))},S.onload=function(){if((S.status>=200&&S.status<300||0===S.status)&&null!==S.response){var z=S.response;if("json"===_.type)try{z=JSON.parse(S.response)}catch(q){return w(q)}w(null,z,S.getResponseHeader("Cache-Control"),S.getResponseHeader("Expires"))}else w(new To(S.statusText,S.status,_.url))},S.send(_.body),{cancel:function(){return S.abort()}}}(t,n)},wi=function(t,n){return or(Z(t,{type:"arrayBuffer"}),n)},Y=function(t,n){return or(Z(t,{method:"POST"}),n)},W="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";vo=[],On=0;var pt=function(t,n){if(kr.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),On>=lr.MAX_PARALLEL_IMAGE_REQUESTS){var u={requestParameters:t,callback:n,cancelled:!1,cancel:function(){this.cancelled=!0}};return vo.push(u),u}On++;var g=!1,_=function(){if(!g)for(g=!0,On--;vo.length&&On<lr.MAX_PARALLEL_IMAGE_REQUESTS;){var S=vo.shift();S.cancelled||(S.cancel=pt(S.requestParameters,S.callback).cancel)}},w=wi(t,function(S,D,z,q){var J,ut;_(),S?n(S):D&&(on()?(J=n,ut=new qt.Blob([new Uint8Array(D)],{type:"image/png"}),qt.createImageBitmap(ut).then(function(mt){J(null,mt)}).catch(function(mt){J(new Error("Could not load image because of "+mt.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})):function(G,J,ut,mt){var zt=new qt.Image,Vt=qt.URL;zt.onload=function(){J(null,zt),Vt.revokeObjectURL(zt.src),zt.onload=null,qt.requestAnimationFrame(function(){zt.src=W})},zt.onerror=function(){return J(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var fe=new qt.Blob([new Uint8Array(G)],{type:"image/png"});zt.cacheControl=ut,zt.expires=mt,zt.src=G.byteLength?Vt.createObjectURL(fe):W}(D,n,z,q))});return{cancel:function(){w.cancel(),_()}}};function bt(t,n,u){u[t]&&-1!==u[t].indexOf(n)||(u[t]=u[t]||[],u[t].push(n))}function Ft(t,n,u){if(u&&u[t]){var g=u[t].indexOf(n);-1!==g&&u[t].splice(g,1)}}var se=function(t,n){void 0===n&&(n={}),Z(this,n),this.type=t},me=function(t){function n(u,g){void 0===g&&(g={}),t.call(this,"error",Z({error:u},g))}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n}(se),ue=function(){};ue.prototype.on=function(t,n){return this._listeners=this._listeners||{},bt(t,n,this._listeners),this},ue.prototype.off=function(t,n){return Ft(t,n,this._listeners),Ft(t,n,this._oneTimeListeners),this},ue.prototype.once=function(t,n){return this._oneTimeListeners=this._oneTimeListeners||{},bt(t,n,this._oneTimeListeners),this},ue.prototype.fire=function(t,n){"string"==typeof t&&(t=new se(t,n||{}));var u=t.type;if(this.listens(u)){t.target=this;for(var g=0,_=this._listeners&&this._listeners[u]?this._listeners[u].slice():[];g<_.length;g+=1)_[g].call(this,t);for(var w=0,S=this._oneTimeListeners&&this._oneTimeListeners[u]?this._oneTimeListeners[u].slice():[];w<S.length;w+=1){var D=S[w];Ft(u,D,this._oneTimeListeners),D.call(this,t)}var z=this._eventedParent;z&&(Z(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),z.fire(t))}else t instanceof me&&console.error(t.error);return this},ue.prototype.listens=function(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)},ue.prototype.setEventedParent=function(t,n){return this._eventedParent=t,this._eventedParentData=n,this};var Dt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Ht=function(t,n,u,g){this.message=(t?t+": ":"")+u,g&&(this.identifier=g),null!=n&&n.__line__&&(this.line=n.__line__)};function ir(t){var n=t.value;return n?[new Ht(t.key,n,"constants have been deprecated as of v8")]:[]}function mr(t){for(var n=[],u=arguments.length-1;u-- >0;)n[u]=arguments[u+1];for(var g=0,_=n;g<_.length;g+=1){var w=_[g];for(var S in w)t[S]=w[S]}return t}function Te(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function Ye(t){if(Array.isArray(t))return t.map(Ye);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){var n={};for(var u in t)n[u]=Ye(t[u]);return n}return Te(t)}var vr=function(t){function n(u,g){t.call(this,g),this.message=g,this.key=u}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n}(Error),_r=function(t,n){void 0===n&&(n=[]),this.parent=t,this.bindings={};for(var u=0,g=n;u<g.length;u+=1){var _=g[u];this.bindings[_[0]]=_[1]}};_r.prototype.concat=function(t){return new _r(this,t)},_r.prototype.get=function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")},_r.prototype.has=function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)};var Pr={kind:"null"},He={kind:"number"},yr={kind:"string"},Ke={kind:"boolean"},wn={kind:"color"},an={kind:"object"},Lr={kind:"value"},_n={kind:"collator"},Nr={kind:"formatted"},Gi={kind:"resolvedImage"};function ri(t,n){return{kind:"array",itemType:t,N:n}}function qn(t){if("array"===t.kind){var n=qn(t.itemType);return"number"==typeof t.N?"array<"+n+", "+t.N+">":"value"===t.itemType.kind?"array":"array<"+n+">"}return t.kind}var En=[Pr,He,yr,Ke,wn,Nr,an,ri(Lr),Gi];function ho(t,n){if("error"===n.kind)return null;if("array"===t.kind){if("array"===n.kind&&(0===n.N&&"value"===n.itemType.kind||!ho(t.itemType,n.itemType))&&("number"!=typeof t.N||t.N===n.N))return null}else{if(t.kind===n.kind)return null;if("value"===t.kind)for(var u=0,g=En;u<g.length;u+=1)if(!ho(g[u],n))return null}return"Expected "+qn(t)+" but found "+qn(n)+" instead."}function li(t,n){return n.some(function(u){return u.kind===t.kind})}function Gr(t,n){return n.some(function(u){return"null"===u?null===t:"array"===u?Array.isArray(t):"object"===u?t&&!Array.isArray(t)&&"object"==typeof t:u===typeof t})}var fa=lt(function(t,n){var u={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function g(D){return(D=Math.round(D))<0?0:D>255?255:D}function _(D){return g("%"===D[D.length-1]?parseFloat(D)/100*255:parseInt(D))}function w(D){return(z="%"===D[D.length-1]?parseFloat(D)/100:parseFloat(D))<0?0:z>1?1:z;var z}function S(D,z,q){return q<0?q+=1:q>1&&(q-=1),6*q<1?D+(z-D)*q*6:2*q<1?z:3*q<2?D+(z-D)*(2/3-q)*6:D}try{n.parseCSSColor=function(D){var z,q=D.replace(/ /g,"").toLowerCase();if(q in u)return u[q].slice();if("#"===q[0])return 4===q.length?(z=parseInt(q.substr(1),16))>=0&&z<=4095?[(3840&z)>>4|(3840&z)>>8,240&z|(240&z)>>4,15&z|(15&z)<<4,1]:null:7===q.length&&(z=parseInt(q.substr(1),16))>=0&&z<=16777215?[(16711680&z)>>16,(65280&z)>>8,255&z,1]:null;var G=q.indexOf("("),J=q.indexOf(")");if(-1!==G&&J+1===q.length){var ut=q.substr(0,G),mt=q.substr(G+1,J-(G+1)).split(","),zt=1;switch(ut){case"rgba":if(4!==mt.length)return null;zt=w(mt.pop());case"rgb":return 3!==mt.length?null:[_(mt[0]),_(mt[1]),_(mt[2]),zt];case"hsla":if(4!==mt.length)return null;zt=w(mt.pop());case"hsl":if(3!==mt.length)return null;var Vt=(parseFloat(mt[0])%360+360)%360/360,fe=w(mt[1]),ne=w(mt[2]),Ee=ne<=.5?ne*(fe+1):ne+fe-ne*fe,Ce=2*ne-Ee;return[g(255*S(Ce,Ee,Vt+1/3)),g(255*S(Ce,Ee,Vt)),g(255*S(Ce,Ee,Vt-1/3)),zt];default:return null}}return null}}catch{}}).parseCSSColor,Jn=function(t,n,u,g){void 0===g&&(g=1),this.r=t,this.g=n,this.b=u,this.a=g};Jn.parse=function(t){if(t){if(t instanceof Jn)return t;if("string"==typeof t){var n=fa(t);if(n)return new Jn(n[0]/255*n[3],n[1]/255*n[3],n[2]/255*n[3],n[3])}}},Jn.prototype.toString=function(){var t=this.toArray(),n=t[1],u=t[2],g=t[3];return"rgba("+Math.round(t[0])+","+Math.round(n)+","+Math.round(u)+","+g+")"},Jn.prototype.toArray=function(){var t=this.a;return 0===t?[0,0,0,0]:[255*this.r/t,255*this.g/t,255*this.b/t,t]},Jn.black=new Jn(0,0,0,1),Jn.white=new Jn(1,1,1,1),Jn.transparent=new Jn(0,0,0,0),Jn.red=new Jn(1,0,0,1);var Ra=function(t,n,u){this.sensitivity=t?n?"variant":"case":n?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Ra.prototype.compare=function(t,n){return this.collator.compare(t,n)},Ra.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Ka=function(t,n,u,g,_){this.text=t,this.image=n,this.scale=u,this.fontStack=g,this.textColor=_},Ro=function(t){this.sections=t};Ro.fromString=function(t){return new Ro([new Ka(t,null,null,null,null)])},Ro.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some(function(t){return 0!==t.text.length||t.image&&0!==t.image.name.length})},Ro.factory=function(t){return t instanceof Ro?t:Ro.fromString(t)},Ro.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map(function(t){return t.text}).join("")},Ro.prototype.serialize=function(){for(var t=["format"],n=0,u=this.sections;n<u.length;n+=1){var g=u[n];if(g.image)t.push(["image",g.image.name]);else{t.push(g.text);var _={};g.fontStack&&(_["text-font"]=["literal",g.fontStack.split(",")]),g.scale&&(_["font-scale"]=g.scale),g.textColor&&(_["text-color"]=["rgba"].concat(g.textColor.toArray())),t.push(_)}}return t};var Hn=function(t){this.name=t.name,this.available=t.available};function mu(t,n,u,g){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof n&&n>=0&&n<=255&&"number"==typeof u&&u>=0&&u<=255?void 0===g||"number"==typeof g&&g>=0&&g<=1?null:"Invalid rgba value ["+[t,n,u,g].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof g?[t,n,u,g]:[t,n,u]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function xa(t){if(null===t||"string"==typeof t||"boolean"==typeof t||"number"==typeof t||t instanceof Jn||t instanceof Ra||t instanceof Ro||t instanceof Hn)return!0;if(Array.isArray(t)){for(var n=0,u=t;n<u.length;n+=1)if(!xa(u[n]))return!1;return!0}if("object"==typeof t){for(var g in t)if(!xa(t[g]))return!1;return!0}return!1}function $o(t){if(null===t)return Pr;if("string"==typeof t)return yr;if("boolean"==typeof t)return Ke;if("number"==typeof t)return He;if(t instanceof Jn)return wn;if(t instanceof Ra)return _n;if(t instanceof Ro)return Nr;if(t instanceof Hn)return Gi;if(Array.isArray(t)){for(var n,u=t.length,g=0,_=t;g<_.length;g+=1){var w=$o(_[g]);if(n){if(n===w)continue;n=Lr;break}n=w}return ri(n||Lr,u)}return an}function su(t){var n=typeof t;return null===t?"":"string"===n||"number"===n||"boolean"===n?String(t):t instanceof Jn||t instanceof Ro||t instanceof Hn?t.toString():JSON.stringify(t)}Hn.prototype.toString=function(){return this.name},Hn.fromString=function(t){return t?new Hn({name:t,available:!1}):null},Hn.prototype.serialize=function(){return["image",this.name]};var Pn=function(t,n){this.type=t,this.value=n};Pn.parse=function(t,n){if(2!==t.length)return n.error("'literal' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(!xa(t[1]))return n.error("invalid value");var u=t[1],g=$o(u),_=n.expectedType;return"array"!==g.kind||0!==g.N||!_||"array"!==_.kind||"number"==typeof _.N&&0!==_.N||(g=_),new Pn(g,u)},Pn.prototype.evaluate=function(){return this.value},Pn.prototype.eachChild=function(){},Pn.prototype.outputDefined=function(){return!0},Pn.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Jn?["rgba"].concat(this.value.toArray()):this.value instanceof Ro?this.value.serialize():this.value};var _o=function(t){this.name="ExpressionEvaluationError",this.message=t};_o.prototype.toJSON=function(){return this.message};var Fo={string:yr,number:He,boolean:Ke,object:an},Fa=function(t,n){this.type=t,this.args=n};Fa.parse=function(t,n){if(t.length<2)return n.error("Expected at least one argument.");var u,g=1,_=t[0];if("array"===_){var w,S;if(t.length>2){var D=t[1];if("string"!=typeof D||!(D in Fo)||"object"===D)return n.error('The item type argument of "array" must be one of string, number, boolean',1);w=Fo[D],g++}else w=Lr;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return n.error('The length argument to "array" must be a positive integer literal',2);S=t[2],g++}u=ri(w,S)}else u=Fo[_];for(var z=[];g<t.length;g++){var q=n.parse(t[g],g,Lr);if(!q)return null;z.push(q)}return new Fa(u,z)},Fa.prototype.evaluate=function(t){for(var n=0;n<this.args.length;n++){var u=this.args[n].evaluate(t);if(!ho(this.type,$o(u)))return u;if(n===this.args.length-1)throw new _o("Expected value to be of type "+qn(this.type)+", but found "+qn($o(u))+" instead.")}return null},Fa.prototype.eachChild=function(t){this.args.forEach(t)},Fa.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},Fa.prototype.serialize=function(){var t=this.type,n=[t.kind];if("array"===t.kind){var u=t.itemType;if("string"===u.kind||"number"===u.kind||"boolean"===u.kind){n.push(u.kind);var g=t.N;("number"==typeof g||this.args.length>1)&&n.push(g)}}return n.concat(this.args.map(function(_){return _.serialize()}))};var xn=function(t){this.type=Nr,this.sections=t};xn.parse=function(t,n){if(t.length<2)return n.error("Expected at least one argument.");var u=t[1];if(!Array.isArray(u)&&"object"==typeof u)return n.error("First argument must be an image or text section.");for(var g=[],_=!1,w=1;w<=t.length-1;++w){var S=t[w];if(_&&"object"==typeof S&&!Array.isArray(S)){_=!1;var D=null;if(S["font-scale"]&&!(D=n.parse(S["font-scale"],1,He)))return null;var z=null;if(S["text-font"]&&!(z=n.parse(S["text-font"],1,ri(yr))))return null;var q=null;if(S["text-color"]&&!(q=n.parse(S["text-color"],1,wn)))return null;var G=g[g.length-1];G.scale=D,G.font=z,G.textColor=q}else{var J=n.parse(t[w],1,Lr);if(!J)return null;var ut=J.type.kind;if("string"!==ut&&"value"!==ut&&"null"!==ut&&"resolvedImage"!==ut)return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,g.push({content:J,scale:null,font:null,textColor:null})}}return new xn(g)},xn.prototype.evaluate=function(t){return new Ro(this.sections.map(function(n){var u=n.content.evaluate(t);return $o(u)===Gi?new Ka("",u,null,null,null):new Ka(su(u),null,n.scale?n.scale.evaluate(t):null,n.font?n.font.evaluate(t).join(","):null,n.textColor?n.textColor.evaluate(t):null)}))},xn.prototype.eachChild=function(t){for(var n=0,u=this.sections;n<u.length;n+=1){var g=u[n];t(g.content),g.scale&&t(g.scale),g.font&&t(g.font),g.textColor&&t(g.textColor)}},xn.prototype.outputDefined=function(){return!1},xn.prototype.serialize=function(){for(var t=["format"],n=0,u=this.sections;n<u.length;n+=1){var g=u[n];t.push(g.content.serialize());var _={};g.scale&&(_["font-scale"]=g.scale.serialize()),g.font&&(_["text-font"]=g.font.serialize()),g.textColor&&(_["text-color"]=g.textColor.serialize()),t.push(_)}return t};var Iu=function(t){this.type=Gi,this.input=t};Iu.parse=function(t,n){if(2!==t.length)return n.error("Expected two arguments.");var u=n.parse(t[1],1,yr);return u?new Iu(u):n.error("No image name provided.")},Iu.prototype.evaluate=function(t){var n=this.input.evaluate(t),u=Hn.fromString(n);return u&&t.availableImages&&(u.available=t.availableImages.indexOf(n)>-1),u},Iu.prototype.eachChild=function(t){t(this.input)},Iu.prototype.outputDefined=function(){return!1},Iu.prototype.serialize=function(){return["image",this.input.serialize()]};var oc={"to-boolean":Ke,"to-color":wn,"to-number":He,"to-string":yr},A=function(t,n){this.type=t,this.args=n};A.parse=function(t,n){if(t.length<2)return n.error("Expected at least one argument.");var u=t[0];if(("to-boolean"===u||"to-string"===u)&&2!==t.length)return n.error("Expected one argument.");for(var g=oc[u],_=[],w=1;w<t.length;w++){var S=n.parse(t[w],w,Lr);if(!S)return null;_.push(S)}return new A(g,_)},A.prototype.evaluate=function(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){for(var n,u,g=0,_=this.args;g<_.length;g+=1){if(u=null,(n=_[g].evaluate(t))instanceof Jn)return n;if("string"==typeof n){var w=t.parseColor(n);if(w)return w}else if(Array.isArray(n)&&!(u=n.length<3||n.length>4?"Invalid rbga value "+JSON.stringify(n)+": expected an array containing either three or four numeric values.":mu(n[0],n[1],n[2],n[3])))return new Jn(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new _o(u||"Could not parse color from value '"+("string"==typeof n?n:String(JSON.stringify(n)))+"'")}if("number"===this.type.kind){for(var S=null,D=0,z=this.args;D<z.length;D+=1){if(null===(S=z[D].evaluate(t)))return 0;var q=Number(S);if(!isNaN(q))return q}throw new _o("Could not convert "+JSON.stringify(S)+" to number.")}return"formatted"===this.type.kind?Ro.fromString(su(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?Hn.fromString(su(this.args[0].evaluate(t))):su(this.args[0].evaluate(t))},A.prototype.eachChild=function(t){this.args.forEach(t)},A.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},A.prototype.serialize=function(){if("formatted"===this.type.kind)return new xn([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Iu(this.args[0]).serialize();var t=["to-"+this.type.kind];return this.eachChild(function(n){t.push(n.serialize())}),t};var U=["Unknown","Point","LineString","Polygon"],ct=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};ct.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},ct.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?U[this.feature.type]:this.feature.type:null},ct.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},ct.prototype.canonicalID=function(){return this.canonical},ct.prototype.properties=function(){return this.feature&&this.feature.properties||{}},ct.prototype.parseColor=function(t){var n=this._parseColorCache[t];return n||(n=this._parseColorCache[t]=Jn.parse(t)),n};var oe=function(t,n,u,g){this.name=t,this.type=n,this._evaluate=u,this.args=g};oe.prototype.evaluate=function(t){return this._evaluate(t,this.args)},oe.prototype.eachChild=function(t){this.args.forEach(t)},oe.prototype.outputDefined=function(){return!1},oe.prototype.serialize=function(){return[this.name].concat(this.args.map(function(t){return t.serialize()}))},oe.parse=function(t,n){var u,g=t[0],_=oe.definitions[g];if(!_)return n.error('Unknown expression "'+g+'". If you wanted a literal array, use ["literal", [...]].',0);for(var w=Array.isArray(_)?_[0]:_.type,S=Array.isArray(_)?[[_[1],_[2]]]:_.overloads,D=S.filter(function(nn){var Fr=nn[0];return!Array.isArray(Fr)||Fr.length===t.length-1}),z=null,q=0,G=D;q<G.length;q+=1){var J=G[q],ut=J[0],mt=J[1];z=new ni(n.registry,n.path,null,n.scope);for(var zt=[],Vt=!1,fe=1;fe<t.length;fe++){var ne=t[fe],Ee=Array.isArray(ut)?ut[fe-1]:ut.type,Ce=z.parse(ne,1+zt.length,Ee);if(!Ce){Vt=!0;break}zt.push(Ce)}if(!Vt)if(Array.isArray(ut)&&ut.length!==zt.length)z.error("Expected "+ut.length+" arguments, but found "+zt.length+" instead.");else{for(var Re=0;Re<zt.length;Re++){var Be=Array.isArray(ut)?ut[Re]:ut.type,rr=zt[Re];z.concat(Re+1).checkSubtype(Be,rr.type)}if(0===z.errors.length)return new oe(g,w,mt,zt)}}if(1===D.length)(u=n.errors).push.apply(u,z.errors);else{for(var wr=(D.length?D:S).map(function(nn){var Fr;return Fr=nn[0],Array.isArray(Fr)?"("+Fr.map(qn).join(", ")+")":"("+qn(Fr.type)+"...)"}).join(" | "),Er=[],Hr=1;Hr<t.length;Hr++){var Ar=n.parse(t[Hr],1+Er.length);if(!Ar)return null;Er.push(qn(Ar.type))}n.error("Expected arguments of type "+wr+", but found ("+Er.join(", ")+") instead.")}return null},oe.register=function(t,n){for(var u in oe.definitions=n,n)t[u]=oe};var Se=function(t,n,u){this.type=_n,this.locale=u,this.caseSensitive=t,this.diacriticSensitive=n};function Bt(t,n){t[0]=Math.min(t[0],n[0]),t[1]=Math.min(t[1],n[1]),t[2]=Math.max(t[2],n[0]),t[3]=Math.max(t[3],n[1])}function Pe(t,n){return!(t[0]<=n[0]||t[2]>=n[2]||t[1]<=n[1]||t[3]>=n[3])}function cr(t,n){var u=(180+t[0])/360,g=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,_=Math.pow(2,n.z);return[Math.round(u*_*8192),Math.round(g*_*8192)]}function ur(t,n,u){return n[1]>t[1]!=u[1]>t[1]&&t[0]<(u[0]-n[0])*(t[1]-n[1])/(u[1]-n[1])+n[0]}function Rr(t,n){for(var u,g,_,w,S,D,z,q=!1,G=0,J=n.length;G<J;G++)for(var ut=n[G],mt=0,zt=ut.length;mt<zt-1;mt++){if((w=(u=t)[0]-(g=ut[mt])[0])*(z=u[1]-(_=ut[mt+1])[1])-(D=u[0]-_[0])*(S=u[1]-g[1])==0&&w*D<=0&&S*z<=0)return!1;ur(t,ut[mt],ut[mt+1])&&(q=!q)}return q}function Ae(t,n){for(var u=0;u<n.length;u++)if(Rr(t,n[u]))return!0;return!1}function sr(t,n,u,g){var _=g[0]-u[0],w=g[1]-u[1],S=(t[0]-u[0])*w-_*(t[1]-u[1]),D=(n[0]-u[0])*w-_*(n[1]-u[1]);return S>0&&D<0||S<0&&D>0}function hr(t,n,u){for(var g=0,_=u;g<_.length;g+=1)for(var w=_[g],S=0;S<w.length-1;++S)if((J=[(G=w[S+1])[0]-(q=w[S])[0],G[1]-q[1]])[0]*(ut=[(z=n)[0]-(D=t)[0],z[1]-D[1]])[1]-J[1]*ut[0]!=0&&sr(D,z,q,G)&&sr(q,G,D,z))return!0;var D,z,q,G,J,ut;return!1}function Dr(t,n){for(var u=0;u<t.length;++u)if(!Rr(t[u],n))return!1;for(var g=0;g<t.length-1;++g)if(hr(t[g],t[g+1],n))return!1;return!0}function Tn(t,n){for(var u=0;u<n.length;u++)if(Dr(t,n[u]))return!0;return!1}function zo(t,n,u){for(var g=[],_=0;_<t.length;_++){for(var w=[],S=0;S<t[_].length;S++){var D=cr(t[_][S],u);Bt(n,D),w.push(D)}g.push(w)}return g}function $e(t,n,u){for(var g=[],_=0;_<t.length;_++){var w=zo(t[_],n,u);g.push(w)}return g}function Vr(t,n,u,g){if(t[0]<u[0]||t[0]>u[2]){var _=.5*g,w=t[0]-u[0]>_?-g:u[0]-t[0]>_?g:0;0===w&&(w=t[0]-u[2]>_?-g:u[2]-t[0]>_?g:0),t[0]+=w}Bt(n,t)}function Qn(t,n,u,g){for(var _=8192*Math.pow(2,g.z),w=[8192*g.x,8192*g.y],S=[],D=0,z=t;D<z.length;D+=1)for(var q=0,G=z[D];q<G.length;q+=1){var J=G[q],ut=[J.x+w[0],J.y+w[1]];Vr(ut,n,u,_),S.push(ut)}return S}function en(t,n,u,g){for(var _,w=8192*Math.pow(2,g.z),S=[8192*g.x,8192*g.y],D=[],z=0,q=t;z<q.length;z+=1){for(var G=[],J=0,ut=q[z];J<ut.length;J+=1){var mt=ut[J],zt=[mt.x+S[0],mt.y+S[1]];Bt(n,zt),G.push(zt)}D.push(G)}if(n[2]-n[0]<=w/2){(_=n)[0]=_[1]=1/0,_[2]=_[3]=-1/0;for(var Vt=0,fe=D;Vt<fe.length;Vt+=1)for(var ne=0,Ee=fe[Vt];ne<Ee.length;ne+=1)Vr(Ee[ne],n,u,w)}return D}Se.parse=function(t,n){if(2!==t.length)return n.error("Expected one argument.");var u=t[1];if("object"!=typeof u||Array.isArray(u))return n.error("Collator options argument must be an object.");var g=n.parse(void 0!==u["case-sensitive"]&&u["case-sensitive"],1,Ke);if(!g)return null;var _=n.parse(void 0!==u["diacritic-sensitive"]&&u["diacritic-sensitive"],1,Ke);if(!_)return null;var w=null;return u.locale&&!(w=n.parse(u.locale,1,yr))?null:new Se(g,_,w)},Se.prototype.evaluate=function(t){return new Ra(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)},Se.prototype.eachChild=function(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)},Se.prototype.outputDefined=function(){return!1},Se.prototype.serialize=function(){var t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]};var ci=function(t,n){this.type=Ke,this.geojson=t,this.geometries=n};function zr(t){if(t instanceof oe&&("get"===t.name&&1===t.args.length||"feature-state"===t.name||"has"===t.name&&1===t.args.length||"properties"===t.name||"geometry-type"===t.name||"id"===t.name||/^filter-/.test(t.name))||t instanceof ci)return!1;var n=!0;return t.eachChild(function(u){n&&!zr(u)&&(n=!1)}),n}function Qo(t){if(t instanceof oe&&"feature-state"===t.name)return!1;var n=!0;return t.eachChild(function(u){n&&!Qo(u)&&(n=!1)}),n}function ls(t,n){if(t instanceof oe&&n.indexOf(t.name)>=0)return!1;var u=!0;return t.eachChild(function(g){u&&!ls(g,n)&&(u=!1)}),u}ci.parse=function(t,n){if(2!==t.length)return n.error("'within' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(xa(t[1])){var u=t[1];if("FeatureCollection"===u.type)for(var g=0;g<u.features.length;++g){var _=u.features[g].geometry.type;if("Polygon"===_||"MultiPolygon"===_)return new ci(u,u.features[g].geometry)}else if("Feature"===u.type){var w=u.geometry.type;if("Polygon"===w||"MultiPolygon"===w)return new ci(u,u.geometry)}else if("Polygon"===u.type||"MultiPolygon"===u.type)return new ci(u,u)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")},ci.prototype.evaluate=function(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(n,u){var g=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],w=n.canonicalID();if("Polygon"===u.type){var S=zo(u.coordinates,_,w),D=Qn(n.geometry(),g,_,w);if(!Pe(g,_))return!1;for(var z=0,q=D;z<q.length;z+=1)if(!Rr(q[z],S))return!1}if("MultiPolygon"===u.type){var G=$e(u.coordinates,_,w),J=Qn(n.geometry(),g,_,w);if(!Pe(g,_))return!1;for(var ut=0,mt=J;ut<mt.length;ut+=1)if(!Ae(mt[ut],G))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(n,u){var g=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],w=n.canonicalID();if("Polygon"===u.type){var S=zo(u.coordinates,_,w),D=en(n.geometry(),g,_,w);if(!Pe(g,_))return!1;for(var z=0,q=D;z<q.length;z+=1)if(!Dr(q[z],S))return!1}if("MultiPolygon"===u.type){var G=$e(u.coordinates,_,w),J=en(n.geometry(),g,_,w);if(!Pe(g,_))return!1;for(var ut=0,mt=J;ut<mt.length;ut+=1)if(!Tn(mt[ut],G))return!1}return!0}(t,this.geometries)}return!1},ci.prototype.eachChild=function(){},ci.prototype.outputDefined=function(){return!0},ci.prototype.serialize=function(){return["within",this.geojson]};var Qr=function(t,n){this.type=n.type,this.name=t,this.boundExpression=n};Qr.parse=function(t,n){if(2!==t.length||"string"!=typeof t[1])return n.error("'var' expression requires exactly one string literal argument.");var u=t[1];return n.scope.has(u)?new Qr(u,n.scope.get(u)):n.error('Unknown variable "'+u+'". Make sure "'+u+'" has been bound in an enclosing "let" expression before using it.',1)},Qr.prototype.evaluate=function(t){return this.boundExpression.evaluate(t)},Qr.prototype.eachChild=function(){},Qr.prototype.outputDefined=function(){return!1},Qr.prototype.serialize=function(){return["var",this.name]};var ni=function(t,n,u,g,_){void 0===n&&(n=[]),void 0===g&&(g=new _r),void 0===_&&(_=[]),this.registry=t,this.path=n,this.key=n.map(function(w){return"["+w+"]"}).join(""),this.scope=g,this.errors=_,this.expectedType=u};function Ao(t,n){for(var u,g=t.length-1,_=0,w=g,S=0;_<=w;)if((u=t[S=Math.floor((_+w)/2)])<=n){if(S===g||n<t[S+1])return S;_=S+1}else{if(!(u>n))throw new _o("Input is not a number.");w=S-1}return 0}ni.prototype.parse=function(t,n,u,g,_){return void 0===_&&(_={}),n?this.concat(n,u,g)._parse(t,_):this._parse(t,_)},ni.prototype._parse=function(t,n){function u(q,G,J){return"assert"===J?new Fa(G,[q]):"coerce"===J?new A(G,[q]):q}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var g=t[0];if("string"!=typeof g)return this.error("Expression name must be a string, but found "+typeof g+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var _=this.registry[g];if(_){var w=_.parse(t,this);if(!w)return null;if(this.expectedType){var S=this.expectedType,D=w.type;if("string"!==S.kind&&"number"!==S.kind&&"boolean"!==S.kind&&"object"!==S.kind&&"array"!==S.kind||"value"!==D.kind)if("color"!==S.kind&&"formatted"!==S.kind&&"resolvedImage"!==S.kind||"value"!==D.kind&&"string"!==D.kind){if(this.checkSubtype(S,D))return null}else w=u(w,S,n.typeAnnotation||"coerce");else w=u(w,S,n.typeAnnotation||"assert")}if(!(w instanceof Pn)&&"resolvedImage"!==w.type.kind&&function q(G){if(G instanceof Qr)return q(G.boundExpression);if(G instanceof oe&&"error"===G.name||G instanceof Se||G instanceof ci)return!1;var J=G instanceof A||G instanceof Fa,ut=!0;return G.eachChild(function(mt){ut=J?ut&&q(mt):ut&&mt instanceof Pn}),!!ut&&zr(G)&&ls(G,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(w)){var z=new ct;try{w=new Pn(w.type,w.evaluate(z))}catch(q){return this.error(q.message),null}}return w}return this.error('Unknown expression "'+g+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(void 0===t?"'undefined' value invalid. Use null instead.":"object"==typeof t?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof t+" instead.")},ni.prototype.concat=function(t,n,u){var g="number"==typeof t?this.path.concat(t):this.path,_=u?this.scope.concat(u):this.scope;return new ni(this.registry,g,n||null,_,this.errors)},ni.prototype.error=function(t){for(var n=[],u=arguments.length-1;u-- >0;)n[u]=arguments[u+1];var g=""+this.key+n.map(function(_){return"["+_+"]"}).join("");this.errors.push(new vr(g,t))},ni.prototype.checkSubtype=function(t,n){var u=ho(t,n);return u&&this.error(u),u};var Lo=function(t,n,u){this.type=t,this.input=n,this.labels=[],this.outputs=[];for(var g=0,_=u;g<_.length;g+=1){var w=_[g],S=w[1];this.labels.push(w[0]),this.outputs.push(S)}};function io(t,n,u){return t*(1-u)+n*u}Lo.parse=function(t,n){if(t.length-1<4)return n.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");var u=n.parse(t[1],1,He);if(!u)return null;var g=[],_=null;n.expectedType&&"value"!==n.expectedType.kind&&(_=n.expectedType);for(var w=1;w<t.length;w+=2){var S=1===w?-1/0:t[w],D=t[w+1],z=w,q=w+1;if("number"!=typeof S)return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',z);if(g.length&&g[g.length-1][0]>=S)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',z);var G=n.parse(D,q,_);if(!G)return null;_=_||G.type,g.push([S,G])}return new Lo(_,u,g)},Lo.prototype.evaluate=function(t){var n=this.labels,u=this.outputs;if(1===n.length)return u[0].evaluate(t);var g=this.input.evaluate(t);if(g<=n[0])return u[0].evaluate(t);var _=n.length;return g>=n[_-1]?u[_-1].evaluate(t):u[Ao(n,g)].evaluate(t)},Lo.prototype.eachChild=function(t){t(this.input);for(var n=0,u=this.outputs;n<u.length;n+=1)t(u[n])},Lo.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})},Lo.prototype.serialize=function(){for(var t=["step",this.input.serialize()],n=0;n<this.labels.length;n++)n>0&&t.push(this.labels[n]),t.push(this.outputs[n].serialize());return t};var ba=Object.freeze({__proto__:null,number:io,color:function(t,n,u){return new Jn(io(t.r,n.r,u),io(t.g,n.g,u),io(t.b,n.b,u),io(t.a,n.a,u))},array:function(t,n,u){return t.map(function(g,_){return io(g,n[_],u)})}}),yu=6/29*3*(6/29),Do=Math.PI/180,jl=180/Math.PI;function Vn(t){return t>.008856451679035631?Math.pow(t,1/3):t/yu+4/29}function wo(t){return t>6/29?t*t*t:yu*(t-4/29)}function Ho(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function zu(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Dl(t){var n=zu(t.r),u=zu(t.g),g=zu(t.b),_=Vn((.4124564*n+.3575761*u+.1804375*g)/.95047),w=Vn((.2126729*n+.7151522*u+.072175*g)/1);return{l:116*w-16,a:500*(_-w),b:200*(w-Vn((.0193339*n+.119192*u+.9503041*g)/1.08883)),alpha:t.a}}function xs(t){var n=(t.l+16)/116,u=isNaN(t.a)?n:n+t.a/500,g=isNaN(t.b)?n:n-t.b/200;return n=1*wo(n),u=.95047*wo(u),g=1.08883*wo(g),new Jn(Ho(3.2404542*u-1.5371385*n-.4985314*g),Ho(-.969266*u+1.8760108*n+.041556*g),Ho(.0556434*u-.2040259*n+1.0572252*g),t.alpha)}function Ol(t,n,u){var g=n-t;return t+u*(g>180||g<-180?g-360*Math.round(g/360):g)}var tl={forward:Dl,reverse:xs,interpolate:function(t,n,u){return{l:io(t.l,n.l,u),a:io(t.a,n.a,u),b:io(t.b,n.b,u),alpha:io(t.alpha,n.alpha,u)}}},da={forward:function(t){var n=Dl(t),u=n.l,g=n.a,_=n.b,w=Math.atan2(_,g)*jl;return{h:w<0?w+360:w,c:Math.sqrt(g*g+_*_),l:u,alpha:t.a}},reverse:function(t){var n=t.h*Do,u=t.c;return xs({l:t.l,a:Math.cos(n)*u,b:Math.sin(n)*u,alpha:t.alpha})},interpolate:function(t,n,u){return{h:Ol(t.h,n.h,u),c:io(t.c,n.c,u),l:io(t.l,n.l,u),alpha:io(t.alpha,n.alpha,u)}}},Ys=Object.freeze({__proto__:null,lab:tl,hcl:da}),yi=function(t,n,u,g,_){this.type=t,this.operator=n,this.interpolation=u,this.input=g,this.labels=[],this.outputs=[];for(var w=0,S=_;w<S.length;w+=1){var D=S[w],z=D[1];this.labels.push(D[0]),this.outputs.push(z)}};function uu(t,n,u,g){var _=g-u,w=t-u;return 0===_?0:1===n?w/_:(Math.pow(n,w)-1)/(Math.pow(n,_)-1)}yi.interpolationFactor=function(t,n,u,g){var _=0;if("exponential"===t.name)_=uu(n,t.base,u,g);else if("linear"===t.name)_=uu(n,1,u,g);else if("cubic-bezier"===t.name){var w=t.controlPoints;_=new ht(w[0],w[1],w[2],w[3]).solve(uu(n,1,u,g))}return _},yi.parse=function(t,n){var u=t[0],g=t[1],_=t[2],w=t.slice(3);if(!Array.isArray(g)||0===g.length)return n.error("Expected an interpolation type expression.",1);if("linear"===g[0])g={name:"linear"};else if("exponential"===g[0]){var S=g[1];if("number"!=typeof S)return n.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:S}}else{if("cubic-bezier"!==g[0])return n.error("Unknown interpolation type "+String(g[0]),1,0);var D=g.slice(1);if(4!==D.length||D.some(function(fe){return"number"!=typeof fe||fe<0||fe>1}))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:D}}if(t.length-1<4)return n.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(!(_=n.parse(_,2,He)))return null;var z=[],q=null;"interpolate-hcl"===u||"interpolate-lab"===u?q=wn:n.expectedType&&"value"!==n.expectedType.kind&&(q=n.expectedType);for(var G=0;G<w.length;G+=2){var J=w[G],ut=w[G+1],mt=G+3,zt=G+4;if("number"!=typeof J)return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',mt);if(z.length&&z[z.length-1][0]>=J)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',mt);var Vt=n.parse(ut,zt,q);if(!Vt)return null;q=q||Vt.type,z.push([J,Vt])}return"number"===q.kind||"color"===q.kind||"array"===q.kind&&"number"===q.itemType.kind&&"number"==typeof q.N?new yi(q,u,g,_,z):n.error("Type "+qn(q)+" is not interpolatable.")},yi.prototype.evaluate=function(t){var n=this.labels,u=this.outputs;if(1===n.length)return u[0].evaluate(t);var g=this.input.evaluate(t);if(g<=n[0])return u[0].evaluate(t);var _=n.length;if(g>=n[_-1])return u[_-1].evaluate(t);var w=Ao(n,g),S=yi.interpolationFactor(this.interpolation,g,n[w],n[w+1]),D=u[w].evaluate(t),z=u[w+1].evaluate(t);return"interpolate"===this.operator?ba[this.type.kind.toLowerCase()](D,z,S):"interpolate-hcl"===this.operator?da.reverse(da.interpolate(da.forward(D),da.forward(z),S)):tl.reverse(tl.interpolate(tl.forward(D),tl.forward(z),S))},yi.prototype.eachChild=function(t){t(this.input);for(var n=0,u=this.outputs;n<u.length;n+=1)t(u[n])},yi.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})},yi.prototype.serialize=function(){var t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var n=[this.operator,t,this.input.serialize()],u=0;u<this.labels.length;u++)n.push(this.labels[u],this.outputs[u].serialize());return n};var wa=function(t,n){this.type=t,this.args=n};wa.parse=function(t,n){if(t.length<2)return n.error("Expectected at least one argument.");var u=null,g=n.expectedType;g&&"value"!==g.kind&&(u=g);for(var _=[],w=0,S=t.slice(1);w<S.length;w+=1){var D=n.parse(S[w],1+_.length,u,void 0,{typeAnnotation:"omit"});if(!D)return null;u=u||D.type,_.push(D)}var z=g&&_.some(function(q){return ho(g,q.type)});return new wa(z?Lr:u,_)},wa.prototype.evaluate=function(t){for(var n,u=null,g=0,_=0,w=this.args;_<w.length&&(g++,(u=w[_].evaluate(t))&&u instanceof Hn&&!u.available&&(n||(n=u.name),u=null,g===this.args.length&&(u=n)),null===u);_+=1);return u},wa.prototype.eachChild=function(t){this.args.forEach(t)},wa.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},wa.prototype.serialize=function(){var t=["coalesce"];return this.eachChild(function(n){t.push(n.serialize())}),t};var Rs=function(t,n){this.type=n.type,this.bindings=[].concat(t),this.result=n};Rs.prototype.evaluate=function(t){return this.result.evaluate(t)},Rs.prototype.eachChild=function(t){for(var n=0,u=this.bindings;n<u.length;n+=1)t(u[n][1]);t(this.result)},Rs.parse=function(t,n){if(t.length<4)return n.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.");for(var u=[],g=1;g<t.length-1;g+=2){var _=t[g];if("string"!=typeof _)return n.error("Expected string, but found "+typeof _+" instead.",g);if(/[^a-zA-Z0-9_]/.test(_))return n.error("Variable names must contain only alphanumeric characters or '_'.",g);var w=n.parse(t[g+1],g+1);if(!w)return null;u.push([_,w])}var S=n.parse(t[t.length-1],t.length-1,n.expectedType,u);return S?new Rs(u,S):null},Rs.prototype.outputDefined=function(){return this.result.outputDefined()},Rs.prototype.serialize=function(){for(var t=["let"],n=0,u=this.bindings;n<u.length;n+=1){var g=u[n];t.push(g[0],g[1].serialize())}return t.push(this.result.serialize()),t};var Fi=function(t,n,u){this.type=t,this.index=n,this.input=u};Fi.parse=function(t,n){if(3!==t.length)return n.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var u=n.parse(t[1],1,He),g=n.parse(t[2],2,ri(n.expectedType||Lr));return u&&g?new Fi(g.type.itemType,u,g):null},Fi.prototype.evaluate=function(t){var n=this.index.evaluate(t),u=this.input.evaluate(t);if(n<0)throw new _o("Array index out of bounds: "+n+" < 0.");if(n>=u.length)throw new _o("Array index out of bounds: "+n+" > "+(u.length-1)+".");if(n!==Math.floor(n))throw new _o("Array index must be an integer, but found "+n+" instead.");return u[n]},Fi.prototype.eachChild=function(t){t(this.index),t(this.input)},Fi.prototype.outputDefined=function(){return!1},Fi.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Jr=function(t,n){this.type=Ke,this.needle=t,this.haystack=n};Jr.parse=function(t,n){if(3!==t.length)return n.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var u=n.parse(t[1],1,Lr),g=n.parse(t[2],2,Lr);return u&&g?li(u.type,[Ke,yr,He,Pr,Lr])?new Jr(u,g):n.error("Expected first argument to be of type boolean, string, number or null, but found "+qn(u.type)+" instead"):null},Jr.prototype.evaluate=function(t){var n=this.needle.evaluate(t),u=this.haystack.evaluate(t);if(!u)return!1;if(!Gr(n,["boolean","string","number","null"]))throw new _o("Expected first argument to be of type boolean, string, number or null, but found "+qn($o(n))+" instead.");if(!Gr(u,["string","array"]))throw new _o("Expected second argument to be of type array or string, but found "+qn($o(u))+" instead.");return u.indexOf(n)>=0},Jr.prototype.eachChild=function(t){t(this.needle),t(this.haystack)},Jr.prototype.outputDefined=function(){return!0},Jr.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var vu=function(t,n,u){this.type=He,this.needle=t,this.haystack=n,this.fromIndex=u};vu.parse=function(t,n){if(t.length<=2||t.length>=5)return n.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var u=n.parse(t[1],1,Lr),g=n.parse(t[2],2,Lr);if(!u||!g)return null;if(!li(u.type,[Ke,yr,He,Pr,Lr]))return n.error("Expected first argument to be of type boolean, string, number or null, but found "+qn(u.type)+" instead");if(4===t.length){var _=n.parse(t[3],3,He);return _?new vu(u,g,_):null}return new vu(u,g)},vu.prototype.evaluate=function(t){var n=this.needle.evaluate(t),u=this.haystack.evaluate(t);if(!Gr(n,["boolean","string","number","null"]))throw new _o("Expected first argument to be of type boolean, string, number or null, but found "+qn($o(n))+" instead.");if(!Gr(u,["string","array"]))throw new _o("Expected second argument to be of type array or string, but found "+qn($o(u))+" instead.");if(this.fromIndex){var g=this.fromIndex.evaluate(t);return u.indexOf(n,g)}return u.indexOf(n)},vu.prototype.eachChild=function(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)},vu.prototype.outputDefined=function(){return!1},vu.prototype.serialize=function(){if(null!=this.fromIndex&&void 0!==this.fromIndex){var t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Js=function(t,n,u,g,_,w){this.inputType=t,this.type=n,this.input=u,this.cases=g,this.outputs=_,this.otherwise=w};Js.parse=function(t,n){if(t.length<5)return n.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if(t.length%2!=1)return n.error("Expected an even number of arguments.");var u,g;n.expectedType&&"value"!==n.expectedType.kind&&(g=n.expectedType);for(var _={},w=[],S=2;S<t.length-1;S+=2){var D=t[S],z=t[S+1];Array.isArray(D)||(D=[D]);var q=n.concat(S);if(0===D.length)return q.error("Expected at least one branch label.");for(var G=0,J=D;G<J.length;G+=1){var ut=J[G];if("number"!=typeof ut&&"string"!=typeof ut)return q.error("Branch labels must be numbers or strings.");if("number"==typeof ut&&Math.abs(ut)>Number.MAX_SAFE_INTEGER)return q.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof ut&&Math.floor(ut)!==ut)return q.error("Numeric branch labels must be integer values.");if(u){if(q.checkSubtype(u,$o(ut)))return null}else u=$o(ut);if(void 0!==_[String(ut)])return q.error("Branch labels must be unique.");_[String(ut)]=w.length}var mt=n.parse(z,S,g);if(!mt)return null;g=g||mt.type,w.push(mt)}var zt=n.parse(t[1],1,Lr);if(!zt)return null;var Vt=n.parse(t[t.length-1],t.length-1,g);return Vt?"value"!==zt.type.kind&&n.concat(1).checkSubtype(u,zt.type)?null:new Js(u,g,zt,_,w,Vt):null},Js.prototype.evaluate=function(t){var n=this.input.evaluate(t);return($o(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(t)},Js.prototype.eachChild=function(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)},Js.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})&&this.otherwise.outputDefined()},Js.prototype.serialize=function(){for(var t=this,n=["match",this.input.serialize()],u=[],g={},_=0,w=Object.keys(this.cases).sort();_<w.length;_+=1){var S=w[_];void 0===(J=g[this.cases[S]])?(g[this.cases[S]]=u.length,u.push([this.cases[S],[S]])):u[J][1].push(S)}for(var D=function(mt){return"number"===t.inputType.kind?Number(mt):mt},z=0,q=u;z<q.length;z+=1){var G=q[z],J=G[0],ut=G[1];n.push(1===ut.length?D(ut[0]):ut.map(D)),n.push(this.outputs[outputIndex$1].serialize())}return n.push(this.otherwise.serialize()),n};var aa=function(t,n,u){this.type=t,this.branches=n,this.otherwise=u};aa.parse=function(t,n){if(t.length<4)return n.error("Expected at least 3 arguments, but found only "+(t.length-1)+".");if(t.length%2!=0)return n.error("Expected an odd number of arguments.");var u;n.expectedType&&"value"!==n.expectedType.kind&&(u=n.expectedType);for(var g=[],_=1;_<t.length-1;_+=2){var w=n.parse(t[_],_,Ke);if(!w)return null;var S=n.parse(t[_+1],_+1,u);if(!S)return null;g.push([w,S]),u=u||S.type}var D=n.parse(t[t.length-1],t.length-1,u);return D?new aa(u,g,D):null},aa.prototype.evaluate=function(t){for(var n=0,u=this.branches;n<u.length;n+=1){var g=u[n],_=g[1];if(g[0].evaluate(t))return _.evaluate(t)}return this.otherwise.evaluate(t)},aa.prototype.eachChild=function(t){for(var n=0,u=this.branches;n<u.length;n+=1){var g=u[n],_=g[1];t(g[0]),t(_)}t(this.otherwise)},aa.prototype.outputDefined=function(){return this.branches.every(function(t){return t[1].outputDefined()})&&this.otherwise.outputDefined()},aa.prototype.serialize=function(){var t=["case"];return this.eachChild(function(n){t.push(n.serialize())}),t};var za=function(t,n,u,g){this.type=t,this.input=n,this.beginIndex=u,this.endIndex=g};function Mu(t,n){return"=="===t||"!="===t?"boolean"===n.kind||"string"===n.kind||"number"===n.kind||"null"===n.kind||"value"===n.kind:"string"===n.kind||"number"===n.kind||"value"===n.kind}function Vi(t,n,u,g){return 0===g.compare(n,u)}function Ms(t,n,u){var g="=="!==t&&"!="!==t;return function(){function _(w,S,D){this.type=Ke,this.lhs=w,this.rhs=S,this.collator=D,this.hasUntypedArgument="value"===w.type.kind||"value"===S.type.kind}return _.parse=function(w,S){if(3!==w.length&&4!==w.length)return S.error("Expected two or three arguments.");var D=w[0],z=S.parse(w[1],1,Lr);if(!z)return null;if(!Mu(D,z.type))return S.concat(1).error('"'+D+"\" comparisons are not supported for type '"+qn(z.type)+"'.");var q=S.parse(w[2],2,Lr);if(!q)return null;if(!Mu(D,q.type))return S.concat(2).error('"'+D+"\" comparisons are not supported for type '"+qn(q.type)+"'.");if(z.type.kind!==q.type.kind&&"value"!==z.type.kind&&"value"!==q.type.kind)return S.error("Cannot compare types '"+qn(z.type)+"' and '"+qn(q.type)+"'.");g&&("value"===z.type.kind&&"value"!==q.type.kind?z=new Fa(q.type,[z]):"value"!==z.type.kind&&"value"===q.type.kind&&(q=new Fa(z.type,[q])));var G=null;if(4===w.length){if("string"!==z.type.kind&&"string"!==q.type.kind&&"value"!==z.type.kind&&"value"!==q.type.kind)return S.error("Cannot use collator to compare non-string types.");if(!(G=S.parse(w[3],3,_n)))return null}return new _(z,q,G)},_.prototype.evaluate=function(w){var S=this.lhs.evaluate(w),D=this.rhs.evaluate(w);if(g&&this.hasUntypedArgument){var z=$o(S),q=$o(D);if(z.kind!==q.kind||"string"!==z.kind&&"number"!==z.kind)throw new _o('Expected arguments for "'+t+'" to be (string, string) or (number, number), but found ('+z.kind+", "+q.kind+") instead.")}if(this.collator&&!g&&this.hasUntypedArgument){var G=$o(S),J=$o(D);if("string"!==G.kind||"string"!==J.kind)return n(w,S,D)}return this.collator?u(w,S,D,this.collator.evaluate(w)):n(w,S,D)},_.prototype.eachChild=function(w){w(this.lhs),w(this.rhs),this.collator&&w(this.collator)},_.prototype.outputDefined=function(){return!0},_.prototype.serialize=function(){var w=[t];return this.eachChild(function(S){w.push(S.serialize())}),w},_}()}za.parse=function(t,n){if(t.length<=2||t.length>=5)return n.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var u=n.parse(t[1],1,Lr),g=n.parse(t[2],2,He);if(!u||!g)return null;if(!li(u.type,[ri(Lr),yr,Lr]))return n.error("Expected first argument to be of type array or string, but found "+qn(u.type)+" instead");if(4===t.length){var _=n.parse(t[3],3,He);return _?new za(u.type,u,g,_):null}return new za(u.type,u,g)},za.prototype.evaluate=function(t){var n=this.input.evaluate(t),u=this.beginIndex.evaluate(t);if(!Gr(n,["string","array"]))throw new _o("Expected first argument to be of type array or string, but found "+qn($o(n))+" instead.");if(this.endIndex){var g=this.endIndex.evaluate(t);return n.slice(u,g)}return n.slice(u)},za.prototype.eachChild=function(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)},za.prototype.outputDefined=function(){return!1},za.prototype.serialize=function(){if(null!=this.endIndex&&void 0!==this.endIndex){var t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Hs=Ms("==",function(t,n,u){return n===u},Vi),$n=Ms("!=",function(t,n,u){return n!==u},function(t,n,u,g){return!Vi(0,n,u,g)}),Ps=Ms("<",function(t,n,u){return n<u},function(t,n,u,g){return g.compare(n,u)<0}),zi=Ms(">",function(t,n,u){return n>u},function(t,n,u,g){return g.compare(n,u)>0}),el=Ms("<=",function(t,n,u){return n<=u},function(t,n,u,g){return g.compare(n,u)<=0}),$a=Ms(">=",function(t,n,u){return n>=u},function(t,n,u,g){return g.compare(n,u)>=0}),cs=function(t,n,u,g,_){this.type=yr,this.number=t,this.locale=n,this.currency=u,this.minFractionDigits=g,this.maxFractionDigits=_};cs.parse=function(t,n){if(3!==t.length)return n.error("Expected two arguments.");var u=n.parse(t[1],1,He);if(!u)return null;var g=t[2];if("object"!=typeof g||Array.isArray(g))return n.error("NumberFormat options argument must be an object.");var _=null;if(g.locale&&!(_=n.parse(g.locale,1,yr)))return null;var w=null;if(g.currency&&!(w=n.parse(g.currency,1,yr)))return null;var S=null;if(g["min-fraction-digits"]&&!(S=n.parse(g["min-fraction-digits"],1,He)))return null;var D=null;return g["max-fraction-digits"]&&!(D=n.parse(g["max-fraction-digits"],1,He))?null:new cs(u,_,w,S,D)},cs.prototype.evaluate=function(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))},cs.prototype.eachChild=function(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)},cs.prototype.outputDefined=function(){return!1},cs.prototype.serialize=function(){var t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]};var Nn=function(t){this.type=He,this.input=t};Nn.parse=function(t,n){if(2!==t.length)return n.error("Expected 1 argument, but found "+(t.length-1)+" instead.");var u=n.parse(t[1],1);return u?"array"!==u.type.kind&&"string"!==u.type.kind&&"value"!==u.type.kind?n.error("Expected argument of type string or array, but found "+qn(u.type)+" instead."):new Nn(u):null},Nn.prototype.evaluate=function(t){var n=this.input.evaluate(t);if("string"==typeof n||Array.isArray(n))return n.length;throw new _o("Expected value to be of type string or array, but found "+qn($o(n))+" instead.")},Nn.prototype.eachChild=function(t){t(this.input)},Nn.prototype.outputDefined=function(){return!1},Nn.prototype.serialize=function(){var t=["length"];return this.eachChild(function(n){t.push(n.serialize())}),t};var Ws={"==":Hs,"!=":$n,">":zi,"<":Ps,">=":$a,"<=":el,array:Fa,at:Fi,boolean:Fa,case:aa,coalesce:wa,collator:Se,format:xn,image:Iu,in:Jr,"index-of":vu,interpolate:yi,"interpolate-hcl":yi,"interpolate-lab":yi,length:Nn,let:Rs,literal:Pn,match:Js,number:Fa,"number-format":cs,object:Fa,slice:za,step:Lo,string:Fa,"to-boolean":A,"to-color":A,"to-number":A,"to-string":A,var:Qr,within:ci};function Eo(t,n){var u=n[0],g=n[1],_=n[2],w=n[3];u=u.evaluate(t),g=g.evaluate(t),_=_.evaluate(t);var S=w?w.evaluate(t):1,D=mu(u,g,_,S);if(D)throw new _o(D);return new Jn(u/255*S,g/255*S,_/255*S,S)}function pl(t,n){return t in n}function ga(t,n){var u=n[t];return void 0===u?null:u}function bs(t){return{type:t}}function _u(t){return{result:"success",value:t}}function Ba(t){return{result:"error",value:t}}function hi(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function ta(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function Bu(t){return!!t.expression&&t.expression.interpolated}function jn(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function Ua(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function Da(t){return t}function Uu(t,n,u){return void 0!==t?t:void 0!==n?n:void 0!==u?u:void 0}function kl(t,n,u,g,_){return Uu(typeof u===_?g[u]:void 0,t.default,n.default)}function xu(t,n,u){if("number"!==jn(u))return Uu(t.default,n.default);var g=t.stops.length;if(1===g||u<=t.stops[0][0])return t.stops[0][1];if(u>=t.stops[g-1][0])return t.stops[g-1][1];var _=Ao(t.stops.map(function(w){return w[0]}),u);return t.stops[_][1]}function qa(t,n,u){var g=void 0!==t.base?t.base:1;if("number"!==jn(u))return Uu(t.default,n.default);var _=t.stops.length;if(1===_||u<=t.stops[0][0])return t.stops[0][1];if(u>=t.stops[_-1][0])return t.stops[_-1][1];var ut,mt,Vt,fe,w=Ao(t.stops.map(function(J){return J[0]}),u),S=(ut=g,fe=u-(mt=t.stops[w][0]),0==(Vt=t.stops[w+1][0]-mt)?0:1===ut?fe/Vt:(Math.pow(ut,fe)-1)/(Math.pow(ut,Vt)-1)),D=t.stops[w][1],z=t.stops[w+1][1],q=ba[n.type]||Da;if(t.colorSpace&&"rgb"!==t.colorSpace){var G=Ys[t.colorSpace];q=function(J,ut){return G.reverse(G.interpolate(G.forward(J),G.forward(ut),S))}}return"function"==typeof D.evaluate?{evaluate:function(){for(var J=[],ut=arguments.length;ut--;)J[ut]=arguments[ut];var mt=D.evaluate.apply(void 0,J),zt=z.evaluate.apply(void 0,J);if(void 0!==mt&&void 0!==zt)return q(mt,zt,S)}}:q(D,z,S)}function Pu(t,n,u){return"color"===n.type?u=Jn.parse(u):"formatted"===n.type?u=Ro.fromString(u.toString()):"resolvedImage"===n.type?u=Hn.fromString(u.toString()):jn(u)===n.type||"enum"===n.type&&n.values[u]||(u=void 0),Uu(u,t.default,n.default)}oe.register(Ws,{error:[{kind:"error"},[yr],function(t,n){throw new _o(n[0].evaluate(t))}],typeof:[yr,[Lr],function(t,n){return qn($o(n[0].evaluate(t)))}],"to-rgba":[ri(He,4),[wn],function(t,n){return n[0].evaluate(t).toArray()}],rgb:[wn,[He,He,He],Eo],rgba:[wn,[He,He,He,He],Eo],has:{type:Ke,overloads:[[[yr],function(t,n){return pl(n[0].evaluate(t),t.properties())}],[[yr,an],function(t,n){var u=n[1];return pl(n[0].evaluate(t),u.evaluate(t))}]]},get:{type:Lr,overloads:[[[yr],function(t,n){return ga(n[0].evaluate(t),t.properties())}],[[yr,an],function(t,n){var u=n[1];return ga(n[0].evaluate(t),u.evaluate(t))}]]},"feature-state":[Lr,[yr],function(t,n){return ga(n[0].evaluate(t),t.featureState||{})}],properties:[an,[],function(t){return t.properties()}],"geometry-type":[yr,[],function(t){return t.geometryType()}],id:[Lr,[],function(t){return t.id()}],zoom:[He,[],function(t){return t.globals.zoom}],"heatmap-density":[He,[],function(t){return t.globals.heatmapDensity||0}],"line-progress":[He,[],function(t){return t.globals.lineProgress||0}],accumulated:[Lr,[],function(t){return void 0===t.globals.accumulated?null:t.globals.accumulated}],"+":[He,bs(He),function(t,n){for(var u=0,g=0,_=n;g<_.length;g+=1)u+=_[g].evaluate(t);return u}],"*":[He,bs(He),function(t,n){for(var u=1,g=0,_=n;g<_.length;g+=1)u*=_[g].evaluate(t);return u}],"-":{type:He,overloads:[[[He,He],function(t,n){var u=n[1];return n[0].evaluate(t)-u.evaluate(t)}],[[He],function(t,n){return-n[0].evaluate(t)}]]},"/":[He,[He,He],function(t,n){var u=n[1];return n[0].evaluate(t)/u.evaluate(t)}],"%":[He,[He,He],function(t,n){var u=n[1];return n[0].evaluate(t)%u.evaluate(t)}],ln2:[He,[],function(){return Math.LN2}],pi:[He,[],function(){return Math.PI}],e:[He,[],function(){return Math.E}],"^":[He,[He,He],function(t,n){var u=n[1];return Math.pow(n[0].evaluate(t),u.evaluate(t))}],sqrt:[He,[He],function(t,n){return Math.sqrt(n[0].evaluate(t))}],log10:[He,[He],function(t,n){return Math.log(n[0].evaluate(t))/Math.LN10}],ln:[He,[He],function(t,n){return Math.log(n[0].evaluate(t))}],log2:[He,[He],function(t,n){return Math.log(n[0].evaluate(t))/Math.LN2}],sin:[He,[He],function(t,n){return Math.sin(n[0].evaluate(t))}],cos:[He,[He],function(t,n){return Math.cos(n[0].evaluate(t))}],tan:[He,[He],function(t,n){return Math.tan(n[0].evaluate(t))}],asin:[He,[He],function(t,n){return Math.asin(n[0].evaluate(t))}],acos:[He,[He],function(t,n){return Math.acos(n[0].evaluate(t))}],atan:[He,[He],function(t,n){return Math.atan(n[0].evaluate(t))}],min:[He,bs(He),function(t,n){return Math.min.apply(Math,n.map(function(u){return u.evaluate(t)}))}],max:[He,bs(He),function(t,n){return Math.max.apply(Math,n.map(function(u){return u.evaluate(t)}))}],abs:[He,[He],function(t,n){return Math.abs(n[0].evaluate(t))}],round:[He,[He],function(t,n){var u=n[0].evaluate(t);return u<0?-Math.round(-u):Math.round(u)}],floor:[He,[He],function(t,n){return Math.floor(n[0].evaluate(t))}],ceil:[He,[He],function(t,n){return Math.ceil(n[0].evaluate(t))}],"filter-==":[Ke,[yr,Lr],function(t,n){var u=n[0],g=n[1];return t.properties()[u.value]===g.value}],"filter-id-==":[Ke,[Lr],function(t,n){var u=n[0];return t.id()===u.value}],"filter-type-==":[Ke,[yr],function(t,n){var u=n[0];return t.geometryType()===u.value}],"filter-<":[Ke,[yr,Lr],function(t,n){var u=n[0],g=n[1],_=t.properties()[u.value],w=g.value;return typeof _==typeof w&&_<w}],"filter-id-<":[Ke,[Lr],function(t,n){var u=n[0],g=t.id(),_=u.value;return typeof g==typeof _&&g<_}],"filter->":[Ke,[yr,Lr],function(t,n){var u=n[0],g=n[1],_=t.properties()[u.value],w=g.value;return typeof _==typeof w&&_>w}],"filter-id->":[Ke,[Lr],function(t,n){var u=n[0],g=t.id(),_=u.value;return typeof g==typeof _&&g>_}],"filter-<=":[Ke,[yr,Lr],function(t,n){var u=n[0],g=n[1],_=t.properties()[u.value],w=g.value;return typeof _==typeof w&&_<=w}],"filter-id-<=":[Ke,[Lr],function(t,n){var u=n[0],g=t.id(),_=u.value;return typeof g==typeof _&&g<=_}],"filter->=":[Ke,[yr,Lr],function(t,n){var u=n[0],g=n[1],_=t.properties()[u.value],w=g.value;return typeof _==typeof w&&_>=w}],"filter-id->=":[Ke,[Lr],function(t,n){var u=n[0],g=t.id(),_=u.value;return typeof g==typeof _&&g>=_}],"filter-has":[Ke,[Lr],function(t,n){return n[0].value in t.properties()}],"filter-has-id":[Ke,[],function(t){return null!==t.id()&&void 0!==t.id()}],"filter-type-in":[Ke,[ri(yr)],function(t,n){return n[0].value.indexOf(t.geometryType())>=0}],"filter-id-in":[Ke,[ri(Lr)],function(t,n){return n[0].value.indexOf(t.id())>=0}],"filter-in-small":[Ke,[yr,ri(Lr)],function(t,n){var u=n[0];return n[1].value.indexOf(t.properties()[u.value])>=0}],"filter-in-large":[Ke,[yr,ri(Lr)],function(t,n){var u=n[0],g=n[1];return function(_,w,S,D){for(;S<=D;){var z=S+D>>1;if(w[z]===_)return!0;w[z]>_?D=z-1:S=z+1}return!1}(t.properties()[u.value],g.value,0,g.value.length-1)}],all:{type:Ke,overloads:[[[Ke,Ke],function(t,n){var u=n[1];return n[0].evaluate(t)&&u.evaluate(t)}],[bs(Ke),function(t,n){for(var u=0,g=n;u<g.length;u+=1)if(!g[u].evaluate(t))return!1;return!0}]]},any:{type:Ke,overloads:[[[Ke,Ke],function(t,n){var u=n[1];return n[0].evaluate(t)||u.evaluate(t)}],[bs(Ke),function(t,n){for(var u=0,g=n;u<g.length;u+=1)if(g[u].evaluate(t))return!0;return!1}]]},"!":[Ke,[Ke],function(t,n){return!n[0].evaluate(t)}],"is-supported-script":[Ke,[yr],function(t,n){var u=t.globals&&t.globals.isSupportedScript;return!u||u(n[0].evaluate(t))}],upcase:[yr,[yr],function(t,n){return n[0].evaluate(t).toUpperCase()}],downcase:[yr,[yr],function(t,n){return n[0].evaluate(t).toLowerCase()}],concat:[yr,bs(Lr),function(t,n){return n.map(function(u){return su(u.evaluate(t))}).join("")}],"resolved-locale":[yr,[_n],function(t,n){return n[0].evaluate(t).resolvedLocale()}]});var ea=function(t,n){var u;this.expression=t,this._warningHistory={},this._evaluator=new ct,this._defaultValue=n?"color"===(u=n).type&&Ua(u.default)?new Jn(0,0,0,0):"color"===u.type?Jn.parse(u.default)||null:void 0===u.default?null:u.default:null,this._enumValues=n&&"enum"===n.type?n.values:null};function hs(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in Ws}function Fs(t,n){var _,w,u=new ni(Ws,[],n?(w={color:wn,string:yr,number:He,enum:yr,boolean:Ke,formatted:Nr,resolvedImage:Gi},"array"===(_=n).type?ri(w[_.value]||Lr,_.length):w[_.type]):void 0),g=u.parse(t,void 0,void 0,void 0,n&&"string"===n.type?{typeAnnotation:"coerce"}:void 0);return g?_u(new ea(g,n)):Ba(u.errors)}ea.prototype.evaluateWithoutErrorHandling=function(t,n,u,g,_,w){return this._evaluator.globals=t,this._evaluator.feature=n,this._evaluator.featureState=u,this._evaluator.canonical=g,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=w,this.expression.evaluate(this._evaluator)},ea.prototype.evaluate=function(t,n,u,g,_,w){this._evaluator.globals=t,this._evaluator.feature=n||null,this._evaluator.featureState=u||null,this._evaluator.canonical=g,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=w||null;try{var S=this.expression.evaluate(this._evaluator);if(null==S||"number"==typeof S&&S!=S)return this._defaultValue;if(this._enumValues&&!(S in this._enumValues))throw new _o("Expected value to be one of "+Object.keys(this._enumValues).map(function(D){return JSON.stringify(D)}).join(", ")+", but found "+JSON.stringify(S)+" instead.");return S}catch(D){return this._warningHistory[D.message]||(this._warningHistory[D.message]=!0,typeof console<"u"&&console.warn(D.message)),this._defaultValue}};var be=function(t,n){this.kind=t,this._styleExpression=n,this.isStateDependent="constant"!==t&&!Qo(n.expression)};be.prototype.evaluateWithoutErrorHandling=function(t,n,u,g,_,w){return this._styleExpression.evaluateWithoutErrorHandling(t,n,u,g,_,w)},be.prototype.evaluate=function(t,n,u,g,_,w){return this._styleExpression.evaluate(t,n,u,g,_,w)};var je=function(t,n,u,g){this.kind=t,this.zoomStops=u,this._styleExpression=n,this.isStateDependent="camera"!==t&&!Qo(n.expression),this.interpolationType=g};function dr(t,n){if("error"===(t=Fs(t,n)).result)return t;var u=t.value.expression,g=zr(u);if(!g&&!hi(n))return Ba([new vr("","data expressions not supported")]);var _=ls(u,["zoom"]);if(!_&&!ta(n))return Ba([new vr("","zoom expressions not supported")]);var w=function S(D){var z=null;if(D instanceof Rs)z=S(D.result);else if(D instanceof wa)for(var q=0,G=D.args;q<G.length&&!(z=S(G[q]));q+=1);else(D instanceof Lo||D instanceof yi)&&D.input instanceof oe&&"zoom"===D.input.name&&(z=D);return z instanceof vr||D.eachChild(function(J){var ut=S(J);ut instanceof vr?z=ut:!z&&ut?z=new vr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):z&&ut&&z!==ut&&(z=new vr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),z}(u);return w||_?w instanceof vr?Ba([w]):w instanceof yi&&!Bu(n)?Ba([new vr("",'"interpolate" expressions cannot be used with this property')]):_u(w?new je(g?"camera":"composite",t.value,w.labels,w instanceof yi?w.interpolation:void 0):new be(g?"constant":"source",t.value)):Ba([new vr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}je.prototype.evaluateWithoutErrorHandling=function(t,n,u,g,_,w){return this._styleExpression.evaluateWithoutErrorHandling(t,n,u,g,_,w)},je.prototype.evaluate=function(t,n,u,g,_,w){return this._styleExpression.evaluate(t,n,u,g,_,w)},je.prototype.interpolationFactor=function(t,n,u){return this.interpolationType?yi.interpolationFactor(this.interpolationType,t,n,u):0};var fn=function(t,n){this._parameters=t,this._specification=n,mr(this,function u(g,_){var w,S,D,z="color"===_.type,q=g.stops&&"object"==typeof g.stops[0][0],G=q||!(q||void 0!==g.property),J=g.type||(Bu(_)?"exponential":"interval");if(z&&((g=mr({},g)).stops&&(g.stops=g.stops.map(function(Ar){return[Ar[0],Jn.parse(Ar[1])]})),g.default=Jn.parse(g.default?g.default:_.default)),g.colorSpace&&"rgb"!==g.colorSpace&&!Ys[g.colorSpace])throw new Error("Unknown color space: "+g.colorSpace);if("exponential"===J)w=qa;else if("interval"===J)w=xu;else if("categorical"===J){w=kl,S=Object.create(null);for(var ut=0,mt=g.stops;ut<mt.length;ut+=1){var zt=mt[ut];S[zt[0]]=zt[1]}D=typeof g.stops[0][0]}else{if("identity"!==J)throw new Error('Unknown function type "'+J+'"');w=Pu}if(q){for(var Vt={},fe=[],ne=0;ne<g.stops.length;ne++){var Ee=g.stops[ne],Ce=Ee[0].zoom;void 0===Vt[Ce]&&(Vt[Ce]={zoom:Ce,type:g.type,property:g.property,default:g.default,stops:[]},fe.push(Ce)),Vt[Ce].stops.push([Ee[0].value,Ee[1]])}for(var Re=[],Be=0,rr=fe;Be<rr.length;Be+=1){var wr=rr[Be];Re.push([Vt[wr].zoom,u(Vt[wr],_)])}var Er={name:"linear"};return{kind:"composite",interpolationType:Er,interpolationFactor:yi.interpolationFactor.bind(void 0,Er),zoomStops:Re.map(function(Ar){return Ar[0]}),evaluate:function(Ar,nn){var Fr=Ar.zoom;return qa({stops:Re,base:g.base},_,Fr).evaluate(Fr,nn)}}}if(G){var Hr="exponential"===J?{name:"exponential",base:void 0!==g.base?g.base:1}:null;return{kind:"camera",interpolationType:Hr,interpolationFactor:yi.interpolationFactor.bind(void 0,Hr),zoomStops:g.stops.map(function(Ar){return Ar[0]}),evaluate:function(Ar){return w(g,_,Ar.zoom,S,D)}}}return{kind:"source",evaluate:function(Ar,nn){var Fr=nn&&nn.properties?nn.properties[g.property]:void 0;return void 0===Fr?Uu(g.default,_.default):w(g,_,Fr,S,D)}}}(this._parameters,this._specification))};function Ei(t){var n=t.key,u=t.value,g=t.valueSpec||{},_=t.objectElementValidators||{},w=t.style,S=t.styleSpec,D=[],z=jn(u);if("object"!==z)return[new Ht(n,u,"object expected, "+z+" found")];for(var q in u){var G=q.split(".")[0],J=g[G]||g["*"],ut=void 0;if(_[G])ut=_[G];else if(g[G])ut=Wn;else if(_["*"])ut=_["*"];else{if(!g["*"]){D.push(new Ht(n,u[q],'unknown property "'+q+'"'));continue}ut=Wn}D=D.concat(ut({key:(n&&n+".")+q,value:u[q],valueSpec:J,style:w,styleSpec:S,object:u,objectKey:q},u))}for(var mt in g)_[mt]||g[mt].required&&void 0===g[mt].default&&void 0===u[mt]&&D.push(new Ht(n,u,'missing required property "'+mt+'"'));return D}function An(t){var n=t.value,u=t.valueSpec,g=t.style,_=t.styleSpec,w=t.key,S=t.arrayElementValidator||Wn;if("array"!==jn(n))return[new Ht(w,n,"array expected, "+jn(n)+" found")];if(u.length&&n.length!==u.length)return[new Ht(w,n,"array length "+u.length+" expected, length "+n.length+" found")];if(u["min-length"]&&n.length<u["min-length"])return[new Ht(w,n,"array length at least "+u["min-length"]+" expected, length "+n.length+" found")];var D={type:u.value,values:u.values};_.$version<7&&(D.function=u.function),"object"===jn(u.value)&&(D=u.value);for(var z=[],q=0;q<n.length;q++)z=z.concat(S({array:n,arrayIndex:q,value:n[q],valueSpec:D,style:g,styleSpec:_,key:w+"["+q+"]"}));return z}function xo(t){var n=t.key,u=t.value,g=t.valueSpec,_=jn(u);return"number"===_&&u!=u&&(_="NaN"),"number"!==_?[new Ht(n,u,"number expected, "+_+" found")]:"minimum"in g&&u<g.minimum?[new Ht(n,u,u+" is less than the minimum value "+g.minimum)]:"maximum"in g&&u>g.maximum?[new Ht(n,u,u+" is greater than the maximum value "+g.maximum)]:[]}function oo(t){var n,u,g,_=t.valueSpec,w=Te(t.value.type),S={},D="categorical"!==w&&void 0===t.value.property,z=!D,q="array"===jn(t.value.stops)&&"array"===jn(t.value.stops[0])&&"object"===jn(t.value.stops[0][0]),G=Ei({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(mt){if("identity"===w)return[new Ht(mt.key,mt.value,'identity function may not have a "stops" property')];var zt=[],Vt=mt.value;return zt=zt.concat(An({key:mt.key,value:Vt,valueSpec:mt.valueSpec,style:mt.style,styleSpec:mt.styleSpec,arrayElementValidator:J})),"array"===jn(Vt)&&0===Vt.length&&zt.push(new Ht(mt.key,Vt,"array must have at least one stop")),zt},default:function(mt){return Wn({key:mt.key,value:mt.value,valueSpec:_,style:mt.style,styleSpec:mt.styleSpec})}}});return"identity"===w&&D&&G.push(new Ht(t.key,t.value,'missing required property "property"')),"identity"===w||t.value.stops||G.push(new Ht(t.key,t.value,'missing required property "stops"')),"exponential"===w&&t.valueSpec.expression&&!Bu(t.valueSpec)&&G.push(new Ht(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(z&&!hi(t.valueSpec)?G.push(new Ht(t.key,t.value,"property functions not supported")):D&&!ta(t.valueSpec)&&G.push(new Ht(t.key,t.value,"zoom functions not supported"))),"categorical"!==w&&!q||void 0!==t.value.property||G.push(new Ht(t.key,t.value,'"property" property is required')),G;function J(mt){var zt=[],Vt=mt.value,fe=mt.key;if("array"!==jn(Vt))return[new Ht(fe,Vt,"array expected, "+jn(Vt)+" found")];if(2!==Vt.length)return[new Ht(fe,Vt,"array length 2 expected, length "+Vt.length+" found")];if(q){if("object"!==jn(Vt[0]))return[new Ht(fe,Vt,"object expected, "+jn(Vt[0])+" found")];if(void 0===Vt[0].zoom)return[new Ht(fe,Vt,"object stop key must have zoom")];if(void 0===Vt[0].value)return[new Ht(fe,Vt,"object stop key must have value")];if(g&&g>Te(Vt[0].zoom))return[new Ht(fe,Vt[0].zoom,"stop zoom values must appear in ascending order")];Te(Vt[0].zoom)!==g&&(g=Te(Vt[0].zoom),u=void 0,S={}),zt=zt.concat(Ei({key:fe+"[0]",value:Vt[0],valueSpec:{zoom:{}},style:mt.style,styleSpec:mt.styleSpec,objectElementValidators:{zoom:xo,value:ut}}))}else zt=zt.concat(ut({key:fe+"[0]",value:Vt[0],valueSpec:{},style:mt.style,styleSpec:mt.styleSpec},Vt));return hs(Ye(Vt[1]))?zt.concat([new Ht(fe+"[1]",Vt[1],"expressions are not allowed in function stops.")]):zt.concat(Wn({key:fe+"[1]",value:Vt[1],valueSpec:_,style:mt.style,styleSpec:mt.styleSpec}))}function ut(mt,zt){var Vt=jn(mt.value),fe=Te(mt.value),ne=null!==mt.value?mt.value:zt;if(n){if(Vt!==n)return[new Ht(mt.key,ne,Vt+" stop domain type must match previous stop domain type "+n)]}else n=Vt;if("number"!==Vt&&"string"!==Vt&&"boolean"!==Vt)return[new Ht(mt.key,ne,"stop domain value must be a number, string, or boolean")];if("number"!==Vt&&"categorical"!==w){var Ee="number expected, "+Vt+" found";return hi(_)&&void 0===w&&(Ee+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ht(mt.key,ne,Ee)]}return"categorical"!==w||"number"!==Vt||isFinite(fe)&&Math.floor(fe)===fe?"categorical"!==w&&"number"===Vt&&void 0!==u&&fe<u?[new Ht(mt.key,ne,"stop domain values must appear in ascending order")]:(u=fe,"categorical"===w&&fe in S?[new Ht(mt.key,ne,"stop domain values must be unique")]:(S[fe]=!0,[])):[new Ht(mt.key,ne,"integer expected, found "+fe)]}}function Ga(t){var n=("property"===t.expressionContext?dr:Fs)(Ye(t.value),t.valueSpec);if("error"===n.result)return n.value.map(function(g){return new Ht(""+t.key+g.key,t.value,g.message)});var u=n.value.expression||n.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!u.outputDefined())return[new Ht(t.key,t.value,'Invalid data expression for "'+t.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===t.expressionContext&&"layout"===t.propertyType&&!Qo(u))return[new Ht(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext&&!Qo(u))return[new Ht(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!ls(u,["zoom","feature-state"]))return[new Ht(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!zr(u))return[new Ht(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function mi(t){var n=t.key,u=t.value,g=t.valueSpec,_=[];return Array.isArray(g.values)?-1===g.values.indexOf(Te(u))&&_.push(new Ht(n,u,"expected one of ["+g.values.join(", ")+"], "+JSON.stringify(u)+" found")):-1===Object.keys(g.values).indexOf(Te(u))&&_.push(new Ht(n,u,"expected one of ["+Object.keys(g.values).join(", ")+"], "+JSON.stringify(u)+" found")),_}function Wo(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(var n=0,u=t.slice(1);n<u.length;n+=1){var g=u[n];if(!Wo(g)&&"boolean"!=typeof g)return!1}return!0;default:return!0}}fn.deserialize=function(t){return new fn(t._parameters,t._specification)},fn.serialize=function(t){return{_parameters:t._parameters,_specification:t._specification}};var Ts={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Qa(t){if(null==t)return{filter:function(){return!0},needGeometry:!1};Wo(t)||(t=Ks(t));var n=Fs(t,Ts);if("error"===n.result)throw new Error(n.value.map(function(u){return u.key+": "+u.message}).join(", "));return{filter:function(u,g,_){return n.value.evaluate(u,g,{},_)},needGeometry:function u(g){if(!Array.isArray(g))return!1;if("within"===g[0])return!0;for(var _=1;_<g.length;_++)if(u(g[_]))return!0;return!1}(t)}}function ps(t,n){return t<n?-1:t>n?1:0}function Ks(t){if(!t)return!0;var n,u=t[0];return t.length<=1?"any"!==u:"=="===u?zs(t[1],t[2],"=="):"!="===u?$s(zs(t[1],t[2],"==")):"<"===u||">"===u||"<="===u||">="===u?zs(t[1],t[2],u):"any"===u?(n=t.slice(1),["any"].concat(n.map(Ks))):"all"===u?["all"].concat(t.slice(1).map(Ks)):"none"===u?["all"].concat(t.slice(1).map(Ks).map($s)):"in"===u?As(t[1],t.slice(2)):"!in"===u?$s(As(t[1],t.slice(2))):"has"===u?Bo(t[1]):"!has"===u?$s(Bo(t[1])):"within"!==u||t}function zs(t,n,u){switch(t){case"$type":return["filter-type-"+u,n];case"$id":return["filter-id-"+u,n];default:return["filter-"+u,t,n]}}function As(t,n){if(0===n.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some(function(u){return typeof u!=typeof n[0]})?["filter-in-large",t,["literal",n.sort(ps)]]:["filter-in-small",t,["literal",n]]}}function Bo(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function $s(t){return["!",t]}function sa(t){return Wo(Ye(t.value))?Ga(mr({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function n(u){var g=u.value,_=u.key;if("array"!==jn(g))return[new Ht(_,g,"array expected, "+jn(g)+" found")];var w,S=u.styleSpec,D=[];if(g.length<1)return[new Ht(_,g,"filter array must have at least 1 element")];switch(D=D.concat(mi({key:_+"[0]",value:g[0],valueSpec:S.filter_operator,style:u.style,styleSpec:u.styleSpec})),Te(g[0])){case"<":case"<=":case">":case">=":g.length>=2&&"$type"===Te(g[1])&&D.push(new Ht(_,g,'"$type" cannot be use with operator "'+g[0]+'"'));case"==":case"!=":3!==g.length&&D.push(new Ht(_,g,'filter array for operator "'+g[0]+'" must have 3 elements'));case"in":case"!in":g.length>=2&&"string"!==(w=jn(g[1]))&&D.push(new Ht(_+"[1]",g[1],"string expected, "+w+" found"));for(var z=2;z<g.length;z++)w=jn(g[z]),"$type"===Te(g[1])?D=D.concat(mi({key:_+"["+z+"]",value:g[z],valueSpec:S.geometry_type,style:u.style,styleSpec:u.styleSpec})):"string"!==w&&"number"!==w&&"boolean"!==w&&D.push(new Ht(_+"["+z+"]",g[z],"string, number, or boolean expected, "+w+" found"));break;case"any":case"all":case"none":for(var q=1;q<g.length;q++)D=D.concat(n({key:_+"["+q+"]",value:g[q],style:u.style,styleSpec:u.styleSpec}));break;case"has":case"!has":w=jn(g[1]),2!==g.length?D.push(new Ht(_,g,'filter array for "'+g[0]+'" operator must have 2 elements')):"string"!==w&&D.push(new Ht(_+"[1]",g[1],"string expected, "+w+" found"));break;case"within":w=jn(g[1]),2!==g.length?D.push(new Ht(_,g,'filter array for "'+g[0]+'" operator must have 2 elements')):"object"!==w&&D.push(new Ht(_+"[1]",g[1],"object expected, "+w+" found"))}return D}(t)}function Bs(t,n){var u=t.key,g=t.style,_=t.styleSpec,w=t.value,S=t.objectKey,D=_[n+"_"+t.layerType];if(!D)return[];var z=S.match(/^(.*)-transition$/);if("paint"===n&&z&&D[z[1]]&&D[z[1]].transition)return Wn({key:u,value:w,valueSpec:_.transition,style:g,styleSpec:_});var q,G=t.valueSpec||D[S];if(!G)return[new Ht(u,w,'unknown property "'+S+'"')];if("string"===jn(w)&&hi(G)&&!G.tokens&&(q=/^{([^}]+)}$/.exec(w)))return[new Ht(u,w,'"'+S+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(q[1])+" }`.")];var J=[];return"symbol"===t.layerType&&("text-field"===S&&g&&!g.glyphs&&J.push(new Ht(u,w,'use of "text-field" requires a style "glyphs" property')),"text-font"===S&&Ua(Ye(w))&&"identity"===Te(w.type)&&J.push(new Ht(u,w,'"text-font" does not support identity functions'))),J.concat(Wn({key:t.key,value:w,valueSpec:G,style:g,styleSpec:_,expressionContext:"property",propertyType:n,propertyKey:S}))}function Qs(t){return Bs(t,"paint")}function So(t){return Bs(t,"layout")}function Ii(t){var n=[],u=t.value,g=t.key,_=t.style,w=t.styleSpec;u.type||u.ref||n.push(new Ht(g,u,'either "type" or "ref" is required'));var S,D=Te(u.type),z=Te(u.ref);if(u.id)for(var q=Te(u.id),G=0;G<t.arrayIndex;G++){var J=_.layers[G];Te(J.id)===q&&n.push(new Ht(g,u.id,'duplicate layer id "'+u.id+'", previously used at line '+J.id.__line__))}if("ref"in u)["type","source","source-layer","filter","layout"].forEach(function(zt){zt in u&&n.push(new Ht(g,u[zt],'"'+zt+'" is prohibited for ref layers'))}),_.layers.forEach(function(zt){Te(zt.id)===z&&(S=zt)}),S?S.ref?n.push(new Ht(g,u.ref,"ref cannot reference another ref layer")):D=Te(S.type):n.push(new Ht(g,u.ref,'ref layer "'+z+'" not found'));else if("background"!==D)if(u.source){var ut=_.sources&&_.sources[u.source],mt=ut&&Te(ut.type);ut?"vector"===mt&&"raster"===D?n.push(new Ht(g,u.source,'layer "'+u.id+'" requires a raster source')):"raster"===mt&&"raster"!==D?n.push(new Ht(g,u.source,'layer "'+u.id+'" requires a vector source')):"vector"!==mt||u["source-layer"]?"raster-dem"===mt&&"hillshade"!==D?n.push(new Ht(g,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==D||!u.paint||!u.paint["line-gradient"]||"geojson"===mt&&ut.lineMetrics||n.push(new Ht(g,u,'layer "'+u.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):n.push(new Ht(g,u,'layer "'+u.id+'" must specify a "source-layer"')):n.push(new Ht(g,u.source,'source "'+u.source+'" not found'))}else n.push(new Ht(g,u,'missing required property "source"'));return n=n.concat(Ei({key:g,value:u,valueSpec:w.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Wn({key:g+".type",value:u.type,valueSpec:w.layer.type,style:t.style,styleSpec:t.styleSpec,object:u,objectKey:"type"})},filter:sa,layout:function(zt){return Ei({layer:u,key:zt.key,value:zt.value,style:zt.style,styleSpec:zt.styleSpec,objectElementValidators:{"*":function(Vt){return So(mr({layerType:D},Vt))}}})},paint:function(zt){return Ei({layer:u,key:zt.key,value:zt.value,style:zt.style,styleSpec:zt.styleSpec,objectElementValidators:{"*":function(Vt){return Qs(mr({layerType:D},Vt))}}})}}}))}function oi(t){var n=t.value,u=t.key,g=jn(n);return"string"!==g?[new Ht(u,n,"string expected, "+g+" found")]:[]}var Ea={promoteId:function(t){var n=t.key,u=t.value;if("string"===jn(u))return oi({key:n,value:u});var g=[];for(var _ in u)g.push.apply(g,oi({key:n+"."+_,value:u[_]}));return g}};function Po(t){var n=t.value,u=t.key,g=t.styleSpec,_=t.style;if(!n.type)return[new Ht(u,n,'"type" is required')];var w,S=Te(n.type);switch(S){case"vector":case"raster":case"raster-dem":return Ei({key:u,value:n,valueSpec:g["source_"+S.replace("-","_")],style:t.style,styleSpec:g,objectElementValidators:Ea});case"geojson":if(w=Ei({key:u,value:n,valueSpec:g.source_geojson,style:_,styleSpec:g,objectElementValidators:Ea}),n.cluster)for(var D in n.clusterProperties){var z=n.clusterProperties[D],q=z[0],G="string"==typeof q?[q,["accumulated"],["get",D]]:q;w.push.apply(w,Ga({key:u+"."+D+".map",value:z[1],expressionContext:"cluster-map"})),w.push.apply(w,Ga({key:u+"."+D+".reduce",value:G,expressionContext:"cluster-reduce"}))}return w;case"video":return Ei({key:u,value:n,valueSpec:g.source_video,style:_,styleSpec:g});case"image":return Ei({key:u,value:n,valueSpec:g.source_image,style:_,styleSpec:g});case"canvas":return[new Ht(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return mi({key:u+".type",value:n.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:_,styleSpec:g})}}function po(t){var n=t.value,u=t.styleSpec,g=u.light,_=t.style,w=[],S=jn(n);if(void 0===n)return w;if("object"!==S)return w.concat([new Ht("light",n,"object expected, "+S+" found")]);for(var D in n){var z=D.match(/^(.*)-transition$/);w=w.concat(z&&g[z[1]]&&g[z[1]].transition?Wn({key:D,value:n[D],valueSpec:u.transition,style:_,styleSpec:u}):g[D]?Wn({key:D,value:n[D],valueSpec:g[D],style:_,styleSpec:u}):[new Ht(D,n[D],'unknown property "'+D+'"')])}return w}var bn={"*":function(){return[]},array:An,boolean:function(t){var n=t.value,u=t.key,g=jn(n);return"boolean"!==g?[new Ht(u,n,"boolean expected, "+g+" found")]:[]},number:xo,color:function(t){var n=t.key,u=t.value,g=jn(u);return"string"!==g?[new Ht(n,u,"color expected, "+g+" found")]:null===fa(u)?[new Ht(n,u,'color expected, "'+u+'" found')]:[]},constants:ir,enum:mi,filter:sa,function:oo,layer:Ii,object:Ei,source:Po,light:po,string:oi,formatted:function(t){return 0===oi(t).length?[]:Ga(t)},resolvedImage:function(t){return 0===oi(t).length?[]:Ga(t)}};function Wn(t){var n=t.value,u=t.valueSpec,g=t.styleSpec;return u.expression&&Ua(Te(n))?oo(t):u.expression&&hs(Ye(n))?Ga(t):u.type&&bn[u.type]?bn[u.type](t):Ei(mr({},t,{valueSpec:u.type?g[u.type]:u}))}function Va(t){var n=t.value,u=t.key,g=oi(t);return g.length||(-1===n.indexOf("{fontstack}")&&g.push(new Ht(u,n,'"glyphs" url must include a "{fontstack}" token')),-1===n.indexOf("{range}")&&g.push(new Ht(u,n,'"glyphs" url must include a "{range}" token'))),g}function ja(t,n){void 0===n&&(n=Dt);var u=[];return u=u.concat(Wn({key:"",value:t,valueSpec:n.$root,styleSpec:n,style:t,objectElementValidators:{glyphs:Va,"*":function(){return[]}}})),t.constants&&(u=u.concat(ir({key:"constants",value:t.constants,style:t,styleSpec:n}))),Zo(u)}function Zo(t){return[].concat(t).sort(function(n,u){return n.line-u.line})}function fo(t){return function(){for(var n=[],u=arguments.length;u--;)n[u]=arguments[u];return Zo(t.apply(this,n))}}ja.source=fo(Po),ja.light=fo(po),ja.layer=fo(Ii),ja.filter=fo(sa),ja.paintProperty=fo(Qs),ja.layoutProperty=fo(So);var ts=ja,es=ts.light,qu=ts.paintProperty,tu=ts.layoutProperty;function ws(t,n){var u=!1;if(n&&n.length)for(var g=0,_=n;g<_.length;g+=1)t.fire(new me(new Error(_[g].message))),u=!0;return u}var ao=rs;function rs(t,n,u){var g=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var _=new Int32Array(this.arrayBuffer);t=_[0],this.d=(n=_[1])+2*(u=_[2]);for(var w=0;w<this.d*this.d;w++){var S=_[3+w],D=_[3+w+1];g.push(S===D?null:_.subarray(S,D))}var z=_[3+g.length+1];this.keys=_.subarray(_[3+g.length],z),this.bboxes=_.subarray(z),this.insert=this._insertReadonly}else{this.d=n+2*u;for(var q=0;q<this.d*this.d;q++)g.push([]);this.keys=[],this.bboxes=[]}this.n=n,this.extent=t,this.padding=u,this.scale=n/t,this.uid=0;var G=u/n*t;this.min=-G,this.max=t+G}rs.prototype.insert=function(t,n,u,g,_){this._forEachCell(n,u,g,_,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(n),this.bboxes.push(u),this.bboxes.push(g),this.bboxes.push(_)},rs.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},rs.prototype._insertCell=function(t,n,u,g,_,w){this.cells[_].push(w)},rs.prototype.query=function(t,n,u,g,_){var w=this.min,S=this.max;if(t<=w&&n<=w&&S<=u&&S<=g&&!_)return Array.prototype.slice.call(this.keys);var D=[];return this._forEachCell(t,n,u,g,this._queryCell,D,{},_),D},rs.prototype._queryCell=function(t,n,u,g,_,w,S,D){var z=this.cells[_];if(null!==z)for(var q=this.keys,G=this.bboxes,J=0;J<z.length;J++){var ut=z[J];if(void 0===S[ut]){var mt=4*ut;(D?D(G[mt+0],G[mt+1],G[mt+2],G[mt+3]):t<=G[mt+2]&&n<=G[mt+3]&&u>=G[mt+0]&&g>=G[mt+1])?(S[ut]=!0,w.push(q[ut])):S[ut]=!1}}},rs.prototype._forEachCell=function(t,n,u,g,_,w,S,D){for(var z=this._convertToCellCoord(t),q=this._convertToCellCoord(n),G=this._convertToCellCoord(u),J=this._convertToCellCoord(g),ut=z;ut<=G;ut++)for(var mt=q;mt<=J;mt++){var zt=this.d*mt+ut;if((!D||D(this._convertFromCellCoord(ut),this._convertFromCellCoord(mt),this._convertFromCellCoord(ut+1),this._convertFromCellCoord(mt+1)))&&_.call(this,t,n,u,g,zt,w,S,D))return}},rs.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},rs.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},rs.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,n=3+this.cells.length+1+1,u=0,g=0;g<this.cells.length;g++)u+=this.cells[g].length;var _=new Int32Array(n+u+this.keys.length+this.bboxes.length);_[0]=this.extent,_[1]=this.n,_[2]=this.padding;for(var w=n,S=0;S<t.length;S++){var D=t[S];_[3+S]=w,_.set(D,w),w+=D.length}return _[3+t.length]=w,_.set(this.keys,w),_[3+t.length+1]=w+=this.keys.length,_.set(this.bboxes,w),w+=this.bboxes.length,_.buffer};var ra=qt.ImageData,Za=qt.ImageBitmap,Ko={};function xr(t,n,u){void 0===u&&(u={}),Object.defineProperty(n,"_classRegistryKey",{value:t,writeable:!1}),Ko[t]={klass:n,omit:u.omit||[],shallow:u.shallow||[]}}for(var Ls in xr("Object",Object),ao.serialize=function(t,n){var u=t.toArrayBuffer();return n&&n.push(u),{buffer:u}},ao.deserialize=function(t){return new ao(t.buffer)},xr("Grid",ao),xr("Color",Jn),xr("Error",Error),xr("ResolvedImage",Hn),xr("StylePropertyFunction",fn),xr("StyleExpression",ea,{omit:["_evaluator"]}),xr("ZoomDependentExpression",je),xr("ZoomConstantExpression",be),xr("CompoundExpression",oe,{omit:["_evaluate"]}),Ws)Ws[Ls]._classRegistryKey||xr("Expression_"+Ls,Ws[Ls]);function bu(t){return t&&typeof ArrayBuffer<"u"&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function lu(t){return Za&&t instanceof Za}function ua(t,n){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(bu(t)||lu(t))return n&&n.push(t),t;if(ArrayBuffer.isView(t)){var u=t;return n&&n.push(u.buffer),u}if(t instanceof ra)return n&&n.push(t.data.buffer),t;if(Array.isArray(t)){for(var g=[],_=0,w=t;_<w.length;_+=1)g.push(ua(w[_],n));return g}if("object"==typeof t){var S=t.constructor,D=S._classRegistryKey;if(!D)throw new Error("can't serialize object of unregistered class");var z=S.serialize?S.serialize(t,n):{};if(!S.serialize){for(var q in t)if(t.hasOwnProperty(q)&&!(Ko[D].omit.indexOf(q)>=0)){var G=t[q];z[q]=Ko[D].shallow.indexOf(q)>=0?G:ua(G,n)}t instanceof Error&&(z.message=t.message)}if(z.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==D&&(z.$name=D),z}throw new Error("can't serialize object of type "+typeof t)}function Tu(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||bu(t)||lu(t)||ArrayBuffer.isView(t)||t instanceof ra)return t;if(Array.isArray(t))return t.map(Tu);if("object"==typeof t){var n=t.$name||"Object",u=Ko[n].klass;if(!u)throw new Error("can't deserialize unregistered class "+n);if(u.deserialize)return u.deserialize(t);for(var g=Object.create(u.prototype),_=0,w=Object.keys(t);_<w.length;_+=1){var S=w[_];if("$name"!==S){var D=t[S];g[S]=Ko[n].shallow.indexOf(S)>=0?D:Tu(D)}}return g}throw new Error("can't deserialize object of type "+typeof t)}var Co=function(){this.first=!0};Co.prototype.update=function(t,n){var u=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=u,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=u,!0):(this.lastFloorZoom>u?(this.lastIntegerZoom=u+1,this.lastIntegerZoomTime=n):this.lastFloorZoom<u&&(this.lastIntegerZoom=u,this.lastIntegerZoomTime=n),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=u,!0))};var Cr={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function Xo(t){for(var n=0,u=t;n<u.length;n+=1)if(Zl(u[n].charCodeAt(0)))return!0;return!1}function Zl(t){return!(746!==t&&747!==t&&(t<4352||!(Cr["Bopomofo Extended"](t)||Cr.Bopomofo(t)||Cr["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||Cr["CJK Compatibility Ideographs"](t)||Cr["CJK Compatibility"](t)||Cr["CJK Radicals Supplement"](t)||Cr["CJK Strokes"](t)||!(!Cr["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||Cr["CJK Unified Ideographs Extension A"](t)||Cr["CJK Unified Ideographs"](t)||Cr["Enclosed CJK Letters and Months"](t)||Cr["Hangul Compatibility Jamo"](t)||Cr["Hangul Jamo Extended-A"](t)||Cr["Hangul Jamo Extended-B"](t)||Cr["Hangul Jamo"](t)||Cr["Hangul Syllables"](t)||Cr.Hiragana(t)||Cr["Ideographic Description Characters"](t)||Cr.Kanbun(t)||Cr["Kangxi Radicals"](t)||Cr["Katakana Phonetic Extensions"](t)||Cr.Katakana(t)&&12540!==t||!(!Cr["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!Cr["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||Cr["Unified Canadian Aboriginal Syllabics"](t)||Cr["Unified Canadian Aboriginal Syllabics Extended"](t)||Cr["Vertical Forms"](t)||Cr["Yijing Hexagram Symbols"](t)||Cr["Yi Syllables"](t)||Cr["Yi Radicals"](t))))}function wu(t){return!(Zl(t)||(n=t,Cr["Latin-1 Supplement"](n)&&(167===n||169===n||174===n||177===n||188===n||189===n||190===n||215===n||247===n)||Cr["General Punctuation"](n)&&(8214===n||8224===n||8225===n||8240===n||8241===n||8251===n||8252===n||8258===n||8263===n||8264===n||8265===n||8273===n)||Cr["Letterlike Symbols"](n)||Cr["Number Forms"](n)||Cr["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||9003===n||n>=9085&&n<=9114||n>=9150&&n<=9165||9167===n||n>=9169&&n<=9179||n>=9186&&n<=9215)||Cr["Control Pictures"](n)&&9251!==n||Cr["Optical Character Recognition"](n)||Cr["Enclosed Alphanumerics"](n)||Cr["Geometric Shapes"](n)||Cr["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||Cr["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||Cr["CJK Symbols and Punctuation"](n)||Cr.Katakana(n)||Cr["Private Use Area"](n)||Cr["CJK Compatibility Forms"](n)||Cr["Small Form Variants"](n)||Cr["Halfwidth and Fullwidth Forms"](n)||8734===n||8756===n||8757===n||n>=9984&&n<=10087||n>=10102&&n<=10131||65532===n||65533===n));var n}function go(t){return t>=1424&&t<=2303||Cr["Arabic Presentation Forms-A"](t)||Cr["Arabic Presentation Forms-B"](t)}function Au(t,n){return!(!n&&go(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||Cr.Khmer(t))}function ac(t){for(var n=0,u=t;n<u.length;n+=1)if(go(u[n].charCodeAt(0)))return!0;return!1}var rl=null,Sa="unavailable",Uo=null,Xa=function(t){t&&"string"==typeof t&&t.indexOf("NetworkError")>-1&&(Sa="error"),rl&&rl(t)};function bl(){fs.fire(new se("pluginStateChange",{pluginStatus:Sa,pluginURL:Uo}))}var fs=new ue,eu=function(){return Sa},fl=function(){if("deferred"!==Sa||!Uo)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Sa="loading",bl(),Uo&&wi({url:Uo},function(t){t?Xa(t):(Sa="loaded",bl())})},ai={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return"loaded"===Sa||null!=ai.applyArabicShaping},isLoading:function(){return"loading"===Sa},setState:function(t){Sa=t.pluginStatus,Uo=t.pluginURL},isParsed:function(){return null!=ai.applyArabicShaping&&null!=ai.processBidirectionalText&&null!=ai.processStyledBidirectionalText},getPluginURL:function(){return Uo}},mo=function(t,n){this.zoom=t,n?(this.now=n.now,this.fadeDuration=n.fadeDuration,this.zoomHistory=n.zoomHistory,this.transition=n.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Co,this.transition={})};mo.prototype.isSupportedScript=function(t){return function(n,u){for(var g=0,_=n;g<_.length;g+=1)if(!Au(_[g].charCodeAt(0),u))return!1;return!0}(t,ai.isLoaded())},mo.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},mo.prototype.getCrossfadeParameters=function(){var t=this.zoom,n=t-Math.floor(t),u=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:n+(1-n)*u}:{fromScale:.5,toScale:1,t:1-(1-u)*n}};var Ca=function(t,n){this.property=t,this.value=n,this.expression=function(u,g){if(Ua(u))return new fn(u,g);if(hs(u)){var _=dr(u,g);if("error"===_.result)throw new Error(_.value.map(function(S){return S.key+": "+S.message}).join(", "));return _.value}var w=u;return"string"==typeof u&&"color"===g.type&&(w=Jn.parse(u)),{kind:"constant",evaluate:function(){return w}}}(void 0===n?t.specification.default:n,t.specification)};Ca.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},Ca.prototype.possiblyEvaluate=function(t,n,u){return this.property.possiblyEvaluate(this,t,n,u)};var ru=function(t){this.property=t,this.value=new Ca(t,void 0)};ru.prototype.transitioned=function(t,n){return new wl(this.property,this.value,n,Z({},t.transition,this.transition),t.now)},ru.prototype.untransitioned=function(){return new wl(this.property,this.value,null,{},0)};var Ds=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};Ds.prototype.getValue=function(t){return j(this._values[t].value.value)},Ds.prototype.setValue=function(t,n){this._values.hasOwnProperty(t)||(this._values[t]=new ru(this._values[t].property)),this._values[t].value=new Ca(this._values[t].property,null===n?void 0:j(n))},Ds.prototype.getTransition=function(t){return j(this._values[t].transition)},Ds.prototype.setTransition=function(t,n){this._values.hasOwnProperty(t)||(this._values[t]=new ru(this._values[t].property)),this._values[t].transition=j(n)||void 0},Ds.prototype.serialize=function(){for(var t={},n=0,u=Object.keys(this._values);n<u.length;n+=1){var g=u[n],_=this.getValue(g);void 0!==_&&(t[g]=_);var w=this.getTransition(g);void 0!==w&&(t[g+"-transition"]=w)}return t},Ds.prototype.transitioned=function(t,n){for(var u=new Ju(this._properties),g=0,_=Object.keys(this._values);g<_.length;g+=1){var w=_[g];u._values[w]=this._values[w].transitioned(t,n._values[w])}return u},Ds.prototype.untransitioned=function(){for(var t=new Ju(this._properties),n=0,u=Object.keys(this._values);n<u.length;n+=1){var g=u[n];t._values[g]=this._values[g].untransitioned()}return t};var wl=function(t,n,u,g,_){this.property=t,this.value=n,this.begin=_+g.delay||0,this.end=this.begin+g.duration||0,t.specification.transition&&(g.delay||g.duration)&&(this.prior=u)};wl.prototype.possiblyEvaluate=function(t,n,u){var g=t.now||0,_=this.value.possiblyEvaluate(t,n,u),w=this.prior;if(w){if(g>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(g<this.begin)return w.possiblyEvaluate(t,n,u);var S=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(w.possiblyEvaluate(t,n,u),_,function(D){if(D<=0)return 0;if(D>=1)return 1;var z=D*D,q=z*D;return 4*(D<.5?q:3*(D-z)+q-.75)}(S))}return _};var Ju=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};Ju.prototype.possiblyEvaluate=function(t,n,u){for(var g=new Eu(this._properties),_=0,w=Object.keys(this._values);_<w.length;_+=1){var S=w[_];g._values[S]=this._values[S].possiblyEvaluate(t,n,u)}return g},Ju.prototype.hasTransition=function(){for(var t=0,n=Object.keys(this._values);t<n.length;t+=1)if(this._values[n[t]].prior)return!0;return!1};var ds=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};ds.prototype.getValue=function(t){return j(this._values[t].value)},ds.prototype.setValue=function(t,n){this._values[t]=new Ca(this._values[t].property,null===n?void 0:j(n))},ds.prototype.serialize=function(){for(var t={},n=0,u=Object.keys(this._values);n<u.length;n+=1){var g=u[n],_=this.getValue(g);void 0!==_&&(t[g]=_)}return t},ds.prototype.possiblyEvaluate=function(t,n,u){for(var g=new Eu(this._properties),_=0,w=Object.keys(this._values);_<w.length;_+=1){var S=w[_];g._values[S]=this._values[S].possiblyEvaluate(t,n,u)}return g};var Es=function(t,n,u){this.property=t,this.value=n,this.parameters=u};Es.prototype.isConstant=function(){return"constant"===this.value.kind},Es.prototype.constantOr=function(t){return"constant"===this.value.kind?this.value.value:t},Es.prototype.evaluate=function(t,n,u,g){return this.property.evaluate(this.value,this.parameters,t,n,u,g)};var Eu=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};Eu.prototype.get=function(t){return this._values[t]};var Tr=function(t){this.specification=t};Tr.prototype.possiblyEvaluate=function(t,n){return t.expression.evaluate(n)},Tr.prototype.interpolate=function(t,n,u){var g=ba[this.specification.type];return g?g(t,n,u):t};var mn=function(t,n){this.specification=t,this.overrides=n};mn.prototype.possiblyEvaluate=function(t,n,u,g){return new Es(this,"constant"===t.expression.kind||"camera"===t.expression.kind?{kind:"constant",value:t.expression.evaluate(n,null,{},u,g)}:t.expression,n)},mn.prototype.interpolate=function(t,n,u){if("constant"!==t.value.kind||"constant"!==n.value.kind)return t;if(void 0===t.value.value||void 0===n.value.value)return new Es(this,{kind:"constant",value:void 0},t.parameters);var g=ba[this.specification.type];return g?new Es(this,{kind:"constant",value:g(t.value.value,n.value.value,u)},t.parameters):t},mn.prototype.evaluate=function(t,n,u,g,_,w){return"constant"===t.kind?t.value:t.evaluate(n,u,g,_,w)};var Ia=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.possiblyEvaluate=function(u,g,_,w){if(void 0===u.value)return new Es(this,{kind:"constant",value:void 0},g);if("constant"===u.expression.kind){var S=u.expression.evaluate(g,null,{},_,w),D="resolvedImage"===u.property.specification.type&&"string"!=typeof S?S.name:S,z=this._calculate(D,D,D,g);return new Es(this,{kind:"constant",value:z},g)}if("camera"===u.expression.kind){var q=this._calculate(u.expression.evaluate({zoom:g.zoom-1}),u.expression.evaluate({zoom:g.zoom}),u.expression.evaluate({zoom:g.zoom+1}),g);return new Es(this,{kind:"constant",value:q},g)}return new Es(this,u.expression,g)},n.prototype.evaluate=function(u,g,_,w,S,D){if("source"===u.kind){var z=u.evaluate(g,_,w,S,D);return this._calculate(z,z,z,g)}return"composite"===u.kind?this._calculate(u.evaluate({zoom:Math.floor(g.zoom)-1},_,w),u.evaluate({zoom:Math.floor(g.zoom)},_,w),u.evaluate({zoom:Math.floor(g.zoom)+1},_,w),g):u.value},n.prototype._calculate=function(u,g,_,w){return w.zoom>w.zoomHistory.lastIntegerZoom?{from:u,to:g}:{from:_,to:g}},n.prototype.interpolate=function(u){return u},n}(mn),Ss=function(t){this.specification=t};Ss.prototype.possiblyEvaluate=function(t,n,u,g){if(void 0!==t.value){if("constant"===t.expression.kind){var _=t.expression.evaluate(n,null,{},u,g);return this._calculate(_,_,_,n)}return this._calculate(t.expression.evaluate(new mo(Math.floor(n.zoom-1),n)),t.expression.evaluate(new mo(Math.floor(n.zoom),n)),t.expression.evaluate(new mo(Math.floor(n.zoom+1),n)),n)}},Ss.prototype._calculate=function(t,n,u,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:t,to:n}:{from:u,to:n}},Ss.prototype.interpolate=function(t){return t};var nu=function(t){this.specification=t};nu.prototype.possiblyEvaluate=function(t,n,u,g){return!!t.expression.evaluate(n,null,{},u,g)},nu.prototype.interpolate=function(){return!1};var Ma=function(t){for(var n in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],t){var u=t[n];u.specification.overridable&&this.overridableProperties.push(n);var g=this.defaultPropertyValues[n]=new Ca(u,void 0),_=this.defaultTransitionablePropertyValues[n]=new ru(u);this.defaultTransitioningPropertyValues[n]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=g.possiblyEvaluate({})}};xr("DataDrivenProperty",mn),xr("DataConstantProperty",Tr),xr("CrossFadedDataDrivenProperty",Ia),xr("CrossFadedProperty",Ss),xr("ColorRampProperty",nu);var dn=function(t){function n(u,g){if(t.call(this),this.id=u.id,this.type=u.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},"custom"!==u.type&&(this.metadata=u.metadata,this.minzoom=u.minzoom,this.maxzoom=u.maxzoom,"background"!==u.type&&(this.source=u.source,this.sourceLayer=u["source-layer"],this.filter=u.filter),g.layout&&(this._unevaluatedLayout=new ds(g.layout)),g.paint)){for(var _ in this._transitionablePaint=new Ds(g.paint),u.paint)this.setPaintProperty(_,u.paint[_],{validate:!1});for(var w in u.layout)this.setLayoutProperty(w,u.layout[w],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Eu(g.paint)}}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},n.prototype.getLayoutProperty=function(u){return"visibility"===u?this.visibility:this._unevaluatedLayout.getValue(u)},n.prototype.setLayoutProperty=function(u,g,_){void 0===_&&(_={}),null!=g&&this._validate(tu,"layers."+this.id+".layout."+u,u,g,_)||("visibility"!==u?this._unevaluatedLayout.setValue(u,g):this.visibility=g)},n.prototype.getPaintProperty=function(u){return H(u,"-transition")?this._transitionablePaint.getTransition(u.slice(0,-11)):this._transitionablePaint.getValue(u)},n.prototype.setPaintProperty=function(u,g,_){if(void 0===_&&(_={}),null!=g&&this._validate(qu,"layers."+this.id+".paint."+u,u,g,_))return!1;if(H(u,"-transition"))return this._transitionablePaint.setTransition(u.slice(0,-11),g||void 0),!1;var w=this._transitionablePaint._values[u],S="cross-faded-data-driven"===w.property.specification["property-type"],D=w.value.isDataDriven(),z=w.value;this._transitionablePaint.setValue(u,g),this._handleSpecialPaintPropertyUpdate(u);var q=this._transitionablePaint._values[u].value;return q.isDataDriven()||D||S||this._handleOverridablePaintPropertyUpdate(u,z,q)},n.prototype._handleSpecialPaintPropertyUpdate=function(u){},n.prototype._handleOverridablePaintPropertyUpdate=function(u,g,_){return!1},n.prototype.isHidden=function(u){return!!(this.minzoom&&u<this.minzoom)||!!(this.maxzoom&&u>=this.maxzoom)||"none"===this.visibility},n.prototype.updateTransitions=function(u){this._transitioningPaint=this._transitionablePaint.transitioned(u,this._transitioningPaint)},n.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},n.prototype.recalculate=function(u,g){u.getCrossfadeParameters&&(this._crossfadeParameters=u.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(u,void 0,g)),this.paint=this._transitioningPaint.possiblyEvaluate(u,void 0,g)},n.prototype.serialize=function(){var u={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(u.layout=u.layout||{},u.layout.visibility=this.visibility),at(u,function(g,_){return!(void 0===g||"layout"===_&&!Object.keys(g).length||"paint"===_&&!Object.keys(g).length)})},n.prototype._validate=function(u,g,_,w,S){return void 0===S&&(S={}),(!S||!1!==S.validate)&&ws(this,u.call(ts,{key:g,layerType:this.type,objectKey:_,value:w,styleSpec:Dt,style:{glyphs:!0,sprite:!0}}))},n.prototype.is3D=function(){return!1},n.prototype.isTileClipped=function(){return!1},n.prototype.hasOffscreenPass=function(){return!1},n.prototype.resize=function(){},n.prototype.isStateDependent=function(){for(var u in this.paint._values){var g=this.paint.get(u);if(g instanceof Es&&hi(g.property.specification)&&("source"===g.value.kind||"composite"===g.value.kind)&&g.value.isStateDependent)return!0}return!1},n}(ue),Lu={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},cu=function(t,n){this._structArray=t,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Si=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function bo(t,n){void 0===n&&(n=1);var u=0,g=0;return{members:t.map(function(_){var w=Lu[_.type].BYTES_PER_ELEMENT,S=u=sc(u,Math.max(n,w)),D=_.components||1;return g=Math.max(g,w),u+=w*D,{name:_.name,type:_.type,components:D,offset:S}}),size:sc(u,Math.max(g,n)),alignment:n}}function sc(t,n){return Math.ceil(t/n)*n}Si.serialize=function(t,n){return t._trim(),n&&(t.isTransferred=!0,n.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}},Si.deserialize=function(t){var n=Object.create(this.prototype);return n.arrayBuffer=t.arrayBuffer,n.length=t.length,n.capacity=t.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n},Si.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Si.prototype.clear=function(){this.length=0},Si.prototype.resize=function(t){this.reserve(t),this.length=t},Si.prototype.reserve=function(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}},Si.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var gs=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g){var _=this.length;return this.resize(_+1),this.emplace(_,u,g)},n.prototype.emplace=function(u,g,_){var w=2*u;return this.int16[w+0]=g,this.int16[w+1]=_,u},n}(Si);gs.prototype.bytesPerElement=4,xr("StructArrayLayout2i4",gs);var Io=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g,_,w){var S=this.length;return this.resize(S+1),this.emplace(S,u,g,_,w)},n.prototype.emplace=function(u,g,_,w,S){var D=4*u;return this.int16[D+0]=g,this.int16[D+1]=_,this.int16[D+2]=w,this.int16[D+3]=S,u},n}(Si);Io.prototype.bytesPerElement=8,xr("StructArrayLayout4i8",Io);var iu=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g,_,w,S,D){var z=this.length;return this.resize(z+1),this.emplace(z,u,g,_,w,S,D)},n.prototype.emplace=function(u,g,_,w,S,D,z){var q=6*u;return this.int16[q+0]=g,this.int16[q+1]=_,this.int16[q+2]=w,this.int16[q+3]=S,this.int16[q+4]=D,this.int16[q+5]=z,u},n}(Si);iu.prototype.bytesPerElement=12,xr("StructArrayLayout2i4i12",iu);var nl=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g,_,w,S,D){var z=this.length;return this.resize(z+1),this.emplace(z,u,g,_,w,S,D)},n.prototype.emplace=function(u,g,_,w,S,D,z){var q=4*u,G=8*u;return this.int16[q+0]=g,this.int16[q+1]=_,this.uint8[G+4]=w,this.uint8[G+5]=S,this.uint8[G+6]=D,this.uint8[G+7]=z,u},n}(Si);nl.prototype.bytesPerElement=8,xr("StructArrayLayout2i4ub8",nl);var e=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g){var _=this.length;return this.resize(_+1),this.emplace(_,u,g)},n.prototype.emplace=function(u,g,_){var w=2*u;return this.float32[w+0]=g,this.float32[w+1]=_,u},n}(Si);e.prototype.bytesPerElement=8,xr("StructArrayLayout2f8",e);var i=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g,_,w,S,D,z,q,G,J){var ut=this.length;return this.resize(ut+1),this.emplace(ut,u,g,_,w,S,D,z,q,G,J)},n.prototype.emplace=function(u,g,_,w,S,D,z,q,G,J,ut){var mt=10*u;return this.uint16[mt+0]=g,this.uint16[mt+1]=_,this.uint16[mt+2]=w,this.uint16[mt+3]=S,this.uint16[mt+4]=D,this.uint16[mt+5]=z,this.uint16[mt+6]=q,this.uint16[mt+7]=G,this.uint16[mt+8]=J,this.uint16[mt+9]=ut,u},n}(Si);i.prototype.bytesPerElement=20,xr("StructArrayLayout10ui20",i);var h=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g,_,w,S,D,z,q,G,J,ut,mt){var zt=this.length;return this.resize(zt+1),this.emplace(zt,u,g,_,w,S,D,z,q,G,J,ut,mt)},n.prototype.emplace=function(u,g,_,w,S,D,z,q,G,J,ut,mt,zt){var Vt=12*u;return this.int16[Vt+0]=g,this.int16[Vt+1]=_,this.int16[Vt+2]=w,this.int16[Vt+3]=S,this.uint16[Vt+4]=D,this.uint16[Vt+5]=z,this.uint16[Vt+6]=q,this.uint16[Vt+7]=G,this.int16[Vt+8]=J,this.int16[Vt+9]=ut,this.int16[Vt+10]=mt,this.int16[Vt+11]=zt,u},n}(Si);h.prototype.bytesPerElement=24,xr("StructArrayLayout4i4ui4i24",h);var d=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g,_){var w=this.length;return this.resize(w+1),this.emplace(w,u,g,_)},n.prototype.emplace=function(u,g,_,w){var S=3*u;return this.float32[S+0]=g,this.float32[S+1]=_,this.float32[S+2]=w,u},n}(Si);d.prototype.bytesPerElement=12,xr("StructArrayLayout3f12",d);var x=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u){var g=this.length;return this.resize(g+1),this.emplace(g,u)},n.prototype.emplace=function(u,g){return this.uint32[1*u+0]=g,u},n}(Si);x.prototype.bytesPerElement=4,xr("StructArrayLayout1ul4",x);var L=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g,_,w,S,D,z,q,G){var J=this.length;return this.resize(J+1),this.emplace(J,u,g,_,w,S,D,z,q,G)},n.prototype.emplace=function(u,g,_,w,S,D,z,q,G,J){var ut=10*u,mt=5*u;return this.int16[ut+0]=g,this.int16[ut+1]=_,this.int16[ut+2]=w,this.int16[ut+3]=S,this.int16[ut+4]=D,this.int16[ut+5]=z,this.uint32[mt+3]=q,this.uint16[ut+8]=G,this.uint16[ut+9]=J,u},n}(Si);L.prototype.bytesPerElement=20,xr("StructArrayLayout6i1ul2ui20",L);var F=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g,_,w,S,D){var z=this.length;return this.resize(z+1),this.emplace(z,u,g,_,w,S,D)},n.prototype.emplace=function(u,g,_,w,S,D,z){var q=6*u;return this.int16[q+0]=g,this.int16[q+1]=_,this.int16[q+2]=w,this.int16[q+3]=S,this.int16[q+4]=D,this.int16[q+5]=z,u},n}(Si);F.prototype.bytesPerElement=12,xr("StructArrayLayout2i2i2i12",F);var K=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g,_,w,S){var D=this.length;return this.resize(D+1),this.emplace(D,u,g,_,w,S)},n.prototype.emplace=function(u,g,_,w,S,D){var z=4*u,q=8*u;return this.float32[z+0]=g,this.float32[z+1]=_,this.float32[z+2]=w,this.int16[q+6]=S,this.int16[q+7]=D,u},n}(Si);K.prototype.bytesPerElement=16,xr("StructArrayLayout2f1f2i16",K);var Mt=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g,_,w){var S=this.length;return this.resize(S+1),this.emplace(S,u,g,_,w)},n.prototype.emplace=function(u,g,_,w,S){var D=12*u,z=3*u;return this.uint8[D+0]=g,this.uint8[D+1]=_,this.float32[z+1]=w,this.float32[z+2]=S,u},n}(Si);Mt.prototype.bytesPerElement=12,xr("StructArrayLayout2ub2f12",Mt);var Qt=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g,_){var w=this.length;return this.resize(w+1),this.emplace(w,u,g,_)},n.prototype.emplace=function(u,g,_,w){var S=3*u;return this.uint16[S+0]=g,this.uint16[S+1]=_,this.uint16[S+2]=w,u},n}(Si);Qt.prototype.bytesPerElement=6,xr("StructArrayLayout3ui6",Qt);var ke=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g,_,w,S,D,z,q,G,J,ut,mt,zt,Vt,fe,ne,Ee){var Ce=this.length;return this.resize(Ce+1),this.emplace(Ce,u,g,_,w,S,D,z,q,G,J,ut,mt,zt,Vt,fe,ne,Ee)},n.prototype.emplace=function(u,g,_,w,S,D,z,q,G,J,ut,mt,zt,Vt,fe,ne,Ee,Ce){var Re=24*u,Be=12*u,rr=48*u;return this.int16[Re+0]=g,this.int16[Re+1]=_,this.uint16[Re+2]=w,this.uint16[Re+3]=S,this.uint32[Be+2]=D,this.uint32[Be+3]=z,this.uint32[Be+4]=q,this.uint16[Re+10]=G,this.uint16[Re+11]=J,this.uint16[Re+12]=ut,this.float32[Be+7]=mt,this.float32[Be+8]=zt,this.uint8[rr+36]=Vt,this.uint8[rr+37]=fe,this.uint8[rr+38]=ne,this.uint32[Be+10]=Ee,this.int16[Re+22]=Ce,u},n}(Si);ke.prototype.bytesPerElement=48,xr("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ke);var Ge=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g,_,w,S,D,z,q,G,J,ut,mt,zt,Vt,fe,ne,Ee,Ce,Re,Be,rr,wr,Er,Hr,Ar,nn,Fr,ii){var Cn=this.length;return this.resize(Cn+1),this.emplace(Cn,u,g,_,w,S,D,z,q,G,J,ut,mt,zt,Vt,fe,ne,Ee,Ce,Re,Be,rr,wr,Er,Hr,Ar,nn,Fr,ii)},n.prototype.emplace=function(u,g,_,w,S,D,z,q,G,J,ut,mt,zt,Vt,fe,ne,Ee,Ce,Re,Be,rr,wr,Er,Hr,Ar,nn,Fr,ii,Cn){var Yr=34*u,fi=17*u;return this.int16[Yr+0]=g,this.int16[Yr+1]=_,this.int16[Yr+2]=w,this.int16[Yr+3]=S,this.int16[Yr+4]=D,this.int16[Yr+5]=z,this.int16[Yr+6]=q,this.int16[Yr+7]=G,this.uint16[Yr+8]=J,this.uint16[Yr+9]=ut,this.uint16[Yr+10]=mt,this.uint16[Yr+11]=zt,this.uint16[Yr+12]=Vt,this.uint16[Yr+13]=fe,this.uint16[Yr+14]=ne,this.uint16[Yr+15]=Ee,this.uint16[Yr+16]=Ce,this.uint16[Yr+17]=Re,this.uint16[Yr+18]=Be,this.uint16[Yr+19]=rr,this.uint16[Yr+20]=wr,this.uint16[Yr+21]=Er,this.uint16[Yr+22]=Hr,this.uint32[fi+12]=Ar,this.float32[fi+13]=nn,this.float32[fi+14]=Fr,this.float32[fi+15]=ii,this.float32[fi+16]=Cn,u},n}(Si);Ge.prototype.bytesPerElement=68,xr("StructArrayLayout8i15ui1ul4f68",Ge);var gr=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u){var g=this.length;return this.resize(g+1),this.emplace(g,u)},n.prototype.emplace=function(u,g){return this.float32[1*u+0]=g,u},n}(Si);gr.prototype.bytesPerElement=4,xr("StructArrayLayout1f4",gr);var Ir=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g,_){var w=this.length;return this.resize(w+1),this.emplace(w,u,g,_)},n.prototype.emplace=function(u,g,_,w){var S=3*u;return this.int16[S+0]=g,this.int16[S+1]=_,this.int16[S+2]=w,u},n}(Si);Ir.prototype.bytesPerElement=6,xr("StructArrayLayout3i6",Ir);var jr=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g,_){var w=this.length;return this.resize(w+1),this.emplace(w,u,g,_)},n.prototype.emplace=function(u,g,_,w){var S=4*u;return this.uint32[2*u+0]=g,this.uint16[S+2]=_,this.uint16[S+3]=w,u},n}(Si);jr.prototype.bytesPerElement=8,xr("StructArrayLayout1ul2ui8",jr);var ln=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g){var _=this.length;return this.resize(_+1),this.emplace(_,u,g)},n.prototype.emplace=function(u,g,_){var w=2*u;return this.uint16[w+0]=g,this.uint16[w+1]=_,u},n}(Si);ln.prototype.bytesPerElement=4,xr("StructArrayLayout2ui4",ln);var Mi=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u){var g=this.length;return this.resize(g+1),this.emplace(g,u)},n.prototype.emplace=function(u,g){return this.uint16[1*u+0]=g,u},n}(Si);Mi.prototype.bytesPerElement=2,xr("StructArrayLayout1ui2",Mi);var l=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g,_,w){var S=this.length;return this.resize(S+1),this.emplace(S,u,g,_,w)},n.prototype.emplace=function(u,g,_,w,S){var D=4*u;return this.float32[D+0]=g,this.float32[D+1]=_,this.float32[D+2]=w,this.float32[D+3]=S,u},n}(Si);l.prototype.bytesPerElement=16,xr("StructArrayLayout4f16",l);var f=function(t){function n(){t.apply(this,arguments)}t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n;var u={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return u.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},u.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},u.x1.get=function(){return this._structArray.int16[this._pos2+2]},u.y1.get=function(){return this._structArray.int16[this._pos2+3]},u.x2.get=function(){return this._structArray.int16[this._pos2+4]},u.y2.get=function(){return this._structArray.int16[this._pos2+5]},u.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},u.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},u.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},u.anchorPoint.get=function(){return new Nt(this.anchorPointX,this.anchorPointY)},Object.defineProperties(n.prototype,u),n}(cu);f.prototype.size=20;var c=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.get=function(u){return new f(this,u)},n}(L);xr("CollisionBoxArray",c);var m=function(t){function n(){t.apply(this,arguments)}t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n;var u={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return u.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},u.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},u.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},u.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},u.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},u.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},u.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},u.segment.get=function(){return this._structArray.uint16[this._pos2+10]},u.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},u.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},u.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},u.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},u.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},u.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},u.placedOrientation.set=function(g){this._structArray.uint8[this._pos1+37]=g},u.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},u.hidden.set=function(g){this._structArray.uint8[this._pos1+38]=g},u.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},u.crossTileID.set=function(g){this._structArray.uint32[this._pos4+10]=g},u.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(n.prototype,u),n}(cu);m.prototype.size=48;var E=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.get=function(u){return new m(this,u)},n}(ke);xr("PlacedSymbolArray",E);var P=function(t){function n(){t.apply(this,arguments)}t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n;var u={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return u.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},u.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},u.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},u.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},u.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},u.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},u.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},u.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},u.key.get=function(){return this._structArray.uint16[this._pos2+8]},u.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},u.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},u.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},u.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},u.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},u.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},u.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},u.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},u.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},u.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},u.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},u.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},u.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},u.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},u.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},u.crossTileID.set=function(g){this._structArray.uint32[this._pos4+12]=g},u.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},u.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},u.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},u.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(n.prototype,u),n}(cu);P.prototype.size=68;var T=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.get=function(u){return new P(this,u)},n}(Ge);xr("SymbolInstanceArray",T);var R=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.getoffsetX=function(u){return this.float32[1*u+0]},n}(gr);xr("GlyphOffsetArray",R);var V=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.getx=function(u){return this.int16[3*u+0]},n.prototype.gety=function(u){return this.int16[3*u+1]},n.prototype.gettileUnitDistanceFromAnchor=function(u){return this.int16[3*u+2]},n}(Ir);xr("SymbolLineVertexArray",V);var Q=function(t){function n(){t.apply(this,arguments)}t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n;var u={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return u.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},u.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},u.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(n.prototype,u),n}(cu);Q.prototype.size=8;var vt=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.get=function(u){return new Q(this,u)},n}(jr);xr("FeatureIndexArray",vt);var Et=bo([{name:"a_pos",components:2,type:"Int16"}],4).members,_t=function(t){void 0===t&&(t=[]),this.segments=t};function Jt(t,n){return 256*(t=Yt(Math.floor(t),0,255))+Yt(Math.floor(n),0,255)}_t.prototype.prepareSegment=function(t,n,u,g){var _=this.segments[this.segments.length-1];return t>_t.MAX_VERTEX_ARRAY_LENGTH&&Ct("Max vertices per segment is "+_t.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+t),(!_||_.vertexLength+t>_t.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==g)&&(_={vertexOffset:n.length,primitiveOffset:u.length,vertexLength:0,primitiveLength:0},void 0!==g&&(_.sortKey=g),this.segments.push(_)),_},_t.prototype.get=function(){return this.segments},_t.prototype.destroy=function(){for(var t=0,n=this.segments;t<n.length;t+=1){var u=n[t];for(var g in u.vaos)u.vaos[g].destroy()}},_t.simpleSegment=function(t,n,u,g){return new _t([{vertexOffset:t,primitiveOffset:n,vertexLength:u,primitiveLength:g,vaos:{},sortKey:0}])},_t.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,xr("SegmentVector",_t);var Gt=bo([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),ee=lt(function(t){t.exports=function(n,u){var g,_,w,S,D,z,q,G;for(_=n.length-(g=3&n.length),w=u,D=3432918353,z=461845907,G=0;G<_;)q=255&n.charCodeAt(G)|(255&n.charCodeAt(++G))<<8|(255&n.charCodeAt(++G))<<16|(255&n.charCodeAt(++G))<<24,++G,w=27492+(65535&(S=5*(65535&(w=(w^=q=(65535&(q=(q=(65535&q)*D+(((q>>>16)*D&65535)<<16)&4294967295)<<15|q>>>17))*z+(((q>>>16)*z&65535)<<16)&4294967295)<<13|w>>>19))+((5*(w>>>16)&65535)<<16)&4294967295))+((58964+(S>>>16)&65535)<<16);switch(q=0,g){case 3:q^=(255&n.charCodeAt(G+2))<<16;case 2:q^=(255&n.charCodeAt(G+1))<<8;case 1:w^=q=(65535&(q=(q=(65535&(q^=255&n.charCodeAt(G)))*D+(((q>>>16)*D&65535)<<16)&4294967295)<<15|q>>>17))*z+(((q>>>16)*z&65535)<<16)&4294967295}return w^=n.length,w=2246822507*(65535&(w^=w>>>16))+((2246822507*(w>>>16)&65535)<<16)&4294967295,w=3266489909*(65535&(w^=w>>>13))+((3266489909*(w>>>16)&65535)<<16)&4294967295,(w^=w>>>16)>>>0}}),jt=lt(function(t){t.exports=function(n,u){for(var g,_=n.length,w=u^_,S=0;_>=4;)g=1540483477*(65535&(g=255&n.charCodeAt(S)|(255&n.charCodeAt(++S))<<8|(255&n.charCodeAt(++S))<<16|(255&n.charCodeAt(++S))<<24))+((1540483477*(g>>>16)&65535)<<16),w=1540483477*(65535&w)+((1540483477*(w>>>16)&65535)<<16)^(g=1540483477*(65535&(g^=g>>>24))+((1540483477*(g>>>16)&65535)<<16)),_-=4,++S;switch(_){case 3:w^=(255&n.charCodeAt(S+2))<<16;case 2:w^=(255&n.charCodeAt(S+1))<<8;case 1:w=1540483477*(65535&(w^=255&n.charCodeAt(S)))+((1540483477*(w>>>16)&65535)<<16)}return w=1540483477*(65535&(w^=w>>>13))+((1540483477*(w>>>16)&65535)<<16),(w^=w>>>15)>>>0}}),ie=ee,ye=jt;ie.murmur3=ee,ie.murmur2=ye;var we=function(){this.ids=[],this.positions=[],this.indexed=!1};we.prototype.add=function(t,n,u,g){this.ids.push(Ne(t)),this.positions.push(n,u,g)},we.prototype.getPositions=function(t){for(var n=Ne(t),u=0,g=this.ids.length-1;u<g;){var _=u+g>>1;this.ids[_]>=n?g=_:u=_+1}for(var w=[];this.ids[u]===n;)w.push({index:this.positions[3*u],start:this.positions[3*u+1],end:this.positions[3*u+2]}),u++;return w},we.serialize=function(t,n){var u=new Float64Array(t.ids),g=new Uint32Array(t.positions);return function _(w,S,D,z){for(;D<z;){for(var q=w[D+z>>1],G=D-1,J=z+1;;){do{G++}while(w[G]<q);do{J--}while(w[J]>q);if(G>=J)break;We(w,G,J),We(S,3*G,3*J),We(S,3*G+1,3*J+1),We(S,3*G+2,3*J+2)}J-D<z-J?(_(w,S,D,J),D=J+1):(_(w,S,J+1,z),z=J)}}(u,g,0,u.length-1),n&&n.push(u.buffer,g.buffer),{ids:u,positions:g}},we.deserialize=function(t){var n=new we;return n.ids=t.ids,n.positions=t.positions,n.indexed=!0,n};var Ze=Math.pow(2,53)-1;function Ne(t){var n=+t;return!isNaN(n)&&n<=Ze?n:ie(String(t))}function We(t,n,u){var g=t[n];t[n]=t[u],t[u]=g}xr("FeaturePositionMap",we);var er=function(t,n){this.gl=t.gl,this.location=n},br=function(t){function n(u,g){t.call(this,u,g),this.current=0}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.set=function(u){this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))},n}(er),fr=function(t){function n(u,g){t.call(this,u,g),this.current=0}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.set=function(u){this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))},n}(er),Br=function(t){function n(u,g){t.call(this,u,g),this.current=[0,0]}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.set=function(u){u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1]))},n}(er),cn=function(t){function n(u,g){t.call(this,u,g),this.current=[0,0,0]}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.set=function(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2]))},n}(er),hn=function(t){function n(u,g){t.call(this,u,g),this.current=[0,0,0,0]}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.set=function(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3]))},n}(er),rn=function(t){function n(u,g){t.call(this,u,g),this.current=Jn.transparent}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.set=function(u){u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a))},n}(er),Pi=new Float32Array(16),Ur=function(t){function n(u,g){t.call(this,u,g),this.current=Pi}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.set=function(u){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(var g=1;g<16;g++)if(u[g]!==this.current[g]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}},n}(er);function Zn(t){return[Jt(255*t.r,255*t.g),Jt(255*t.b,255*t.a)]}var si=function(t,n,u){this.value=t,this.uniformNames=n.map(function(g){return"u_"+g}),this.type=u};si.prototype.setUniform=function(t,n,u){t.set(u.constantOr(this.value))},si.prototype.getBinding=function(t,n,u){return"color"===this.type?new rn(t,n):new fr(t,n)};var Rn=function(t,n){this.uniformNames=n.map(function(u){return"u_"+u}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Rn.prototype.setConstantPatternPositions=function(t,n){this.pixelRatioFrom=n.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=n.tlbr,this.patternTo=t.tlbr},Rn.prototype.setUniform=function(t,n,u,g){var _="u_pattern_to"===g?this.patternTo:"u_pattern_from"===g?this.patternFrom:"u_pixel_ratio_to"===g?this.pixelRatioTo:"u_pixel_ratio_from"===g?this.pixelRatioFrom:null;_&&t.set(_)},Rn.prototype.getBinding=function(t,n,u){return"u_pattern"===u.substr(0,9)?new hn(t,n):new fr(t,n)};var Fn=function(t,n,u,g){this.expression=t,this.type=u,this.maxValue=0,this.paintVertexAttributes=n.map(function(_){return{name:"a_"+_,type:"Float32",components:"color"===u?2:1,offset:0}}),this.paintVertexArray=new g};Fn.prototype.populatePaintArray=function(t,n,u,g,_){var w=this.paintVertexArray.length,S=this.expression.evaluate(new mo(0),n,{},g,[],_);this.paintVertexArray.resize(t),this._setPaintValue(w,t,S)},Fn.prototype.updatePaintArray=function(t,n,u,g){var _=this.expression.evaluate({zoom:0},u,g);this._setPaintValue(t,n,_)},Fn.prototype._setPaintValue=function(t,n,u){if("color"===this.type)for(var g=Zn(u),_=t;_<n;_++)this.paintVertexArray.emplace(_,g[0],g[1]);else{for(var w=t;w<n;w++)this.paintVertexArray.emplace(w,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}},Fn.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Fn.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Dn=function(t,n,u,g,_,w){this.expression=t,this.uniformNames=n.map(function(S){return"u_"+S+"_t"}),this.type=u,this.useIntegerZoom=g,this.zoom=_,this.maxValue=0,this.paintVertexAttributes=n.map(function(S){return{name:"a_"+S,type:"Float32",components:"color"===u?4:2,offset:0}}),this.paintVertexArray=new w};Dn.prototype.populatePaintArray=function(t,n,u,g,_){var w=this.expression.evaluate(new mo(this.zoom),n,{},g,[],_),S=this.expression.evaluate(new mo(this.zoom+1),n,{},g,[],_),D=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(D,t,w,S)},Dn.prototype.updatePaintArray=function(t,n,u,g){var _=this.expression.evaluate({zoom:this.zoom},u,g),w=this.expression.evaluate({zoom:this.zoom+1},u,g);this._setPaintValue(t,n,_,w)},Dn.prototype._setPaintValue=function(t,n,u,g){if("color"===this.type)for(var _=Zn(u),w=Zn(g),S=t;S<n;S++)this.paintVertexArray.emplace(S,_[0],_[1],w[0],w[1]);else{for(var D=t;D<n;D++)this.paintVertexArray.emplace(D,u,g);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(g))}},Dn.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Dn.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Dn.prototype.setUniform=function(t,n){var u=this.useIntegerZoom?Math.floor(n.zoom):n.zoom,g=Yt(this.expression.interpolationFactor(u,this.zoom,this.zoom+1),0,1);t.set(g)},Dn.prototype.getBinding=function(t,n,u){return new fr(t,n)};var Ln=function(t,n,u,g,_,w){this.expression=t,this.type=n,this.useIntegerZoom=u,this.zoom=g,this.layerId=w,this.zoomInPaintVertexArray=new _,this.zoomOutPaintVertexArray=new _};Ln.prototype.populatePaintArray=function(t,n,u){var g=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(g,t,n.patterns&&n.patterns[this.layerId],u)},Ln.prototype.updatePaintArray=function(t,n,u,g,_){this._setPaintValues(t,n,u.patterns&&u.patterns[this.layerId],_)},Ln.prototype._setPaintValues=function(t,n,u,g){if(g&&u){var _=g[u.min],w=g[u.mid],S=g[u.max];if(_&&w&&S)for(var D=t;D<n;D++)this.zoomInPaintVertexArray.emplace(D,w.tl[0],w.tl[1],w.br[0],w.br[1],_.tl[0],_.tl[1],_.br[0],_.br[1],w.pixelRatio,_.pixelRatio),this.zoomOutPaintVertexArray.emplace(D,w.tl[0],w.tl[1],w.br[0],w.br[1],S.tl[0],S.tl[1],S.br[0],S.br[1],w.pixelRatio,S.pixelRatio)}},Ln.prototype.upload=function(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Gt.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Gt.members,this.expression.isStateDependent))},Ln.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var gn=function(t,n,u){this.binders={},this._buffers=[];var g=[];for(var _ in t.paint._values)if(u(_)){var w=t.paint.get(_);if(w instanceof Es&&hi(w.property.specification)){var S=Pa(_,t.type),D=w.value,z=w.property.specification.type,q=w.property.useIntegerZoom,G=w.property.specification["property-type"],J="cross-faded"===G||"cross-faded-data-driven"===G;if("constant"===D.kind)this.binders[_]=J?new Rn(D.value,S):new si(D.value,S,z),g.push("/u_"+_);else if("source"===D.kind||J){var ut=Us(_,z,"source");this.binders[_]=J?new Ln(D,z,q,n,ut,t.id):new Fn(D,S,z,ut),g.push("/a_"+_)}else{var mt=Us(_,z,"composite");this.binders[_]=new Dn(D,S,z,q,n,mt),g.push("/z_"+_)}}}this.cacheKey=g.sort().join("")};gn.prototype.getMaxValue=function(t){var n=this.binders[t];return n instanceof Fn||n instanceof Dn?n.maxValue:0},gn.prototype.populatePaintArrays=function(t,n,u,g,_){for(var w in this.binders){var S=this.binders[w];(S instanceof Fn||S instanceof Dn||S instanceof Ln)&&S.populatePaintArray(t,n,u,g,_)}},gn.prototype.setConstantPatternPositions=function(t,n){for(var u in this.binders){var g=this.binders[u];g instanceof Rn&&g.setConstantPatternPositions(t,n)}},gn.prototype.updatePaintArrays=function(t,n,u,g,_){var w=!1;for(var S in t)for(var D=0,z=n.getPositions(S);D<z.length;D+=1){var q=z[D],G=u.feature(q.index);for(var J in this.binders){var ut=this.binders[J];if((ut instanceof Fn||ut instanceof Dn||ut instanceof Ln)&&!0===ut.expression.isStateDependent){var mt=g.paint.get(J);ut.expression=mt.value,ut.updatePaintArray(q.start,q.end,G,t[S],_),w=!0}}}return w},gn.prototype.defines=function(){var t=[];for(var n in this.binders){var u=this.binders[n];(u instanceof si||u instanceof Rn)&&t.push.apply(t,u.uniformNames.map(function(g){return"#define HAS_UNIFORM_"+g}))}return t},gn.prototype.getBinderAttributes=function(){var t=[];for(var n in this.binders){var u=this.binders[n];if(u instanceof Fn||u instanceof Dn)for(var g=0;g<u.paintVertexAttributes.length;g++)t.push(u.paintVertexAttributes[g].name);else if(u instanceof Ln)for(var _=0;_<Gt.members.length;_++)t.push(Gt.members[_].name)}return t},gn.prototype.getBinderUniforms=function(){var t=[];for(var n in this.binders){var u=this.binders[n];if(u instanceof si||u instanceof Rn||u instanceof Dn)for(var g=0,_=u.uniformNames;g<_.length;g+=1)t.push(_[g])}return t},gn.prototype.getPaintVertexBuffers=function(){return this._buffers},gn.prototype.getUniforms=function(t,n){var u=[];for(var g in this.binders){var _=this.binders[g];if(_ instanceof si||_ instanceof Rn||_ instanceof Dn)for(var w=0,S=_.uniformNames;w<S.length;w+=1){var D=S[w];if(n[D]){var z=_.getBinding(t,n[D],D);u.push({name:D,property:g,binding:z})}}}return u},gn.prototype.setUniforms=function(t,n,u,g){for(var _=0,w=n;_<w.length;_+=1){var S=w[_],D=S.name,z=S.property;this.binders[z].setUniform(S.binding,g,u.get(z),D)}},gn.prototype.updatePaintBuffers=function(t){for(var n in this._buffers=[],this.binders){var u=this.binders[n];if(t&&u instanceof Ln){var g=2===t.fromScale?u.zoomInPaintVertexBuffer:u.zoomOutPaintVertexBuffer;g&&this._buffers.push(g)}else(u instanceof Fn||u instanceof Dn)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}},gn.prototype.upload=function(t){for(var n in this.binders){var u=this.binders[n];(u instanceof Fn||u instanceof Dn||u instanceof Ln)&&u.upload(t)}this.updatePaintBuffers()},gn.prototype.destroy=function(){for(var t in this.binders){var n=this.binders[t];(n instanceof Fn||n instanceof Dn||n instanceof Ln)&&n.destroy()}};var qo=function(t,n,u){void 0===u&&(u=function(){return!0}),this.programConfigurations={};for(var g=0,_=t;g<_.length;g+=1){var w=_[g];this.programConfigurations[w.id]=new gn(w,n,u)}this.needsUpload=!1,this._featureMap=new we,this._bufferOffset=0};function Pa(t,n){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[t]||[t.replace(n+"-","").replace(/-/g,"_")]}function Us(t,n,u){var _={"line-pattern":{source:i,composite:i},"fill-pattern":{source:i,composite:i},"fill-extrusion-pattern":{source:i,composite:i}}[t];return _&&_[u]||{color:{source:e,composite:l},number:{source:gr,composite:e}}[n][u]}qo.prototype.populatePaintArrays=function(t,n,u,g,_,w){for(var S in this.programConfigurations)this.programConfigurations[S].populatePaintArrays(t,n,g,_,w);void 0!==n.id&&this._featureMap.add(n.id,u,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0},qo.prototype.updatePaintArrays=function(t,n,u,g){for(var _=0,w=u;_<w.length;_+=1){var S=w[_];this.needsUpload=this.programConfigurations[S.id].updatePaintArrays(t,this._featureMap,n,S,g)||this.needsUpload}},qo.prototype.get=function(t){return this.programConfigurations[t]},qo.prototype.upload=function(t){if(this.needsUpload){for(var n in this.programConfigurations)this.programConfigurations[n].upload(t);this.needsUpload=!1}},qo.prototype.destroy=function(){for(var t in this.programConfigurations)this.programConfigurations[t].destroy()},xr("ConstantBinder",si),xr("CrossFadedConstantBinder",Rn),xr("SourceExpressionBinder",Fn),xr("CrossFadedCompositeBinder",Ln),xr("CompositeExpressionBinder",Dn),xr("ProgramConfiguration",gn,{omit:["_buffers"]}),xr("ProgramConfigurationSet",qo);var ms=Math.pow(2,14)-1,Cs=-ms-1;function Ya(t){for(var n=8192/t.extent,u=t.loadGeometry(),g=0;g<u.length;g++)for(var _=u[g],w=0;w<_.length;w++){var S=_[w],D=Math.round(S.x*n),z=Math.round(S.y*n);S.x=Yt(D,Cs,ms),S.y=Yt(z,Cs,ms),(D<S.x||D>S.x+1||z<S.y||z>S.y+1)&&Ct("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return u}function Os(t,n){return{type:t.type,id:t.id,properties:t.properties,geometry:n?Ya(t):[]}}function dl(t,n,u,g,_){t.emplaceBack(2*n+(g+1)/2,2*u+(_+1)/2)}var hu=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(n){return n.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new gs,this.indexArray=new Qt,this.segments=new _t,this.programConfigurations=new qo(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(function(n){return n.isStateDependent()}).map(function(n){return n.id})};function ks(t,n){for(var u=0;u<t.length;u++)if(il(n,t[u]))return!0;for(var g=0;g<n.length;g++)if(il(t,n[g]))return!0;return!!Nl(t,n)}function gl(t,n,u){return!!il(t,n)||!!El(n,t,u)}function Gu(t,n){if(1===t.length)return lc(n,t[0]);for(var u=0;u<n.length;u++)for(var g=n[u],_=0;_<g.length;_++)if(il(t,g[_]))return!0;for(var w=0;w<t.length;w++)if(lc(n,t[w]))return!0;for(var S=0;S<n.length;S++)if(Nl(t,n[S]))return!0;return!1}function Ec(t,n,u){if(t.length>1){if(Nl(t,n))return!0;for(var g=0;g<n.length;g++)if(El(n[g],t,u))return!0}for(var _=0;_<t.length;_++)if(El(t[_],n,u))return!0;return!1}function Nl(t,n){if(0===t.length||0===n.length)return!1;for(var u=0;u<t.length-1;u++)for(var g=t[u],_=t[u+1],w=0;w<n.length-1;w++)if(uc(g,_,n[w],n[w+1]))return!0;return!1}function uc(t,n,u,g){return kt(t,u,g)!==kt(n,u,g)&&kt(t,n,u)!==kt(t,n,g)}function El(t,n,u){var g=u*u;if(1===n.length)return t.distSqr(n[0])<g;for(var _=1;_<n.length;_++)if(Sc(t,n[_-1],n[_])<g)return!0;return!1}function Sc(t,n,u){var g=n.distSqr(u);if(0===g)return t.distSqr(n);var _=((t.x-n.x)*(u.x-n.x)+(t.y-n.y)*(u.y-n.y))/g;return t.distSqr(_<0?n:_>1?u:u.sub(n)._mult(_)._add(n))}function lc(t,n){for(var u,g,_,w=!1,S=0;S<t.length;S++)for(var D=0,z=(u=t[S]).length-1;D<u.length;z=D++)(g=u[D]).y>n.y!=(_=u[z]).y>n.y&&n.x<(_.x-g.x)*(n.y-g.y)/(_.y-g.y)+g.x&&(w=!w);return w}function il(t,n){for(var u=!1,g=0,_=t.length-1;g<t.length;_=g++){var w=t[g],S=t[_];w.y>n.y!=S.y>n.y&&n.x<(S.x-w.x)*(n.y-w.y)/(S.y-w.y)+w.x&&(u=!u)}return u}function cc(t,n,u){var g=u[0],_=u[2];if(t.x<g.x&&n.x<g.x||t.x>_.x&&n.x>_.x||t.y<g.y&&n.y<g.y||t.y>_.y&&n.y>_.y)return!1;var w=kt(t,n,u[0]);return w!==kt(t,n,u[1])||w!==kt(t,n,u[2])||w!==kt(t,n,u[3])}function ys(t,n,u){var g=n.paint.get(t).value;return"constant"===g.kind?g.value:u.programConfigurations.get(n.id).getMaxValue(t)}function ol(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Hu(t,n,u,g,_){if(!n[0]&&!n[1])return t;var w=Nt.convert(n)._mult(_);"viewport"===u&&w._rotate(-g);for(var S=[],D=0;D<t.length;D++)S.push(t[D].sub(w));return S}hu.prototype.populate=function(t,n,u){var g=this.layers[0],_=[],w=null,S=!1;"circle"===g.type&&(S=!(w=g.layout.get("circle-sort-key")).isConstant());for(var D=0,z=t;D<z.length;D+=1){var q=z[D],G=q.feature,J=q.id,ut=q.index,mt=q.sourceLayerIndex,zt=this.layers[0]._featureFilter.needGeometry,Vt=Os(G,zt);if(this.layers[0]._featureFilter.filter(new mo(this.zoom),Vt,u)){var fe=S?w.evaluate(Vt,{},u):void 0,ne={id:J,properties:G.properties,type:G.type,sourceLayerIndex:mt,index:ut,geometry:zt?Vt.geometry:Ya(G),patterns:{},sortKey:fe};_.push(ne)}}S&&_.sort(function(Hr,Ar){return Hr.sortKey-Ar.sortKey});for(var Ee=0,Ce=_;Ee<Ce.length;Ee+=1){var Re=Ce[Ee],Be=Re.geometry,rr=Re.index,wr=Re.sourceLayerIndex,Er=t[rr].feature;this.addFeature(Re,Be,rr,u),n.featureIndex.insert(Er,Be,rr,wr,this.index)}},hu.prototype.update=function(t,n,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,u)},hu.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},hu.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},hu.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Et),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},hu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},hu.prototype.addFeature=function(t,n,u,g){for(var _=0,w=n;_<w.length;_+=1)for(var S=0,D=w[_];S<D.length;S+=1){var z=D[S],q=z.x,G=z.y;if(!(q<0||q>=8192||G<0||G>=8192)){var J=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),ut=J.vertexLength;dl(this.layoutVertexArray,q,G,-1,-1),dl(this.layoutVertexArray,q,G,1,-1),dl(this.layoutVertexArray,q,G,1,1),dl(this.layoutVertexArray,q,G,-1,1),this.indexArray.emplaceBack(ut,ut+1,ut+2),this.indexArray.emplaceBack(ut,ut+3,ut+2),J.vertexLength+=4,J.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,{},g)},xr("CircleBucket",hu,{omit:["layers"]});var Rl=new Ma({"circle-sort-key":new mn(Dt.layout_circle["circle-sort-key"])}),na={paint:new Ma({"circle-radius":new mn(Dt.paint_circle["circle-radius"]),"circle-color":new mn(Dt.paint_circle["circle-color"]),"circle-blur":new mn(Dt.paint_circle["circle-blur"]),"circle-opacity":new mn(Dt.paint_circle["circle-opacity"]),"circle-translate":new Tr(Dt.paint_circle["circle-translate"]),"circle-translate-anchor":new Tr(Dt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Tr(Dt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Tr(Dt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new mn(Dt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new mn(Dt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new mn(Dt.paint_circle["circle-stroke-opacity"])}),layout:Rl},Oa=typeof Float32Array<"u"?Float32Array:Array;function pu(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Cc(t,n,u){var g=n[0],_=n[1],w=n[2],S=n[3],D=n[4],z=n[5],q=n[6],G=n[7],J=n[8],ut=n[9],mt=n[10],zt=n[11],Vt=n[12],fe=n[13],ne=n[14],Ee=n[15],Ce=u[0],Re=u[1],Be=u[2],rr=u[3];return t[0]=Ce*g+Re*D+Be*J+rr*Vt,t[1]=Ce*_+Re*z+Be*ut+rr*fe,t[2]=Ce*w+Re*q+Be*mt+rr*ne,t[3]=Ce*S+Re*G+Be*zt+rr*Ee,t[4]=(Ce=u[4])*g+(Re=u[5])*D+(Be=u[6])*J+(rr=u[7])*Vt,t[5]=Ce*_+Re*z+Be*ut+rr*fe,t[6]=Ce*w+Re*q+Be*mt+rr*ne,t[7]=Ce*S+Re*G+Be*zt+rr*Ee,t[8]=(Ce=u[8])*g+(Re=u[9])*D+(Be=u[10])*J+(rr=u[11])*Vt,t[9]=Ce*_+Re*z+Be*ut+rr*fe,t[10]=Ce*w+Re*q+Be*mt+rr*ne,t[11]=Ce*S+Re*G+Be*zt+rr*Ee,t[12]=(Ce=u[12])*g+(Re=u[13])*D+(Be=u[14])*J+(rr=u[15])*Vt,t[13]=Ce*_+Re*z+Be*ut+rr*fe,t[14]=Ce*w+Re*q+Be*mt+rr*ne,t[15]=Ce*S+Re*G+Be*zt+rr*Ee,t}Math.hypot||(Math.hypot=function(){for(var t=arguments,n=0,u=arguments.length;u--;)n+=t[u]*t[u];return Math.sqrt(n)});var Fl,t,Sh=Cc;function hc(t,n,u){var g=n[0],_=n[1],w=n[2],S=n[3];return t[0]=u[0]*g+u[4]*_+u[8]*w+u[12]*S,t[1]=u[1]*g+u[5]*_+u[9]*w+u[13]*S,t[2]=u[2]*g+u[6]*_+u[10]*w+u[14]*S,t[3]=u[3]*g+u[7]*_+u[11]*w+u[15]*S,t}Fl=new Oa(3),Oa!=Float32Array&&(Fl[0]=0,Fl[1]=0,Fl[2]=0),t=new Oa(4),Oa!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0);var Xc=(function(){var t=new Oa(2);Oa!=Float32Array&&(t[0]=0,t[1]=0)}(),function(t){function n(u){t.call(this,u,na)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.createBucket=function(u){return new hu(u)},n.prototype.queryRadius=function(u){var g=u;return ys("circle-radius",this,g)+ys("circle-stroke-width",this,g)+ol(this.paint.get("circle-translate"))},n.prototype.queryIntersectsFeature=function(u,g,_,w,S,D,z,q){for(var G=Hu(u,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),D.angle,z),J=this.paint.get("circle-radius").evaluate(g,_)+this.paint.get("circle-stroke-width").evaluate(g,_),ut="map"===this.paint.get("circle-pitch-alignment"),mt=ut?G:function(wr,Er){return wr.map(function(Hr){return Ch(Hr,Er)})}(G,q),zt=ut?J*z:J,Vt=0,fe=w;Vt<fe.length;Vt+=1)for(var ne=0,Ee=fe[Vt];ne<Ee.length;ne+=1){var Ce=Ee[ne],Re=ut?Ce:Ch(Ce,q),Be=zt,rr=hc([],[Ce.x,Ce.y,0,1],q);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?Be*=rr[3]/D.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(Be*=D.cameraToCenterDistance/rr[3]),gl(mt,Re,Be))return!0}return!1},n}(dn));function Ch(t,n){var u=hc([],[t.x,t.y,0,1],n);return new Nt(u[0]/u[3],u[1]/u[3])}var pc=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n}(hu);function Xl(t,n,u,g){var _=n.width,w=n.height;if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==_*w*u)throw new RangeError("mismatched image size")}else g=new Uint8Array(_*w*u);return t.width=_,t.height=w,t.data=g,t}function Yl(t,n,u){var g=n.width,_=n.height;if(g!==t.width||_!==t.height){var w=Xl({},{width:g,height:_},u);ap(t,w,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,g),height:Math.min(t.height,_)},u),t.width=g,t.height=_,t.data=w.data}}function ap(t,n,u,g,_,w){if(0===_.width||0===_.height)return n;if(_.width>t.width||_.height>t.height||u.x>t.width-_.width||u.y>t.height-_.height)throw new RangeError("out of range source coordinates for image copy");if(_.width>n.width||_.height>n.height||g.x>n.width-_.width||g.y>n.height-_.height)throw new RangeError("out of range destination coordinates for image copy");for(var S=t.data,D=n.data,z=0;z<_.height;z++)for(var q=((u.y+z)*t.width+u.x)*w,G=((g.y+z)*n.width+g.x)*w,J=0;J<_.width*w;J++)D[G+J]=S[q+J];return n}xr("HeatmapBucket",pc,{omit:["layers"]});var ns=function(t,n){Xl(this,t,1,n)};ns.prototype.resize=function(t){Yl(this,t,1)},ns.prototype.clone=function(){return new ns({width:this.width,height:this.height},new Uint8Array(this.data))},ns.copy=function(t,n,u,g,_){ap(t,n,u,g,_,1)};var ma=function(t,n){Xl(this,t,4,n)};ma.prototype.resize=function(t){Yl(this,t,4)},ma.prototype.replace=function(t,n){n?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t},ma.prototype.clone=function(){return new ma({width:this.width,height:this.height},new Uint8Array(this.data))},ma.copy=function(t,n,u,g,_){ap(t,n,u,g,_,4)},xr("AlphaImage",ns),xr("RGBAImage",ma);var qs={paint:new Ma({"heatmap-radius":new mn(Dt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new mn(Dt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Tr(Dt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new nu(Dt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Tr(Dt.paint_heatmap["heatmap-opacity"])})};function Gs(t){var n={},u=t.resolution||256,g=t.clips?t.clips.length:1,_=t.image||new ma({width:u,height:g}),w=function(zt,Vt,fe){n[t.evaluationKey]=fe;var ne=t.expression.evaluate(n);_.data[zt+Vt+0]=Math.floor(255*ne.r/ne.a),_.data[zt+Vt+1]=Math.floor(255*ne.g/ne.a),_.data[zt+Vt+2]=Math.floor(255*ne.b/ne.a),_.data[zt+Vt+3]=Math.floor(255*ne.a)};if(t.clips)for(var S=0,D=0;S<g;++S,D+=4*u)for(var z=0,q=0;z<u;z++,q+=4){var G=z/(u-1),J=t.clips[S];w(D,q,J.start*(1-G)+J.end*G)}else for(var ut=0,mt=0;ut<u;ut++,mt+=4)w(0,mt,ut/(u-1));return _}var ji=function(t){function n(u){t.call(this,u,qs),this._updateColorRamp()}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.createBucket=function(u){return new pc(u)},n.prototype._handleSpecialPaintPropertyUpdate=function(u){"heatmap-color"===u&&this._updateColorRamp()},n.prototype._updateColorRamp=function(){this.colorRamp=Gs({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},n.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},n.prototype.queryRadius=function(){return 0},n.prototype.queryIntersectsFeature=function(){return!1},n.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},n}(dn),Zi={paint:new Ma({"hillshade-illumination-direction":new Tr(Dt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Tr(Dt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Tr(Dt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Tr(Dt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Tr(Dt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Tr(Dt.paint_hillshade["hillshade-accent-color"])})},Xi=function(t){function n(u){t.call(this,u,Zi)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},n}(dn),Yi=bo([{name:"a_pos",components:2,type:"Int16"}],4).members,Di=Ti,Ji=Ti;function Ti(t,n,u){u=u||2;var g,_,w,S,D,z,q,G=n&&n.length,J=G?n[0]*u:t.length,ut=Bi(t,0,J,u,!0),mt=[];if(!ut||ut.next===ut.prev)return mt;if(G&&(ut=function(Vt,fe,ne,Ee){var Ce,Re,Be,rr=[];for(Ce=0,Re=fe.length;Ce<Re;Ce++)(Be=Bi(Vt,fe[Ce]*Ee,Ce<Re-1?fe[Ce+1]*Ee:Vt.length,Ee,!1))===Be.next&&(Be.steiner=!0),rr.push(ro(Be));for(rr.sort(Qi),Ce=0;Ce<rr.length;Ce++)to(rr[Ce],ne),ne=di(ne,ne.next);return ne}(t,n,ut,u)),t.length>80*u){g=w=t[0],_=S=t[1];for(var zt=u;zt<J;zt+=u)(D=t[zt])<g&&(g=D),(z=t[zt+1])<_&&(_=z),D>w&&(w=D),z>S&&(S=z);q=0!==(q=Math.max(w-g,S-_))?1/q:0}return Ci(ut,mt,u,g,_,q),mt}function Bi(t,n,u,g,_){var w,S;if(_===Jc(t,n,u,g)>0)for(w=n;w<u;w+=g)S=Mh(w,t[w],t[w+1],S);else for(w=u-g;w>=n;w-=g)S=Mh(w,t[w],t[w+1],S);return S&&Ai(S,S.next)&&(dc(S),S=S.next),S}function di(t,n){if(!t)return t;n||(n=t);var u,g=t;do{if(u=!1,g.steiner||!Ai(g,g.next)&&0!==Sn(g.prev,g,g.next))g=g.next;else{if(dc(g),(g=n=g.prev)===g.next)break;u=!0}}while(u||g!==n);return n}function Ci(t,n,u,g,_,w,S){if(t){!S&&w&&function(G,J,ut,mt){var zt=G;do{null===zt.z&&(zt.z=Oi(zt.x,zt.y,J,ut,mt)),zt.prevZ=zt.prev,zt.nextZ=zt.next,zt=zt.next}while(zt!==G);zt.prevZ.nextZ=null,zt.prevZ=null,function(Vt){var fe,ne,Ee,Ce,Re,Be,rr,wr,Er=1;do{for(ne=Vt,Vt=null,Re=null,Be=0;ne;){for(Be++,Ee=ne,rr=0,fe=0;fe<Er&&(rr++,Ee=Ee.nextZ);fe++);for(wr=Er;rr>0||wr>0&&Ee;)0!==rr&&(0===wr||!Ee||ne.z<=Ee.z)?(Ce=ne,ne=ne.nextZ,rr--):(Ce=Ee,Ee=Ee.nextZ,wr--),Re?Re.nextZ=Ce:Vt=Ce,Ce.prevZ=Re,Re=Ce;ne=Ee}Re.nextZ=null,Er*=2}while(Be>1)}(zt)}(t,g,_,w);for(var D,z,q=t;t.prev!==t.next;)if(D=t.prev,z=t.next,w?Wi(t,g,_,w):Hi(t))n.push(D.i/u),n.push(t.i/u),n.push(z.i/u),dc(t),t=z.next,q=z.next;else if((t=z)===q){S?1===S?Ci(t=Ki(di(t),n,u),n,u,g,_,w,2):2===S&&$i(t,n,u,g,_,w):Ci(di(t),n,u,g,_,w,1);break}}}function Hi(t){var n=t.prev,u=t,g=t.next;if(Sn(n,u,g)>=0)return!1;for(var _=t.next.next;_!==t.prev;){if(vi(n.x,n.y,u.x,u.y,g.x,g.y,_.x,_.y)&&Sn(_.prev,_,_.next)>=0)return!1;_=_.next}return!0}function Wi(t,n,u,g){var _=t.prev,w=t,S=t.next;if(Sn(_,w,S)>=0)return!1;for(var D=_.x>w.x?_.x>S.x?_.x:S.x:w.x>S.x?w.x:S.x,z=_.y>w.y?_.y>S.y?_.y:S.y:w.y>S.y?w.y:S.y,q=Oi(_.x<w.x?_.x<S.x?_.x:S.x:w.x<S.x?w.x:S.x,_.y<w.y?_.y<S.y?_.y:S.y:w.y<S.y?w.y:S.y,n,u,g),G=Oi(D,z,n,u,g),J=t.prevZ,ut=t.nextZ;J&&J.z>=q&&ut&&ut.z<=G;){if(J!==t.prev&&J!==t.next&&vi(_.x,_.y,w.x,w.y,S.x,S.y,J.x,J.y)&&Sn(J.prev,J,J.next)>=0||(J=J.prevZ,ut!==t.prev&&ut!==t.next&&vi(_.x,_.y,w.x,w.y,S.x,S.y,ut.x,ut.y)&&Sn(ut.prev,ut,ut.next)>=0))return!1;ut=ut.nextZ}for(;J&&J.z>=q;){if(J!==t.prev&&J!==t.next&&vi(_.x,_.y,w.x,w.y,S.x,S.y,J.x,J.y)&&Sn(J.prev,J,J.next)>=0)return!1;J=J.prevZ}for(;ut&&ut.z<=G;){if(ut!==t.prev&&ut!==t.next&&vi(_.x,_.y,w.x,w.y,S.x,S.y,ut.x,ut.y)&&Sn(ut.prev,ut,ut.next)>=0)return!1;ut=ut.nextZ}return!0}function Ki(t,n,u){var g=t;do{var _=g.prev,w=g.next.next;!Ai(_,w)&&Ui(_,g,g.next,w)&&fc(_,w)&&fc(w,_)&&(n.push(_.i/u),n.push(g.i/u),n.push(w.i/u),dc(g),dc(g.next),g=t=w),g=g.next}while(g!==t);return di(g)}function $i(t,n,u,g,_,w){var S=t;do{for(var D=S.next.next;D!==S.prev;){if(S.i!==D.i&&no(S,D)){var z=Ih(S,D);return S=di(S,S.next),z=di(z,z.next),Ci(S,n,u,g,_,w),void Ci(z,n,u,g,_,w)}D=D.next}S=S.next}while(S!==t)}function Qi(t,n){return t.x-n.x}function to(t,n){if(n=function(g,_){var w,S=_,D=g.x,z=g.y,q=-1/0;do{if(z<=S.y&&z>=S.next.y&&S.next.y!==S.y){var G=S.x+(z-S.y)*(S.next.x-S.x)/(S.next.y-S.y);if(G<=D&&G>q){if(q=G,G===D){if(z===S.y)return S;if(z===S.next.y)return S.next}w=S.x<S.next.x?S:S.next}}S=S.next}while(S!==_);if(!w)return null;if(D===q)return w;var J,ut=w,mt=w.x,zt=w.y,Vt=1/0;S=w;do{D>=S.x&&S.x>=mt&&D!==S.x&&vi(z<zt?D:q,z,mt,zt,z<zt?q:D,z,S.x,S.y)&&(J=Math.abs(z-S.y)/(D-S.x),fc(S,g)&&(J<Vt||J===Vt&&(S.x>w.x||S.x===w.x&&eo(w,S)))&&(w=S,Vt=J)),S=S.next}while(S!==ut);return w}(t,n)){var u=Ih(n,t);di(n,n.next),di(u,u.next)}}function eo(t,n){return Sn(t.prev,t,n.prev)<0&&Sn(n.next,t,t.next)<0}function Oi(t,n,u,g,_){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-u)*_)|t<<8))|t<<4))|t<<2))|t<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=32767*(n-g)*_)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function ro(t){var n=t,u=t;do{(n.x<u.x||n.x===u.x&&n.y<u.y)&&(u=n),n=n.next}while(n!==t);return u}function vi(t,n,u,g,_,w,S,D){return(_-S)*(n-D)-(t-S)*(w-D)>=0&&(t-S)*(g-D)-(u-S)*(n-D)>=0&&(u-S)*(w-D)-(_-S)*(g-D)>=0}function no(t,n){return t.next.i!==n.i&&t.prev.i!==n.i&&!function(u,g){var _=u;do{if(_.i!==u.i&&_.next.i!==u.i&&_.i!==g.i&&_.next.i!==g.i&&Ui(_,_.next,u,g))return!0;_=_.next}while(_!==u);return!1}(t,n)&&(fc(t,n)&&fc(n,t)&&function(u,g){var _=u,w=!1,S=(u.x+g.x)/2,D=(u.y+g.y)/2;do{_.y>D!=_.next.y>D&&_.next.y!==_.y&&S<(_.next.x-_.x)*(D-_.y)/(_.next.y-_.y)+_.x&&(w=!w),_=_.next}while(_!==u);return w}(t,n)&&(Sn(t.prev,t,n.prev)||Sn(t,n.prev,n))||Ai(t,n)&&Sn(t.prev,t,t.next)>0&&Sn(n.prev,n,n.next)>0)}function Sn(t,n,u){return(n.y-t.y)*(u.x-n.x)-(n.x-t.x)*(u.y-n.y)}function Ai(t,n){return t.x===n.x&&t.y===n.y}function Ui(t,n,u,g){var _=Mc(Sn(t,n,u)),w=Mc(Sn(t,n,g)),S=Mc(Sn(u,g,t)),D=Mc(Sn(u,g,n));return _!==w&&S!==D||!(0!==_||!Ic(t,u,n))||!(0!==w||!Ic(t,g,n))||!(0!==S||!Ic(u,t,g))||!(0!==D||!Ic(u,n,g))}function Ic(t,n,u){return n.x<=Math.max(t.x,u.x)&&n.x>=Math.min(t.x,u.x)&&n.y<=Math.max(t.y,u.y)&&n.y>=Math.min(t.y,u.y)}function Mc(t){return t>0?1:t<0?-1:0}function fc(t,n){return Sn(t.prev,t,t.next)<0?Sn(t,n,t.next)>=0&&Sn(t,t.prev,n)>=0:Sn(t,n,t.prev)<0||Sn(t,t.next,n)<0}function Ih(t,n){var u=new Yc(t.i,t.x,t.y),g=new Yc(n.i,n.x,n.y),_=t.next,w=n.prev;return t.next=n,n.prev=t,u.next=_,_.prev=u,g.next=u,u.prev=g,w.next=g,g.prev=w,g}function Mh(t,n,u,g){var _=new Yc(t,n,u);return g?(_.next=g.next,_.prev=g,g.next.prev=_,g.next=_):(_.prev=_,_.next=_),_}function dc(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Yc(t,n,u){this.i=t,this.x=n,this.y=u,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Jc(t,n,u,g){for(var _=0,w=n,S=u-g;w<u;w+=g)_+=(t[S]-t[w])*(t[w+1]+t[S+1]),S=w;return _}function Hf(t,n,u,g,_){!function w(S,D,z,q,G){for(;q>z;){if(q-z>600){var J=q-z+1,ut=D-z+1,mt=Math.log(J),zt=.5*Math.exp(2*mt/3),Vt=.5*Math.sqrt(mt*zt*(J-zt)/J)*(ut-J/2<0?-1:1);w(S,D,Math.max(z,Math.floor(D-ut*zt/J+Vt)),Math.min(q,Math.floor(D+(J-ut)*zt/J+Vt)),G)}var fe=S[D],ne=z,Ee=q;for(Hc(S,z,D),G(S[q],fe)>0&&Hc(S,z,q);ne<Ee;){for(Hc(S,ne,Ee),ne++,Ee--;G(S[ne],fe)<0;)ne++;for(;G(S[Ee],fe)>0;)Ee--}0===G(S[z],fe)?Hc(S,z,Ee):Hc(S,++Ee,q),Ee<=D&&(z=Ee+1),D<=Ee&&(q=Ee-1)}}(t,n,u||0,g||t.length-1,_||Wf)}function Hc(t,n,u){var g=t[n];t[n]=t[u],t[u]=g}function Wf(t,n){return t<n?-1:t>n?1:0}function sp(t,n){var u=t.length;if(u<=1)return[t];for(var g,_,w=[],S=0;S<u;S++){var D=gt(t[S]);0!==D&&(t[S].area=Math.abs(D),void 0===_&&(_=D<0),_===D<0?(g&&w.push(g),g=[t[S]]):g.push(t[S]))}if(g&&w.push(g),n>1)for(var z=0;z<w.length;z++)w[z].length<=n||(Hf(w[z],n,1,w[z].length-1,Kf),w[z]=w[z].slice(0,n));return w}function Kf(t,n){return n.area-t.area}function up(t,n,u){for(var g=u.patternDependencies,_=!1,w=0,S=n;w<S.length;w+=1){var D=S[w].paint.get(t+"-pattern");D.isConstant()||(_=!0);var z=D.constantOr(null);z&&(_=!0,g[z.to]=!0,g[z.from]=!0)}return _}function lp(t,n,u,g,_){for(var w=_.patternDependencies,S=0,D=n;S<D.length;S+=1){var z=D[S],q=z.paint.get(t+"-pattern").value;if("constant"!==q.kind){var G=q.evaluate({zoom:g-1},u,{},_.availableImages),J=q.evaluate({zoom:g},u,{},_.availableImages),ut=q.evaluate({zoom:g+1},u,{},_.availableImages);J=J&&J.name?J.name:J,ut=ut&&ut.name?ut.name:ut,w[G=G&&G.name?G.name:G]=!0,w[J]=!0,w[ut]=!0,u.patterns[z.id]={min:G,mid:J,max:ut}}}return u}Ti.deviation=function(t,n,u,g){var _=n&&n.length,w=Math.abs(Jc(t,0,_?n[0]*u:t.length,u));if(_)for(var S=0,D=n.length;S<D;S++)w-=Math.abs(Jc(t,n[S]*u,S<D-1?n[S+1]*u:t.length,u));var z=0;for(S=0;S<g.length;S+=3){var q=g[S]*u,G=g[S+1]*u,J=g[S+2]*u;z+=Math.abs((t[q]-t[J])*(t[G+1]-t[q+1])-(t[q]-t[G])*(t[J+1]-t[q+1]))}return 0===w&&0===z?0:Math.abs((z-w)/w)},Ti.flatten=function(t){for(var n=t[0][0].length,u={vertices:[],holes:[],dimensions:n},g=0,_=0;_<t.length;_++){for(var w=0;w<t[_].length;w++)for(var S=0;S<n;S++)u.vertices.push(t[_][w][S]);_>0&&u.holes.push(g+=t[_-1].length)}return u},Di.default=Ji;var ml=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(n){return n.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new gs,this.indexArray=new Qt,this.indexArray2=new ln,this.programConfigurations=new qo(t.layers,t.zoom),this.segments=new _t,this.segments2=new _t,this.stateDependentLayerIds=this.layers.filter(function(n){return n.isStateDependent()}).map(function(n){return n.id})};ml.prototype.populate=function(t,n,u){this.hasPattern=up("fill",this.layers,n);for(var g=this.layers[0].layout.get("fill-sort-key"),_=!g.isConstant(),w=[],S=0,D=t;S<D.length;S+=1){var z=D[S],q=z.feature,G=z.id,J=z.index,ut=z.sourceLayerIndex,mt=this.layers[0]._featureFilter.needGeometry,zt=Os(q,mt);if(this.layers[0]._featureFilter.filter(new mo(this.zoom),zt,u)){var Vt=_?g.evaluate(zt,{},u,n.availableImages):void 0,fe={id:G,properties:q.properties,type:q.type,sourceLayerIndex:ut,index:J,geometry:mt?zt.geometry:Ya(q),patterns:{},sortKey:Vt};w.push(fe)}}_&&w.sort(function(Er,Hr){return Er.sortKey-Hr.sortKey});for(var ne=0,Ee=w;ne<Ee.length;ne+=1){var Ce=Ee[ne],Re=Ce.geometry,Be=Ce.index,rr=Ce.sourceLayerIndex;if(this.hasPattern){var wr=lp("fill",this.layers,Ce,this.zoom,n);this.patternFeatures.push(wr)}else this.addFeature(Ce,Re,Be,u,{});n.featureIndex.insert(t[Be].feature,Re,Be,rr,this.index)}},ml.prototype.update=function(t,n,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,u)},ml.prototype.addFeatures=function(t,n,u){for(var g=0,_=this.patternFeatures;g<_.length;g+=1){var w=_[g];this.addFeature(w,w.geometry,w.index,n,u)}},ml.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},ml.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ml.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Yi),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0},ml.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},ml.prototype.addFeature=function(t,n,u,g,_){for(var w=0,S=sp(n,500);w<S.length;w+=1){for(var D=S[w],z=0,q=0,G=D;q<G.length;q+=1)z+=G[q].length;for(var J=this.segments.prepareSegment(z,this.layoutVertexArray,this.indexArray),ut=J.vertexLength,mt=[],zt=[],Vt=0,fe=D;Vt<fe.length;Vt+=1){var ne=fe[Vt];if(0!==ne.length){ne!==D[0]&&zt.push(mt.length/2);var Ee=this.segments2.prepareSegment(ne.length,this.layoutVertexArray,this.indexArray2),Ce=Ee.vertexLength;this.layoutVertexArray.emplaceBack(ne[0].x,ne[0].y),this.indexArray2.emplaceBack(Ce+ne.length-1,Ce),mt.push(ne[0].x),mt.push(ne[0].y);for(var Re=1;Re<ne.length;Re++)this.layoutVertexArray.emplaceBack(ne[Re].x,ne[Re].y),this.indexArray2.emplaceBack(Ce+Re-1,Ce+Re),mt.push(ne[Re].x),mt.push(ne[Re].y);Ee.vertexLength+=ne.length,Ee.primitiveLength+=ne.length}}for(var Be=Di(mt,zt),rr=0;rr<Be.length;rr+=3)this.indexArray.emplaceBack(ut+Be[rr],ut+Be[rr+1],ut+Be[rr+2]);J.vertexLength+=z,J.primitiveLength+=Be.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,_,g)},xr("FillBucket",ml,{omit:["layers","patternFeatures"]});var $f=new Ma({"fill-sort-key":new mn(Dt.layout_fill["fill-sort-key"])}),Qf={paint:new Ma({"fill-antialias":new Tr(Dt.paint_fill["fill-antialias"]),"fill-opacity":new mn(Dt.paint_fill["fill-opacity"]),"fill-color":new mn(Dt.paint_fill["fill-color"]),"fill-outline-color":new mn(Dt.paint_fill["fill-outline-color"]),"fill-translate":new Tr(Dt.paint_fill["fill-translate"]),"fill-translate-anchor":new Tr(Dt.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ia(Dt.paint_fill["fill-pattern"])}),layout:$f},td=function(t){function n(u){t.call(this,u,Qf)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.recalculate=function(u,g){t.prototype.recalculate.call(this,u,g);var _=this.paint._values["fill-outline-color"];"constant"===_.value.kind&&void 0===_.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},n.prototype.createBucket=function(u){return new ml(u)},n.prototype.queryRadius=function(){return ol(this.paint.get("fill-translate"))},n.prototype.queryIntersectsFeature=function(u,g,_,w,S,D,z){return Gu(Hu(u,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),D.angle,z),w)},n.prototype.isTileClipped=function(){return!0},n}(dn),ed=bo([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,$p=Pc;function Pc(t,n,u,g,_){this.properties={},this.extent=u,this.type=0,this._pbf=t,this._geometry=-1,this._keys=g,this._values=_,t.readFields(rd,this,n)}function rd(t,n,u){1==t?n.id=u.readVarint():2==t?function(g,_){for(var w=g.readVarint()+g.pos;g.pos<w;){var S=_._keys[g.readVarint()],D=_._values[g.readVarint()];_.properties[S]=D}}(u,n):3==t?n.type=u.readVarint():4==t&&(n._geometry=u.pos)}function nd(t){for(var n,u,g=0,_=0,w=t.length,S=w-1;_<w;S=_++)g+=((u=t[S]).x-(n=t[_]).x)*(n.y+u.y);return g}Pc.types=["Unknown","Point","LineString","Polygon"],Pc.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var n,u=t.readVarint()+t.pos,g=1,_=0,w=0,S=0,D=[];t.pos<u;){if(_<=0){var z=t.readVarint();g=7&z,_=z>>3}if(_--,1===g||2===g)w+=t.readSVarint(),S+=t.readSVarint(),1===g&&(n&&D.push(n),n=[]),n.push(new Nt(w,S));else{if(7!==g)throw new Error("unknown command "+g);n&&n.push(n[0].clone())}}return n&&D.push(n),D},Pc.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var n=t.readVarint()+t.pos,u=1,g=0,_=0,w=0,S=1/0,D=-1/0,z=1/0,q=-1/0;t.pos<n;){if(g<=0){var G=t.readVarint();u=7&G,g=G>>3}if(g--,1===u||2===u)(_+=t.readSVarint())<S&&(S=_),_>D&&(D=_),(w+=t.readSVarint())<z&&(z=w),w>q&&(q=w);else if(7!==u)throw new Error("unknown command "+u)}return[S,z,D,q]},Pc.prototype.toGeoJSON=function(t,n,u){var g,_,w=this.extent*Math.pow(2,u),S=this.extent*t,D=this.extent*n,z=this.loadGeometry(),q=Pc.types[this.type];function G(mt){for(var zt=0;zt<mt.length;zt++){var Vt=mt[zt];mt[zt]=[360*(Vt.x+S)/w-180,360/Math.PI*Math.atan(Math.exp((180-360*(Vt.y+D)/w)*Math.PI/180))-90]}}switch(this.type){case 1:var J=[];for(g=0;g<z.length;g++)J[g]=z[g][0];G(z=J);break;case 2:for(g=0;g<z.length;g++)G(z[g]);break;case 3:for(z=function(mt){var zt=mt.length;if(zt<=1)return[mt];for(var Vt,fe,ne=[],Ee=0;Ee<zt;Ee++){var Ce=nd(mt[Ee]);0!==Ce&&(void 0===fe&&(fe=Ce<0),fe===Ce<0?(Vt&&ne.push(Vt),Vt=[mt[Ee]]):Vt.push(mt[Ee]))}return Vt&&ne.push(Vt),ne}(z),g=0;g<z.length;g++)for(_=0;_<z[g].length;_++)G(z[g][_])}1===z.length?z=z[0]:q="Multi"+q;var ut={type:"Feature",geometry:{type:q,coordinates:z},properties:this.properties};return"id"in this&&(ut.id=this.id),ut};var Qp=tf;function tf(t,n){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(id,this,n),this.length=this._features.length}function id(t,n,u){15===t?n.version=u.readVarint():1===t?n.name=u.readString():5===t?n.extent=u.readVarint():2===t?n._features.push(u.pos):3===t?n._keys.push(u.readString()):4===t&&n._values.push(function(g){for(var _=null,w=g.readVarint()+g.pos;g.pos<w;){var S=g.readVarint()>>3;_=1===S?g.readString():2===S?g.readFloat():3===S?g.readDouble():4===S?g.readVarint64():5===S?g.readVarint():6===S?g.readSVarint():7===S?g.readBoolean():null}return _}(u))}function od(t,n,u){if(3===t){var g=new Qp(u,u.readVarint()+u.pos);g.length&&(n[g.name]=g)}}tf.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var n=this._pbf.readVarint()+this._pbf.pos;return new $p(this._pbf,n,this.extent,this._keys,this._values)};var Tc={VectorTile:function(t,n){this.layers=t.readFields(od,{},n)},VectorTileFeature:$p,VectorTileLayer:Qp},ad=Tc.VectorTileFeature.types,cp=Math.pow(2,13);function Wc(t,n,u,g,_,w,S,D){t.emplaceBack(n,u,2*Math.floor(g*cp)+S,_*cp*2,w*cp*2,Math.round(D))}var yl=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(n){return n.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new iu,this.indexArray=new Qt,this.programConfigurations=new qo(t.layers,t.zoom),this.segments=new _t,this.stateDependentLayerIds=this.layers.filter(function(n){return n.isStateDependent()}).map(function(n){return n.id})};function sd(t,n){return t.x===n.x&&(t.x<0||t.x>8192)||t.y===n.y&&(t.y<0||t.y>8192)}yl.prototype.populate=function(t,n,u){this.features=[],this.hasPattern=up("fill-extrusion",this.layers,n);for(var g=0,_=t;g<_.length;g+=1){var w=_[g],S=w.feature,D=w.id,z=w.index,q=w.sourceLayerIndex,G=this.layers[0]._featureFilter.needGeometry,J=Os(S,G);if(this.layers[0]._featureFilter.filter(new mo(this.zoom),J,u)){var ut={id:D,sourceLayerIndex:q,index:z,geometry:G?J.geometry:Ya(S),properties:S.properties,type:S.type,patterns:{}};this.hasPattern?this.features.push(lp("fill-extrusion",this.layers,ut,this.zoom,n)):this.addFeature(ut,ut.geometry,z,u,{}),n.featureIndex.insert(S,ut.geometry,z,q,this.index,!0)}}},yl.prototype.addFeatures=function(t,n,u){for(var g=0,_=this.features;g<_.length;g+=1){var w=_[g];this.addFeature(w,w.geometry,w.index,n,u)}},yl.prototype.update=function(t,n,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,u)},yl.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},yl.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},yl.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ed),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},yl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},yl.prototype.addFeature=function(t,n,u,g,_){for(var w=0,S=sp(n,500);w<S.length;w+=1){for(var D=S[w],z=0,q=0,G=D;q<G.length;q+=1)z+=G[q].length;for(var J=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),ut=0,mt=D;ut<mt.length;ut+=1){var zt=mt[ut];if(0!==zt.length&&!((fi=zt).every(function(Yn){return Yn.x<0})||fi.every(function(Yn){return Yn.x>8192})||fi.every(function(Yn){return Yn.y<0})||fi.every(function(Yn){return Yn.y>8192})))for(var Vt=0,fe=0;fe<zt.length;fe++){var ne=zt[fe];if(fe>=1){var Ee=zt[fe-1];if(!sd(ne,Ee)){J.vertexLength+4>_t.MAX_VERTEX_ARRAY_LENGTH&&(J=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var Ce=ne.sub(Ee)._perp()._unit(),Re=Ee.dist(ne);Vt+Re>32768&&(Vt=0),Wc(this.layoutVertexArray,ne.x,ne.y,Ce.x,Ce.y,0,0,Vt),Wc(this.layoutVertexArray,ne.x,ne.y,Ce.x,Ce.y,0,1,Vt),Wc(this.layoutVertexArray,Ee.x,Ee.y,Ce.x,Ce.y,0,0,Vt+=Re),Wc(this.layoutVertexArray,Ee.x,Ee.y,Ce.x,Ce.y,0,1,Vt);var Be=J.vertexLength;this.indexArray.emplaceBack(Be,Be+2,Be+1),this.indexArray.emplaceBack(Be+1,Be+2,Be+3),J.vertexLength+=4,J.primitiveLength+=2}}}}if(J.vertexLength+z>_t.MAX_VERTEX_ARRAY_LENGTH&&(J=this.segments.prepareSegment(z,this.layoutVertexArray,this.indexArray)),"Polygon"===ad[t.type]){for(var rr=[],wr=[],Er=J.vertexLength,Hr=0,Ar=D;Hr<Ar.length;Hr+=1){var nn=Ar[Hr];if(0!==nn.length){nn!==D[0]&&wr.push(rr.length/2);for(var Fr=0;Fr<nn.length;Fr++){var ii=nn[Fr];Wc(this.layoutVertexArray,ii.x,ii.y,0,0,1,1,0),rr.push(ii.x),rr.push(ii.y)}}}for(var Cn=Di(rr,wr),Yr=0;Yr<Cn.length;Yr+=3)this.indexArray.emplaceBack(Er+Cn[Yr],Er+Cn[Yr+2],Er+Cn[Yr+1]);J.primitiveLength+=Cn.length/3,J.vertexLength+=z}}var fi;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,_,g)},xr("FillExtrusionBucket",yl,{omit:["layers","features"]});var ud={paint:new Ma({"fill-extrusion-opacity":new Tr(Dt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new mn(Dt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Tr(Dt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Tr(Dt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ia(Dt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new mn(Dt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new mn(Dt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Tr(Dt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},ld=function(t){function n(u){t.call(this,u,ud)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.createBucket=function(u){return new yl(u)},n.prototype.queryRadius=function(){return ol(this.paint.get("fill-extrusion-translate"))},n.prototype.is3D=function(){return!0},n.prototype.queryIntersectsFeature=function(u,g,_,w,S,D,z,q){var G=Hu(u,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),D.angle,z),J=this.paint.get("fill-extrusion-height").evaluate(g,_),ut=this.paint.get("fill-extrusion-base").evaluate(g,_),mt=function(Vt,fe,ne,Ee){for(var Ce=[],Re=0,Be=Vt;Re<Be.length;Re+=1){var rr=Be[Re],wr=[rr.x,rr.y,0,1];hc(wr,wr,fe),Ce.push(new Nt(wr[0]/wr[3],wr[1]/wr[3]))}return Ce}(G,q),zt=function(Vt,fe,ne,Ee){for(var Ce=[],Re=[],Be=Ee[8]*fe,rr=Ee[9]*fe,wr=Ee[10]*fe,Er=Ee[11]*fe,Hr=Ee[8]*ne,Ar=Ee[9]*ne,nn=Ee[10]*ne,Fr=Ee[11]*ne,ii=0,Cn=Vt;ii<Cn.length;ii+=1){for(var Yr=[],fi=[],Yn=0,ki=Cn[ii];Yn<ki.length;Yn+=1){var sn=ki[Yn],uo=sn.x,la=sn.y,ya=Ee[0]*uo+Ee[4]*la+Ee[12],va=Ee[1]*uo+Ee[5]*la+Ee[13],ca=Ee[2]*uo+Ee[6]*la+Ee[14],ka=Ee[3]*uo+Ee[7]*la+Ee[15],os=ca+wr,as=ka+Er,Vs=ya+Hr,Is=va+Ar,ou=ca+nn,_a=ka+Fr,Ns=new Nt((ya+Be)/as,(va+rr)/as);Ns.z=os/as,Yr.push(Ns);var _i=new Nt(Vs/_a,Is/_a);_i.z=ou/_a,fi.push(_i)}Ce.push(Yr),Re.push(fi)}return[Ce,Re]}(w,ut,J,q);return function(Vt,fe,ne){var Ee=1/0;Gu(ne,fe)&&(Ee=ef(ne,fe[0]));for(var Ce=0;Ce<fe.length;Ce++)for(var Re=fe[Ce],Be=Vt[Ce],rr=0;rr<Re.length-1;rr++){var wr=Re[rr],Er=[wr,Re[rr+1],Be[rr+1],Be[rr],wr];ks(ne,Er)&&(Ee=Math.min(Ee,ef(ne,Er)))}return Ee!==1/0&&Ee}(zt[0],zt[1],mt)},n}(dn);function Kc(t,n){return t.x*n.x+t.y*n.y}function ef(t,n){if(1===t.length){for(var u,g=0,_=n[g++];!u||_.equals(u);)if(!(u=n[g++]))return 1/0;for(;g<n.length;g++){var w=n[g],S=t[0],D=u.sub(_),z=w.sub(_),q=S.sub(_),G=Kc(D,D),J=Kc(D,z),ut=Kc(z,z),mt=Kc(q,D),zt=Kc(q,z),Vt=G*ut-J*J,fe=(ut*mt-J*zt)/Vt,ne=(G*zt-J*mt)/Vt,Ee=_.z*(1-fe-ne)+u.z*fe+w.z*ne;if(isFinite(Ee))return Ee}return 1/0}for(var Ce=1/0,Re=0,Be=n;Re<Be.length;Re+=1)Ce=Math.min(Ce,Be[Re].z);return Ce}var cd=bo([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,hd=bo([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,tn=Tc.VectorTileFeature.types,Wr=Math.cos(Math.PI/180*37.5),In=Math.pow(2,14)/.5,Zr=function(t){var n=this;this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(u){return u.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(u){n.gradients[u.id]={}}),this.layoutVertexArray=new nl,this.layoutVertexArray2=new e,this.indexArray=new Qt,this.programConfigurations=new qo(t.layers,t.zoom),this.segments=new _t,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(u){return u.isStateDependent()}).map(function(u){return u.id})};Zr.prototype.populate=function(t,n,u){this.hasPattern=up("line",this.layers,n);for(var g=this.layers[0].layout.get("line-sort-key"),_=!g.isConstant(),w=[],S=0,D=t;S<D.length;S+=1){var z=D[S],q=z.feature,G=z.id,J=z.index,ut=z.sourceLayerIndex,mt=this.layers[0]._featureFilter.needGeometry,zt=Os(q,mt);if(this.layers[0]._featureFilter.filter(new mo(this.zoom),zt,u)){var Vt=_?g.evaluate(zt,{},u):void 0,fe={id:G,properties:q.properties,type:q.type,sourceLayerIndex:ut,index:J,geometry:mt?zt.geometry:Ya(q),patterns:{},sortKey:Vt};w.push(fe)}}_&&w.sort(function(Er,Hr){return Er.sortKey-Hr.sortKey});for(var ne=0,Ee=w;ne<Ee.length;ne+=1){var Ce=Ee[ne],Re=Ce.geometry,Be=Ce.index,rr=Ce.sourceLayerIndex;if(this.hasPattern){var wr=lp("line",this.layers,Ce,this.zoom,n);this.patternFeatures.push(wr)}else this.addFeature(Ce,Re,Be,u,{});n.featureIndex.insert(t[Be].feature,Re,Be,rr,this.index)}},Zr.prototype.update=function(t,n,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,u)},Zr.prototype.addFeatures=function(t,n,u){for(var g=0,_=this.patternFeatures;g<_.length;g+=1){var w=_[g];this.addFeature(w,w.geometry,w.index,n,u)}},Zr.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Zr.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Zr.prototype.upload=function(t){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,hd)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,cd),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},Zr.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Zr.prototype.lineFeatureClips=function(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}},Zr.prototype.addFeature=function(t,n,u,g,_){var w=this.layers[0].layout,S=w.get("line-join").evaluate(t,{}),D=w.get("line-cap"),z=w.get("line-miter-limit"),q=w.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(var G=0,J=n;G<J.length;G+=1)this.addLine(J[G],t,S,D,z,q);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,_,g)},Zr.prototype.addLine=function(t,n,u,g,_,w){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var S=0;S<t.length-1;S++)this.totalDistance+=t[S].dist(t[S+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var D="Polygon"===tn[n.type],z=t.length;z>=2&&t[z-1].equals(t[z-2]);)z--;for(var q=0;q<z-1&&t[q].equals(t[q+1]);)q++;if(!(z<(D?3:2))){"bevel"===u&&(_=1.05);var G,J=this.overscaling<=16?122880/(512*this.overscaling):0,ut=this.segments.prepareSegment(10*z,this.layoutVertexArray,this.indexArray),mt=void 0,zt=void 0,Vt=void 0,fe=void 0;this.e1=this.e2=-1,D&&(fe=t[q].sub(G=t[z-2])._unit()._perp());for(var ne=q;ne<z;ne++)if(!(zt=ne===z-1?D?t[q+1]:void 0:t[ne+1])||!t[ne].equals(zt)){fe&&(Vt=fe),G&&(mt=G),G=t[ne],fe=zt?zt.sub(G)._unit()._perp():Vt;var Ee=(Vt=Vt||fe).add(fe);0===Ee.x&&0===Ee.y||Ee._unit();var Ce=Vt.x*fe.x+Vt.y*fe.y,Re=Ee.x*fe.x+Ee.y*fe.y,Be=0!==Re?1/Re:1/0,rr=2*Math.sqrt(2-2*Re),wr=Re<Wr&&mt&&zt,Er=Vt.x*fe.y-Vt.y*fe.x>0;if(wr&&ne>q){var Hr=G.dist(mt);if(Hr>2*J){var Ar=G.sub(G.sub(mt)._mult(J/Hr)._round());this.updateDistance(mt,Ar),this.addCurrentVertex(Ar,Vt,0,0,ut),mt=Ar}}var nn=mt&&zt,Fr=nn?u:D?"butt":g;if(nn&&"round"===Fr&&(Be<w?Fr="miter":Be<=2&&(Fr="fakeround")),"miter"===Fr&&Be>_&&(Fr="bevel"),"bevel"===Fr&&(Be>2&&(Fr="flipbevel"),Be<_&&(Fr="miter")),mt&&this.updateDistance(mt,G),"miter"===Fr)Ee._mult(Be),this.addCurrentVertex(G,Ee,0,0,ut);else if("flipbevel"===Fr){if(Be>100)Ee=fe.mult(-1);else{var ii=Be*Vt.add(fe).mag()/Vt.sub(fe).mag();Ee._perp()._mult(ii*(Er?-1:1))}this.addCurrentVertex(G,Ee,0,0,ut),this.addCurrentVertex(G,Ee.mult(-1),0,0,ut)}else if("bevel"===Fr||"fakeround"===Fr){var Cn=-Math.sqrt(Be*Be-1),Yr=Er?Cn:0,fi=Er?0:Cn;if(mt&&this.addCurrentVertex(G,Vt,Yr,fi,ut),"fakeround"===Fr)for(var Yn=Math.round(180*rr/Math.PI/20),ki=1;ki<Yn;ki++){var sn=ki/Yn;if(.5!==sn){var uo=sn-.5;sn+=sn*uo*(sn-1)*((1.0904+Ce*(Ce*(3.55645-1.43519*Ce)-3.2452))*uo*uo+(.848013+Ce*(.215638*Ce-1.06021)))}var la=fe.sub(Vt)._mult(sn)._add(Vt)._unit()._mult(Er?-1:1);this.addHalfVertex(G,la.x,la.y,!1,Er,0,ut)}zt&&this.addCurrentVertex(G,fe,-Yr,-fi,ut)}else if("butt"===Fr)this.addCurrentVertex(G,Ee,0,0,ut);else if("square"===Fr){var ya=mt?1:-1;this.addCurrentVertex(G,Ee,ya,ya,ut)}else"round"===Fr&&(mt&&(this.addCurrentVertex(G,Vt,0,0,ut),this.addCurrentVertex(G,Vt,1,1,ut,!0)),zt&&(this.addCurrentVertex(G,fe,-1,-1,ut,!0),this.addCurrentVertex(G,fe,0,0,ut)));if(wr&&ne<z-1){var va=G.dist(zt);if(va>2*J){var ca=G.add(zt.sub(G)._mult(J/va)._round());this.updateDistance(G,ca),this.addCurrentVertex(ca,fe,0,0,ut),G=ca}}}}},Zr.prototype.addCurrentVertex=function(t,n,u,g,_,w){void 0===w&&(w=!1);var S=n.y*g-n.x,D=-n.y-n.x*g;this.addHalfVertex(t,n.x+n.y*u,n.y-n.x*u,w,!1,u,_),this.addHalfVertex(t,S,D,w,!0,-g,_),this.distance>In/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(t,n,u,g,_,w))},Zr.prototype.addHalfVertex=function(t,n,u,g,_,w,S){var D=.5*(this.lineClips?this.scaledDistance*(In-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t.x<<1)+(g?1:0),(t.y<<1)+(_?1:0),Math.round(63*n)+128,Math.round(63*u)+128,1+(0===w?0:w<0?-1:1)|(63&D)<<2,D>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var z=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,z),S.primitiveLength++),_?this.e2=z:this.e1=z},Zr.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Zr.prototype.updateDistance=function(t,n){this.distance+=t.dist(n),this.updateScaledDistance()},xr("LineBucket",Zr,{omit:["layers","patternFeatures"]});var Xn=new Ma({"line-cap":new Tr(Dt.layout_line["line-cap"]),"line-join":new mn(Dt.layout_line["line-join"]),"line-miter-limit":new Tr(Dt.layout_line["line-miter-limit"]),"line-round-limit":new Tr(Dt.layout_line["line-round-limit"]),"line-sort-key":new mn(Dt.layout_line["line-sort-key"])}),zn={paint:new Ma({"line-opacity":new mn(Dt.paint_line["line-opacity"]),"line-color":new mn(Dt.paint_line["line-color"]),"line-translate":new Tr(Dt.paint_line["line-translate"]),"line-translate-anchor":new Tr(Dt.paint_line["line-translate-anchor"]),"line-width":new mn(Dt.paint_line["line-width"]),"line-gap-width":new mn(Dt.paint_line["line-gap-width"]),"line-offset":new mn(Dt.paint_line["line-offset"]),"line-blur":new mn(Dt.paint_line["line-blur"]),"line-dasharray":new Ss(Dt.paint_line["line-dasharray"]),"line-pattern":new Ia(Dt.paint_line["line-pattern"]),"line-gradient":new nu(Dt.paint_line["line-gradient"])}),layout:Xn},qi=new(function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.possiblyEvaluate=function(u,g){return g=new mo(Math.floor(g.zoom),{now:g.now,fadeDuration:g.fadeDuration,zoomHistory:g.zoomHistory,transition:g.transition}),t.prototype.possiblyEvaluate.call(this,u,g)},n.prototype.evaluate=function(u,g,_,w){return g=Z({},g,{zoom:Math.floor(g.zoom)}),t.prototype.evaluate.call(this,u,g,_,w)},n}(mn))(zn.paint.properties["line-width"].specification);qi.useIntegerZoom=!0;var so=function(t){function n(u){t.call(this,u,zn),this.gradientVersion=0}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._handleSpecialPaintPropertyUpdate=function(u){"line-gradient"===u&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Lo,this.gradientVersion=(this.gradientVersion+1)%_e)},n.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},n.prototype.recalculate=function(u,g){t.prototype.recalculate.call(this,u,g),this.paint._values["line-floorwidth"]=qi.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,u)},n.prototype.createBucket=function(u){return new Zr(u)},n.prototype.queryRadius=function(u){var g=u,_=qr(ys("line-width",this,g),ys("line-gap-width",this,g)),w=ys("line-offset",this,g);return _/2+Math.abs(w)+ol(this.paint.get("line-translate"))},n.prototype.queryIntersectsFeature=function(u,g,_,w,S,D,z){var q=Hu(u,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),D.angle,z),G=z/2*qr(this.paint.get("line-width").evaluate(g,_),this.paint.get("line-gap-width").evaluate(g,_)),J=this.paint.get("line-offset").evaluate(g,_);return J&&(w=function(ut,mt){for(var zt=[],Vt=new Nt(0,0),fe=0;fe<ut.length;fe++){for(var ne=ut[fe],Ee=[],Ce=0;Ce<ne.length;Ce++){var Re=ne[Ce],Be=ne[Ce+1],rr=0===Ce?Vt:Re.sub(ne[Ce-1])._unit()._perp(),wr=Ce===ne.length-1?Vt:Be.sub(Re)._unit()._perp(),Er=rr._add(wr)._unit();Er._mult(1/(Er.x*wr.x+Er.y*wr.y)),Ee.push(Er._mult(mt)._add(Re))}zt.push(Ee)}return zt}(w,J*z)),function(ut,mt,zt){for(var Vt=0;Vt<mt.length;Vt++){var fe=mt[Vt];if(ut.length>=3)for(var ne=0;ne<fe.length;ne++)if(il(ut,fe[ne]))return!0;if(Ec(ut,fe,zt))return!0}return!1}(q,w,G)},n.prototype.isTileClipped=function(){return!0},n}(dn);function qr(t,n){return n>0?n+2*t:t}var ft=bo([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),hp=bo([{name:"a_projected_pos",components:3,type:"Float32"}],4),pd=(bo([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),bo([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),rf=(bo([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),bo([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),fd=bo([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function dd(t,n,u){return t.sections.forEach(function(g){var _,S,D;g.text=(_=g.text,S=u,"uppercase"===(D=n.layout.get("text-transform").evaluate(S,{}))?_=_.toLocaleUpperCase():"lowercase"===D&&(_=_.toLocaleLowerCase()),ai.applyArabicShaping&&(_=ai.applyArabicShaping(_)),_)}),t}bo([{name:"triangle",components:3,type:"Uint16"}]),bo([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),bo([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),bo([{type:"Float32",name:"offsetX"}]),bo([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var $c={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"},nf=function(t,n,u,g,_){var w,S,D=8*_-g-1,z=(1<<D)-1,q=z>>1,G=-7,J=u?_-1:0,ut=u?-1:1,mt=t[n+J];for(J+=ut,w=mt&(1<<-G)-1,mt>>=-G,G+=D;G>0;w=256*w+t[n+J],J+=ut,G-=8);for(S=w&(1<<-G)-1,w>>=-G,G+=g;G>0;S=256*S+t[n+J],J+=ut,G-=8);if(0===w)w=1-q;else{if(w===z)return S?NaN:1/0*(mt?-1:1);S+=Math.pow(2,g),w-=q}return(mt?-1:1)*S*Math.pow(2,w-g)},of=function(t,n,u,g,_,w){var S,D,z,q=8*w-_-1,G=(1<<q)-1,J=G>>1,ut=23===_?Math.pow(2,-24)-Math.pow(2,-77):0,mt=g?0:w-1,zt=g?1:-1,Vt=n<0||0===n&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(D=isNaN(n)?1:0,S=G):(S=Math.floor(Math.log(n)/Math.LN2),n*(z=Math.pow(2,-S))<1&&(S--,z*=2),(n+=S+J>=1?ut/z:ut*Math.pow(2,1-J))*z>=2&&(S++,z/=2),S+J>=G?(D=0,S=G):S+J>=1?(D=(n*z-1)*Math.pow(2,_),S+=J):(D=n*Math.pow(2,J-1)*Math.pow(2,_),S=0));_>=8;t[u+mt]=255&D,mt+=zt,D/=256,_-=8);for(S=S<<_|D,q+=_;q>0;t[u+mt]=255&S,mt+=zt,S/=256,q-=8);t[u+mt-zt]|=128*Vt},pp=Yo;function Yo(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Yo.Varint=0,Yo.Fixed64=1,Yo.Bytes=2,Yo.Fixed32=5;var af=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function zl(t){return t.type===Yo.Bytes?t.readVarint()+t.pos:t.pos+1}function sf(t,n,u){var g=n<=16383?1:n<=2097151?2:n<=268435455?3:Math.floor(Math.log(n)/(7*Math.LN2));u.realloc(g);for(var _=u.pos-1;_>=t;_--)u.buf[_+g]=u.buf[_]}function gd(t,n){for(var u=0;u<t.length;u++)n.writeVarint(t[u])}function lg(t,n){for(var u=0;u<t.length;u++)n.writeSVarint(t[u])}function cg(t,n){for(var u=0;u<t.length;u++)n.writeFloat(t[u])}function hg(t,n){for(var u=0;u<t.length;u++)n.writeDouble(t[u])}function pg(t,n){for(var u=0;u<t.length;u++)n.writeBoolean(t[u])}function uf(t,n){for(var u=0;u<t.length;u++)n.writeFixed32(t[u])}function md(t,n){for(var u=0;u<t.length;u++)n.writeSFixed32(t[u])}function fg(t,n){for(var u=0;u<t.length;u++)n.writeFixed64(t[u])}function dg(t,n){for(var u=0;u<t.length;u++)n.writeSFixed64(t[u])}function fp(t,n){return(t[n]|t[n+1]<<8|t[n+2]<<16)+16777216*t[n+3]}function Bl(t,n,u){t[u]=n,t[u+1]=n>>>8,t[u+2]=n>>>16,t[u+3]=n>>>24}function Ph(t,n){return(t[n]|t[n+1]<<8|t[n+2]<<16)+(t[n+3]<<24)}function yd(t,n,u){1===t&&u.readMessage(vd,n)}function vd(t,n,u){if(3===t){var g=u.readMessage(_d,{}),_=g.width,w=g.height,S=g.left,D=g.top,z=g.advance;n.push({id:g.id,bitmap:new ns({width:_+6,height:w+6},g.bitmap),metrics:{width:_,height:w,left:S,top:D,advance:z}})}}function _d(t,n,u){1===t?n.id=u.readVarint():2===t?n.bitmap=u.readBytes():3===t?n.width=u.readVarint():4===t?n.height=u.readVarint():5===t?n.left=u.readSVarint():6===t?n.top=u.readSVarint():7===t&&(n.advance=u.readVarint())}function lf(t){for(var n=0,u=0,g=0,_=t;g<_.length;g+=1){var w=_[g];n+=w.w*w.h,u=Math.max(u,w.w)}t.sort(function(Vt,fe){return fe.h-Vt.h});for(var S=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),u),h:1/0}],D=0,z=0,q=0,G=t;q<G.length;q+=1)for(var J=G[q],ut=S.length-1;ut>=0;ut--){var mt=S[ut];if(!(J.w>mt.w||J.h>mt.h)){if(J.x=mt.x,J.y=mt.y,z=Math.max(z,J.y+J.h),D=Math.max(D,J.x+J.w),J.w===mt.w&&J.h===mt.h){var zt=S.pop();ut<S.length&&(S[ut]=zt)}else J.h===mt.h?(mt.x+=J.w,mt.w-=J.w):J.w===mt.w?(mt.y+=J.h,mt.h-=J.h):(S.push({x:mt.x+J.w,y:mt.y,w:mt.w-J.w,h:J.h}),mt.y+=J.h,mt.h-=J.h);break}}return{w:D,h:z,fill:n/(D*z)||0}}Yo.prototype={destroy:function(){this.buf=null},readFields:function(t,n,u){for(u=u||this.length;this.pos<u;){var g=this.readVarint(),_=g>>3,w=this.pos;this.type=7&g,t(_,n,this),this.pos===w&&this.skip(g)}return n},readMessage:function(t,n){return this.readFields(t,n,this.readVarint()+this.pos)},readFixed32:function(){var t=fp(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=Ph(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=fp(this.buf,this.pos)+4294967296*fp(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=fp(this.buf,this.pos)+4294967296*Ph(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=nf(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=nf(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var n,u,g=this.buf;return n=127&(u=g[this.pos++]),u<128?n:(n|=(127&(u=g[this.pos++]))<<7,u<128?n:(n|=(127&(u=g[this.pos++]))<<14,u<128?n:(n|=(127&(u=g[this.pos++]))<<21,u<128?n:function(_,w,S){var D,z,q=S.buf;if(D=(112&(z=q[S.pos++]))>>4,z<128||(D|=(127&(z=q[S.pos++]))<<3,z<128)||(D|=(127&(z=q[S.pos++]))<<10,z<128)||(D|=(127&(z=q[S.pos++]))<<17,z<128)||(D|=(127&(z=q[S.pos++]))<<24,z<128)||(D|=(1&(z=q[S.pos++]))<<31,z<128))return function Ac(t,n,u){return u?4294967296*n+(t>>>0):4294967296*(n>>>0)+(t>>>0)}(_,D,w);throw new Error("Expected varint not more than 10 bytes")}(n|=(15&(u=g[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,n=this.pos;return this.pos=t,t-n>=12&&af?af.decode(this.buf.subarray(n,t)):function(u,g,_){for(var w="",S=g;S<_;){var D,z,q,G=u[S],J=null,ut=G>239?4:G>223?3:G>191?2:1;if(S+ut>_)break;1===ut?G<128&&(J=G):2===ut?128==(192&(D=u[S+1]))&&(J=(31&G)<<6|63&D)<=127&&(J=null):3===ut?(z=u[S+2],128==(192&(D=u[S+1]))&&128==(192&z)&&((J=(15&G)<<12|(63&D)<<6|63&z)<=2047||J>=55296&&J<=57343)&&(J=null)):4===ut&&(z=u[S+2],q=u[S+3],128==(192&(D=u[S+1]))&&128==(192&z)&&128==(192&q)&&((J=(15&G)<<18|(63&D)<<12|(63&z)<<6|63&q)<=65535||J>=1114112)&&(J=null)),null===J?(J=65533,ut=1):J>65535&&(J-=65536,w+=String.fromCharCode(J>>>10&1023|55296),J=56320|1023&J),w+=String.fromCharCode(J),S+=ut}return w}(this.buf,n,t)},readBytes:function(){var t=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,t);return this.pos=t,n},readPackedVarint:function(t,n){if(this.type!==Yo.Bytes)return t.push(this.readVarint(n));var u=zl(this);for(t=t||[];this.pos<u;)t.push(this.readVarint(n));return t},readPackedSVarint:function(t){if(this.type!==Yo.Bytes)return t.push(this.readSVarint());var n=zl(this);for(t=t||[];this.pos<n;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Yo.Bytes)return t.push(this.readBoolean());var n=zl(this);for(t=t||[];this.pos<n;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Yo.Bytes)return t.push(this.readFloat());var n=zl(this);for(t=t||[];this.pos<n;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Yo.Bytes)return t.push(this.readDouble());var n=zl(this);for(t=t||[];this.pos<n;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Yo.Bytes)return t.push(this.readFixed32());var n=zl(this);for(t=t||[];this.pos<n;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Yo.Bytes)return t.push(this.readSFixed32());var n=zl(this);for(t=t||[];this.pos<n;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Yo.Bytes)return t.push(this.readFixed64());var n=zl(this);for(t=t||[];this.pos<n;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Yo.Bytes)return t.push(this.readSFixed64());var n=zl(this);for(t=t||[];this.pos<n;)t.push(this.readSFixed64());return t},skip:function(t){var n=7&t;if(n===Yo.Varint)for(;this.buf[this.pos++]>127;);else if(n===Yo.Bytes)this.pos=this.readVarint()+this.pos;else if(n===Yo.Fixed32)this.pos+=4;else{if(n!==Yo.Fixed64)throw new Error("Unimplemented type: "+n);this.pos+=8}},writeTag:function(t,n){this.writeVarint(t<<3|n)},realloc:function(t){for(var n=this.length||16;n<this.pos+t;)n*=2;if(n!==this.length){var u=new Uint8Array(n);u.set(this.buf),this.buf=u,this.length=n}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Bl(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Bl(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Bl(this.buf,-1&t,this.pos),Bl(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Bl(this.buf,-1&t,this.pos),Bl(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(n,u){var g,_,w,D;if(n>=0?(g=n%4294967296|0,_=n/4294967296|0):(_=~(-n/4294967296),4294967295^(g=~(-n%4294967296))?g=g+1|0:(g=0,_=_+1|0)),n>=0x10000000000000000||n<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");u.realloc(10),w=g,(D=u).buf[D.pos++]=127&w|128,w>>>=7,D.buf[D.pos++]=127&w|128,w>>>=7,D.buf[D.pos++]=127&w|128,w>>>=7,D.buf[D.pos++]=127&w|128,D.buf[D.pos]=127&(w>>>=7),function(w,S){var D=(7&w)<<4;S.buf[S.pos++]|=D|((w>>>=3)?128:0),w&&(S.buf[S.pos++]=127&w|((w>>>=7)?128:0),w&&(S.buf[S.pos++]=127&w|((w>>>=7)?128:0),w&&(S.buf[S.pos++]=127&w|((w>>>=7)?128:0),w&&(S.buf[S.pos++]=127&w|((w>>>=7)?128:0),w&&(S.buf[S.pos++]=127&w)))))}(_,u)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var n=this.pos;this.pos=function(g,_,w){for(var S,D,z=0;z<_.length;z++){if((S=_.charCodeAt(z))>55295&&S<57344){if(!D){S>56319||z+1===_.length?(g[w++]=239,g[w++]=191,g[w++]=189):D=S;continue}if(S<56320){g[w++]=239,g[w++]=191,g[w++]=189,D=S;continue}S=D-55296<<10|S-56320|65536,D=null}else D&&(g[w++]=239,g[w++]=191,g[w++]=189,D=null);S<128?g[w++]=S:(S<2048?g[w++]=S>>6|192:(S<65536?g[w++]=S>>12|224:(g[w++]=S>>18|240,g[w++]=S>>12&63|128),g[w++]=S>>6&63|128),g[w++]=63&S|128)}return w}(this.buf,t,this.pos);var u=this.pos-n;u>=128&&sf(n,u,this),this.pos=n-1,this.writeVarint(u),this.pos+=u},writeFloat:function(t){this.realloc(4),of(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),of(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var n=t.length;this.writeVarint(n),this.realloc(n);for(var u=0;u<n;u++)this.buf[this.pos++]=t[u]},writeRawMessage:function(t,n){this.pos++;var u=this.pos;t(n,this);var g=this.pos-u;g>=128&&sf(u,g,this),this.pos=u-1,this.writeVarint(g),this.pos+=g},writeMessage:function(t,n,u){this.writeTag(t,Yo.Bytes),this.writeRawMessage(n,u)},writePackedVarint:function(t,n){n.length&&this.writeMessage(t,gd,n)},writePackedSVarint:function(t,n){n.length&&this.writeMessage(t,lg,n)},writePackedBoolean:function(t,n){n.length&&this.writeMessage(t,pg,n)},writePackedFloat:function(t,n){n.length&&this.writeMessage(t,cg,n)},writePackedDouble:function(t,n){n.length&&this.writeMessage(t,hg,n)},writePackedFixed32:function(t,n){n.length&&this.writeMessage(t,uf,n)},writePackedSFixed32:function(t,n){n.length&&this.writeMessage(t,md,n)},writePackedFixed64:function(t,n){n.length&&this.writeMessage(t,fg,n)},writePackedSFixed64:function(t,n){n.length&&this.writeMessage(t,dg,n)},writeBytesField:function(t,n){this.writeTag(t,Yo.Bytes),this.writeBytes(n)},writeFixed32Field:function(t,n){this.writeTag(t,Yo.Fixed32),this.writeFixed32(n)},writeSFixed32Field:function(t,n){this.writeTag(t,Yo.Fixed32),this.writeSFixed32(n)},writeFixed64Field:function(t,n){this.writeTag(t,Yo.Fixed64),this.writeFixed64(n)},writeSFixed64Field:function(t,n){this.writeTag(t,Yo.Fixed64),this.writeSFixed64(n)},writeVarintField:function(t,n){this.writeTag(t,Yo.Varint),this.writeVarint(n)},writeSVarintField:function(t,n){this.writeTag(t,Yo.Varint),this.writeSVarint(n)},writeStringField:function(t,n){this.writeTag(t,Yo.Bytes),this.writeString(n)},writeFloatField:function(t,n){this.writeTag(t,Yo.Fixed32),this.writeFloat(n)},writeDoubleField:function(t,n){this.writeTag(t,Yo.Fixed64),this.writeDouble(n)},writeBooleanField:function(t,n){this.writeVarintField(t,Boolean(n))}};var Th=function(t,n){var u=n.pixelRatio,g=n.version,_=n.stretchX,w=n.stretchY,S=n.content;this.paddedRect=t,this.pixelRatio=u,this.stretchX=_,this.stretchY=w,this.content=S,this.version=g},Qc={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Qc.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Qc.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Qc.tlbr.get=function(){return this.tl.concat(this.br)},Qc.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Th.prototype,Qc);var Ah=function(t,n){var u={},g={};this.haveRenderCallbacks=[];var _=[];this.addImages(t,u,_),this.addImages(n,g,_);var w=lf(_),S=new ma({width:w.w||1,height:w.h||1});for(var D in t){var z=t[D],q=u[D].paddedRect;ma.copy(z.data,S,{x:0,y:0},{x:q.x+1,y:q.y+1},z.data)}for(var G in n){var J=n[G],ut=g[G].paddedRect,mt=ut.x+1,zt=ut.y+1,Vt=J.data.width,fe=J.data.height;ma.copy(J.data,S,{x:0,y:0},{x:mt,y:zt},J.data),ma.copy(J.data,S,{x:0,y:fe-1},{x:mt,y:zt-1},{width:Vt,height:1}),ma.copy(J.data,S,{x:0,y:0},{x:mt,y:zt+fe},{width:Vt,height:1}),ma.copy(J.data,S,{x:Vt-1,y:0},{x:mt-1,y:zt},{width:1,height:fe}),ma.copy(J.data,S,{x:0,y:0},{x:mt+Vt,y:zt},{width:1,height:fe})}this.image=S,this.iconPositions=u,this.patternPositions=g};Ah.prototype.addImages=function(t,n,u){for(var g in t){var _=t[g],w={x:0,y:0,w:_.data.width+2,h:_.data.height+2};u.push(w),n[g]=new Th(w,_),_.hasRenderCallback&&this.haveRenderCallbacks.push(g)}},Ah.prototype.patchUpdatedImages=function(t,n){for(var u in t.dispatchRenderCallbacks(this.haveRenderCallbacks),t.updatedImages)this.patchUpdatedImage(this.iconPositions[u],t.getImage(u),n),this.patchUpdatedImage(this.patternPositions[u],t.getImage(u),n)},Ah.prototype.patchUpdatedImage=function(t,n,u){if(t&&n&&t.version!==n.version){t.version=n.version;var g=t.tl;u.update(n.data,void 0,{x:g[0],y:g[1]})}},xr("ImagePosition",Th),xr("ImageAtlas",Ah);var Du={horizontal:1,vertical:2,horizontalOnly:3},Lc=function(){this.scale=1,this.fontStack="",this.imageName=null};Lc.forText=function(t,n){var u=new Lc;return u.scale=t||1,u.fontStack=n,u},Lc.forImage=function(t){var n=new Lc;return n.imageName=t,n};var fu=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Lh(t,n,u,g,_,w,S,D,z,q,G,J,ut,mt,zt,Vt){var fe,ne=fu.fromFeature(t,_);J===Du.vertical&&ne.verticalizePunctuation();var Ee=ai.processBidirectionalText,Ce=ai.processStyledBidirectionalText;if(Ee&&1===ne.sections.length){fe=[];for(var Re=0,Be=Ee(ne.toString(),mp(ne,q,w,n,g,mt,zt));Re<Be.length;Re+=1){var rr=Be[Re],wr=new fu;wr.text=rr,wr.sections=ne.sections;for(var Er=0;Er<rr.length;Er++)wr.sectionIndex.push(0);fe.push(wr)}}else if(Ce){fe=[];for(var Hr=0,Ar=Ce(ne.text,ne.sectionIndex,mp(ne,q,w,n,g,mt,zt));Hr<Ar.length;Hr+=1){var nn=Ar[Hr],Fr=new fu;Fr.text=nn[0],Fr.sectionIndex=nn[1],Fr.sections=ne.sections,fe.push(Fr)}}else fe=function(Yr,fi){for(var Yn=[],ki=Yr.text,sn=0,uo=0,la=fi;uo<la.length;uo+=1){var ya=la[uo];Yn.push(Yr.substring(sn,ya)),sn=ya}return sn<ki.length&&Yn.push(Yr.substring(sn,ki.length)),Yn}(ne,mp(ne,q,w,n,g,mt,zt));var ii=[],Cn={positionedLines:ii,text:ne.toString(),top:G[1],bottom:G[1],left:G[0],right:G[0],writingMode:J,iconsInText:!1,verticalizable:!1};return function(Yr,fi,Yn,ki,sn,uo,la,ya,va,ca,ka,os){for(var as=0,Vs=-17,Is=0,ou=0,_a="right"===ya?1:"left"===ya?0:.5,Ns=0,_i=0,Go=sn;_i<Go.length;_i+=1){var Mo=Go[_i];Mo.trim();var Li=Mo.getMaxScale(),du=24*(Li-1),js={positionedGlyphs:[],lineOffset:0};Yr.positionedLines[Ns]=js;var Jo=js.positionedGlyphs,ss=0;if(Mo.length()){for(var Zs=0;Zs<Mo.length();Zs++){var lo=Mo.getSection(Zs),Cl=Mo.getSectionIndex(Zs),ku=Mo.getCharCode(Zs),Il=0,Ja=null,Ul=null,_l=null,sh=24,qc=!(va===Du.horizontal||!ka&&!Zl(ku)||ka&&(Dc[ku]||(sl=ku,Cr.Arabic(sl)||Cr["Arabic Supplement"](sl)||Cr["Arabic Extended-A"](sl)||Cr["Arabic Presentation Forms-A"](sl)||Cr["Arabic Presentation Forms-B"](sl))));if(lo.imageName){var Wu=ki[lo.imageName];if(!Wu)continue;_l=lo.imageName,Yr.iconsInText=Yr.iconsInText||!0,Ul=Wu.paddedRect;var al=Wu.displaySize;lo.scale=24*lo.scale/os,Il=du+(24-al[1]*lo.scale),sh=(Ja={width:al[0],height:al[1],left:1,top:-3,advance:qc?al[1]:al[0]}).advance;var ql=qc?al[0]*lo.scale-24*Li:al[1]*lo.scale-24*Li;ql>0&&ql>ss&&(ss=ql)}else{var uh=Yn[lo.fontStack],Ha=uh&&uh[ku];if(Ha&&Ha.rect)Ul=Ha.rect,Ja=Ha.metrics;else{var Uh=fi[lo.fontStack],Aa=Uh&&Uh[ku];if(!Aa)continue;Ja=Aa.metrics}Il=24*(Li-lo.scale)}qc?(Yr.verticalizable=!0,Jo.push({glyph:ku,imageName:_l,x:as,y:Vs+Il,vertical:qc,scale:lo.scale,fontStack:lo.fontStack,sectionIndex:Cl,metrics:Ja,rect:Ul}),as+=sh*lo.scale+ca):(Jo.push({glyph:ku,imageName:_l,x:as,y:Vs+Il,vertical:qc,scale:lo.scale,fontStack:lo.fontStack,sectionIndex:Cl,metrics:Ja,rect:Ul}),as+=Ja.advance*lo.scale+ca)}0!==Jo.length&&(Is=Math.max(as-ca,Is),bd(Jo,0,Jo.length-1,_a,ss)),as=0;var gu=uo*Li+ss;js.lineOffset=Math.max(ss,du),Vs+=gu,ou=Math.max(gu,ou),++Ns}else Vs+=uo,++Ns}var sl,Ml=Vs- -17,Wl=yp(la),Vo=Wl.horizontalAlign,Xs=Wl.verticalAlign;(function(Kl,Gl,yo,qh,lh,Gh,Gc,Vh,Ni){var ch,ul=(Gl-yo)*lh;ch=Gh!==Gc?-Vh*qh- -17:(-qh*Ni+.5)*Gc;for(var xc=0,hh=Kl;xc<hh.length;xc+=1)for(var ll=0,jh=hh[xc].positionedGlyphs;ll<jh.length;ll+=1){var ha=jh[ll];ha.x+=ul,ha.y+=ch}})(Yr.positionedLines,_a,Vo,Xs,Is,ou,uo,Ml,sn.length),Yr.top+=-Xs*Ml,Yr.bottom=Yr.top+Ml,Yr.left+=-Vo*Is,Yr.right=Yr.left+Is}(Cn,n,u,g,fe,S,D,z,J,q,ut,Vt),!function(Yr){for(var fi=0,Yn=Yr;fi<Yn.length;fi+=1)if(0!==Yn[fi].positionedGlyphs.length)return!1;return!0}(ii)&&Cn}fu.fromFeature=function(t,n){for(var u=new fu,g=0;g<t.sections.length;g++){var _=t.sections[g];_.image?u.addImageSection(_):u.addTextSection(_,n)}return u},fu.prototype.length=function(){return this.text.length},fu.prototype.getSection=function(t){return this.sections[this.sectionIndex[t]]},fu.prototype.getSectionIndex=function(t){return this.sectionIndex[t]},fu.prototype.getCharCode=function(t){return this.text.charCodeAt(t)},fu.prototype.verticalizePunctuation=function(){this.text=function(t){for(var n="",u=0;u<t.length;u++){var g=t.charCodeAt(u+1)||null,_=t.charCodeAt(u-1)||null;n+=g&&wu(g)&&!$c[t[u+1]]||_&&wu(_)&&!$c[t[u-1]]||!$c[t[u]]?t[u]:$c[t[u]]}return n}(this.text)},fu.prototype.trim=function(){for(var t=0,n=0;n<this.text.length&&Dc[this.text.charCodeAt(n)];n++)t++;for(var u=this.text.length,g=this.text.length-1;g>=0&&g>=t&&Dc[this.text.charCodeAt(g)];g--)u--;this.text=this.text.substring(t,u),this.sectionIndex=this.sectionIndex.slice(t,u)},fu.prototype.substring=function(t,n){var u=new fu;return u.text=this.text.substring(t,n),u.sectionIndex=this.sectionIndex.slice(t,n),u.sections=this.sections,u},fu.prototype.toString=function(){return this.text},fu.prototype.getMaxScale=function(){var t=this;return this.sectionIndex.reduce(function(n,u){return Math.max(n,t.sections[u].scale)},0)},fu.prototype.addTextSection=function(t,n){this.text+=t.text,this.sections.push(Lc.forText(t.scale,t.fontStack||n));for(var u=this.sections.length-1,g=0;g<t.text.length;++g)this.sectionIndex.push(u)},fu.prototype.addImageSection=function(t){var n=t.image?t.image.name:"";if(0!==n.length){var u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCharCode(u),this.sections.push(Lc.forImage(n)),this.sectionIndex.push(this.sections.length-1)):Ct("Reached maximum number of images 6401")}else Ct("Can't add FormattedSection with an empty image.")},fu.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Dc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Ou={};function dp(t,n,u,g,_,w){if(n.imageName){var S=g[n.imageName];return S?S.displaySize[0]*n.scale*24/w+_:0}var D=u[n.fontStack],z=D&&D[t];return z?z.metrics.advance*n.scale+_:0}function cf(t,n,u,g){var _=Math.pow(t-n,2);return g?t<n?_/2:2*_:_+Math.abs(u)*u}function xd(t,n,u){var g=0;return 10===t&&(g-=1e4),u&&(g+=150),40!==t&&65288!==t||(g+=50),41!==n&&65289!==n||(g+=50),g}function gp(t,n,u,g,_,w){for(var S=null,D=cf(n,u,_,w),z=0,q=g;z<q.length;z+=1){var G=q[z],J=cf(n-G.x,u,_,w)+G.badness;J<=D&&(S=G,D=J)}return{index:t,x:n,priorBreak:S,badness:D}}function mp(t,n,u,g,_,w,S){if("point"!==w)return[];if(!t)return[];for(var D,z=[],q=function(fe,ne,Ee,Ce,Re,Be){for(var rr=0,wr=0;wr<fe.length();wr++){var Er=fe.getSection(wr);rr+=dp(fe.getCharCode(wr),Er,Ce,Re,ne,Be)}return rr/Math.max(1,Math.ceil(rr/Ee))}(t,n,u,g,_,S),G=t.text.indexOf("\u200b")>=0,J=0,ut=0;ut<t.length();ut++){var mt=t.getSection(ut),zt=t.getCharCode(ut);if(Dc[zt]||(J+=dp(zt,mt,g,_,n,S)),ut<t.length()-1){var Vt=!((D=zt)<11904||!(Cr["Bopomofo Extended"](D)||Cr.Bopomofo(D)||Cr["CJK Compatibility Forms"](D)||Cr["CJK Compatibility Ideographs"](D)||Cr["CJK Compatibility"](D)||Cr["CJK Radicals Supplement"](D)||Cr["CJK Strokes"](D)||Cr["CJK Symbols and Punctuation"](D)||Cr["CJK Unified Ideographs Extension A"](D)||Cr["CJK Unified Ideographs"](D)||Cr["Enclosed CJK Letters and Months"](D)||Cr["Halfwidth and Fullwidth Forms"](D)||Cr.Hiragana(D)||Cr["Ideographic Description Characters"](D)||Cr["Kangxi Radicals"](D)||Cr["Katakana Phonetic Extensions"](D)||Cr.Katakana(D)||Cr["Vertical Forms"](D)||Cr["Yi Radicals"](D)||Cr["Yi Syllables"](D)));(Ou[zt]||Vt||mt.imageName)&&z.push(gp(ut+1,J,q,z,xd(zt,t.getCharCode(ut+1),Vt&&G),!1))}}return function fe(ne){return ne?fe(ne.priorBreak).concat(ne.index):[]}(gp(t.length(),J,q,z,0,!0))}function yp(t){var n=.5,u=.5;switch(t){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":u=1;break;case"top":case"top-right":case"top-left":u=0}return{horizontalAlign:n,verticalAlign:u}}function bd(t,n,u,g,_){if(g||_)for(var w=t[u],S=(t[u].x+w.metrics.advance*w.scale)*g,D=n;D<=u;D++)t[D].x-=S,t[D].y+=_}function hf(t,n,u,g,_,w){var S,D=t.image;if(D.content){var z=D.content,q=D.pixelRatio||1;S=[z[0]/q,z[1]/q,D.displaySize[0]-z[2]/q,D.displaySize[1]-z[3]/q]}var G,J,ut,mt,zt=n.left*w,Vt=n.right*w;"width"===u||"both"===u?(mt=_[0]+zt-g[3],J=_[0]+Vt+g[1]):J=(mt=_[0]+(zt+Vt-D.displaySize[0])/2)+D.displaySize[0];var fe=n.top*w,ne=n.bottom*w;return"height"===u||"both"===u?(G=_[1]+fe-g[0],ut=_[1]+ne+g[2]):ut=(G=_[1]+(fe+ne-D.displaySize[1])/2)+D.displaySize[1],{image:D,top:G,right:J,bottom:ut,left:mt,collisionPadding:S}}Ou[10]=!0,Ou[32]=!0,Ou[38]=!0,Ou[40]=!0,Ou[41]=!0,Ou[43]=!0,Ou[45]=!0,Ou[47]=!0,Ou[173]=!0,Ou[183]=!0,Ou[8203]=!0,Ou[8208]=!0,Ou[8211]=!0,Ou[8231]=!0;var Oc=function(t){function n(u,g,_,w){t.call(this,u,g),this.angle=_,void 0!==w&&(this.segment=w)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.clone=function(){return new n(this.x,this.y,this.angle,this.segment)},n}(Nt);function pf(t,n){var u=n.expression;if("constant"===u.kind)return{kind:"constant",layoutSize:u.evaluate(new mo(t+1))};if("source"===u.kind)return{kind:"source"};for(var g=u.zoomStops,_=u.interpolationType,w=0;w<g.length&&g[w]<=t;)w++;for(var S=w=Math.max(0,w-1);S<g.length&&g[S]<t+1;)S++;S=Math.min(g.length-1,S);var D=g[w],z=g[S];return"composite"===u.kind?{kind:"composite",minZoom:D,maxZoom:z,interpolationType:_}:{kind:"camera",minZoom:D,maxZoom:z,minSize:u.evaluate(new mo(D)),maxSize:u.evaluate(new mo(z)),interpolationType:_}}function wd(t,n,u){var g=n.uSize,_=u.lowerSize;return"source"===t.kind?_/128:"composite"===t.kind?io(_/128,u.upperSize/128,n.uSizeT):g}function Ed(t,n){var u=0,g=0;if("constant"===t.kind)g=t.layoutSize;else if("source"!==t.kind){var _=t.interpolationType,w=_?Yt(yi.interpolationFactor(_,n,t.minZoom,t.maxZoom),0,1):0;"camera"===t.kind?g=io(t.minSize,t.maxSize,w):u=w}return{uSizeT:u,uSize:g}}xr("Anchor",Oc);var gg=Object.freeze({__proto__:null,getSizeData:pf,evaluateSizeForFeature:wd,evaluateSizeForZoom:Ed,SIZE_PACK_FACTOR:128});function ff(t,n,u,g,_){if(void 0===n.segment)return!0;for(var w=n,S=n.segment+1,D=0;D>-u/2;){if(--S<0)return!1;D-=t[S].dist(w),w=t[S]}D+=t[S].dist(t[S+1]),S++;for(var z=[],q=0;D<u/2;){var G=t[S],J=t[S+1];if(!J)return!1;var ut=t[S-1].angleTo(G)-G.angleTo(J);for(ut=Math.abs((ut+3*Math.PI)%(2*Math.PI)-Math.PI),z.push({distance:D,angleDelta:ut}),q+=ut;D-z[0].distance>g;)q-=z.shift().angleDelta;if(q>_)return!1;S++,D+=G.dist(J)}return!0}function vp(t){for(var n=0,u=0;u<t.length-1;u++)n+=t[u].dist(t[u+1]);return n}function df(t,n,u){return t?.6*n*u:0}function _p(t,n){return Math.max(t?t.right-t.left:0,n?n.right-n.left:0)}function Sd(t,n,u,g,_,w){for(var S=df(u,_,w),D=_p(u,g)*w,z=0,q=vp(t)/2,G=0;G<t.length-1;G++){var J=t[G],ut=t[G+1],mt=J.dist(ut);if(z+mt>q){var zt=(q-z)/mt,Vt=io(J.x,ut.x,zt),fe=io(J.y,ut.y,zt),ne=new Oc(Vt,fe,ut.angleTo(J),G);return ne._round(),!S||ff(t,ne,D,S,n)?ne:void 0}z+=mt}}function Cd(t,n,u,g,_,w,S,D,z){var q=df(g,w,S),G=_p(g,_),J=G*S,ut=0===t[0].x||t[0].x===z||0===t[0].y||t[0].y===z;return n-J<n/4&&(n=J+n/4),function mt(zt,Vt,fe,ne,Ee,Ce,Re,Be,rr){for(var wr=Ce/2,Er=vp(zt),Hr=0,Ar=Vt-fe,nn=[],Fr=0;Fr<zt.length-1;Fr++){for(var ii=zt[Fr],Cn=zt[Fr+1],Yr=ii.dist(Cn),fi=Cn.angleTo(ii);Ar+fe<Hr+Yr;){var Yn=((Ar+=fe)-Hr)/Yr,ki=io(ii.x,Cn.x,Yn),sn=io(ii.y,Cn.y,Yn);if(ki>=0&&ki<rr&&sn>=0&&sn<rr&&Ar-wr>=0&&Ar+wr<=Er){var uo=new Oc(ki,sn,fi,Fr);uo._round(),ne&&!ff(zt,uo,Ce,ne,Ee)||nn.push(uo)}}Hr+=Yr}return Be||nn.length||Re||(nn=mt(zt,Hr/2,fe,ne,Ee,Ce,Re,!0,rr)),nn}(t,ut?n/2*D%n:(G/2+2*w)*S*D%n,n,q,u,J,ut,!1,z)}function gf(t,n,u,g,_){for(var w=[],S=0;S<t.length;S++)for(var D=t[S],z=void 0,q=0;q<D.length-1;q++){var G=D[q],J=D[q+1];G.x<n&&J.x<n||(G.x<n?G=new Nt(n,G.y+(n-G.x)/(J.x-G.x)*(J.y-G.y))._round():J.x<n&&(J=new Nt(n,G.y+(n-G.x)/(J.x-G.x)*(J.y-G.y))._round()),G.y<u&&J.y<u||(G.y<u?G=new Nt(G.x+(u-G.y)/(J.y-G.y)*(J.x-G.x),u)._round():J.y<u&&(J=new Nt(G.x+(u-G.y)/(J.y-G.y)*(J.x-G.x),u)._round()),G.x>=g&&J.x>=g||(G.x>=g?G=new Nt(g,G.y+(g-G.x)/(J.x-G.x)*(J.y-G.y))._round():J.x>=g&&(J=new Nt(g,G.y+(g-G.x)/(J.x-G.x)*(J.y-G.y))._round()),G.y>=_&&J.y>=_||(G.y>=_?G=new Nt(G.x+(_-G.y)/(J.y-G.y)*(J.x-G.x),_)._round():J.y>=_&&(J=new Nt(G.x+(_-G.y)/(J.y-G.y)*(J.x-G.x),_)._round()),z&&G.equals(z[z.length-1])||w.push(z=[G]),z.push(J)))))}return w}function Id(t,n,u,g){var _=[],w=t.image,S=w.pixelRatio,D=w.paddedRect.w-2,z=w.paddedRect.h-2,q=t.right-t.left,G=t.bottom-t.top,J=w.stretchX||[[0,D]],ut=w.stretchY||[[0,z]],mt=function(ki,sn){return ki+sn[1]-sn[0]},zt=J.reduce(mt,0),Vt=ut.reduce(mt,0),fe=D-zt,ne=z-Vt,Ee=0,Ce=zt,Re=0,Be=Vt,rr=0,wr=fe,Er=0,Hr=ne;if(w.content&&g){var Ar=w.content;Ee=xp(J,0,Ar[0]),Re=xp(ut,0,Ar[1]),Ce=xp(J,Ar[0],Ar[2]),Be=xp(ut,Ar[1],Ar[3]),rr=Ar[0]-Ee,Er=Ar[1]-Re,wr=Ar[2]-Ar[0]-Ce,Hr=Ar[3]-Ar[1]-Be}var nn=function(ki,sn,uo,la){var ya=Dh(ki.stretch-Ee,Ce,q,t.left),va=Oh(ki.fixed-rr,wr,ki.stretch,zt),ca=Dh(sn.stretch-Re,Be,G,t.top),ka=Oh(sn.fixed-Er,Hr,sn.stretch,Vt),os=Dh(uo.stretch-Ee,Ce,q,t.left),as=Oh(uo.fixed-rr,wr,uo.stretch,zt),Vs=Dh(la.stretch-Re,Be,G,t.top),Is=Oh(la.fixed-Er,Hr,la.stretch,Vt),ou=new Nt(ya,ca),_a=new Nt(os,ca),Ns=new Nt(os,Vs),_i=new Nt(ya,Vs),Go=new Nt(va/S,ka/S),Mo=new Nt(as/S,Is/S),Li=n*Math.PI/180;if(Li){var du=Math.sin(Li),js=Math.cos(Li),Jo=[js,-du,du,js];ou._matMult(Jo),_a._matMult(Jo),_i._matMult(Jo),Ns._matMult(Jo)}var ss=ki.stretch+ki.fixed,Zs=sn.stretch+sn.fixed;return{tl:ou,tr:_a,bl:_i,br:Ns,tex:{x:w.paddedRect.x+1+ss,y:w.paddedRect.y+1+Zs,w:uo.stretch+uo.fixed-ss,h:la.stretch+la.fixed-Zs},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Go,pixelOffsetBR:Mo,minFontScaleX:wr/S/q,minFontScaleY:Hr/S/G,isSDF:u}};if(g&&(w.stretchX||w.stretchY))for(var Fr=mf(J,fe,zt),ii=mf(ut,ne,Vt),Cn=0;Cn<Fr.length-1;Cn++)for(var Yr=Fr[Cn],fi=Fr[Cn+1],Yn=0;Yn<ii.length-1;Yn++)_.push(nn(Yr,ii[Yn],fi,ii[Yn+1]));else _.push(nn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:D+1},{fixed:0,stretch:z+1}));return _}function xp(t,n,u){for(var g=0,_=0,w=t;_<w.length;_+=1){var S=w[_];g+=Math.max(n,Math.min(u,S[1]))-Math.max(n,Math.min(u,S[0]))}return g}function mf(t,n,u){for(var g=[{fixed:-1,stretch:0}],_=0,w=t;_<w.length;_+=1){var S=w[_],D=S[0],z=S[1],q=g[g.length-1];g.push({fixed:D-q.stretch,stretch:q.stretch}),g.push({fixed:D-q.stretch,stretch:q.stretch+(z-D)})}return g.push({fixed:n+1,stretch:u}),g}function Dh(t,n,u,g){return t/n*u+g}function Oh(t,n,u,g){return t-n*u/g}var kh=function(t,n,u,g,_,w,S,D,z,q){if(this.boxStartIndex=t.length,z){var G=w.top,J=w.bottom,ut=w.collisionPadding;ut&&(G-=ut[1],J+=ut[3]);var mt=J-G;mt>0&&(mt=Math.max(10,mt),this.circleDiameter=mt)}else{var zt=w.top*S-D,Vt=w.bottom*S+D,fe=w.left*S-D,ne=w.right*S+D,Ee=w.collisionPadding;if(Ee&&(fe-=Ee[0]*S,zt-=Ee[1]*S,ne+=Ee[2]*S,Vt+=Ee[3]*S),q){var Ce=new Nt(fe,zt),Re=new Nt(ne,zt),Be=new Nt(fe,Vt),rr=new Nt(ne,Vt),wr=q*Math.PI/180;Ce._rotate(wr),Re._rotate(wr),Be._rotate(wr),rr._rotate(wr),fe=Math.min(Ce.x,Re.x,Be.x,rr.x),ne=Math.max(Ce.x,Re.x,Be.x,rr.x),zt=Math.min(Ce.y,Re.y,Be.y,rr.y),Vt=Math.max(Ce.y,Re.y,Be.y,rr.y)}t.emplaceBack(n.x,n.y,fe,zt,ne,Vt,u,g,_)}this.boxEndIndex=t.length},kc=function(t,n){if(void 0===t&&(t=[]),void 0===n&&(n=Md),this.data=t,this.length=this.data.length,this.compare=n,this.length>0)for(var u=(this.length>>1)-1;u>=0;u--)this._down(u)};function Md(t,n){return t<n?-1:t>n?1:0}function Pd(t,n,u){void 0===n&&(n=1),void 0===u&&(u=!1);for(var g=1/0,_=1/0,w=-1/0,S=-1/0,D=t[0],z=0;z<D.length;z++){var q=D[z];(!z||q.x<g)&&(g=q.x),(!z||q.y<_)&&(_=q.y),(!z||q.x>w)&&(w=q.x),(!z||q.y>S)&&(S=q.y)}var G=Math.min(w-g,S-_),J=G/2,ut=new kc([],yf);if(0===G)return new Nt(g,_);for(var mt=g;mt<w;mt+=G)for(var zt=_;zt<S;zt+=G)ut.push(new Jl(mt+J,zt+J,J,t));for(var Vt=function(Ee){for(var Ce=0,Re=0,Be=0,rr=Ee[0],wr=0,Er=rr.length,Hr=Er-1;wr<Er;Hr=wr++){var Ar=rr[wr],nn=rr[Hr],Fr=Ar.x*nn.y-nn.x*Ar.y;Re+=(Ar.x+nn.x)*Fr,Be+=(Ar.y+nn.y)*Fr,Ce+=3*Fr}return new Jl(Re/Ce,Be/Ce,0,Ee)}(t),fe=ut.length;ut.length;){var ne=ut.pop();(ne.d>Vt.d||!Vt.d)&&(Vt=ne,u&&console.log("found best %d after %d probes",Math.round(1e4*ne.d)/1e4,fe)),ne.max-Vt.d<=n||(ut.push(new Jl(ne.p.x-(J=ne.h/2),ne.p.y-J,J,t)),ut.push(new Jl(ne.p.x+J,ne.p.y-J,J,t)),ut.push(new Jl(ne.p.x-J,ne.p.y+J,J,t)),ut.push(new Jl(ne.p.x+J,ne.p.y+J,J,t)),fe+=4)}return u&&(console.log("num probes: "+fe),console.log("best distance: "+Vt.d)),Vt.p}function yf(t,n){return n.max-t.max}function Jl(t,n,u,g){this.p=new Nt(t,n),this.h=u,this.d=function(_,w){for(var S=!1,D=1/0,z=0;z<w.length;z++)for(var q=w[z],G=0,J=q.length,ut=J-1;G<J;ut=G++){var mt=q[G],zt=q[ut];mt.y>_.y!=zt.y>_.y&&_.x<(zt.x-mt.x)*(_.y-mt.y)/(zt.y-mt.y)+mt.x&&(S=!S),D=Math.min(D,Sc(_,mt,zt))}return(S?1:-1)*Math.sqrt(D)}(this.p,g),this.max=this.d+this.h*Math.SQRT2}kc.prototype.push=function(t){this.data.push(t),this.length++,this._up(this.length-1)},kc.prototype.pop=function(){if(0!==this.length){var t=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),t}},kc.prototype.peek=function(){return this.data[0]},kc.prototype._up=function(t){for(var n=this.data,u=this.compare,g=n[t];t>0;){var _=t-1>>1,w=n[_];if(u(g,w)>=0)break;n[t]=w,t=_}n[t]=g},kc.prototype._down=function(t){for(var n=this.data,u=this.compare,g=this.length>>1,_=n[t];t<g;){var w=1+(t<<1),S=n[w],D=w+1;if(D<this.length&&u(n[D],S)<0&&(w=D,S=n[D]),u(S,_)>=0)break;n[t]=S,t=w}n[t]=_};var bp=Number.POSITIVE_INFINITY;function Td(t,n){return n[1]!==bp?function(u,g,_){var w=0,S=0;switch(g=Math.abs(g),_=Math.abs(_),u){case"top-right":case"top-left":case"top":S=_-7;break;case"bottom-right":case"bottom-left":case"bottom":S=7-_}switch(u){case"top-right":case"bottom-right":case"right":w=-g;break;case"top-left":case"bottom-left":case"left":w=g}return[w,S]}(t,n[0],n[1]):function(u,g){var _=0,w=0;g<0&&(g=0);var S=g/Math.sqrt(2);switch(u){case"top-right":case"top-left":w=S-7;break;case"bottom-right":case"bottom-left":w=7-S;break;case"bottom":w=7-g;break;case"top":w=g-7}switch(u){case"top-right":case"bottom-right":_=-S;break;case"top-left":case"bottom-left":_=S;break;case"left":_=g;break;case"right":_=-g}return[_,w]}(t,n[0])}function Nh(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function vf(t,n,u,g,_,w,S,D,z,q,G,J,ut,mt,zt){var Vt=function(Re,Be,rr,wr,Er,Hr,Ar,nn){for(var Fr=wr.layout.get("text-rotate").evaluate(Hr,{})*Math.PI/180,ii=[],Cn=0,Yr=Be.positionedLines;Cn<Yr.length;Cn+=1)for(var fi=Yr[Cn],Yn=0,ki=fi.positionedGlyphs;Yn<ki.length;Yn+=1){var sn=ki[Yn];if(sn.rect){var uo=sn.rect||{},la=4,ya=!0,va=1,ca=0,ka=(Er||nn)&&sn.vertical,os=sn.metrics.advance*sn.scale/2;if(nn&&Be.verticalizable&&(ca=fi.lineOffset/2-(sn.imageName?-(24-sn.metrics.width*sn.scale)/2:24*(sn.scale-1))),sn.imageName){var as=Ar[sn.imageName];ya=as.sdf,la=1/(va=as.pixelRatio)}var Vs=Er?[sn.x+os,sn.y]:[0,0],Is=Er?[0,0]:[sn.x+os+rr[0],sn.y+rr[1]-ca],ou=[0,0];ka&&(ou=Is,Is=[0,0]);var _a=(sn.metrics.left-la)*sn.scale-os+Is[0],Ns=(-sn.metrics.top-la)*sn.scale+Is[1],_i=_a+uo.w*sn.scale/va,Go=Ns+uo.h*sn.scale/va,Mo=new Nt(_a,Ns),Li=new Nt(_i,Ns),du=new Nt(_a,Go),js=new Nt(_i,Go);if(ka){var Jo=new Nt(-os,os- -17),ss=-Math.PI/2,Zs=12-os,lo=new Nt(22-Zs,-(sn.imageName?Zs:0)),Cl=new(Function.prototype.bind.apply(Nt,[null].concat(ou)));Mo._rotateAround(ss,Jo)._add(lo)._add(Cl),Li._rotateAround(ss,Jo)._add(lo)._add(Cl),du._rotateAround(ss,Jo)._add(lo)._add(Cl),js._rotateAround(ss,Jo)._add(lo)._add(Cl)}if(Fr){var ku=Math.sin(Fr),Il=Math.cos(Fr),Ja=[Il,-ku,ku,Il];Mo._matMult(Ja),Li._matMult(Ja),du._matMult(Ja),js._matMult(Ja)}var Ul=new Nt(0,0),_l=new Nt(0,0);ii.push({tl:Mo,tr:Li,bl:du,br:js,tex:uo,writingMode:Be.writingMode,glyphOffset:Vs,sectionIndex:sn.sectionIndex,isSDF:ya,pixelOffsetTL:Ul,pixelOffsetBR:_l,minFontScaleX:0,minFontScaleY:0})}}return ii}(0,u,D,_,w,S,g,t.allowVerticalPlacement),fe=t.textSizeData,ne=null;"source"===fe.kind?(ne=[128*_.layout.get("text-size").evaluate(S,{})])[0]>32640&&Ct(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):"composite"===fe.kind&&((ne=[128*mt.compositeTextSizes[0].evaluate(S,{},zt),128*mt.compositeTextSizes[1].evaluate(S,{},zt)])[0]>32640||ne[1]>32640)&&Ct(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),t.addSymbols(t.text,Vt,ne,D,w,S,q,n,z.lineStartIndex,z.lineLength,ut,zt);for(var Ee=0,Ce=G;Ee<Ce.length;Ee+=1)J[Ce[Ee]]=t.text.placedSymbolArray.length-1;return 4*Vt.length}function wp(t){for(var n in t)return t[n];return null}function _f(t,n,u,g){var _=t.compareText;if(n in _){for(var w=_[n],S=w.length-1;S>=0;S--)if(g.dist(w[S])<u)return!0}else _[n]=[];return _[n].push(g),!1}var xf=Tc.VectorTileFeature.types,mg=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Ep(t,n,u,g,_,w,S,D,z,q,G,J,ut){var mt=D?Math.min(32640,Math.round(D[0])):0,zt=D?Math.min(32640,Math.round(D[1])):0;t.emplaceBack(n,u,Math.round(32*g),Math.round(32*_),w,S,(mt<<1)+(z?1:0),zt,16*q,16*G,256*J,256*ut)}function bf(t,n,u){t.emplaceBack(n.x,n.y,u),t.emplaceBack(n.x,n.y,u),t.emplaceBack(n.x,n.y,u),t.emplaceBack(n.x,n.y,u)}function yg(t){for(var n=0,u=t.sections;n<u.length;n+=1)if(ac(u[n].text))return!0;return!1}var th=function(t){this.layoutVertexArray=new h,this.indexArray=new Qt,this.programConfigurations=t,this.segments=new _t,this.dynamicLayoutVertexArray=new d,this.opacityVertexArray=new x,this.placedSymbolArray=new E};th.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length},th.prototype.upload=function(t,n,u,g){this.isEmpty()||(u&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ft.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,hp.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,mg,!0),this.opacityVertexBuffer.itemSize=1),(u||g)&&this.programConfigurations.upload(t))},th.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},xr("SymbolBuffers",th);var Rh=function(t,n,u){this.layoutVertexArray=new t,this.layoutAttributes=n,this.indexArray=new u,this.segments=new _t,this.collisionVertexArray=new Mt};Rh.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,pd.members,!0)},Rh.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},xr("CollisionBuffers",Rh);var Oo=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(w){return w.id}),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=pu([]),this.placementViewportMatrix=pu([]);var n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=pf(this.zoom,n["text-size"]),this.iconSizeData=pf(this.zoom,n["icon-size"]);var u=this.layers[0].layout,g=u.get("symbol-sort-key"),_=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==_&&!g.isConstant(),this.sortFeaturesByY=("viewport-y"===_||"auto"===_&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===u.get("symbol-placement")&&(this.writingModes=u.get("text-writing-mode").map(function(w){return Du[w]})),this.stateDependentLayerIds=this.layers.filter(function(w){return w.isStateDependent()}).map(function(w){return w.id}),this.sourceID=t.sourceID};Oo.prototype.createArrays=function(){this.text=new th(new qo(this.layers,this.zoom,function(t){return/^text/.test(t)})),this.icon=new th(new qo(this.layers,this.zoom,function(t){return/^icon/.test(t)})),this.glyphOffsetArray=new R,this.lineVertexArray=new V,this.symbolInstances=new T},Oo.prototype.calculateGlyphDependencies=function(t,n,u,g,_){for(var w=0;w<t.length;w++)if(n[t.charCodeAt(w)]=!0,(u||g)&&_){var S=$c[t.charAt(w)];S&&(n[S.charCodeAt(0)]=!0)}},Oo.prototype.populate=function(t,n,u){var g=this.layers[0],_=g.layout,w=_.get("text-font"),S=_.get("text-field"),D=_.get("icon-image"),z=("constant"!==S.value.kind||S.value.value instanceof Ro&&!S.value.value.isEmpty()||S.value.value.toString().length>0)&&("constant"!==w.value.kind||w.value.value.length>0),q="constant"!==D.value.kind||!!D.value.value||Object.keys(D.parameters).length>0,G=_.get("symbol-sort-key");if(this.features=[],z||q){for(var J=n.iconDependencies,ut=n.glyphDependencies,mt=n.availableImages,zt=new mo(this.zoom),Vt=0,fe=t;Vt<fe.length;Vt+=1){var ne=fe[Vt],Ee=ne.feature,Ce=ne.id,Re=ne.index,Be=ne.sourceLayerIndex,rr=g._featureFilter.needGeometry,wr=Os(Ee,rr);if(g._featureFilter.filter(zt,wr,u)){rr||(wr.geometry=Ya(Ee));var Er=void 0;if(z){var Hr=g.getValueAndResolveTokens("text-field",wr,u,mt),Ar=Ro.factory(Hr);yg(Ar)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===eu()||this.hasRTLText&&ai.isParsed())&&(Er=dd(Ar,g,wr))}var nn=void 0;if(q){var Fr=g.getValueAndResolveTokens("icon-image",wr,u,mt);nn=Fr instanceof Hn?Fr:Hn.fromString(Fr)}if(Er||nn){var ii=this.sortFeaturesByKey?G.evaluate(wr,{},u):void 0;if(this.features.push({id:Ce,text:Er,icon:nn,index:Re,sourceLayerIndex:Be,geometry:wr.geometry,properties:Ee.properties,type:xf[Ee.type],sortKey:ii}),nn&&(J[nn.name]=!0),Er){var Cn=w.evaluate(wr,{},u).join(","),Yr="map"===_.get("text-rotation-alignment")&&"point"!==_.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Du.vertical)>=0;for(var fi=0,Yn=Er.sections;fi<Yn.length;fi+=1){var ki=Yn[fi];if(ki.image)J[ki.image.name]=!0;else{var sn=Xo(Er.toString()),uo=ki.fontStack||Cn,la=ut[uo]=ut[uo]||{};this.calculateGlyphDependencies(ki.text,la,Yr,this.allowVerticalPlacement,sn)}}}}}}"line"===_.get("symbol-placement")&&(this.features=function(ya){var va={},ca={},ka=[],os=0;function as(Jo){ka.push(ya[Jo]),os++}function Vs(Jo,ss,Zs){var lo=ca[Jo];return delete ca[Jo],ca[ss]=lo,ka[lo].geometry[0].pop(),ka[lo].geometry[0]=ka[lo].geometry[0].concat(Zs[0]),lo}function Is(Jo,ss,Zs){var lo=va[ss];return delete va[ss],va[Jo]=lo,ka[lo].geometry[0].shift(),ka[lo].geometry[0]=Zs[0].concat(ka[lo].geometry[0]),lo}function ou(Jo,ss,Zs){var lo=Zs?ss[0][ss[0].length-1]:ss[0][0];return Jo+":"+lo.x+":"+lo.y}for(var _a=0;_a<ya.length;_a++){var Ns=ya[_a],_i=Ns.geometry,Go=Ns.text?Ns.text.toString():null;if(Go){var Mo=ou(Go,_i),Li=ou(Go,_i,!0);if(Mo in ca&&Li in va&&ca[Mo]!==va[Li]){var du=Is(Mo,Li,_i),js=Vs(Mo,Li,ka[du].geometry);delete va[Mo],delete ca[Li],ca[ou(Go,ka[js].geometry,!0)]=js,ka[du].geometry=null}else Mo in ca?Vs(Mo,Li,_i):Li in va?Is(Mo,Li,_i):(as(_a),va[Mo]=os-1,ca[Li]=os-1)}else as(_a)}return ka.filter(function(Jo){return Jo.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(ya,va){return ya.sortKey-va.sortKey})}},Oo.prototype.update=function(t,n,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,n,this.layers,u),this.icon.programConfigurations.updatePaintArrays(t,n,this.layers,u))},Oo.prototype.isEmpty=function(){return 0===this.symbolInstances.length&&!this.hasRTLText},Oo.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Oo.prototype.upload=function(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Oo.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Oo.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Oo.prototype.addToLineVertexArray=function(t,n){var u=this.lineVertexArray.length;if(void 0!==t.segment){for(var g=t.dist(n[t.segment+1]),_=t.dist(n[t.segment]),w={},S=t.segment+1;S<n.length;S++)w[S]={x:n[S].x,y:n[S].y,tileUnitDistanceFromAnchor:g},S<n.length-1&&(g+=n[S+1].dist(n[S]));for(var D=t.segment||0;D>=0;D--)w[D]={x:n[D].x,y:n[D].y,tileUnitDistanceFromAnchor:_},D>0&&(_+=n[D-1].dist(n[D]));for(var z=0;z<n.length;z++){var q=w[z];this.lineVertexArray.emplaceBack(q.x,q.y,q.tileUnitDistanceFromAnchor)}}return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}},Oo.prototype.addSymbols=function(t,n,u,g,_,w,S,D,z,q,G,J){for(var ut=t.indexArray,mt=t.layoutVertexArray,zt=t.segments.prepareSegment(4*n.length,mt,ut,this.canOverlap?w.sortKey:void 0),Vt=this.glyphOffsetArray.length,fe=zt.vertexLength,ne=this.allowVerticalPlacement&&S===Du.vertical?Math.PI/2:0,Ee=w.text&&w.text.sections,Ce=0;Ce<n.length;Ce++){var Re=n[Ce],Be=Re.tl,rr=Re.tr,wr=Re.bl,Er=Re.br,Hr=Re.tex,Ar=Re.pixelOffsetTL,nn=Re.pixelOffsetBR,Fr=Re.minFontScaleX,ii=Re.minFontScaleY,Cn=Re.glyphOffset,Yr=Re.isSDF,fi=Re.sectionIndex,Yn=zt.vertexLength,ki=Cn[1];Ep(mt,D.x,D.y,Be.x,ki+Be.y,Hr.x,Hr.y,u,Yr,Ar.x,Ar.y,Fr,ii),Ep(mt,D.x,D.y,rr.x,ki+rr.y,Hr.x+Hr.w,Hr.y,u,Yr,nn.x,Ar.y,Fr,ii),Ep(mt,D.x,D.y,wr.x,ki+wr.y,Hr.x,Hr.y+Hr.h,u,Yr,Ar.x,nn.y,Fr,ii),Ep(mt,D.x,D.y,Er.x,ki+Er.y,Hr.x+Hr.w,Hr.y+Hr.h,u,Yr,nn.x,nn.y,Fr,ii),bf(t.dynamicLayoutVertexArray,D,ne),ut.emplaceBack(Yn,Yn+1,Yn+2),ut.emplaceBack(Yn+1,Yn+2,Yn+3),zt.vertexLength+=4,zt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Cn[0]),Ce!==n.length-1&&fi===n[Ce+1].sectionIndex||t.programConfigurations.populatePaintArrays(mt.length,w,w.index,{},J,Ee&&Ee[fi])}t.placedSymbolArray.emplaceBack(D.x,D.y,Vt,this.glyphOffsetArray.length-Vt,fe,z,q,D.segment,u?u[0]:0,u?u[1]:0,g[0],g[1],S,0,!1,0,G)},Oo.prototype._addCollisionDebugVertex=function(t,n,u,g,_,w){return n.emplaceBack(0,0),t.emplaceBack(u.x,u.y,g,_,Math.round(w.x),Math.round(w.y))},Oo.prototype.addCollisionDebugVertices=function(t,n,u,g,_,w,S){var D=_.segments.prepareSegment(4,_.layoutVertexArray,_.indexArray),z=D.vertexLength,q=_.layoutVertexArray,G=_.collisionVertexArray,J=S.anchorX,ut=S.anchorY;this._addCollisionDebugVertex(q,G,w,J,ut,new Nt(t,n)),this._addCollisionDebugVertex(q,G,w,J,ut,new Nt(u,n)),this._addCollisionDebugVertex(q,G,w,J,ut,new Nt(u,g)),this._addCollisionDebugVertex(q,G,w,J,ut,new Nt(t,g)),D.vertexLength+=4;var mt=_.indexArray;mt.emplaceBack(z,z+1),mt.emplaceBack(z+1,z+2),mt.emplaceBack(z+2,z+3),mt.emplaceBack(z+3,z),D.primitiveLength+=4},Oo.prototype.addDebugCollisionBoxes=function(t,n,u,g){for(var _=t;_<n;_++){var w=this.collisionBoxArray.get(_);this.addCollisionDebugVertices(w.x1,w.y1,w.x2,w.y2,g?this.textCollisionBox:this.iconCollisionBox,w.anchorPoint,u)}},Oo.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Rh(F,rf.members,ln),this.iconCollisionBox=new Rh(F,rf.members,ln);for(var t=0;t<this.symbolInstances.length;t++){var n=this.symbolInstances.get(t);this.addDebugCollisionBoxes(n.textBoxStartIndex,n.textBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.iconBoxStartIndex,n.iconBoxEndIndex,n,!1),this.addDebugCollisionBoxes(n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex,n,!1)}},Oo.prototype._deserializeCollisionBoxesForSymbol=function(t,n,u,g,_,w,S,D,z){for(var q={},G=n;G<u;G++){var J=t.get(G);q.textBox={x1:J.x1,y1:J.y1,x2:J.x2,y2:J.y2,anchorPointX:J.anchorPointX,anchorPointY:J.anchorPointY},q.textFeatureIndex=J.featureIndex;break}for(var ut=g;ut<_;ut++){var mt=t.get(ut);q.verticalTextBox={x1:mt.x1,y1:mt.y1,x2:mt.x2,y2:mt.y2,anchorPointX:mt.anchorPointX,anchorPointY:mt.anchorPointY},q.verticalTextFeatureIndex=mt.featureIndex;break}for(var zt=w;zt<S;zt++){var Vt=t.get(zt);q.iconBox={x1:Vt.x1,y1:Vt.y1,x2:Vt.x2,y2:Vt.y2,anchorPointX:Vt.anchorPointX,anchorPointY:Vt.anchorPointY},q.iconFeatureIndex=Vt.featureIndex;break}for(var fe=D;fe<z;fe++){var ne=t.get(fe);q.verticalIconBox={x1:ne.x1,y1:ne.y1,x2:ne.x2,y2:ne.y2,anchorPointX:ne.anchorPointX,anchorPointY:ne.anchorPointY},q.verticalIconFeatureIndex=ne.featureIndex;break}return q},Oo.prototype.deserializeCollisionBoxes=function(t){this.collisionArrays=[];for(var n=0;n<this.symbolInstances.length;n++){var u=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}},Oo.prototype.hasTextData=function(){return this.text.segments.get().length>0},Oo.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Oo.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Oo.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Oo.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Oo.prototype.addIndicesForPlacedSymbol=function(t,n){for(var u=t.placedSymbolArray.get(n),g=u.vertexStartIndex+4*u.numGlyphs,_=u.vertexStartIndex;_<g;_+=4)t.indexArray.emplaceBack(_,_+1,_+2),t.indexArray.emplaceBack(_+1,_+2,_+3)},Oo.prototype.getSortedSymbolIndexes=function(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var n=Math.sin(t),u=Math.cos(t),g=[],_=[],w=[],S=0;S<this.symbolInstances.length;++S){w.push(S);var D=this.symbolInstances.get(S);g.push(0|Math.round(n*D.anchorX+u*D.anchorY)),_.push(D.featureIndex)}return w.sort(function(z,q){return g[z]-g[q]||_[q]-_[z]}),w},Oo.prototype.addToSortKeyRanges=function(t,n){var u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===n?u.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:t,symbolInstanceEnd:t+1})},Oo.prototype.sortFeatures=function(t){var n=this;if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var u=0,g=this.symbolInstanceIndexes;u<g.length;u+=1){var _=this.symbolInstances.get(g[u]);this.featureSortOrder.push(_.featureIndex),[_.rightJustifiedTextSymbolIndex,_.centerJustifiedTextSymbolIndex,_.leftJustifiedTextSymbolIndex].forEach(function(w,S,D){w>=0&&D.indexOf(w)===S&&n.addIndicesForPlacedSymbol(n.text,w)}),_.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,_.verticalPlacedTextSymbolIndex),_.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,_.placedIconSymbolIndex),_.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,_.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},xr("SymbolBucket",Oo,{omit:["layers","collisionBoxArray","features","compareText"]}),Oo.MAX_GLYPHS=65535,Oo.addDynamicAttributes=bf;var vg=new Ma({"symbol-placement":new Tr(Dt.layout_symbol["symbol-placement"]),"symbol-spacing":new Tr(Dt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Tr(Dt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new mn(Dt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Tr(Dt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Tr(Dt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Tr(Dt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Tr(Dt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Tr(Dt.layout_symbol["icon-rotation-alignment"]),"icon-size":new mn(Dt.layout_symbol["icon-size"]),"icon-text-fit":new Tr(Dt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Tr(Dt.layout_symbol["icon-text-fit-padding"]),"icon-image":new mn(Dt.layout_symbol["icon-image"]),"icon-rotate":new mn(Dt.layout_symbol["icon-rotate"]),"icon-padding":new Tr(Dt.layout_symbol["icon-padding"]),"icon-keep-upright":new Tr(Dt.layout_symbol["icon-keep-upright"]),"icon-offset":new mn(Dt.layout_symbol["icon-offset"]),"icon-anchor":new mn(Dt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Tr(Dt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Tr(Dt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Tr(Dt.layout_symbol["text-rotation-alignment"]),"text-field":new mn(Dt.layout_symbol["text-field"]),"text-font":new mn(Dt.layout_symbol["text-font"]),"text-size":new mn(Dt.layout_symbol["text-size"]),"text-max-width":new mn(Dt.layout_symbol["text-max-width"]),"text-line-height":new Tr(Dt.layout_symbol["text-line-height"]),"text-letter-spacing":new mn(Dt.layout_symbol["text-letter-spacing"]),"text-justify":new mn(Dt.layout_symbol["text-justify"]),"text-radial-offset":new mn(Dt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Tr(Dt.layout_symbol["text-variable-anchor"]),"text-anchor":new mn(Dt.layout_symbol["text-anchor"]),"text-max-angle":new Tr(Dt.layout_symbol["text-max-angle"]),"text-writing-mode":new Tr(Dt.layout_symbol["text-writing-mode"]),"text-rotate":new mn(Dt.layout_symbol["text-rotate"]),"text-padding":new Tr(Dt.layout_symbol["text-padding"]),"text-keep-upright":new Tr(Dt.layout_symbol["text-keep-upright"]),"text-transform":new mn(Dt.layout_symbol["text-transform"]),"text-offset":new mn(Dt.layout_symbol["text-offset"]),"text-allow-overlap":new Tr(Dt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Tr(Dt.layout_symbol["text-ignore-placement"]),"text-optional":new Tr(Dt.layout_symbol["text-optional"])}),wf={paint:new Ma({"icon-opacity":new mn(Dt.paint_symbol["icon-opacity"]),"icon-color":new mn(Dt.paint_symbol["icon-color"]),"icon-halo-color":new mn(Dt.paint_symbol["icon-halo-color"]),"icon-halo-width":new mn(Dt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new mn(Dt.paint_symbol["icon-halo-blur"]),"icon-translate":new Tr(Dt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Tr(Dt.paint_symbol["icon-translate-anchor"]),"text-opacity":new mn(Dt.paint_symbol["text-opacity"]),"text-color":new mn(Dt.paint_symbol["text-color"],{runtimeType:wn,getOverride:function(t){return t.textColor},hasOverride:function(t){return!!t.textColor}}),"text-halo-color":new mn(Dt.paint_symbol["text-halo-color"]),"text-halo-width":new mn(Dt.paint_symbol["text-halo-width"]),"text-halo-blur":new mn(Dt.paint_symbol["text-halo-blur"]),"text-translate":new Tr(Dt.paint_symbol["text-translate"]),"text-translate-anchor":new Tr(Dt.paint_symbol["text-translate-anchor"])}),layout:vg},eh=function(t){this.type=t.property.overrides?t.property.overrides.runtimeType:Pr,this.defaultValue=t};eh.prototype.evaluate=function(t){if(t.formattedSection){var n=this.defaultValue.property.overrides;if(n&&n.hasOverride(t.formattedSection))return n.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default},eh.prototype.eachChild=function(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)},eh.prototype.outputDefined=function(){return!1},eh.prototype.serialize=function(){return null},xr("FormatSectionOverride",eh,{omit:["defaultValue"]});var _g=function(t){function n(u){t.call(this,u,wf)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.recalculate=function(u,g){if(t.prototype.recalculate.call(this,u,g),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var _=this.layout.get("text-writing-mode");if(_){for(var w=[],S=0,D=_;S<D.length;S+=1){var z=D[S];w.indexOf(z)<0&&w.push(z)}this.layout._values["text-writing-mode"]=w}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},n.prototype.getValueAndResolveTokens=function(u,g,_,w){var z,S=this.layout.get(u).evaluate(g,{},_,w),D=this._unevaluatedLayout._values[u];return D.isDataDriven()||hs(D.value)||!S?S:(z=g.properties,S.replace(/{([^{}]+)}/g,function(G,J){return J in z?String(z[J]):""}))},n.prototype.createBucket=function(u){return new Oo(u)},n.prototype.queryRadius=function(){return 0},n.prototype.queryIntersectsFeature=function(){return!1},n.prototype._setPaintOverrides=function(){for(var u=0,g=wf.paint.overridableProperties;u<g.length;u+=1){var _=g[u];if(n.hasPaintOverride(this.layout,_)){var w,S=this.paint.get(_),D=new eh(S),z=new ea(D,S.property.specification);w="constant"===S.value.kind||"source"===S.value.kind?new be("source",z):new je("composite",z,S.value.zoomStops,S.value._interpolationType),this.paint._values[_]=new Es(S.property,w,S.parameters)}}},n.prototype._handleOverridablePaintPropertyUpdate=function(u,g,_){return!(!this.layout||g.isDataDriven()||_.isDataDriven())&&n.hasPaintOverride(this.layout,u)},n.hasPaintOverride=function(u,g){var _=u.get("text-field"),w=wf.paint.properties[g],S=!1,D=function(G){for(var J=0,ut=G;J<ut.length;J+=1)if(w.overrides&&w.overrides.hasOverride(ut[J]))return void(S=!0)};if("constant"===_.value.kind&&_.value.value instanceof Ro)D(_.value.value.sections);else if("source"===_.value.kind){var z=function(G){S||(G instanceof Pn&&$o(G.value)===Nr?D(G.value.sections):G instanceof xn?D(G.sections):G.eachChild(z))},q=_.value;q._styleExpression&&z(q._styleExpression.expression)}return S},n}(dn),xg={paint:new Ma({"background-color":new Tr(Dt.paint_background["background-color"]),"background-pattern":new Ss(Dt.paint_background["background-pattern"]),"background-opacity":new Tr(Dt.paint_background["background-opacity"])})},bg=function(t){function n(u){t.call(this,u,xg)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n}(dn),Ad={paint:new Ma({"raster-opacity":new Tr(Dt.paint_raster["raster-opacity"]),"raster-hue-rotate":new Tr(Dt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Tr(Dt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Tr(Dt.paint_raster["raster-brightness-max"]),"raster-saturation":new Tr(Dt.paint_raster["raster-saturation"]),"raster-contrast":new Tr(Dt.paint_raster["raster-contrast"]),"raster-resampling":new Tr(Dt.paint_raster["raster-resampling"]),"raster-fade-duration":new Tr(Dt.paint_raster["raster-fade-duration"])})},Ef=function(t){function n(u){t.call(this,u,Ad)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n}(dn),wg=function(t){function n(u){t.call(this,u,{}),this.implementation=u}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.is3D=function(){return"3d"===this.implementation.renderingMode},n.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},n.prototype.recalculate=function(){},n.prototype.updateTransitions=function(){},n.prototype.hasTransition=function(){},n.prototype.serialize=function(){},n.prototype.onAdd=function(u){this.implementation.onAdd&&this.implementation.onAdd(u,u.painter.context.gl)},n.prototype.onRemove=function(u){this.implementation.onRemove&&this.implementation.onRemove(u,u.painter.context.gl)},n}(dn),Sf={circle:Xc,heatmap:ji,hillshade:Xi,fill:td,"fill-extrusion":ld,line:so,symbol:_g,background:bg,raster:Ef},Cf=qt.HTMLImageElement,rh=qt.HTMLCanvasElement,gc=qt.HTMLVideoElement,nh=qt.ImageData,ih=qt.ImageBitmap,Nc=function(t,n,u,g){this.context=t,this.format=u,this.texture=t.gl.createTexture(),this.update(n,g)};Nc.prototype.update=function(t,n,u){var g=t.width,_=t.height,w=!(this.size&&this.size[0]===g&&this.size[1]===_||u),S=this.context,D=S.gl;if(this.useMipmap=Boolean(n&&n.useMipmap),D.bindTexture(D.TEXTURE_2D,this.texture),S.pixelStoreUnpackFlipY.set(!1),S.pixelStoreUnpack.set(1),S.pixelStoreUnpackPremultiplyAlpha.set(this.format===D.RGBA&&(!n||!1!==n.premultiply)),w)this.size=[g,_],t instanceof Cf||t instanceof rh||t instanceof gc||t instanceof nh||ih&&t instanceof ih?D.texImage2D(D.TEXTURE_2D,0,this.format,this.format,D.UNSIGNED_BYTE,t):D.texImage2D(D.TEXTURE_2D,0,this.format,g,_,0,this.format,D.UNSIGNED_BYTE,t.data);else{var z=u||{x:0,y:0},q=z.x,G=z.y;t instanceof Cf||t instanceof rh||t instanceof gc||t instanceof nh||ih&&t instanceof ih?D.texSubImage2D(D.TEXTURE_2D,0,q,G,D.RGBA,D.UNSIGNED_BYTE,t):D.texSubImage2D(D.TEXTURE_2D,0,q,G,g,_,D.RGBA,D.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&D.generateMipmap(D.TEXTURE_2D)},Nc.prototype.bind=function(t,n,u){var g=this.context.gl;g.bindTexture(g.TEXTURE_2D,this.texture),u!==g.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(u=g.LINEAR),t!==this.filter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,t),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,u||t),this.filter=t),n!==this.wrap&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,n),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,n),this.wrap=n)},Nc.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Nc.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Sp=function(t){var n=this;this._callback=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){n._triggered=!1,n._callback()})};Sp.prototype.trigger=function(){var t=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){t._triggered=!1,t._callback()},0))},Sp.prototype.remove=function(){delete this._channel,this._callback=function(){}};var oh=function(t,n,u){this.target=t,this.parent=n,this.mapId=u,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},rt(["receive","process"],this),this.invoker=new Sp(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Fe()?t:qt};function Fh(t,n,u){var g=2*Math.PI*6378137/256/Math.pow(2,u);return[t*g-2*Math.PI*6378137/2,n*g-2*Math.PI*6378137/2]}oh.prototype.send=function(t,n,u,g,_){var w=this;void 0===_&&(_=!1);var S=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(this.callbacks[S]=u);var D=pe(this.globalScope)?void 0:[];return this.target.postMessage({id:S,type:t,hasCallback:!!u,targetMapId:g,mustQueue:_,sourceMapId:this.mapId,data:ua(n,D)},D),{cancel:function(){u&&delete w.callbacks[S],w.target.postMessage({id:S,type:"<cancel>",targetMapId:g,sourceMapId:w.mapId})}}},oh.prototype.receive=function(t){var n=t.data,u=n.id;if(u&&(!n.targetMapId||this.mapId===n.targetMapId))if("<cancel>"===n.type){delete this.tasks[u];var g=this.cancelCallbacks[u];delete this.cancelCallbacks[u],g&&g()}else Fe()||n.mustQueue?(this.tasks[u]=n,this.taskQueue.push(u),this.invoker.trigger()):this.processTask(u,n)},oh.prototype.process=function(){if(this.taskQueue.length){var t=this.taskQueue.shift(),n=this.tasks[t];delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),n&&this.processTask(t,n)}},oh.prototype.processTask=function(t,n){var u=this;if("<response>"===n.type){var g=this.callbacks[t];delete this.callbacks[t],g&&(n.error?g(Tu(n.error)):g(null,Tu(n.data)))}else{var _=!1,w=pe(this.globalScope)?void 0:[],S=n.hasCallback?function(G,J){_=!0,delete u.cancelCallbacks[t],u.target.postMessage({id:t,type:"<response>",sourceMapId:u.mapId,error:G?ua(G):null,data:ua(J,w)},w)}:function(G){_=!0},D=null,z=Tu(n.data);if(this.parent[n.type])D=this.parent[n.type](n.sourceMapId,z,S);else if(this.parent.getWorkerSource){var q=n.type.split(".");D=this.parent.getWorkerSource(n.sourceMapId,q[0],z.source)[q[1]](z,S)}else S(new Error("Could not find function "+n.type));!_&&D&&D.cancel&&(this.cancelCallbacks[t]=D.cancel)}},oh.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Ta=function(t,n){t&&(n?this.setSouthWest(t).setNorthEast(n):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};Ta.prototype.setNorthEast=function(t){return this._ne=t instanceof ko?new ko(t.lng,t.lat):ko.convert(t),this},Ta.prototype.setSouthWest=function(t){return this._sw=t instanceof ko?new ko(t.lng,t.lat):ko.convert(t),this},Ta.prototype.extend=function(t){var n,u,g=this._sw,_=this._ne;if(t instanceof ko)n=t,u=t;else{if(!(t instanceof Ta))return Array.isArray(t)?4===t.length||t.every(Array.isArray)?this.extend(Ta.convert(t)):this.extend(ko.convert(t)):this;if(u=t._ne,!(n=t._sw)||!u)return this}return g||_?(g.lng=Math.min(n.lng,g.lng),g.lat=Math.min(n.lat,g.lat),_.lng=Math.max(u.lng,_.lng),_.lat=Math.max(u.lat,_.lat)):(this._sw=new ko(n.lng,n.lat),this._ne=new ko(u.lng,u.lat)),this},Ta.prototype.getCenter=function(){return new ko((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Ta.prototype.getSouthWest=function(){return this._sw},Ta.prototype.getNorthEast=function(){return this._ne},Ta.prototype.getNorthWest=function(){return new ko(this.getWest(),this.getNorth())},Ta.prototype.getSouthEast=function(){return new ko(this.getEast(),this.getSouth())},Ta.prototype.getWest=function(){return this._sw.lng},Ta.prototype.getSouth=function(){return this._sw.lat},Ta.prototype.getEast=function(){return this._ne.lng},Ta.prototype.getNorth=function(){return this._ne.lat},Ta.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Ta.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Ta.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Ta.prototype.contains=function(t){var n=ko.convert(t),u=n.lng,g=n.lat,_=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(_=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=g&&g<=this._ne.lat&&_},Ta.convert=function(t){return!t||t instanceof Ta?t:new Ta(t)};var ko=function(t,n){if(isNaN(t)||isNaN(n))throw new Error("Invalid LngLat object: ("+t+", "+n+")");if(this.lng=+t,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};ko.prototype.wrap=function(){return new ko(ge(this.lng,-180,180),this.lat)},ko.prototype.toArray=function(){return[this.lng,this.lat]},ko.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},ko.prototype.distanceTo=function(t){var n=Math.PI/180,u=this.lat*n,g=t.lat*n,_=Math.sin(u)*Math.sin(g)+Math.cos(u)*Math.cos(g)*Math.cos((t.lng-this.lng)*n);return 6371008.8*Math.acos(Math.min(_,1))},ko.prototype.toBounds=function(t){void 0===t&&(t=0);var n=360*t/40075017,u=n/Math.cos(Math.PI/180*this.lat);return new Ta(new ko(this.lng-u,this.lat-n),new ko(this.lng+u,this.lat+n))},ko.convert=function(t){if(t instanceof ko)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new ko(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new ko(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Rc=2*Math.PI*6371008.8;function Cp(t){return Rc*Math.cos(t*Math.PI/180)}function Ip(t){return(180+t)/360}function Fc(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function zc(t,n){return t/Cp(n)}function Bc(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}var mc=function(t,n,u){void 0===u&&(u=0),this.x=+t,this.y=+n,this.z=+u};mc.fromLngLat=function(t,n){void 0===n&&(n=0);var u=ko.convert(t);return new mc(Ip(u.lng),Fc(u.lat),zc(n,u.lat))},mc.prototype.toLngLat=function(){return new ko(360*this.x-180,Bc(this.y))},mc.prototype.toAltitude=function(){return this.z*Cp(Bc(this.y))},mc.prototype.meterInMercatorCoordinateUnits=function(){return 1/Rc*(t=Bc(this.y),1/Math.cos(t*Math.PI/180));var t};var yc=function(t,n,u){this.z=t,this.x=n,this.y=u,this.key=ah(0,t,t,n,u)};yc.prototype.equals=function(t){return this.z===t.z&&this.x===t.x&&this.y===t.y},yc.prototype.url=function(t,n){var u,g,_,w,S,D=(g=this.y,_=this.z,w=Fh(256*(u=this.x),256*(g=Math.pow(2,_)-g-1),_),S=Fh(256*(u+1),256*(g+1),_),w[0]+","+w[1]+","+S[0]+","+S[1]),z=function(q,G,J){for(var ut,mt="",zt=q;zt>0;zt--)mt+=(G&(ut=1<<zt-1)?1:0)+(J&ut?2:0);return mt}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===n?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",z).replace("{bbox-epsg-3857}",D)},yc.prototype.getTilePoint=function(t){var n=Math.pow(2,this.z);return new Nt(8192*(t.x*n-this.x),8192*(t.y*n-this.y))},yc.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var If=function(t,n){this.wrap=t,this.canonical=n,this.key=ah(t,n.z,n.z,n.x,n.y)},is=function(t,n,u,g,_){this.overscaledZ=t,this.wrap=n,this.canonical=new yc(u,+g,+_),this.key=ah(n,t,u,g,_)};function ah(t,n,u,g,_){(t*=2)<0&&(t=-1*t-1);var w=1<<u;return(w*w*t+w*_+g).toString(36)+u.toString(36)+n.toString(36)}is.prototype.equals=function(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)},is.prototype.scaledTo=function(t){var n=this.canonical.z-t;return t>this.canonical.z?new is(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new is(t,this.wrap,t,this.canonical.x>>n,this.canonical.y>>n)},is.prototype.calculateScaledKey=function(t,n){var u=this.canonical.z-t;return t>this.canonical.z?ah(this.wrap*+n,t,this.canonical.z,this.canonical.x,this.canonical.y):ah(this.wrap*+n,t,t,this.canonical.x>>u,this.canonical.y>>u)},is.prototype.isChildOf=function(t){if(t.wrap!==this.wrap)return!1;var n=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>n&&t.canonical.y===this.canonical.y>>n},is.prototype.children=function(t){if(this.overscaledZ>=t)return[new is(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var n=this.canonical.z+1,u=2*this.canonical.x,g=2*this.canonical.y;return[new is(n,this.wrap,n,u,g),new is(n,this.wrap,n,u+1,g),new is(n,this.wrap,n,u,g+1),new is(n,this.wrap,n,u+1,g+1)]},is.prototype.isLessThan=function(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))},is.prototype.wrapped=function(){return new is(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},is.prototype.unwrapTo=function(t){return new is(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)},is.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},is.prototype.toUnwrapped=function(){return new If(this.wrap,this.canonical)},is.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},is.prototype.getTilePoint=function(t){return this.canonical.getTilePoint(new mc(t.x-this.wrap,t.y))},xr("CanonicalTileID",yc),xr("OverscaledTileID",is,{omit:["posMatrix"]});var Sl=function(t,n,u){if(this.uid=t,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(u&&"mapbox"!==u&&"terrarium"!==u)return Ct('"'+u+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=n.height;var g=this.dim=n.height-2;this.data=new Uint32Array(n.data.buffer),this.encoding=u||"mapbox";for(var _=0;_<g;_++)this.data[this._idx(-1,_)]=this.data[this._idx(0,_)],this.data[this._idx(g,_)]=this.data[this._idx(g-1,_)],this.data[this._idx(_,-1)]=this.data[this._idx(_,0)],this.data[this._idx(_,g)]=this.data[this._idx(_,g-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(g,-1)]=this.data[this._idx(g-1,0)],this.data[this._idx(-1,g)]=this.data[this._idx(0,g-1)],this.data[this._idx(g,g)]=this.data[this._idx(g-1,g-1)]};Sl.prototype.get=function(t,n){var u=new Uint8Array(this.data.buffer),g=4*this._idx(t,n);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(u[g],u[g+1],u[g+2])},Sl.prototype.getUnpackVector=function(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Sl.prototype._idx=function(t,n){if(t<-1||t>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(t+1)},Sl.prototype._unpackMapbox=function(t,n,u){return(256*t*256+256*n+u)/10-1e4},Sl.prototype._unpackTerrarium=function(t,n,u){return 256*t+n+u/256-32768},Sl.prototype.getPixels=function(){return new ma({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Sl.prototype.backfillBorder=function(t,n,u){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");var g=n*this.dim,_=n*this.dim+this.dim,w=u*this.dim,S=u*this.dim+this.dim;switch(n){case-1:g=_-1;break;case 1:_=g+1}switch(u){case-1:w=S-1;break;case 1:S=w+1}for(var D=-n*this.dim,z=-u*this.dim,q=w;q<S;q++)for(var G=g;G<_;G++)this.data[this._idx(G,q)]=t.data[this._idx(G+D,q+z)]},xr("DEMData",Sl);var zh=function(t){this._stringToNumber={},this._numberToString=[];for(var n=0;n<t.length;n++){var u=t[n];this._stringToNumber[u]=n,this._numberToString[n]=u}};zh.prototype.encode=function(t){return this._stringToNumber[t]},zh.prototype.decode=function(t){return this._numberToString[t]};var Bh=function(t,n,u,g,_){this.type="Feature",this._vectorTileFeature=t,t._z=n,t._x=u,t._y=g,this.properties=t.properties,this.id=_},Mp={geometry:{configurable:!0}};Mp.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Mp.geometry.set=function(t){this._geometry=t},Bh.prototype.toJSON=function(){var t={geometry:this.geometry};for(var n in this)"_geometry"!==n&&"_vectorTileFeature"!==n&&(t[n]=this[n]);return t},Object.defineProperties(Bh.prototype,Mp);var vc=function(){this.state={},this.stateChanges={},this.deletedStates={}};vc.prototype.updateState=function(t,n,u){var g=String(n);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][g]=this.stateChanges[t][g]||{},Z(this.stateChanges[t][g],u),null===this.deletedStates[t])for(var _ in this.deletedStates[t]={},this.state[t])_!==g&&(this.deletedStates[t][_]=null);else if(this.deletedStates[t]&&null===this.deletedStates[t][g])for(var w in this.deletedStates[t][g]={},this.state[t][g])u[w]||(this.deletedStates[t][g][w]=null);else for(var S in u)this.deletedStates[t]&&this.deletedStates[t][g]&&null===this.deletedStates[t][g][S]&&delete this.deletedStates[t][g][S]},vc.prototype.removeFeatureState=function(t,n,u){if(null!==this.deletedStates[t]){var g=String(n);if(this.deletedStates[t]=this.deletedStates[t]||{},u&&void 0!==n)null!==this.deletedStates[t][g]&&(this.deletedStates[t][g]=this.deletedStates[t][g]||{},this.deletedStates[t][g][u]=null);else if(void 0!==n)if(this.stateChanges[t]&&this.stateChanges[t][g])for(u in this.deletedStates[t][g]={},this.stateChanges[t][g])this.deletedStates[t][g][u]=null;else this.deletedStates[t][g]=null;else this.deletedStates[t]=null}},vc.prototype.getState=function(t,n){var u=String(n),g=Z({},(this.state[t]||{})[u],(this.stateChanges[t]||{})[u]);if(null===this.deletedStates[t])return{};if(this.deletedStates[t]){var _=this.deletedStates[t][n];if(null===_)return{};for(var w in _)delete g[w]}return g},vc.prototype.initializeTileState=function(t,n){t.setFeatureState(this.state,n)},vc.prototype.coalesceChanges=function(t,n){var u={};for(var g in this.stateChanges){this.state[g]=this.state[g]||{};var _={};for(var w in this.stateChanges[g])this.state[g][w]||(this.state[g][w]={}),Z(this.state[g][w],this.stateChanges[g][w]),_[w]=this.state[g][w];u[g]=_}for(var S in this.deletedStates){this.state[S]=this.state[S]||{};var D={};if(null===this.deletedStates[S])for(var z in this.state[S])D[z]={},this.state[S][z]={};else for(var q in this.deletedStates[S]){if(null===this.deletedStates[S][q])this.state[S][q]={};else for(var G=0,J=Object.keys(this.deletedStates[S][q]);G<J.length;G+=1)delete this.state[S][q][J[G]];D[q]=this.state[S][q]}u[S]=u[S]||{},Z(u[S],D)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(u).length)for(var ut in t)t[ut].setFeatureState(u,n)};var vl=function(t,n){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new ao(8192,16,0),this.grid3D=new ao(8192,16,0),this.featureIndexArray=new vt,this.promoteId=n};function Mf(t,n,u,g,_){return et(t,function(w,S){var D=n instanceof Eu?n.get(S):null;return D&&D.evaluate?D.evaluate(u,g,_):D})}function _c(t){for(var n=1/0,u=1/0,g=-1/0,_=-1/0,w=0,S=t;w<S.length;w+=1){var D=S[w];n=Math.min(n,D.x),u=Math.min(u,D.y),g=Math.max(g,D.x),_=Math.max(_,D.y)}return{minX:n,minY:u,maxX:g,maxY:_}}function Uc(t,n){return n-t}vl.prototype.insert=function(t,n,u,g,_,w){var S=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,g,_);for(var D=w?this.grid3D:this.grid,z=0;z<n.length;z++){for(var q=n[z],G=[1/0,1/0,-1/0,-1/0],J=0;J<q.length;J++){var ut=q[J];G[0]=Math.min(G[0],ut.x),G[1]=Math.min(G[1],ut.y),G[2]=Math.max(G[2],ut.x),G[3]=Math.max(G[3],ut.y)}G[0]<8192&&G[1]<8192&&G[2]>=0&&G[3]>=0&&D.insert(S,G[0],G[1],G[2],G[3])}},vl.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Tc.VectorTile(new pp(this.rawTileData)).layers,this.sourceLayerCoder=new zh(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},vl.prototype.query=function(t,n,u,g){var _=this;this.loadVTLayers();for(var w=t.params||{},S=8192/t.tileSize/t.scale,D=Qa(w.filter),z=t.queryGeometry,q=t.queryPadding*S,G=_c(z),J=this.grid.query(G.minX-q,G.minY-q,G.maxX+q,G.maxY+q),ut=_c(t.cameraQueryGeometry),zt=0,Vt=this.grid3D.query(ut.minX-q,ut.minY-q,ut.maxX+q,ut.maxY+q,function(Re,Be,rr,wr){return function(Er,Hr,Ar,nn,Fr){for(var ii=0,Cn=Er;ii<Cn.length;ii+=1){var Yr=Cn[ii];if(Hr<=Yr.x&&Ar<=Yr.y&&nn>=Yr.x&&Fr>=Yr.y)return!0}var fi=[new Nt(Hr,Ar),new Nt(Hr,Fr),new Nt(nn,Fr),new Nt(nn,Ar)];if(Er.length>2)for(var Yn=0,ki=fi;Yn<ki.length;Yn+=1)if(il(Er,ki[Yn]))return!0;for(var sn=0;sn<Er.length-1;sn++)if(cc(Er[sn],Er[sn+1],fi))return!0;return!1}(t.cameraQueryGeometry,Re-q,Be-q,rr+q,wr+q)});zt<Vt.length;zt+=1)J.push(Vt[zt]);J.sort(Uc);for(var fe,ne={},Ee=function(Re){var Be=J[Re];if(Be!==fe){fe=Be;var rr=_.featureIndexArray.get(Be),wr=null;_.loadMatchingFeature(ne,rr.bucketIndex,rr.sourceLayerIndex,rr.featureIndex,D,w.layers,w.availableImages,n,u,g,function(Er,Hr,Ar){return wr||(wr=Ya(Er)),Hr.queryIntersectsFeature(z,Er,Ar,wr,_.z,t.transform,S,t.pixelPosMatrix)})}},Ce=0;Ce<J.length;Ce++)Ee(Ce);return ne},vl.prototype.loadMatchingFeature=function(t,n,u,g,_,w,S,D,z,q,G){var J=this.bucketLayerIDs[n];if(!w||function(Er,Hr){for(var Ar=0;Ar<Er.length;Ar++)if(Hr.indexOf(Er[Ar])>=0)return!0;return!1}(w,J)){var ut=this.sourceLayerCoder.decode(u),mt=this.vtLayers[ut].feature(g);if(_.needGeometry){var zt=Os(mt,!0);if(!_.filter(new mo(this.tileID.overscaledZ),zt,this.tileID.canonical))return}else if(!_.filter(new mo(this.tileID.overscaledZ),mt))return;for(var Vt=this.getId(mt,ut),fe=0;fe<J.length;fe++){var ne=J[fe];if(!(w&&w.indexOf(ne)<0)){var Ee=D[ne];if(Ee){var Ce={};void 0!==Vt&&q&&(Ce=q.getState(Ee.sourceLayer||"_geojsonTileLayer",Vt));var Re=Z({},z[ne]);Re.paint=Mf(Re.paint,Ee.paint,mt,Ce,S),Re.layout=Mf(Re.layout,Ee.layout,mt,Ce,S);var Be=!G||G(mt,Ee,Ce);if(Be){var rr=new Bh(mt,this.z,this.x,this.y,Vt);rr.layer=Re;var wr=t[ne];void 0===wr&&(wr=t[ne]=[]),wr.push({featureIndex:g,feature:rr,intersectionZ:Be})}}}}}},vl.prototype.lookupSymbolFeatures=function(t,n,u,g,_,w,S,D){var z={};this.loadVTLayers();for(var q=Qa(_),G=0,J=t;G<J.length;G+=1)this.loadMatchingFeature(z,u,g,J[G],q,w,S,D,n);return z},vl.prototype.hasLayer=function(t){for(var n=0,u=this.bucketLayerIDs;n<u.length;n+=1)for(var g=0,_=u[n];g<_.length;g+=1)if(t===_[g])return!0;return!1},vl.prototype.getId=function(t,n){var u=t.id;return this.promoteId&&"boolean"==typeof(u=t.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[n]])&&(u=Number(u)),u},xr("FeatureIndex",vl,{omit:["rawTileData","sourceLayerCoder"]});var vs=function(t,n){this.tileID=t,this.uid=$(),this.uses=0,this.tileSize=n,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};vs.prototype.registerFadeDuration=function(t){var n=t+this.timeAdded;n<Mr.now()||this.fadeEndTime&&n<this.fadeEndTime||(this.fadeEndTime=n)},vs.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},vs.prototype.loadVectorData=function(t,n,u){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){for(var g in t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(q,G){var J={};if(!G)return J;for(var ut=function(){var Vt=zt[mt],fe=Vt.layerIds.map(function(Ce){return G.getLayer(Ce)}).filter(Boolean);if(0!==fe.length){Vt.layers=fe,Vt.stateDependentLayerIds&&(Vt.stateDependentLayers=Vt.stateDependentLayerIds.map(function(Ce){return fe.filter(function(Re){return Re.id===Ce})[0]}));for(var ne=0,Ee=fe;ne<Ee.length;ne+=1)J[Ee[ne].id]=Vt}},mt=0,zt=q;mt<zt.length;mt+=1)ut();return J}(t.buckets,n.style),this.hasSymbolBuckets=!1,this.buckets){var _=this.buckets[g];if(_ instanceof Oo){if(this.hasSymbolBuckets=!0,!u)break;_.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var w in this.buckets){var S=this.buckets[w];if(S instanceof Oo&&S.hasRTLText){this.hasRTLText=!0,ai.isLoading()||ai.isLoaded()||"deferred"!==eu()||fl();break}}for(var D in this.queryPadding=0,this.buckets){var z=this.buckets[D];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(D).queryRadius(z))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new c},vs.prototype.unloadVectorData=function(){for(var t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},vs.prototype.getBucket=function(t){return this.buckets[t.id]},vs.prototype.upload=function(t){for(var n in this.buckets){var u=this.buckets[n];u.uploadPending()&&u.upload(t)}var g=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Nc(t,this.imageAtlas.image,g.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Nc(t,this.glyphAtlasImage,g.ALPHA),this.glyphAtlasImage=null)},vs.prototype.prepare=function(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)},vs.prototype.queryRenderedFeatures=function(t,n,u,g,_,w,S,D,z,q){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:g,cameraQueryGeometry:_,scale:w,tileSize:this.tileSize,pixelPosMatrix:q,transform:D,params:S,queryPadding:this.queryPadding*z},t,n,u):{}},vs.prototype.querySourceFeatures=function(t,n){var u=this.latestFeatureIndex;if(u&&u.rawTileData){var g=u.loadVTLayers(),_=n?n.sourceLayer:"",w=g._geojsonTileLayer||g[_];if(w)for(var S=Qa(n&&n.filter),D=this.tileID.canonical,z=D.z,q=D.x,G=D.y,J={z,x:q,y:G},ut=0;ut<w.length;ut++){var mt=w.feature(ut);if(S.needGeometry){var zt=Os(mt,!0);if(!S.filter(new mo(this.tileID.overscaledZ),zt,this.tileID.canonical))continue}else if(!S.filter(new mo(this.tileID.overscaledZ),mt))continue;var Vt=u.getId(mt,_),fe=new Bh(mt,z,q,G,Vt);fe.tile=J,t.push(fe)}}},vs.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},vs.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},vs.prototype.setExpiryData=function(t){var n=this.expirationTime;if(t.cacheControl){var u=Ie(t.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){var g=Date.now(),_=!1;if(this.expirationTime>g)_=!1;else if(n)if(this.expirationTime<n)_=!0;else{var w=this.expirationTime-n;w?this.expirationTime=g+Math.max(w,3e4):_=!0}else _=!0;_?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},vs.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},vs.prototype.setFeatureState=function(t,n){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(t).length){var u=this.latestFeatureIndex.loadVTLayers();for(var g in this.buckets)if(n.style.hasLayer(g)){var _=this.buckets[g],w=_.layers[0].sourceLayer||"_geojsonTileLayer",S=u[w],D=t[w];if(S&&D&&0!==Object.keys(D).length){_.update(D,S,this.imageAtlas&&this.imageAtlas.patternPositions||{});var z=n&&n.style&&n.style.getLayer(g);z&&(this.queryPadding=Math.max(this.queryPadding,z.queryRadius(_)))}}}},vs.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},vs.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Mr.now()},vs.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},vs.prototype.setHoldDuration=function(t){this.symbolFadeHoldUntil=Mr.now()+t},vs.prototype.setDependencies=function(t,n){for(var u={},g=0,_=n;g<_.length;g+=1)u[_[g]]=!0;this.dependencies[t]=u},vs.prototype.hasDependency=function(t,n){for(var u=0,g=t;u<g.length;u+=1){var _=this.dependencies[g[u]];if(_)for(var w=0,S=n;w<S.length;w+=1)if(_[S[w]])return!0}return!1};var Hl=qt.performance,Pp=function(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},Hl.mark(this._marks.start)};Pp.prototype.finish=function(){Hl.mark(this._marks.end);var t=Hl.getEntriesByName(this._marks.measure);return 0===t.length&&(Hl.measure(this._marks.measure,this._marks.start,this._marks.end),t=Hl.getEntriesByName(this._marks.measure),Hl.clearMarks(this._marks.start),Hl.clearMarks(this._marks.end),Hl.clearMeasures(this._marks.measure)),t},s.Actor=oh,s.AlphaImage=ns,s.CanonicalTileID=yc,s.CollisionBoxArray=c,s.Color=Jn,s.DEMData=Sl,s.DataConstantProperty=Tr,s.DictionaryCoder=zh,s.EXTENT=8192,s.ErrorEvent=me,s.EvaluationParameters=mo,s.Event=se,s.Evented=ue,s.FeatureIndex=vl,s.FillBucket=ml,s.FillExtrusionBucket=yl,s.ImageAtlas=Ah,s.ImagePosition=Th,s.LineBucket=Zr,s.LngLat=ko,s.LngLatBounds=Ta,s.MercatorCoordinate=mc,s.ONE_EM=24,s.OverscaledTileID=is,s.Point=Nt,s.Point$1=Nt,s.Properties=Ma,s.Protobuf=pp,s.RGBAImage=ma,s.RequestManager=vn,s.RequestPerformance=Pp,s.ResourceType=bi,s.SegmentVector=_t,s.SourceFeatureState=vc,s.StructArrayLayout1ui2=Mi,s.StructArrayLayout2f1f2i16=K,s.StructArrayLayout2i4=gs,s.StructArrayLayout3ui6=Qt,s.StructArrayLayout4i8=Io,s.SymbolBucket=Oo,s.Texture=Nc,s.Tile=vs,s.Transitionable=Ds,s.Uniform1f=fr,s.Uniform1i=br,s.Uniform2f=Br,s.Uniform3f=cn,s.Uniform4f=hn,s.UniformColor=rn,s.UniformMatrix4f=Ur,s.UnwrappedTileID=If,s.ValidationError=Ht,s.WritingMode=Du,s.ZoomHistory=Co,s.add=function(t,n,u){return t[0]=n[0]+u[0],t[1]=n[1]+u[1],t[2]=n[2]+u[2],t},s.addDynamicAttributes=bf,s.asyncAll=function(t,n,u){if(!t.length)return u(null,[]);var g=t.length,_=new Array(t.length),w=null;t.forEach(function(S,D){n(S,function(z,q){z&&(w=z),_[D]=q,0==--g&&u(w,_)})})},s.bezier=yt,s.bindAll=rt,s.browser=Mr,s.cacheEntryPossiblyAdded=function(t){++Mn>un&&(t.getActor().send("enforceCacheSizeLimit",pr),Mn=0)},s.clamp=Yt,s.clearTileCache=function(t){var n=qt.caches.delete("mapbox-tiles");t&&n.catch(t).then(function(){return t()})},s.clipLine=gf,s.clone=function(t){var n=new Oa(16);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n},s.clone$1=j,s.clone$2=function(t){var n=new Oa(3);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n},s.collisionCircleLayout=fd,s.config=lr,s.create=function(){var t=new Oa(16);return Oa!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},s.create$1=function(){var t=new Oa(9);return Oa!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t},s.create$2=function(){var t=new Oa(4);return Oa!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},s.createCommonjsModule=lt,s.createExpression=Fs,s.createLayout=bo,s.createStyleLayer=function(t){return"custom"===t.type?new wg(t):new Sf[t.type](t)},s.cross=function(t,n,u){var g=n[0],_=n[1],w=n[2],S=u[0],D=u[1],z=u[2];return t[0]=_*z-w*D,t[1]=w*S-g*z,t[2]=g*D-_*S,t},s.deepEqual=function t(n,u){if(Array.isArray(n)){if(!Array.isArray(u)||n.length!==u.length)return!1;for(var g=0;g<n.length;g++)if(!t(n[g],u[g]))return!1;return!0}if("object"==typeof n&&null!==n&&null!==u){if("object"!=typeof u||Object.keys(n).length!==Object.keys(u).length)return!1;for(var _ in n)if(!t(n[_],u[_]))return!1;return!0}return n===u},s.dot=function(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]},s.dot$1=function(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]+t[3]*n[3]},s.ease=xt,s.emitValidationErrors=ws,s.endsWith=H,s.enforceCacheSizeLimit=function(t){ei(),ce&&ce.then(function(n){n.keys().then(function(u){for(var g=0;g<u.length-t;g++)n.delete(u[g])})})},s.evaluateSizeForFeature=wd,s.evaluateSizeForZoom=Ed,s.evaluateVariableOffset=Td,s.evented=fs,s.extend=Z,s.featureFilter=Qa,s.filterObject=at,s.fromRotation=function(t,n){var u=Math.sin(n),g=Math.cos(n);return t[0]=g,t[1]=u,t[2]=0,t[3]=-u,t[4]=g,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},s.getAnchorAlignment=yp,s.getAnchorJustification=Nh,s.getArrayBuffer=wi,s.getImage=pt,s.getJSON=function(t,n){return or(Z(t,{type:"json"}),n)},s.getRTLTextPluginStatus=eu,s.getReferrer=oa,s.getVideo=function(t,n){var u,g,_=qt.document.createElement("video");_.muted=!0,_.onloadstart=function(){n(null,_)};for(var w=0;w<t.length;w++){var S=qt.document.createElement("source");u=t[w],g=void 0,(g=qt.document.createElement("a")).href=u,(g.protocol!==qt.document.location.protocol||g.host!==qt.document.location.host)&&(_.crossOrigin="Anonymous"),S.src=t[w],_.appendChild(S)}return{cancel:function(){}}},s.identity=pu,s.invert=function(t,n){var u=n[0],g=n[1],_=n[2],w=n[3],S=n[4],D=n[5],z=n[6],q=n[7],G=n[8],J=n[9],ut=n[10],mt=n[11],zt=n[12],Vt=n[13],fe=n[14],ne=n[15],Ee=u*D-g*S,Ce=u*z-_*S,Re=u*q-w*S,Be=g*z-_*D,rr=g*q-w*D,wr=_*q-w*z,Er=G*Vt-J*zt,Hr=G*fe-ut*zt,Ar=G*ne-mt*zt,nn=J*fe-ut*Vt,Fr=J*ne-mt*Vt,ii=ut*ne-mt*fe,Cn=Ee*ii-Ce*Fr+Re*nn+Be*Ar-rr*Hr+wr*Er;return Cn?(t[0]=(D*ii-z*Fr+q*nn)*(Cn=1/Cn),t[1]=(_*Fr-g*ii-w*nn)*Cn,t[2]=(Vt*wr-fe*rr+ne*Be)*Cn,t[3]=(ut*rr-J*wr-mt*Be)*Cn,t[4]=(z*Ar-S*ii-q*Hr)*Cn,t[5]=(u*ii-_*Ar+w*Hr)*Cn,t[6]=(fe*Re-zt*wr-ne*Ce)*Cn,t[7]=(G*wr-ut*Re+mt*Ce)*Cn,t[8]=(S*Fr-D*Ar+q*Er)*Cn,t[9]=(g*Ar-u*Fr-w*Er)*Cn,t[10]=(zt*rr-Vt*Re+ne*Ee)*Cn,t[11]=(J*Re-G*rr-mt*Ee)*Cn,t[12]=(D*Hr-S*nn-z*Er)*Cn,t[13]=(u*nn-g*Hr+_*Er)*Cn,t[14]=(Vt*Ce-zt*Be-fe*Ee)*Cn,t[15]=(G*Be-J*Ce+ut*Ee)*Cn,t):null},s.isChar=Cr,s.isMapboxURL=Un,s.keysDifference=function(t,n){var u=[];for(var g in t)g in n||u.push(g);return u},s.makeRequest=or,s.mapObject=et,s.mercatorXfromLng=Ip,s.mercatorYfromLat=Fc,s.mercatorZfromAltitude=zc,s.mul=Sh,s.multiply=Cc,s.mvt=Tc,s.nextPowerOfTwo=function(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},s.normalize=function(t,n){var u=n[0],g=n[1],_=n[2],w=u*u+g*g+_*_;return w>0&&(w=1/Math.sqrt(w)),t[0]=n[0]*w,t[1]=n[1]*w,t[2]=n[2]*w,t},s.number=io,s.offscreenCanvasSupported=on,s.ortho=function(t,n,u,g,_,w,S){var D=1/(n-u),z=1/(g-_),q=1/(w-S);return t[0]=-2*D,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*z,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*q,t[11]=0,t[12]=(n+u)*D,t[13]=(_+g)*z,t[14]=(S+w)*q,t[15]=1,t},s.parseGlyphPBF=function(t){return new pp(t).readFields(yd,[])},s.pbf=pp,s.performSymbolLayout=function(t,n,u,g,_,w,S){t.createArrays(),t.tilePixelRatio=8192/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;var D=t.layers[0].layout,z=t.layers[0]._unevaluatedLayout._values,q={};if("composite"===t.textSizeData.kind){var G=t.textSizeData,J=G.maxZoom;q.compositeTextSizes=[z["text-size"].possiblyEvaluate(new mo(G.minZoom),S),z["text-size"].possiblyEvaluate(new mo(J),S)]}if("composite"===t.iconSizeData.kind){var ut=t.iconSizeData,mt=ut.maxZoom;q.compositeIconSizes=[z["icon-size"].possiblyEvaluate(new mo(ut.minZoom),S),z["icon-size"].possiblyEvaluate(new mo(mt),S)]}q.layoutTextSize=z["text-size"].possiblyEvaluate(new mo(t.zoom+1),S),q.layoutIconSize=z["icon-size"].possiblyEvaluate(new mo(t.zoom+1),S),q.textMaxSize=z["text-size"].possiblyEvaluate(new mo(18));for(var zt=24*D.get("text-line-height"),Vt="map"===D.get("text-rotation-alignment")&&"point"!==D.get("symbol-placement"),fe=D.get("text-keep-upright"),ne=D.get("text-size"),Ee=function(){var Be=Re[Ce],rr=D.get("text-font").evaluate(Be,{},S).join(","),wr=ne.evaluate(Be,{},S),Er=q.layoutTextSize.evaluate(Be,{},S),Hr=q.layoutIconSize.evaluate(Be,{},S),Ar={horizontal:{},vertical:void 0},nn=Be.text,Fr=[0,0];if(nn){var ii=nn.toString(),Cn=24*D.get("text-letter-spacing").evaluate(Be,{},S),Yr=function(_i){for(var Go=0,Mo=_i;Go<Mo.length;Go+=1)if(Li=Mo[Go].charCodeAt(0),Cr.Arabic(Li)||Cr["Arabic Supplement"](Li)||Cr["Arabic Extended-A"](Li)||Cr["Arabic Presentation Forms-A"](Li)||Cr["Arabic Presentation Forms-B"](Li))return!1;var Li;return!0}(ii)?Cn:0,fi=D.get("text-anchor").evaluate(Be,{},S),Yn=D.get("text-variable-anchor");if(!Yn){var ki=D.get("text-radial-offset").evaluate(Be,{},S);Fr=ki?Td(fi,[24*ki,bp]):D.get("text-offset").evaluate(Be,{},S).map(function(_i){return 24*_i})}var sn=Vt?"center":D.get("text-justify").evaluate(Be,{},S),uo=D.get("symbol-placement"),la="point"===uo?24*D.get("text-max-width").evaluate(Be,{},S):0,ya=function(){t.allowVerticalPlacement&&Xo(ii)&&(Ar.vertical=Lh(nn,n,u,_,rr,la,zt,fi,"left",Yr,Fr,Du.vertical,!0,uo,Er,wr))};if(!Vt&&Yn){for(var va="auto"===sn?Yn.map(function(_i){return Nh(_i)}):[sn],ca=!1,ka=0;ka<va.length;ka++){var os=va[ka];if(!Ar.horizontal[os])if(ca)Ar.horizontal[os]=Ar.horizontal[0];else{var as=Lh(nn,n,u,_,rr,la,zt,"center",os,Yr,Fr,Du.horizontal,!1,uo,Er,wr);as&&(Ar.horizontal[os]=as,ca=1===as.positionedLines.length)}}ya()}else{"auto"===sn&&(sn=Nh(fi));var Vs=Lh(nn,n,u,_,rr,la,zt,fi,sn,Yr,Fr,Du.horizontal,!1,uo,Er,wr);Vs&&(Ar.horizontal[sn]=Vs),ya(),Xo(ii)&&Vt&&fe&&(Ar.vertical=Lh(nn,n,u,_,rr,la,zt,fi,sn,Yr,Fr,Du.vertical,!1,uo,Er,wr))}}var _i,Go,Li,du,js,Is=void 0,ou=!1;if(Be.icon&&Be.icon.name){var _a=g[Be.icon.name];_a&&(_i=_[Be.icon.name],Go=D.get("icon-offset").evaluate(Be,{},S),Li=yp(D.get("icon-anchor").evaluate(Be,{},S)),Is={image:_i,top:js=Go[1]-_i.displaySize[1]*Li.verticalAlign,bottom:js+_i.displaySize[1],left:du=Go[0]-_i.displaySize[0]*Li.horizontalAlign,right:du+_i.displaySize[0]},ou=_a.sdf,void 0===t.sdfIcons?t.sdfIcons=_a.sdf:t.sdfIcons!==_a.sdf&&Ct("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(_a.pixelRatio!==t.pixelRatio||0!==D.get("icon-rotate").constantOr(1))&&(t.iconsNeedLinear=!0))}var Ns=wp(Ar.horizontal)||Ar.vertical;t.iconsInText=!!Ns&&Ns.iconsInText,(Ns||Is)&&function(_i,Go,Mo,Li,du,js,Jo,ss,Zs,lo,Cl){var ku=js.textMaxSize.evaluate(Go,{});void 0===ku&&(ku=Jo);var Il,Ja=_i.layers[0].layout,Ul=Ja.get("icon-offset").evaluate(Go,{},Cl),_l=wp(Mo.horizontal),sh=Jo/24,qc=_i.tilePixelRatio*sh,Wu=_i.tilePixelRatio*ku/24,al=_i.tilePixelRatio*ss,ql=_i.tilePixelRatio*Ja.get("symbol-spacing"),uh=Ja.get("text-padding")*_i.tilePixelRatio,Ha=Ja.get("icon-padding")*_i.tilePixelRatio,Uh=Ja.get("text-max-angle")/180*Math.PI,Aa="map"===Ja.get("text-rotation-alignment")&&"point"!==Ja.get("symbol-placement"),gu="map"===Ja.get("icon-rotation-alignment")&&"point"!==Ja.get("symbol-placement"),sl=Ja.get("symbol-placement"),Ml=ql/2,Wl=Ja.get("icon-text-fit");Li&&"none"!==Wl&&(_i.allowVerticalPlacement&&Mo.vertical&&(Il=hf(Li,Mo.vertical,Wl,Ja.get("icon-text-fit-padding"),Ul,sh)),_l&&(Li=hf(Li,_l,Wl,Ja.get("icon-text-fit-padding"),Ul,sh)));var Vo=function(Ld,$l){$l.x<0||$l.x>=8192||$l.y<0||$l.y>=8192||function(pa,cl,Pf,Pl,ph,Jh,Ku,Tl,Hh,fh,dh,Ap,Lp,Wh,Kh,gh,Dd,Od,$h,us,La,Wa,$u,Su,Tf){var Dp,hl,Al,Qu,Vu,ju=pa.addToLineVertexArray(cl,Pf),Qh=0,Op=0,kp=0,Np=0,tp=-1,Rp=-1,Vl={},Zu=ie(""),Fp=0,ep=0;if(void 0===Tl._unevaluatedLayout.getValue("text-radial-offset")?(Fp=(Dp=Tl.layout.get("text-offset").evaluate(La,{},Su).map(function(bh){return 24*bh}))[0],ep=Dp[1]):(Fp=24*Tl.layout.get("text-radial-offset").evaluate(La,{},Su),ep=bp),pa.allowVerticalPlacement&&Pl.vertical){var kd=Tl.layout.get("text-rotate").evaluate(La,{},Su)+90;Qu=new kh(Hh,cl,fh,dh,Ap,Pl.vertical,Lp,Wh,Kh,kd),Ku&&(Vu=new kh(Hh,cl,fh,dh,Ap,Ku,Dd,Od,Kh,kd))}if(ph){var bc=Tl.layout.get("icon-rotate").evaluate(La,{}),mh="none"!==Tl.layout.get("icon-text-fit"),yh=Id(ph,bc,$u,mh),jc=Ku?Id(Ku,bc,$u,mh):void 0;Al=new kh(Hh,cl,fh,dh,Ap,ph,Dd,Od,!1,bc),Qh=4*yh.length;var vh=pa.iconSizeData,Ql=null;"source"===vh.kind?(Ql=[128*Tl.layout.get("icon-size").evaluate(La,{})])[0]>32640&&Ct(pa.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):"composite"===vh.kind&&((Ql=[128*Wa.compositeIconSizes[0].evaluate(La,{},Su),128*Wa.compositeIconSizes[1].evaluate(La,{},Su)])[0]>32640||Ql[1]>32640)&&Ct(pa.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),pa.addSymbols(pa.icon,yh,Ql,us,$h,La,!1,cl,ju.lineStartIndex,ju.lineLength,-1,Su),tp=pa.icon.placedSymbolArray.length-1,jc&&(Op=4*jc.length,pa.addSymbols(pa.icon,jc,Ql,us,$h,La,Du.vertical,cl,ju.lineStartIndex,ju.lineLength,-1,Su),Rp=pa.icon.placedSymbolArray.length-1)}for(var _h in Pl.horizontal){var wc=Pl.horizontal[_h];if(!hl){Zu=ie(wc.text);var zp=Tl.layout.get("text-rotate").evaluate(La,{},Su);hl=new kh(Hh,cl,fh,dh,Ap,wc,Lp,Wh,Kh,zp)}var rp=1===wc.positionedLines.length;if(kp+=vf(pa,cl,wc,Jh,Tl,Kh,La,gh,ju,Pl.vertical?Du.horizontal:Du.horizontalOnly,rp?Object.keys(Pl.horizontal):[_h],Vl,tp,Wa,Su),rp)break}Pl.vertical&&(Np+=vf(pa,cl,Pl.vertical,Jh,Tl,Kh,La,gh,ju,Du.vertical,["vertical"],Vl,Rp,Wa,Su));var Bp=hl?hl.boxStartIndex:pa.collisionBoxArray.length,Af=hl?hl.boxEndIndex:pa.collisionBoxArray.length,Lf=Qu?Qu.boxStartIndex:pa.collisionBoxArray.length,Nu=Qu?Qu.boxEndIndex:pa.collisionBoxArray.length,Ru=Al?Al.boxStartIndex:pa.collisionBoxArray.length,Fu=Al?Al.boxEndIndex:pa.collisionBoxArray.length,xl=Vu?Vu.boxStartIndex:pa.collisionBoxArray.length,Up=Vu?Vu.boxEndIndex:pa.collisionBoxArray.length,Xu=-1,xh=function(bh,qp){return bh&&bh.circleDiameter?Math.max(bh.circleDiameter,qp):qp};Xu=xh(hl,Xu),Xu=xh(Qu,Xu),Xu=xh(Al,Xu);var Df=(Xu=xh(Vu,Xu))>-1?1:0;Df&&(Xu*=Tf/24),pa.glyphOffsetArray.length>=Oo.MAX_GLYPHS&&Ct("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==La.sortKey&&pa.addToSortKeyRanges(pa.symbolInstances.length,La.sortKey),pa.symbolInstances.emplaceBack(cl.x,cl.y,Vl.right>=0?Vl.right:-1,Vl.center>=0?Vl.center:-1,Vl.left>=0?Vl.left:-1,Vl.vertical||-1,tp,Rp,Zu,Bp,Af,Lf,Nu,Ru,Fu,xl,Up,fh,kp,Np,Qh,Op,Df,0,Lp,Fp,ep,Xu)}(_i,$l,Ld,Mo,Li,du,Il,_i.layers[0],_i.collisionBoxArray,Go.index,Go.sourceLayerIndex,_i.index,qc,uh,Aa,Zs,al,Ha,gu,Ul,Go,js,lo,Cl,Jo)};if("line"===sl)for(var Xs=0,Kl=gf(Go.geometry,0,0,8192,8192);Xs<Kl.length;Xs+=1)for(var Gl=Kl[Xs],yo=0,qh=Cd(Gl,ql,Uh,Mo.vertical||_l,Li,24,Wu,_i.overscaling,8192);yo<qh.length;yo+=1){var lh=qh[yo];_l&&_f(_i,_l.text,Ml,lh)||Vo(Gl,lh)}else if("line-center"===sl)for(var Gh=0,Gc=Go.geometry;Gh<Gc.length;Gh+=1){var Vh=Gc[Gh];if(Vh.length>1){var Ni=Sd(Vh,Uh,Mo.vertical||_l,Li,24,Wu);Ni&&Vo(Vh,Ni)}}else if("Polygon"===Go.type)for(var ch=0,ul=sp(Go.geometry,0);ch<ul.length;ch+=1){var xc=ul[ch],hh=Pd(xc,16);Vo(xc[0],new Oc(hh.x,hh.y,0))}else if("LineString"===Go.type)for(var ll=0,jh=Go.geometry;ll<jh.length;ll+=1){var ha=jh[ll];Vo(ha,new Oc(ha[0].x,ha[0].y,0))}else if("Point"===Go.type)for(var Vc=0,Tp=Go.geometry;Vc<Tp.length;Vc+=1)for(var Zh=0,Xh=Tp[Vc];Zh<Xh.length;Zh+=1){var Yh=Xh[Zh];Vo([Yh],new Oc(Yh.x,Yh.y,0))}}(t,Be,Ar,Is,g,q,Er,Hr,Fr,ou,S)},Ce=0,Re=t.features;Ce<Re.length;Ce+=1)Ee();w&&t.generateCollisionDebugBuffers()},s.perspective=function(t,n,u,g,_){var w,S=1/Math.tan(n/2);return t[0]=S/u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=S,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=_&&_!==1/0?(t[10]=(_+g)*(w=1/(g-_)),t[14]=2*_*g*w):(t[10]=-1,t[14]=-2*g),t},s.pick=function(t,n){for(var u={},g=0;g<n.length;g++){var _=n[g];_ in t&&(u[_]=t[_])}return u},s.plugin=ai,s.polygonIntersectsPolygon=ks,s.postMapLoadEvent=Kr,s.postTurnstileEvent=Xe,s.potpack=lf,s.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],s.register=xr,s.registerForPluginStateChange=function(t){return t({pluginStatus:Sa,pluginURL:Uo}),fs.on("pluginStateChange",t),t},s.renderColorRamp=Gs,s.rotate=function(t,n,u){var g=n[0],_=n[1],w=n[2],S=n[3],D=Math.sin(u),z=Math.cos(u);return t[0]=g*z+w*D,t[1]=_*z+S*D,t[2]=g*-D+w*z,t[3]=_*-D+S*z,t},s.rotateX=function(t,n,u){var g=Math.sin(u),_=Math.cos(u),w=n[4],S=n[5],D=n[6],z=n[7],q=n[8],G=n[9],J=n[10],ut=n[11];return n!==t&&(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[4]=w*_+q*g,t[5]=S*_+G*g,t[6]=D*_+J*g,t[7]=z*_+ut*g,t[8]=q*_-w*g,t[9]=G*_-S*g,t[10]=J*_-D*g,t[11]=ut*_-z*g,t},s.rotateZ=function(t,n,u){var g=Math.sin(u),_=Math.cos(u),w=n[0],S=n[1],D=n[2],z=n[3],q=n[4],G=n[5],J=n[6],ut=n[7];return n!==t&&(t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=w*_+q*g,t[1]=S*_+G*g,t[2]=D*_+J*g,t[3]=z*_+ut*g,t[4]=q*_-w*g,t[5]=G*_-S*g,t[6]=J*_-D*g,t[7]=ut*_-z*g,t},s.scale=function(t,n,u){var g=u[0],_=u[1],w=u[2];return t[0]=n[0]*g,t[1]=n[1]*g,t[2]=n[2]*g,t[3]=n[3]*g,t[4]=n[4]*_,t[5]=n[5]*_,t[6]=n[6]*_,t[7]=n[7]*_,t[8]=n[8]*w,t[9]=n[9]*w,t[10]=n[10]*w,t[11]=n[11]*w,t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t},s.scale$1=function(t,n,u){return t[0]=n[0]*u,t[1]=n[1]*u,t[2]=n[2]*u,t[3]=n[3]*u,t},s.scale$2=function(t,n,u){return t[0]=n[0]*u,t[1]=n[1]*u,t[2]=n[2]*u,t},s.setCacheLimits=function(t,n){pr=t,un=n},s.setRTLTextPlugin=function(t,n,u){if(void 0===u&&(u=!1),"deferred"===Sa||"loading"===Sa||"loaded"===Sa)throw new Error("setRTLTextPlugin cannot be called multiple times.");Uo=Mr.resolveURL(t),Sa="deferred",rl=n,bl(),u||fl()},s.sphericalToCartesian=function(t){var n=t[0],u=t[1],g=t[2];return u+=90,u*=Math.PI/180,g*=Math.PI/180,{x:n*Math.cos(u)*Math.sin(g),y:n*Math.sin(u)*Math.sin(g),z:n*Math.cos(g)}},s.sqrLen=function(t){var n=t[0],u=t[1];return n*n+u*u},s.styleSpec=Dt,s.sub=function(t,n,u){return t[0]=n[0]-u[0],t[1]=n[1]-u[1],t[2]=n[2]-u[2],t},s.symbolSize=gg,s.transformMat3=function(t,n,u){var g=n[0],_=n[1],w=n[2];return t[0]=g*u[0]+_*u[3]+w*u[6],t[1]=g*u[1]+_*u[4]+w*u[7],t[2]=g*u[2]+_*u[5]+w*u[8],t},s.transformMat4=hc,s.translate=function(t,n,u){var g,_,w,S,D,z,q,G,J,ut,mt,zt,Vt=u[0],fe=u[1],ne=u[2];return n===t?(t[12]=n[0]*Vt+n[4]*fe+n[8]*ne+n[12],t[13]=n[1]*Vt+n[5]*fe+n[9]*ne+n[13],t[14]=n[2]*Vt+n[6]*fe+n[10]*ne+n[14],t[15]=n[3]*Vt+n[7]*fe+n[11]*ne+n[15]):(_=n[1],w=n[2],S=n[3],D=n[4],z=n[5],q=n[6],G=n[7],J=n[8],ut=n[9],mt=n[10],zt=n[11],t[0]=g=n[0],t[1]=_,t[2]=w,t[3]=S,t[4]=D,t[5]=z,t[6]=q,t[7]=G,t[8]=J,t[9]=ut,t[10]=mt,t[11]=zt,t[12]=g*Vt+D*fe+J*ne+n[12],t[13]=_*Vt+z*fe+ut*ne+n[13],t[14]=w*Vt+q*fe+mt*ne+n[14],t[15]=S*Vt+G*fe+zt*ne+n[15]),t},s.triggerPluginCompletionEvent=Xa,s.uniqueId=$,s.validateCustomStyleLayer=function(t){var n=[],u=t.id;return void 0===u&&n.push({message:"layers."+u+': missing required property "id"'}),void 0===t.render&&n.push({message:"layers."+u+': missing required method "render"'}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&n.push({message:"layers."+u+': property "renderingMode" must be either "2d" or "3d"'}),n},s.validateLight=es,s.validateStyle=ts,s.values=function(t){var n=[];for(var u in t)n.push(t[u]);return n},s.vectorTile=Tc,s.version="1.15.3",s.warnOnce=Ct,s.webpSupported=kr,s.window=qt,s.wrap=ge}),Tt(0,function(s){function lt(Y){var W=typeof Y;if("number"===W||"boolean"===W||"string"===W||null==Y)return JSON.stringify(Y);if(Array.isArray(Y)){for(var pt="[",bt=0,Ft=Y;bt<Ft.length;bt+=1)pt+=lt(Ft[bt])+",";return pt+"]"}for(var se=Object.keys(Y).sort(),me="{",ue=0;ue<se.length;ue++)me+=JSON.stringify(se[ue])+":"+lt(Y[se[ue]])+",";return me+"}"}function ht(Y){for(var W="",pt=0,bt=s.refProperties;pt<bt.length;pt+=1)W+="/"+lt(Y[bt[pt]]);return W}var Lt=function(Y){this.keyCache={},Y&&this.replace(Y)};Lt.prototype.replace=function(Y){this._layerConfigs={},this._layers={},this.update(Y,[])},Lt.prototype.update=function(Y,W){for(var pt=this,bt=0,Ft=Y;bt<Ft.length;bt+=1){var se=Ft[bt];this._layerConfigs[se.id]=se;var me=this._layers[se.id]=s.createStyleLayer(se);me._featureFilter=s.featureFilter(me.filter),this.keyCache[se.id]&&delete this.keyCache[se.id]}for(var ue=0,Dt=W;ue<Dt.length;ue+=1){var Ht=Dt[ue];delete this.keyCache[Ht],delete this._layerConfigs[Ht],delete this._layers[Ht]}this.familiesBySource={};for(var ir=0,mr=function(yr,Ke){for(var wn={},an=0;an<yr.length;an++){var Lr=Ke&&Ke[yr[an].id]||ht(yr[an]);Ke&&(Ke[yr[an].id]=Lr);var _n=wn[Lr];_n||(_n=wn[Lr]=[]),_n.push(yr[an])}var Nr=[];for(var Gi in wn)Nr.push(wn[Gi]);return Nr}(s.values(this._layerConfigs),this.keyCache);ir<mr.length;ir+=1){var Te=mr[ir].map(function(yr){return pt._layers[yr.id]}),Ye=Te[0];if("none"!==Ye.visibility){var vr=Ye.source||"",_r=this.familiesBySource[vr];_r||(_r=this.familiesBySource[vr]={});var Pr=Ye.sourceLayer||"_geojsonTileLayer",He=_r[Pr];He||(He=_r[Pr]=[]),He.push(Te)}}};var Nt=function(Y){var W={},pt=[];for(var bt in Y){var Ft=Y[bt],se=W[bt]={};for(var me in Ft){var ue=Ft[+me];if(ue&&0!==ue.bitmap.width&&0!==ue.bitmap.height){var Dt={x:0,y:0,w:ue.bitmap.width+2,h:ue.bitmap.height+2};pt.push(Dt),se[me]={rect:Dt,metrics:ue.metrics}}}}var Ht=s.potpack(pt),ir=new s.AlphaImage({width:Ht.w||1,height:Ht.h||1});for(var mr in Y){var Te=Y[mr];for(var Ye in Te){var vr=Te[+Ye];if(vr&&0!==vr.bitmap.width&&0!==vr.bitmap.height){var _r=W[mr][Ye].rect;s.AlphaImage.copy(vr.bitmap,ir,{x:0,y:0},{x:_r.x+1,y:_r.y+1},vr.bitmap)}}}this.image=ir,this.positions=W};s.register("GlyphAtlas",Nt);var $t=function(Y){this.tileID=new s.OverscaledTileID(Y.tileID.overscaledZ,Y.tileID.wrap,Y.tileID.canonical.z,Y.tileID.canonical.x,Y.tileID.canonical.y),this.uid=Y.uid,this.zoom=Y.zoom,this.pixelRatio=Y.pixelRatio,this.tileSize=Y.tileSize,this.source=Y.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Y.showCollisionBoxes,this.collectResourceTiming=!!Y.collectResourceTiming,this.returnDependencies=!!Y.returnDependencies,this.promoteId=Y.promoteId};function qt(Y,W,pt){for(var bt=new s.EvaluationParameters(W),Ft=0,se=Y;Ft<se.length;Ft+=1)se[Ft].recalculate(bt,pt)}function _e(Y,W){var pt=s.getArrayBuffer(Y.request,function(bt,Ft,se,me){bt?W(bt):Ft&&W(null,{vectorTile:new s.vectorTile.VectorTile(new s.pbf(Ft)),rawData:Ft,cacheControl:se,expires:me})});return function(){pt.cancel(),W()}}$t.prototype.parse=function(Y,W,pt,bt,Ft){var se=this;this.status="parsing",this.data=Y,this.collisionBoxArray=new s.CollisionBoxArray;var me=new s.DictionaryCoder(Object.keys(Y.layers).sort()),ue=new s.FeatureIndex(this.tileID,this.promoteId);ue.bucketLayerIDs=[];var Dt,Ht,ir,mr,Te={},Ye={featureIndex:ue,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:pt},vr=W.familiesBySource[this.source];for(var _r in vr){var Pr=Y.layers[_r];if(Pr){1===Pr.version&&s.warnOnce('Vector tile source "'+this.source+'" layer "'+_r+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var He=me.encode(_r),yr=[],Ke=0;Ke<Pr.length;Ke++){var wn=Pr.feature(Ke),an=ue.getId(wn,_r);yr.push({feature:wn,id:an,index:Ke,sourceLayerIndex:He})}for(var Lr=0,_n=vr[_r];Lr<_n.length;Lr+=1){var Nr=_n[Lr],Gi=Nr[0];Gi.minzoom&&this.zoom<Math.floor(Gi.minzoom)||Gi.maxzoom&&this.zoom>=Gi.maxzoom||"none"!==Gi.visibility&&(qt(Nr,this.zoom,pt),(Te[Gi.id]=Gi.createBucket({index:ue.bucketLayerIDs.length,layers:Nr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:He,sourceID:this.source})).populate(yr,Ye,this.tileID.canonical),ue.bucketLayerIDs.push(Nr.map(function(li){return li.id})))}}}var ri=s.mapObject(Ye.glyphDependencies,function(li){return Object.keys(li).map(Number)});Object.keys(ri).length?bt.send("getGlyphs",{uid:this.uid,stacks:ri},function(li,Gr){Dt||(Dt=li,Ht=Gr,ho.call(se))}):Ht={};var qn=Object.keys(Ye.iconDependencies);qn.length?bt.send("getImages",{icons:qn,source:this.source,tileID:this.tileID,type:"icons"},function(li,Gr){Dt||(Dt=li,ir=Gr,ho.call(se))}):ir={};var En=Object.keys(Ye.patternDependencies);function ho(){if(Dt)return Ft(Dt);if(Ht&&ir&&mr){var li=new Nt(Ht),Gr=new s.ImageAtlas(ir,mr);for(var fa in Te){var Jn=Te[fa];Jn instanceof s.SymbolBucket?(qt(Jn.layers,this.zoom,pt),s.performSymbolLayout(Jn,Ht,li.positions,ir,Gr.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Jn.hasPattern&&(Jn instanceof s.LineBucket||Jn instanceof s.FillBucket||Jn instanceof s.FillExtrusionBucket)&&(qt(Jn.layers,this.zoom,pt),Jn.addFeatures(Ye,this.tileID.canonical,Gr.patternPositions))}this.status="done",Ft(null,{buckets:s.values(Te).filter(function(Ra){return!Ra.isEmpty()}),featureIndex:ue,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:li.image,imageAtlas:Gr,glyphMap:this.returnDependencies?Ht:null,iconMap:this.returnDependencies?ir:null,glyphPositions:this.returnDependencies?li.positions:null})}}En.length?bt.send("getImages",{icons:En,source:this.source,tileID:this.tileID,type:"patterns"},function(li,Gr){Dt||(Dt=li,mr=Gr,ho.call(se))}):mr={},ho.call(this)};var yt=function(Y,W,pt,bt){this.actor=Y,this.layerIndex=W,this.availableImages=pt,this.loadVectorData=bt||_e,this.loading={},this.loaded={}};yt.prototype.loadTile=function(Y,W){var pt=this,bt=Y.uid;this.loading||(this.loading={});var Ft=!!(Y&&Y.request&&Y.request.collectResourceTiming)&&new s.RequestPerformance(Y.request),se=this.loading[bt]=new $t(Y);se.abort=this.loadVectorData(Y,function(me,ue){if(delete pt.loading[bt],me||!ue)return se.status="done",pt.loaded[bt]=se,W(me);var Dt=ue.rawData,Ht={};ue.expires&&(Ht.expires=ue.expires),ue.cacheControl&&(Ht.cacheControl=ue.cacheControl);var ir={};if(Ft){var mr=Ft.finish();mr&&(ir.resourceTiming=JSON.parse(JSON.stringify(mr)))}se.vectorTile=ue.vectorTile,se.parse(ue.vectorTile,pt.layerIndex,pt.availableImages,pt.actor,function(Te,Ye){if(Te||!Ye)return W(Te);W(null,s.extend({rawTileData:Dt.slice(0)},Ye,Ht,ir))}),pt.loaded=pt.loaded||{},pt.loaded[bt]=se})},yt.prototype.reloadTile=function(Y,W){var pt=this,bt=this.loaded,Ft=Y.uid,se=this;if(bt&&bt[Ft]){var me=bt[Ft];me.showCollisionBoxes=Y.showCollisionBoxes;var ue=function(Dt,Ht){var ir=me.reloadCallback;ir&&(delete me.reloadCallback,me.parse(me.vectorTile,se.layerIndex,pt.availableImages,se.actor,ir)),W(Dt,Ht)};"parsing"===me.status?me.reloadCallback=ue:"done"===me.status&&(me.vectorTile?me.parse(me.vectorTile,this.layerIndex,this.availableImages,this.actor,ue):ue())}},yt.prototype.abortTile=function(Y,W){var pt=this.loading,bt=Y.uid;pt&&pt[bt]&&pt[bt].abort&&(pt[bt].abort(),delete pt[bt]),W()},yt.prototype.removeTile=function(Y,W){var pt=this.loaded,bt=Y.uid;pt&&pt[bt]&&delete pt[bt],W()};var xt=s.window.ImageBitmap,Yt=function(){this.loaded={}};function ge(Y,W){if(0!==Y.length){Z(Y[0],W);for(var pt=1;pt<Y.length;pt++)Z(Y[pt],!W)}}function Z(Y,W){for(var pt=0,bt=0,Ft=Y.length,se=Ft-1;bt<Ft;se=bt++)pt+=(Y[bt][0]-Y[se][0])*(Y[se][1]+Y[bt][1]);pt>=0!=!!W&&Y.reverse()}Yt.prototype.loadTile=function(Y,W){var pt=Y.uid,bt=Y.encoding,Ft=Y.rawImageData,se=xt&&Ft instanceof xt?this.getImageData(Ft):Ft,me=new s.DEMData(pt,se,bt);this.loaded=this.loaded||{},this.loaded[pt]=me,W(null,me)},Yt.prototype.getImageData=function(Y){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Y.width,Y.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=Y.width,this.offscreenCanvas.height=Y.height,this.offscreenCanvasContext.drawImage(Y,0,0,Y.width,Y.height);var W=this.offscreenCanvasContext.getImageData(-1,-1,Y.width+2,Y.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new s.RGBAImage({width:W.width,height:W.height},W.data)},Yt.prototype.removeTile=function(Y){var W=this.loaded,pt=Y.uid;W&&W[pt]&&delete W[pt]};var it=s.vectorTile.VectorTileFeature.prototype.toGeoJSON,$=function(Y){this._feature=Y,this.extent=s.EXTENT,this.type=Y.type,this.properties=Y.tags,"id"in Y&&!isNaN(Y.id)&&(this.id=parseInt(Y.id,10))};$.prototype.loadGeometry=function(){if(1===this._feature.type){for(var Y=[],W=0,pt=this._feature.geometry;W<pt.length;W+=1){var bt=pt[W];Y.push([new s.Point$1(bt[0],bt[1])])}return Y}for(var Ft=[],se=0,me=this._feature.geometry;se<me.length;se+=1){for(var ue=[],Dt=0,Ht=me[se];Dt<Ht.length;Dt+=1){var ir=Ht[Dt];ue.push(new s.Point$1(ir[0],ir[1]))}Ft.push(ue)}return Ft},$.prototype.toGeoJSON=function(Y,W,pt){return it.call(this,Y,W,pt)};var tt=function(Y){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=s.EXTENT,this.length=Y.length,this._features=Y};tt.prototype.feature=function(Y){return new $(this._features[Y])};var X=s.vectorTile.VectorTileFeature,rt=H;function H(Y,W){this.options=W||{},this.features=Y,this.length=Y.length}function et(Y,W){this.id="number"==typeof Y.id?Y.id:void 0,this.type=Y.type,this.rawGeometry=1===Y.type?[Y.geometry]:Y.geometry,this.properties=Y.tags,this.extent=W||4096}H.prototype.feature=function(Y){return new et(this.features[Y],this.options.extent)},et.prototype.loadGeometry=function(){var Y=this.rawGeometry;this.geometry=[];for(var W=0;W<Y.length;W++){for(var pt=Y[W],bt=[],Ft=0;Ft<pt.length;Ft++)bt.push(new s.Point$1(pt[Ft][0],pt[Ft][1]));this.geometry.push(bt)}return this.geometry},et.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Y=this.geometry,W=1/0,pt=-1/0,bt=1/0,Ft=-1/0,se=0;se<Y.length;se++)for(var me=Y[se],ue=0;ue<me.length;ue++){var Dt=me[ue];W=Math.min(W,Dt.x),pt=Math.max(pt,Dt.x),bt=Math.min(bt,Dt.y),Ft=Math.max(Ft,Dt.y)}return[W,bt,pt,Ft]},et.prototype.toGeoJSON=X.prototype.toGeoJSON;var at=Wt,j=rt;function Wt(Y){var W=new s.pbf;return function(pt,bt){for(var Ft in pt.layers)bt.writeMessage(3,Ct,pt.layers[Ft])}(Y,W),W.finish()}function Ct(Y,W){var pt;W.writeVarintField(15,Y.version||1),W.writeStringField(1,Y.name||""),W.writeVarintField(5,Y.extent||4096);var bt={keys:[],values:[],keycache:{},valuecache:{}};for(pt=0;pt<Y.length;pt++)bt.feature=Y.feature(pt),W.writeMessage(2,kt,bt);var Ft=bt.keys;for(pt=0;pt<Ft.length;pt++)W.writeStringField(3,Ft[pt]);var se=bt.values;for(pt=0;pt<se.length;pt++)W.writeMessage(4,pe,se[pt])}function kt(Y,W){var pt=Y.feature;void 0!==pt.id&&W.writeVarintField(1,pt.id),W.writeMessage(2,gt,Y),W.writeVarintField(3,pt.type),W.writeMessage(4,It,pt)}function gt(Y,W){var pt=Y.feature,bt=Y.keys,Ft=Y.values,se=Y.keycache,me=Y.valuecache;for(var ue in pt.properties){var Dt=se[ue];void 0===Dt&&(bt.push(ue),se[ue]=Dt=bt.length-1),W.writeVarint(Dt);var Ht=pt.properties[ue],ir=typeof Ht;"string"!==ir&&"boolean"!==ir&&"number"!==ir&&(Ht=JSON.stringify(Ht));var mr=ir+":"+Ht,Te=me[mr];void 0===Te&&(Ft.push(Ht),me[mr]=Te=Ft.length-1),W.writeVarint(Te)}}function Fe(Y,W){return(W<<3)+(7&Y)}function Ie(Y){return Y<<1^Y>>31}function It(Y,W){for(var pt=Y.loadGeometry(),bt=Y.type,Ft=0,se=0,me=pt.length,ue=0;ue<me;ue++){var Dt=pt[ue],Ht=1;1===bt&&(Ht=Dt.length),W.writeVarint(Fe(1,Ht));for(var ir=3===bt?Dt.length-1:Dt.length,mr=0;mr<ir;mr++){1===mr&&1!==bt&&W.writeVarint(Fe(2,ir-1));var Te=Dt[mr].x-Ft,Ye=Dt[mr].y-se;W.writeVarint(Ie(Te)),W.writeVarint(Ie(Ye)),Ft+=Te,se+=Ye}3===bt&&W.writeVarint(Fe(7,1))}}function pe(Y,W){var pt=typeof Y;"string"===pt?W.writeStringField(1,Y):"boolean"===pt?W.writeBooleanField(7,Y):"number"===pt&&(Y%1!=0?W.writeDoubleField(3,Y):Y<0?W.writeSVarintField(6,Y):W.writeVarintField(5,Y))}function Pt(Y,W,pt,bt){te(Y,pt,bt),te(W,2*pt,2*bt),te(W,2*pt+1,2*bt+1)}function te(Y,W,pt){var bt=Y[W];Y[W]=Y[pt],Y[pt]=bt}function le(Y,W,pt,bt){var Ft=Y-pt,se=W-bt;return Ft*Ft+se*se}at.fromVectorTileJs=Wt,at.fromGeojsonVt=function(Y,W){W=W||{};var pt={};for(var bt in Y)pt[bt]=new rt(Y[bt].features,W),pt[bt].name=bt,pt[bt].version=W.version,pt[bt].extent=W.extent;return Wt({layers:pt})},at.GeoJSONWrapper=j;var Ot=function(Y){return Y[0]},Ue=function(Y){return Y[1]},ze=function(Y,W,pt,bt,Ft){void 0===W&&(W=Ot),void 0===pt&&(pt=Ue),void 0===bt&&(bt=64),void 0===Ft&&(Ft=Float64Array),this.nodeSize=bt,this.points=Y;for(var se=Y.length<65536?Uint16Array:Uint32Array,me=this.ids=new se(Y.length),ue=this.coords=new Ft(2*Y.length),Dt=0;Dt<Y.length;Dt++)me[Dt]=Dt,ue[2*Dt]=W(Y[Dt]),ue[2*Dt+1]=pt(Y[Dt]);!function Ht(ir,mr,Te,Ye,vr,_r){if(!(vr-Ye<=Te)){var Pr=Ye+vr>>1;(function He(yr,Ke,wn,an,Lr,_n){for(;Lr>an;){if(Lr-an>600){var Nr=Lr-an+1,Gi=wn-an+1,ri=Math.log(Nr),qn=.5*Math.exp(2*ri/3),En=.5*Math.sqrt(ri*qn*(Nr-qn)/Nr)*(Gi-Nr/2<0?-1:1);He(yr,Ke,wn,Math.max(an,Math.floor(wn-Gi*qn/Nr+En)),Math.min(Lr,Math.floor(wn+(Nr-Gi)*qn/Nr+En)),_n)}var ho=Ke[2*wn+_n],li=an,Gr=Lr;for(Pt(yr,Ke,an,wn),Ke[2*Lr+_n]>ho&&Pt(yr,Ke,an,Lr);li<Gr;){for(Pt(yr,Ke,li,Gr),li++,Gr--;Ke[2*li+_n]<ho;)li++;for(;Ke[2*Gr+_n]>ho;)Gr--}Ke[2*an+_n]===ho?Pt(yr,Ke,an,Gr):Pt(yr,Ke,++Gr,Lr),Gr<=wn&&(an=Gr+1),wn<=Gr&&(Lr=Gr-1)}})(ir,mr,Pr,Ye,vr,_r%2),Ht(ir,mr,Te,Ye,Pr-1,_r+1),Ht(ir,mr,Te,Pr+1,vr,_r+1)}}(me,ue,bt,0,me.length-1,0)};ze.prototype.range=function(Y,W,pt,bt){return function(Ft,se,me,ue,Dt,Ht,ir){for(var mr,Te,Ye=[0,Ft.length-1,0],vr=[];Ye.length;){var _r=Ye.pop(),Pr=Ye.pop(),He=Ye.pop();if(Pr-He<=ir)for(var yr=He;yr<=Pr;yr++)Te=se[2*yr+1],(mr=se[2*yr])>=me&&mr<=Dt&&Te>=ue&&Te<=Ht&&vr.push(Ft[yr]);else{var Ke=Math.floor((He+Pr)/2);Te=se[2*Ke+1],(mr=se[2*Ke])>=me&&mr<=Dt&&Te>=ue&&Te<=Ht&&vr.push(Ft[Ke]);var wn=(_r+1)%2;(0===_r?me<=mr:ue<=Te)&&(Ye.push(He),Ye.push(Ke-1),Ye.push(wn)),(0===_r?Dt>=mr:Ht>=Te)&&(Ye.push(Ke+1),Ye.push(Pr),Ye.push(wn))}}return vr}(this.ids,this.coords,Y,W,pt,bt,this.nodeSize)},ze.prototype.within=function(Y,W,pt){return function(bt,Ft,se,me,ue,Dt){for(var Ht=[0,bt.length-1,0],ir=[],mr=ue*ue;Ht.length;){var Te=Ht.pop(),Ye=Ht.pop(),vr=Ht.pop();if(Ye-vr<=Dt)for(var _r=vr;_r<=Ye;_r++)le(Ft[2*_r],Ft[2*_r+1],se,me)<=mr&&ir.push(bt[_r]);else{var Pr=Math.floor((vr+Ye)/2),He=Ft[2*Pr],yr=Ft[2*Pr+1];le(He,yr,se,me)<=mr&&ir.push(bt[Pr]);var Ke=(Te+1)%2;(0===Te?se-ue<=He:me-ue<=yr)&&(Ht.push(vr),Ht.push(Pr-1),Ht.push(Ke)),(0===Te?se+ue>=He:me+ue>=yr)&&(Ht.push(Pr+1),Ht.push(Ye),Ht.push(Ke))}}return ir}(this.ids,this.coords,Y,W,pt,this.nodeSize)};var ar={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Y){return Y}},Me=function(Y){this.options=ti(Object.create(ar),Y),this.trees=new Array(this.options.maxZoom+1)};function Mr(Y,W,pt,bt,Ft){return{x:Y,y:W,zoom:1/0,id:pt,parentId:-1,numPoints:bt,properties:Ft}}function lr(Y,W){var pt=Y.geometry.coordinates,bt=pt[1];return{x:Sr(pt[0]),y:qe(bt),zoom:1/0,index:W,parentId:-1}}function kr(Y){return{type:"Feature",id:Y.id,properties:Xr(Y),geometry:{type:"Point",coordinates:[(bt=Y.x,360*(bt-.5)),(W=Y.y,pt=(180-360*W)*Math.PI/180,360*Math.atan(Math.exp(pt))/Math.PI-90)]}};var W,pt,bt}function Xr(Y){var W=Y.numPoints,pt=W>=1e4?Math.round(W/1e3)+"k":W>=1e3?Math.round(W/100)/10+"k":W;return ti(ti({},Y.properties),{cluster:!0,cluster_id:Y.id,point_count:W,point_count_abbreviated:pt})}function Sr(Y){return Y/360+.5}function qe(Y){var W=Math.sin(Y*Math.PI/180),pt=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return pt<0?0:pt>1?1:pt}function ti(Y,W){for(var pt in W)Y[pt]=W[pt];return Y}function vn(Y){return Y.x}function Un(Y){return Y.y}function ae(Y,W,pt,bt,Ft,se){var me=Ft-pt,ue=se-bt;if(0!==me||0!==ue){var Dt=((Y-pt)*me+(W-bt)*ue)/(me*me+ue*ue);Dt>1?(pt=Ft,bt=se):Dt>0&&(pt+=me*Dt,bt+=ue*Dt)}return(me=Y-pt)*me+(ue=W-bt)*ue}function Ve(Y,W,pt,bt){var Ft={id:void 0===Y?null:Y,type:W,geometry:pt,tags:bt,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(se){var me=se.geometry,ue=se.type;if("Point"===ue||"MultiPoint"===ue||"LineString"===ue)Kt(se,me);else if("Polygon"===ue||"MultiLineString"===ue)for(var Dt=0;Dt<me.length;Dt++)Kt(se,me[Dt]);else if("MultiPolygon"===ue)for(Dt=0;Dt<me.length;Dt++)for(var Ht=0;Ht<me[Dt].length;Ht++)Kt(se,me[Dt][Ht])}(Ft),Ft}function Kt(Y,W){for(var pt=0;pt<W.length;pt+=3)Y.minX=Math.min(Y.minX,W[pt]),Y.minY=Math.min(Y.minY,W[pt+1]),Y.maxX=Math.max(Y.maxX,W[pt]),Y.maxY=Math.max(Y.maxY,W[pt+1])}function st(Y,W,pt,bt){if(W.geometry){var Ft=W.geometry.coordinates,se=W.geometry.type,me=Math.pow(pt.tolerance/((1<<pt.maxZoom)*pt.extent),2),ue=[],Dt=W.id;if(pt.promoteId?Dt=W.properties[pt.promoteId]:pt.generateId&&(Dt=bt||0),"Point"===se)nt(Ft,ue);else if("MultiPoint"===se)for(var Ht=0;Ht<Ft.length;Ht++)nt(Ft[Ht],ue);else if("LineString"===se)ot(Ft,ue,me,!1);else if("MultiLineString"===se){if(pt.lineMetrics){for(Ht=0;Ht<Ft.length;Ht++)ot(Ft[Ht],ue=[],me,!1),Y.push(Ve(Dt,"LineString",ue,W.properties));return}Rt(Ft,ue,me,!1)}else if("Polygon"===se)Rt(Ft,ue,me,!0);else{if("MultiPolygon"!==se){if("GeometryCollection"===se){for(Ht=0;Ht<W.geometry.geometries.length;Ht++)st(Y,{id:Dt,geometry:W.geometry.geometries[Ht],properties:W.properties},pt,bt);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Ht=0;Ht<Ft.length;Ht++){var ir=[];Rt(Ft[Ht],ir,me,!0),ue.push(ir)}}Y.push(Ve(Dt,se,ue,W.properties))}}function nt(Y,W){W.push(ce(Y[0])),W.push(De(Y[1])),W.push(0)}function ot(Y,W,pt,bt){for(var Ft,se,me=0,ue=0;ue<Y.length;ue++){var Dt=ce(Y[ue][0]),Ht=De(Y[ue][1]);W.push(Dt),W.push(Ht),W.push(0),ue>0&&(me+=bt?(Ft*Ht-Dt*se)/2:Math.sqrt(Math.pow(Dt-Ft,2)+Math.pow(Ht-se,2))),Ft=Dt,se=Ht}var ir=W.length-3;W[2]=1,function mr(Te,Ye,vr,_r){for(var Pr,He=_r,yr=vr-Ye>>1,Ke=vr-Ye,wn=Te[Ye],an=Te[Ye+1],Lr=Te[vr],_n=Te[vr+1],Nr=Ye+3;Nr<vr;Nr+=3){var Gi=ae(Te[Nr],Te[Nr+1],wn,an,Lr,_n);if(Gi>He)Pr=Nr,He=Gi;else if(Gi===He){var ri=Math.abs(Nr-yr);ri<Ke&&(Pr=Nr,Ke=ri)}}He>_r&&(Pr-Ye>3&&mr(Te,Ye,Pr,_r),Te[Pr+2]=He,vr-Pr>3&&mr(Te,Pr,vr,_r))}(W,0,ir,pt),W[ir+2]=1,W.size=Math.abs(me),W.start=0,W.end=W.size}function Rt(Y,W,pt,bt){for(var Ft=0;Ft<Y.length;Ft++){var se=[];ot(Y[Ft],se,pt,bt),W.push(se)}}function ce(Y){return Y/360+.5}function De(Y){var W=Math.sin(Y*Math.PI/180),pt=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return pt<0?0:pt>1?1:pt}function Qe(Y,W,pt,bt,Ft,se,me,ue){if(bt/=W,se>=(pt/=W)&&me<bt)return Y;if(me<pt||se>=bt)return null;for(var Dt=[],Ht=0;Ht<Y.length;Ht++){var ir=Y[Ht],mr=ir.geometry,Te=ir.type,Ye=0===Ft?ir.minX:ir.minY,vr=0===Ft?ir.maxX:ir.maxY;if(Ye>=pt&&vr<bt)Dt.push(ir);else if(!(vr<pt||Ye>=bt)){var _r=[];if("Point"===Te||"MultiPoint"===Te)nr(mr,_r,pt,bt,Ft);else if("LineString"===Te)Xe(mr,_r,pt,bt,Ft,!1,ue.lineMetrics);else if("MultiLineString"===Te)Kr(mr,_r,pt,bt,Ft,!1);else if("Polygon"===Te)Kr(mr,_r,pt,bt,Ft,!0);else if("MultiPolygon"===Te)for(var Pr=0;Pr<mr.length;Pr++){var He=[];Kr(mr[Pr],He,pt,bt,Ft,!0),He.length&&_r.push(He)}if(_r.length){if(ue.lineMetrics&&"LineString"===Te){for(Pr=0;Pr<_r.length;Pr++)Dt.push(Ve(ir.id,Te,_r[Pr],ir.tags));continue}"LineString"!==Te&&"MultiLineString"!==Te||(1===_r.length?(Te="LineString",_r=_r[0]):Te="MultiLineString"),"Point"!==Te&&"MultiPoint"!==Te||(Te=3===_r.length?"Point":"MultiPoint"),Dt.push(Ve(ir.id,Te,_r,ir.tags))}}}return Dt.length?Dt:null}function nr(Y,W,pt,bt,Ft){for(var se=0;se<Y.length;se+=3){var me=Y[se+Ft];me>=pt&&me<=bt&&(W.push(Y[se]),W.push(Y[se+1]),W.push(Y[se+2]))}}function Xe(Y,W,pt,bt,Ft,se,me){for(var ue,Dt,Ht=pn(Y),ir=0===Ft?un:ei,mr=Y.start,Te=0;Te<Y.length-3;Te+=3){var Ye=Y[Te],vr=Y[Te+1],_r=Y[Te+2],Pr=Y[Te+3],He=Y[Te+4],yr=0===Ft?Ye:vr,Ke=0===Ft?Pr:He,wn=!1;me&&(ue=Math.sqrt(Math.pow(Ye-Pr,2)+Math.pow(vr-He,2))),yr<pt?Ke>pt&&(Dt=ir(Ht,Ye,vr,Pr,He,pt),me&&(Ht.start=mr+ue*Dt)):yr>bt?Ke<bt&&(Dt=ir(Ht,Ye,vr,Pr,He,bt),me&&(Ht.start=mr+ue*Dt)):pr(Ht,Ye,vr,_r),Ke<pt&&yr>=pt&&(Dt=ir(Ht,Ye,vr,Pr,He,pt),wn=!0),Ke>bt&&yr<=bt&&(Dt=ir(Ht,Ye,vr,Pr,He,bt),wn=!0),!se&&wn&&(me&&(Ht.end=mr+ue*Dt),W.push(Ht),Ht=pn(Y)),me&&(mr+=ue)}var an=Y.length-3;Ye=Y[an],vr=Y[an+1],_r=Y[an+2],(yr=0===Ft?Ye:vr)>=pt&&yr<=bt&&pr(Ht,Ye,vr,_r),an=Ht.length-3,se&&an>=3&&(Ht[an]!==Ht[0]||Ht[an+1]!==Ht[1])&&pr(Ht,Ht[0],Ht[1],Ht[2]),Ht.length&&W.push(Ht)}function pn(Y){var W=[];return W.size=Y.size,W.start=Y.start,W.end=Y.end,W}function Kr(Y,W,pt,bt,Ft,se){for(var me=0;me<Y.length;me++)Xe(Y[me],W,pt,bt,Ft,se,!1)}function pr(Y,W,pt,bt){Y.push(W),Y.push(pt),Y.push(bt)}function un(Y,W,pt,bt,Ft,se){var me=(se-W)/(bt-W);return Y.push(se),Y.push(pt+(Ft-pt)*me),Y.push(1),me}function ei(Y,W,pt,bt,Ft,se){var me=(se-pt)/(Ft-pt);return Y.push(W+(bt-W)*me),Y.push(se),Y.push(1),me}function Kn(Y,W){for(var pt=[],bt=0;bt<Y.length;bt++){var Ft,se=Y[bt],me=se.type;if("Point"===me||"MultiPoint"===me||"LineString"===me)Ft=Gn(se.geometry,W);else if("MultiLineString"===me||"Polygon"===me){Ft=[];for(var ue=0;ue<se.geometry.length;ue++)Ft.push(Gn(se.geometry[ue],W))}else if("MultiPolygon"===me)for(Ft=[],ue=0;ue<se.geometry.length;ue++){for(var Dt=[],Ht=0;Ht<se.geometry[ue].length;Ht++)Dt.push(Gn(se.geometry[ue][Ht],W));Ft.push(Dt)}pt.push(Ve(se.id,me,Ft,se.tags))}return pt}function Gn(Y,W){var pt=[];pt.size=Y.size,void 0!==Y.start&&(pt.start=Y.start,pt.end=Y.end);for(var bt=0;bt<Y.length;bt+=3)pt.push(Y[bt]+W,Y[bt+1],Y[bt+2]);return pt}function Mn(Y,W){if(Y.transformed)return Y;var pt,bt,Ft,se=1<<Y.z,me=Y.x,ue=Y.y;for(pt=0;pt<Y.features.length;pt++){var Dt=Y.features[pt],Ht=Dt.geometry,ir=Dt.type;if(Dt.geometry=[],1===ir)for(bt=0;bt<Ht.length;bt+=2)Dt.geometry.push(on(Ht[bt],Ht[bt+1],W,se,me,ue));else for(bt=0;bt<Ht.length;bt++){var mr=[];for(Ft=0;Ft<Ht[bt].length;Ft+=2)mr.push(on(Ht[bt][Ft],Ht[bt][Ft+1],W,se,me,ue));Dt.geometry.push(mr)}}return Y.transformed=!0,Y}function on(Y,W,pt,bt,Ft,se){return[Math.round(pt*(Y*bt-Ft)),Math.round(pt*(W*bt-se))]}function bi(Y,W,pt,bt,Ft){for(var se=W===Ft.maxZoom?0:Ft.tolerance/((1<<W)*Ft.extent),me={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:pt,y:bt,z:W,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ue=0;ue<Y.length;ue++){me.numFeatures++,To(me,Y[ue],se,Ft);var Dt=Y[ue].minX,Ht=Y[ue].minY,ir=Y[ue].maxX,mr=Y[ue].maxY;Dt<me.minX&&(me.minX=Dt),Ht<me.minY&&(me.minY=Ht),ir>me.maxX&&(me.maxX=ir),mr>me.maxY&&(me.maxY=mr)}return me}function To(Y,W,pt,bt){var Ft=W.geometry,se=W.type,me=[];if("Point"===se||"MultiPoint"===se)for(var ue=0;ue<Ft.length;ue+=3)me.push(Ft[ue]),me.push(Ft[ue+1]),Y.numPoints++,Y.numSimplified++;else if("LineString"===se)oa(me,Ft,Y,pt,!1,!1);else if("MultiLineString"===se||"Polygon"===se)for(ue=0;ue<Ft.length;ue++)oa(me,Ft[ue],Y,pt,"Polygon"===se,0===ue);else if("MultiPolygon"===se)for(var Dt=0;Dt<Ft.length;Dt++){var Ht=Ft[Dt];for(ue=0;ue<Ht.length;ue++)oa(me,Ht[ue],Y,pt,!0,0===ue)}if(me.length){var ir=W.tags||null;if("LineString"===se&&bt.lineMetrics){for(var mr in ir={},W.tags)ir[mr]=W.tags[mr];ir.mapbox_clip_start=Ft.start/Ft.size,ir.mapbox_clip_end=Ft.end/Ft.size}var Te={geometry:me,type:"Polygon"===se||"MultiPolygon"===se?3:"LineString"===se||"MultiLineString"===se?2:1,tags:ir};null!==W.id&&(Te.id=W.id),Y.features.push(Te)}}function oa(Y,W,pt,bt,Ft,se){var me=bt*bt;if(bt>0&&W.size<(Ft?me:bt))pt.numPoints+=W.length/3;else{for(var ue=[],Dt=0;Dt<W.length;Dt+=3)(0===bt||W[Dt+2]>me)&&(pt.numSimplified++,ue.push(W[Dt]),ue.push(W[Dt+1])),pt.numPoints++;Ft&&function(Ht,ir){for(var mr=0,Te=0,Ye=Ht.length,vr=Ye-2;Te<Ye;vr=Te,Te+=2)mr+=(Ht[Te]-Ht[vr])*(Ht[Te+1]+Ht[vr+1]);if(mr>0===ir)for(Te=0,Ye=Ht.length;Te<Ye/2;Te+=2){var _r=Ht[Te],Pr=Ht[Te+1];Ht[Te]=Ht[Ye-2-Te],Ht[Te+1]=Ht[Ye-1-Te],Ht[Ye-2-Te]=_r,Ht[Ye-1-Te]=Pr}}(ue,se),Y.push(ue)}}function gi(Y,W){var pt=(W=this.options=function(Ft,se){for(var me in se)Ft[me]=se[me];return Ft}(Object.create(this.options),W)).debug;if(pt&&console.time("preprocess data"),W.maxZoom<0||W.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(W.promoteId&&W.generateId)throw new Error("promoteId and generateId cannot be used together.");var Ft,se,me,ue,Dt,Ht,bt=function(Ft,se){var me=[];if("FeatureCollection"===Ft.type)for(var ue=0;ue<Ft.features.length;ue++)st(me,Ft.features[ue],se,ue);else st(me,"Feature"===Ft.type?Ft:{geometry:Ft},se);return me}(Y,W);this.tiles={},this.tileCoords=[],pt&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",W.indexMaxZoom,W.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(Ft=bt,se=W,me=se.buffer/se.extent,ue=Ft,Dt=Qe(Ft,1,-1-me,me,0,-1,2,se),Ht=Qe(Ft,1,1-me,2+me,0,-1,2,se),(Dt||Ht)&&(ue=Qe(Ft,1,-me,1+me,0,-1,2,se)||[],Dt&&(ue=Kn(Dt,1).concat(ue)),Ht&&(ue=ue.concat(Kn(Ht,-1)))),bt=ue).length&&this.splitTile(bt,0,0,0),pt&&(bt.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function vo(Y,W,pt){return 32*((1<<Y)*pt+W)+Y}function On(Y,W){var pt=Y.tileID.canonical;if(!this._geoJSONIndex)return W(null,null);var bt=this._geoJSONIndex.getTile(pt.z,pt.x,pt.y);if(!bt)return W(null,null);var Ft=new tt(bt.features),se=at(Ft);0===se.byteOffset&&se.byteLength===se.buffer.byteLength||(se=new Uint8Array(se)),W(null,{vectorTile:Ft,rawData:se.buffer})}Me.prototype.load=function(Y){var W=this.options,pt=W.log,bt=W.minZoom,Ft=W.maxZoom,se=W.nodeSize;pt&&console.time("total time");var me="prepare "+Y.length+" points";pt&&console.time(me),this.points=Y;for(var ue=[],Dt=0;Dt<Y.length;Dt++)Y[Dt].geometry&&ue.push(lr(Y[Dt],Dt));this.trees[Ft+1]=new ze(ue,vn,Un,se,Float32Array),pt&&console.timeEnd(me);for(var Ht=Ft;Ht>=bt;Ht--){var ir=+Date.now();ue=this._cluster(ue,Ht),this.trees[Ht]=new ze(ue,vn,Un,se,Float32Array),pt&&console.log("z%d: %d clusters in %dms",Ht,ue.length,+Date.now()-ir)}return pt&&console.timeEnd("total time"),this},Me.prototype.getClusters=function(Y,W){var pt=((Y[0]+180)%360+360)%360-180,bt=Math.max(-90,Math.min(90,Y[1])),Ft=180===Y[2]?180:((Y[2]+180)%360+360)%360-180,se=Math.max(-90,Math.min(90,Y[3]));if(Y[2]-Y[0]>=360)pt=-180,Ft=180;else if(pt>Ft){var me=this.getClusters([pt,bt,180,se],W),ue=this.getClusters([-180,bt,Ft,se],W);return me.concat(ue)}for(var Dt=this.trees[this._limitZoom(W)],Ht=[],ir=0,mr=Dt.range(Sr(pt),qe(se),Sr(Ft),qe(bt));ir<mr.length;ir+=1){var Te=Dt.points[mr[ir]];Ht.push(Te.numPoints?kr(Te):this.points[Te.index])}return Ht},Me.prototype.getChildren=function(Y){var W=this._getOriginId(Y),pt=this._getOriginZoom(Y),bt="No cluster with the specified id.",Ft=this.trees[pt];if(!Ft)throw new Error(bt);var se=Ft.points[W];if(!se)throw new Error(bt);for(var me=this.options.radius/(this.options.extent*Math.pow(2,pt-1)),ue=[],Dt=0,Ht=Ft.within(se.x,se.y,me);Dt<Ht.length;Dt+=1){var ir=Ft.points[Ht[Dt]];ir.parentId===Y&&ue.push(ir.numPoints?kr(ir):this.points[ir.index])}if(0===ue.length)throw new Error(bt);return ue},Me.prototype.getLeaves=function(Y,W,pt){var bt=[];return this._appendLeaves(bt,Y,W=W||10,pt=pt||0,0),bt},Me.prototype.getTile=function(Y,W,pt){var bt=this.trees[this._limitZoom(Y)],Ft=Math.pow(2,Y),se=this.options,me=se.radius/se.extent,ue=(pt-me)/Ft,Dt=(pt+1+me)/Ft,Ht={features:[]};return this._addTileFeatures(bt.range((W-me)/Ft,ue,(W+1+me)/Ft,Dt),bt.points,W,pt,Ft,Ht),0===W&&this._addTileFeatures(bt.range(1-me/Ft,ue,1,Dt),bt.points,Ft,pt,Ft,Ht),W===Ft-1&&this._addTileFeatures(bt.range(0,ue,me/Ft,Dt),bt.points,-1,pt,Ft,Ht),Ht.features.length?Ht:null},Me.prototype.getClusterExpansionZoom=function(Y){for(var W=this._getOriginZoom(Y)-1;W<=this.options.maxZoom;){var pt=this.getChildren(Y);if(W++,1!==pt.length)break;Y=pt[0].properties.cluster_id}return W},Me.prototype._appendLeaves=function(Y,W,pt,bt,Ft){for(var se=0,me=this.getChildren(W);se<me.length;se+=1){var ue=me[se],Dt=ue.properties;if(Dt&&Dt.cluster?Ft+Dt.point_count<=bt?Ft+=Dt.point_count:Ft=this._appendLeaves(Y,Dt.cluster_id,pt,bt,Ft):Ft<bt?Ft++:Y.push(ue),Y.length===pt)break}return Ft},Me.prototype._addTileFeatures=function(Y,W,pt,bt,Ft,se){for(var me=0,ue=Y;me<ue.length;me+=1){var Dt=W[ue[me]],Ht=Dt.numPoints,ir={type:1,geometry:[[Math.round(this.options.extent*(Dt.x*Ft-pt)),Math.round(this.options.extent*(Dt.y*Ft-bt))]],tags:Ht?Xr(Dt):this.points[Dt.index].properties},mr=void 0;Ht?mr=Dt.id:this.options.generateId?mr=Dt.index:this.points[Dt.index].id&&(mr=this.points[Dt.index].id),void 0!==mr&&(ir.id=mr),se.features.push(ir)}},Me.prototype._limitZoom=function(Y){return Math.max(this.options.minZoom,Math.min(+Y,this.options.maxZoom+1))},Me.prototype._cluster=function(Y,W){for(var pt=[],bt=this.options,Ft=bt.reduce,se=bt.minPoints,me=bt.radius/(bt.extent*Math.pow(2,W)),ue=0;ue<Y.length;ue++){var Dt=Y[ue];if(!(Dt.zoom<=W)){Dt.zoom=W;for(var Ht=this.trees[W+1],ir=Ht.within(Dt.x,Dt.y,me),mr=Dt.numPoints||1,Te=mr,Ye=0,vr=ir;Ye<vr.length;Ye+=1){var _r=Ht.points[vr[Ye]];_r.zoom>W&&(Te+=_r.numPoints||1)}if(Te>=se){for(var Pr=Dt.x*mr,He=Dt.y*mr,yr=Ft&&mr>1?this._map(Dt,!0):null,Ke=(ue<<5)+(W+1)+this.points.length,wn=0,an=ir;wn<an.length;wn+=1){var Lr=Ht.points[an[wn]];if(!(Lr.zoom<=W)){Lr.zoom=W;var _n=Lr.numPoints||1;Pr+=Lr.x*_n,He+=Lr.y*_n,Lr.parentId=Ke,Ft&&(yr||(yr=this._map(Dt,!0)),Ft(yr,this._map(Lr)))}}Dt.parentId=Ke,pt.push(Mr(Pr/Te,He/Te,Ke,Te,yr))}else if(pt.push(Dt),Te>1)for(var Nr=0,Gi=ir;Nr<Gi.length;Nr+=1){var ri=Ht.points[Gi[Nr]];ri.zoom<=W||(ri.zoom=W,pt.push(ri))}}}return pt},Me.prototype._getOriginId=function(Y){return Y-this.points.length>>5},Me.prototype._getOriginZoom=function(Y){return(Y-this.points.length)%32},Me.prototype._map=function(Y,W){if(Y.numPoints)return W?ti({},Y.properties):Y.properties;var pt=this.points[Y.index].properties,bt=this.options.map(pt);return W&&bt===pt?ti({},bt):bt},gi.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},gi.prototype.splitTile=function(Y,W,pt,bt,Ft,se,me){for(var ue=[Y,W,pt,bt],Dt=this.options,Ht=Dt.debug;ue.length;){bt=ue.pop(),pt=ue.pop(),W=ue.pop(),Y=ue.pop();var ir=1<<W,mr=vo(W,pt,bt),Te=this.tiles[mr];if(!Te&&(Ht>1&&console.time("creation"),Te=this.tiles[mr]=bi(Y,W,pt,bt,Dt),this.tileCoords.push({z:W,x:pt,y:bt}),Ht)){Ht>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",W,pt,bt,Te.numFeatures,Te.numPoints,Te.numSimplified),console.timeEnd("creation"));var Ye="z"+W;this.stats[Ye]=(this.stats[Ye]||0)+1,this.total++}if(Te.source=Y,Ft){if(W===Dt.maxZoom||W===Ft)continue;var vr=1<<Ft-W;if(pt!==Math.floor(se/vr)||bt!==Math.floor(me/vr))continue}else if(W===Dt.indexMaxZoom||Te.numPoints<=Dt.indexMaxPoints)continue;if(Te.source=null,0!==Y.length){Ht>1&&console.time("clipping");var _r,Pr,He,yr,Ke,wn,an=.5*Dt.buffer/Dt.extent,Lr=.5-an,_n=.5+an,Nr=1+an;_r=Pr=He=yr=null,Ke=Qe(Y,ir,pt-an,pt+_n,0,Te.minX,Te.maxX,Dt),wn=Qe(Y,ir,pt+Lr,pt+Nr,0,Te.minX,Te.maxX,Dt),Y=null,Ke&&(_r=Qe(Ke,ir,bt-an,bt+_n,1,Te.minY,Te.maxY,Dt),Pr=Qe(Ke,ir,bt+Lr,bt+Nr,1,Te.minY,Te.maxY,Dt),Ke=null),wn&&(He=Qe(wn,ir,bt-an,bt+_n,1,Te.minY,Te.maxY,Dt),yr=Qe(wn,ir,bt+Lr,bt+Nr,1,Te.minY,Te.maxY,Dt),wn=null),Ht>1&&console.timeEnd("clipping"),ue.push(_r||[],W+1,2*pt,2*bt),ue.push(Pr||[],W+1,2*pt,2*bt+1),ue.push(He||[],W+1,2*pt+1,2*bt),ue.push(yr||[],W+1,2*pt+1,2*bt+1)}}},gi.prototype.getTile=function(Y,W,pt){var bt=this.options,Ft=bt.extent,se=bt.debug;if(Y<0||Y>24)return null;var me=1<<Y,ue=vo(Y,W=(W%me+me)%me,pt);if(this.tiles[ue])return Mn(this.tiles[ue],Ft);se>1&&console.log("drilling down to z%d-%d-%d",Y,W,pt);for(var Dt,Ht=Y,ir=W,mr=pt;!Dt&&Ht>0;)Ht--,ir=Math.floor(ir/2),mr=Math.floor(mr/2),Dt=this.tiles[vo(Ht,ir,mr)];return Dt&&Dt.source?(se>1&&console.log("found parent tile z%d-%d-%d",Ht,ir,mr),se>1&&console.time("drilling down"),this.splitTile(Dt.source,Ht,ir,mr,Y,W,pt),se>1&&console.timeEnd("drilling down"),this.tiles[ue]?Mn(this.tiles[ue],Ft):null):null};var or=function(Y){function W(pt,bt,Ft,se){Y.call(this,pt,bt,Ft,On),se&&(this.loadGeoJSON=se)}return Y&&(W.__proto__=Y),(W.prototype=Object.create(Y&&Y.prototype)).constructor=W,W.prototype.loadData=function(pt,bt){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=bt,this._pendingLoadDataParams=pt,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},W.prototype._loadData=function(){var pt=this;if(this._pendingCallback&&this._pendingLoadDataParams){var bt=this._pendingCallback,Ft=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var se=!!(Ft&&Ft.request&&Ft.request.collectResourceTiming)&&new s.RequestPerformance(Ft.request);this.loadGeoJSON(Ft,function(me,ue){if(me||!ue)return bt(me);if("object"!=typeof ue)return bt(new Error("Input data given to '"+Ft.source+"' is not a valid GeoJSON object."));!function Te(Ye,vr){var _r,Pr=Ye&&Ye.type;if("FeatureCollection"===Pr)for(_r=0;_r<Ye.features.length;_r++)Te(Ye.features[_r],vr);else if("GeometryCollection"===Pr)for(_r=0;_r<Ye.geometries.length;_r++)Te(Ye.geometries[_r],vr);else if("Feature"===Pr)Te(Ye.geometry,vr);else if("Polygon"===Pr)ge(Ye.coordinates,vr);else if("MultiPolygon"===Pr)for(_r=0;_r<Ye.coordinates.length;_r++)ge(Ye.coordinates[_r],vr);return Ye}(ue,!0);try{if(Ft.filter){var Dt=s.createExpression(Ft.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===Dt.result)throw new Error(Dt.value.map(function(Te){return Te.key+": "+Te.message}).join(", "));var Ht=ue.features.filter(function(Te){return Dt.value.evaluate({zoom:0},Te)});ue={type:"FeatureCollection",features:Ht}}pt._geoJSONIndex=Ft.cluster?new Me(function(Te){var Ye=Te.superclusterOptions,vr=Te.clusterProperties;if(!vr||!Ye)return Ye;for(var _r={},Pr={},He={accumulated:null,zoom:0},yr={properties:null},Ke=Object.keys(vr),wn=0,an=Ke;wn<an.length;wn+=1){var Lr=an[wn],_n=vr[Lr],Nr=_n[0],Gi=s.createExpression(_n[1]),ri=s.createExpression("string"==typeof Nr?[Nr,["accumulated"],["get",Lr]]:Nr);_r[Lr]=Gi.value,Pr[Lr]=ri.value}return Ye.map=function(qn){yr.properties=qn;for(var En={},ho=0,li=Ke;ho<li.length;ho+=1){var Gr=li[ho];En[Gr]=_r[Gr].evaluate(He,yr)}return En},Ye.reduce=function(qn,En){yr.properties=En;for(var ho=0,li=Ke;ho<li.length;ho+=1){var Gr=li[ho];He.accumulated=qn[Gr],qn[Gr]=Pr[Gr].evaluate(He,yr)}},Ye}(Ft)).load(ue.features):new gi(Te=ue,Ft.geojsonVtOptions)}catch(Te){return bt(Te)}var Te;pt.loaded={};var ir={};if(se){var mr=se.finish();mr&&(ir.resourceTiming={},ir.resourceTiming[Ft.source]=JSON.parse(JSON.stringify(mr)))}bt(null,ir)})}},W.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},W.prototype.reloadTile=function(pt,bt){var Ft=this.loaded;return Ft&&Ft[pt.uid]?Y.prototype.reloadTile.call(this,pt,bt):this.loadTile(pt,bt)},W.prototype.loadGeoJSON=function(pt,bt){if(pt.request)s.getJSON(pt.request,bt);else{if("string"!=typeof pt.data)return bt(new Error("Input data given to '"+pt.source+"' is not a valid GeoJSON object."));try{return bt(null,JSON.parse(pt.data))}catch{return bt(new Error("Input data given to '"+pt.source+"' is not a valid GeoJSON object."))}}},W.prototype.removeSource=function(pt,bt){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),bt()},W.prototype.getClusterExpansionZoom=function(pt,bt){try{bt(null,this._geoJSONIndex.getClusterExpansionZoom(pt.clusterId))}catch(Ft){bt(Ft)}},W.prototype.getClusterChildren=function(pt,bt){try{bt(null,this._geoJSONIndex.getChildren(pt.clusterId))}catch(Ft){bt(Ft)}},W.prototype.getClusterLeaves=function(pt,bt){try{bt(null,this._geoJSONIndex.getLeaves(pt.clusterId,pt.limit,pt.offset))}catch(Ft){bt(Ft)}},W}(yt),wi=function(Y){var W=this;this.self=Y,this.actor=new s.Actor(Y,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:yt,geojson:or},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(pt,bt){if(W.workerSourceTypes[pt])throw new Error('Worker source with name "'+pt+'" already registered.');W.workerSourceTypes[pt]=bt},this.self.registerRTLTextPlugin=function(pt){if(s.plugin.isParsed())throw new Error("RTL text plugin already registered.");s.plugin.applyArabicShaping=pt.applyArabicShaping,s.plugin.processBidirectionalText=pt.processBidirectionalText,s.plugin.processStyledBidirectionalText=pt.processStyledBidirectionalText}};return wi.prototype.setReferrer=function(Y,W){this.referrer=W},wi.prototype.setImages=function(Y,W,pt){for(var bt in this.availableImages[Y]=W,this.workerSources[Y]){var Ft=this.workerSources[Y][bt];for(var se in Ft)Ft[se].availableImages=W}pt()},wi.prototype.setLayers=function(Y,W,pt){this.getLayerIndex(Y).replace(W),pt()},wi.prototype.updateLayers=function(Y,W,pt){this.getLayerIndex(Y).update(W.layers,W.removedIds),pt()},wi.prototype.loadTile=function(Y,W,pt){this.getWorkerSource(Y,W.type,W.source).loadTile(W,pt)},wi.prototype.loadDEMTile=function(Y,W,pt){this.getDEMWorkerSource(Y,W.source).loadTile(W,pt)},wi.prototype.reloadTile=function(Y,W,pt){this.getWorkerSource(Y,W.type,W.source).reloadTile(W,pt)},wi.prototype.abortTile=function(Y,W,pt){this.getWorkerSource(Y,W.type,W.source).abortTile(W,pt)},wi.prototype.removeTile=function(Y,W,pt){this.getWorkerSource(Y,W.type,W.source).removeTile(W,pt)},wi.prototype.removeDEMTile=function(Y,W){this.getDEMWorkerSource(Y,W.source).removeTile(W)},wi.prototype.removeSource=function(Y,W,pt){if(this.workerSources[Y]&&this.workerSources[Y][W.type]&&this.workerSources[Y][W.type][W.source]){var bt=this.workerSources[Y][W.type][W.source];delete this.workerSources[Y][W.type][W.source],void 0!==bt.removeSource?bt.removeSource(W,pt):pt()}},wi.prototype.loadWorkerSource=function(Y,W,pt){try{this.self.importScripts(W.url),pt()}catch(bt){pt(bt.toString())}},wi.prototype.syncRTLPluginState=function(Y,W,pt){try{s.plugin.setState(W);var bt=s.plugin.getPluginURL();if(s.plugin.isLoaded()&&!s.plugin.isParsed()&&null!=bt){this.self.importScripts(bt);var Ft=s.plugin.isParsed();pt(Ft?void 0:new Error("RTL Text Plugin failed to import scripts from "+bt),Ft)}}catch(se){pt(se.toString())}},wi.prototype.getAvailableImages=function(Y){var W=this.availableImages[Y];return W||(W=[]),W},wi.prototype.getLayerIndex=function(Y){var W=this.layerIndexes[Y];return W||(W=this.layerIndexes[Y]=new Lt),W},wi.prototype.getWorkerSource=function(Y,W,pt){var bt=this;return this.workerSources[Y]||(this.workerSources[Y]={}),this.workerSources[Y][W]||(this.workerSources[Y][W]={}),this.workerSources[Y][W][pt]||(this.workerSources[Y][W][pt]=new this.workerSourceTypes[W]({send:function(Ft,se,me){bt.actor.send(Ft,se,me,Y)}},this.getLayerIndex(Y),this.getAvailableImages(Y))),this.workerSources[Y][W][pt]},wi.prototype.getDEMWorkerSource=function(Y,W){return this.demWorkerSources[Y]||(this.demWorkerSources[Y]={}),this.demWorkerSources[Y][W]||(this.demWorkerSources[Y][W]=new Yt),this.demWorkerSources[Y][W]},wi.prototype.enforceCacheSizeLimit=function(Y,W){s.enforceCacheSizeLimit(W)},typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new wi(self)),wi}),Tt(0,function(s){var lt=s.createCommonjsModule(function(l){function f(E){return!c(E)}function c(E){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var T,R,V=new Blob([""],{type:"text/javascript"}),Q=URL.createObjectURL(V);try{R=new Worker(Q),T=!0}catch{T=!1}return R&&R.terminate(),URL.revokeObjectURL(Q),T}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var T=document.createElement("canvas");T.width=T.height=1;var R=T.getContext("2d");if(!R)return!1;var V=R.getImageData(0,0,1,1);return V&&V.width===T.width}()?(void 0===m[P=E&&E.failIfMajorPerformanceCaveat]&&(m[P]=function(T){var Q,vt,Et,R=(Q=T,vt=document.createElement("canvas"),(Et=Object.create(f.webGLContextAttributes)).failIfMajorPerformanceCaveat=Q,vt.probablySupportsContext?vt.probablySupportsContext("webgl",Et)||vt.probablySupportsContext("experimental-webgl",Et):vt.supportsContext?vt.supportsContext("webgl",Et)||vt.supportsContext("experimental-webgl",Et):vt.getContext("webgl",Et)||vt.getContext("experimental-webgl",Et));if(!R)return!1;var V=R.createShader(R.VERTEX_SHADER);return!(!V||R.isContextLost())&&(R.shaderSource(V,"void main() {}"),R.compileShader(V),!0===R.getShaderParameter(V,R.COMPILE_STATUS))}(P)),m[P]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var P}l.exports?l.exports=f:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=f,window.mapboxgl.notSupportedReason=c);var m={};f.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),ht={create:function(l,f,c){var m=s.window.document.createElement(l);return void 0!==f&&(m.className=f),c&&c.appendChild(m),m},createNS:function(l,f){return s.window.document.createElementNS(l,f)}},Lt=s.window.document&&s.window.document.documentElement.style;function Nt(l){if(!Lt)return l[0];for(var f=0;f<l.length;f++)if(l[f]in Lt)return l[f];return l[0]}var $t,qt=Nt(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);ht.disableDrag=function(){Lt&&qt&&($t=Lt[qt],Lt[qt]="none")},ht.enableDrag=function(){Lt&&qt&&(Lt[qt]=$t)};var _e=Nt(["transform","WebkitTransform"]);ht.setTransform=function(l,f){l.style[_e]=f};var yt=!1;try{var xt=Object.defineProperty({},"passive",{get:function(){yt=!0}});s.window.addEventListener("test",xt,xt),s.window.removeEventListener("test",xt,xt)}catch{yt=!1}ht.addEventListener=function(l,f,c,m){void 0===m&&(m={}),l.addEventListener(f,c,"passive"in m&&yt?m:m.capture)},ht.removeEventListener=function(l,f,c,m){void 0===m&&(m={}),l.removeEventListener(f,c,"passive"in m&&yt?m:m.capture)};var Yt=function(l){l.preventDefault(),l.stopPropagation(),s.window.removeEventListener("click",Yt,!0)};function ge(l){var f=l.userImage;return!!(f&&f.render&&f.render())&&(l.data.replace(new Uint8Array(f.data.buffer)),!0)}ht.suppressClick=function(){s.window.addEventListener("click",Yt,!0),s.window.setTimeout(function(){s.window.removeEventListener("click",Yt,!0)},0)},ht.mousePos=function(l,f){var c=l.getBoundingClientRect();return new s.Point(f.clientX-c.left-l.clientLeft,f.clientY-c.top-l.clientTop)},ht.touchPos=function(l,f){for(var c=l.getBoundingClientRect(),m=[],E=0;E<f.length;E++)m.push(new s.Point(f[E].clientX-c.left-l.clientLeft,f[E].clientY-c.top-l.clientTop));return m},ht.mouseButton=function(l){return void 0!==s.window.InstallTrigger&&2===l.button&&l.ctrlKey&&s.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:l.button},ht.remove=function(l){l.parentNode&&l.parentNode.removeChild(l)};var Z=function(l){function f(){l.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.RGBAImage({width:1,height:1}),this.dirty=!0}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.isLoaded=function(){return this.loaded},f.prototype.setLoaded=function(c){if(this.loaded!==c&&(this.loaded=c,c)){for(var m=0,E=this.requestors;m<E.length;m+=1){var P=E[m];this._notify(P.ids,P.callback)}this.requestors=[]}},f.prototype.getImage=function(c){return this.images[c]},f.prototype.addImage=function(c,m){this._validate(c,m)&&(this.images[c]=m)},f.prototype._validate=function(c,m){var E=!0;return this._validateStretch(m.stretchX,m.data&&m.data.width)||(this.fire(new s.ErrorEvent(new Error('Image "'+c+'" has invalid "stretchX" value'))),E=!1),this._validateStretch(m.stretchY,m.data&&m.data.height)||(this.fire(new s.ErrorEvent(new Error('Image "'+c+'" has invalid "stretchY" value'))),E=!1),this._validateContent(m.content,m)||(this.fire(new s.ErrorEvent(new Error('Image "'+c+'" has invalid "content" value'))),E=!1),E},f.prototype._validateStretch=function(c,m){if(!c)return!0;for(var E=0,P=0,T=c;P<T.length;P+=1){var R=T[P];if(R[0]<E||R[1]<R[0]||m<R[1])return!1;E=R[1]}return!0},f.prototype._validateContent=function(c,m){return!(c&&(4!==c.length||c[0]<0||m.data.width<c[0]||c[1]<0||m.data.height<c[1]||c[2]<0||m.data.width<c[2]||c[3]<0||m.data.height<c[3]||c[2]<c[0]||c[3]<c[1]))},f.prototype.updateImage=function(c,m){m.version=this.images[c].version+1,this.images[c]=m,this.updatedImages[c]=!0},f.prototype.removeImage=function(c){var m=this.images[c];delete this.images[c],delete this.patterns[c],m.userImage&&m.userImage.onRemove&&m.userImage.onRemove()},f.prototype.listImages=function(){return Object.keys(this.images)},f.prototype.getImages=function(c,m){var E=!0;if(!this.isLoaded())for(var P=0,T=c;P<T.length;P+=1)this.images[T[P]]||(E=!1);this.isLoaded()||E?this._notify(c,m):this.requestors.push({ids:c,callback:m})},f.prototype._notify=function(c,m){for(var E={},P=0,T=c;P<T.length;P+=1){var R=T[P];this.images[R]||this.fire(new s.Event("styleimagemissing",{id:R}));var V=this.images[R];V?E[R]={data:V.data.clone(),pixelRatio:V.pixelRatio,sdf:V.sdf,version:V.version,stretchX:V.stretchX,stretchY:V.stretchY,content:V.content,hasRenderCallback:Boolean(V.userImage&&V.userImage.render)}:s.warnOnce('Image "'+R+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}m(null,E)},f.prototype.getPixelSize=function(){var c=this.atlasImage;return{width:c.width,height:c.height}},f.prototype.getPattern=function(c){var m=this.patterns[c],E=this.getImage(c);if(!E)return null;if(m&&m.position.version===E.version)return m.position;if(m)m.position.version=E.version;else{var P={w:E.data.width+2,h:E.data.height+2,x:0,y:0},T=new s.ImagePosition(P,E);this.patterns[c]={bin:P,position:T}}return this._updatePatternAtlas(),this.patterns[c].position},f.prototype.bind=function(c){var m=c.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new s.Texture(c,this.atlasImage,m.RGBA),this.atlasTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE)},f.prototype._updatePatternAtlas=function(){var c=[];for(var m in this.patterns)c.push(this.patterns[m].bin);var E=s.potpack(c),P=E.w,T=E.h,R=this.atlasImage;for(var V in R.resize({width:P||1,height:T||1}),this.patterns){var Q=this.patterns[V].bin,vt=Q.x+1,Et=Q.y+1,_t=this.images[V].data,Jt=_t.width,Gt=_t.height;s.RGBAImage.copy(_t,R,{x:0,y:0},{x:vt,y:Et},{width:Jt,height:Gt}),s.RGBAImage.copy(_t,R,{x:0,y:Gt-1},{x:vt,y:Et-1},{width:Jt,height:1}),s.RGBAImage.copy(_t,R,{x:0,y:0},{x:vt,y:Et+Gt},{width:Jt,height:1}),s.RGBAImage.copy(_t,R,{x:Jt-1,y:0},{x:vt-1,y:Et},{width:1,height:Gt}),s.RGBAImage.copy(_t,R,{x:0,y:0},{x:vt+Jt,y:Et},{width:1,height:Gt})}this.dirty=!0},f.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},f.prototype.dispatchRenderCallbacks=function(c){for(var m=0,E=c;m<E.length;m+=1){var P=E[m];if(!this.callbackDispatchedThisFrame[P]){this.callbackDispatchedThisFrame[P]=!0;var T=this.images[P];ge(T)&&this.updateImage(P,T)}}},f}(s.Evented),it=X,$=X,tt=1e20;function X(l,f,c,m,E,P){this.fontSize=l||24,this.buffer=void 0===f?3:f,this.cutoff=m||.25,this.fontFamily=E||"sans-serif",this.fontWeight=P||"normal",this.radius=c||8;var T=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=T,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.d=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Int16Array(T),this.middle=Math.round(T/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function rt(l,f,c,m,E,P,T){for(var R=0;R<f;R++){for(var V=0;V<c;V++)m[V]=l[V*f+R];for(H(m,E,P,T,c),V=0;V<c;V++)l[V*f+R]=E[V]}for(V=0;V<c;V++){for(R=0;R<f;R++)m[R]=l[V*f+R];for(H(m,E,P,T,f),R=0;R<f;R++)l[V*f+R]=Math.sqrt(E[R])}}function H(l,f,c,m,E){c[0]=0,m[0]=-tt,m[1]=+tt;for(var P=1,T=0;P<E;P++){for(var R=(l[P]+P*P-(l[c[T]]+c[T]*c[T]))/(2*P-2*c[T]);R<=m[T];)T--,R=(l[P]+P*P-(l[c[T]]+c[T]*c[T]))/(2*P-2*c[T]);c[++T]=P,m[T]=R,m[T+1]=+tt}for(P=0,T=0;P<E;P++){for(;m[T+1]<P;)T++;f[P]=(P-c[T])*(P-c[T])+l[c[T]]}}X.prototype.draw=function(l){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(l,this.buffer,this.middle);for(var f=this.ctx.getImageData(0,0,this.size,this.size),c=new Uint8ClampedArray(this.size*this.size),m=0;m<this.size*this.size;m++){var E=f.data[4*m+3]/255;this.gridOuter[m]=1===E?0:0===E?tt:Math.pow(Math.max(0,.5-E),2),this.gridInner[m]=1===E?tt:0===E?0:Math.pow(Math.max(0,E-.5),2)}for(rt(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),rt(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),m=0;m<this.size*this.size;m++)c[m]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[m]-this.gridInner[m])/this.radius+this.cutoff))));return c},it.default=$;var et=function(l,f){this.requestManager=l,this.localIdeographFontFamily=f,this.entries={}};et.prototype.setURL=function(l){this.url=l},et.prototype.getGlyphs=function(l,f){var c=this,m=[];for(var E in l)for(var P=0,T=l[E];P<T.length;P+=1)m.push({stack:E,id:T[P]});s.asyncAll(m,function(R,V){var Q=R.stack,vt=R.id,Et=c.entries[Q];Et||(Et=c.entries[Q]={glyphs:{},requests:{},ranges:{}});var _t=Et.glyphs[vt];if(void 0===_t){if(_t=c._tinySDF(Et,Q,vt))return Et.glyphs[vt]=_t,void V(null,{stack:Q,id:vt,glyph:_t});var Jt=Math.floor(vt/256);if(256*Jt>65535)V(new Error("glyphs > 65535 not supported"));else if(Et.ranges[Jt])V(null,{stack:Q,id:vt,glyph:_t});else{var Gt=Et.requests[Jt];Gt||(Gt=Et.requests[Jt]=[],et.loadGlyphRange(Q,Jt,c.url,c.requestManager,function(ee,jt){if(jt){for(var ie in jt)c._doesCharSupportLocalGlyph(+ie)||(Et.glyphs[+ie]=jt[+ie]);Et.ranges[Jt]=!0}for(var ye=0,we=Gt;ye<we.length;ye+=1)(0,we[ye])(ee,jt);delete Et.requests[Jt]})),Gt.push(function(ee,jt){ee?V(ee):jt&&V(null,{stack:Q,id:vt,glyph:jt[vt]||null})})}}else V(null,{stack:Q,id:vt,glyph:_t})},function(R,V){if(R)f(R);else if(V){for(var Q={},vt=0,Et=V;vt<Et.length;vt+=1){var _t=Et[vt],Jt=_t.stack,Gt=_t.id,ee=_t.glyph;(Q[Jt]||(Q[Jt]={}))[Gt]=ee&&{id:ee.id,bitmap:ee.bitmap.clone(),metrics:ee.metrics}}f(null,Q)}})},et.prototype._doesCharSupportLocalGlyph=function(l){return!!this.localIdeographFontFamily&&(s.isChar["CJK Unified Ideographs"](l)||s.isChar["Hangul Syllables"](l)||s.isChar.Hiragana(l)||s.isChar.Katakana(l))},et.prototype._tinySDF=function(l,f,c){var m=this.localIdeographFontFamily;if(m&&this._doesCharSupportLocalGlyph(c)){var E=l.tinySDF;if(!E){var P="400";/bold/i.test(f)?P="900":/medium/i.test(f)?P="500":/light/i.test(f)&&(P="200"),E=l.tinySDF=new et.TinySDF(24,3,8,.25,m,P)}return{id:c,bitmap:new s.AlphaImage({width:30,height:30},E.draw(String.fromCharCode(c))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},et.loadGlyphRange=function(l,f,c,m,E){var P=256*f,T=P+255,R=m.transformRequest(m.normalizeGlyphsURL(c).replace("{fontstack}",l).replace("{range}",P+"-"+T),s.ResourceType.Glyphs);s.getArrayBuffer(R,function(V,Q){if(V)E(V);else if(Q){for(var vt={},Et=0,_t=s.parseGlyphPBF(Q);Et<_t.length;Et+=1){var Jt=_t[Et];vt[Jt.id]=Jt}E(null,vt)}})},et.TinySDF=it;var at=function(){this.specification=s.styleSpec.light.position};at.prototype.possiblyEvaluate=function(l,f){return s.sphericalToCartesian(l.expression.evaluate(f))},at.prototype.interpolate=function(l,f,c){return{x:s.number(l.x,f.x,c),y:s.number(l.y,f.y,c),z:s.number(l.z,f.z,c)}};var j=new s.Properties({anchor:new s.DataConstantProperty(s.styleSpec.light.anchor),position:new at,color:new s.DataConstantProperty(s.styleSpec.light.color),intensity:new s.DataConstantProperty(s.styleSpec.light.intensity)}),Wt=function(l){function f(c){l.call(this),this._transitionable=new s.Transitionable(j),this.setLight(c),this._transitioning=this._transitionable.untransitioned()}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getLight=function(){return this._transitionable.serialize()},f.prototype.setLight=function(c,m){if(void 0===m&&(m={}),!this._validate(s.validateLight,c,m))for(var E in c){var P=c[E];s.endsWith(E,"-transition")?this._transitionable.setTransition(E.slice(0,-11),P):this._transitionable.setValue(E,P)}},f.prototype.updateTransitions=function(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)},f.prototype.hasTransition=function(){return this._transitioning.hasTransition()},f.prototype.recalculate=function(c){this.properties=this._transitioning.possiblyEvaluate(c)},f.prototype._validate=function(c,m,E){return(!E||!1!==E.validate)&&s.emitValidationErrors(this,c.call(s.validateStyle,s.extend({value:m,style:{glyphs:!0,sprite:!0},styleSpec:s.styleSpec})))},f}(s.Evented),Ct=function(l,f){this.width=l,this.height=f,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};Ct.prototype.getDash=function(l,f){var c=l.join(",")+String(f);return this.dashEntry[c]||(this.dashEntry[c]=this.addDash(l,f)),this.dashEntry[c]},Ct.prototype.getDashRanges=function(l,f,c){var m=[],E=l.length%2==1?-l[l.length-1]*c:0,P=l[0]*c,T=!0;m.push({left:E,right:P,isDash:T,zeroLength:0===l[0]});for(var R=l[0],V=1;V<l.length;V++){var Q=l[V];m.push({left:E=R*c,right:P=(R+=Q)*c,isDash:T=!T,zeroLength:0===Q})}return m},Ct.prototype.addRoundDash=function(l,f,c){for(var m=f/2,E=-c;E<=c;E++)for(var P=this.width*(this.nextRow+c+E),T=0,R=l[T],V=0;V<this.width;V++){V/R.right>1&&(R=l[++T]);var Q=Math.abs(V-R.left),vt=Math.abs(V-R.right),Et=Math.min(Q,vt),_t=void 0,Jt=E/c*(m+1);if(R.isDash){var Gt=m-Math.abs(Jt);_t=Math.sqrt(Et*Et+Gt*Gt)}else _t=m-Math.sqrt(Et*Et+Jt*Jt);this.data[P+V]=Math.max(0,Math.min(255,_t+128))}},Ct.prototype.addRegularDash=function(l){for(var f=l.length-1;f>=0;--f){var c=l[f],m=l[f+1];c.zeroLength?l.splice(f,1):m&&m.isDash===c.isDash&&(m.left=c.left,l.splice(f,1))}var E=l[0],P=l[l.length-1];E.isDash===P.isDash&&(E.left=P.left-this.width,P.right=E.right+this.width);for(var T=this.width*this.nextRow,R=0,V=l[R],Q=0;Q<this.width;Q++){Q/V.right>1&&(V=l[++R]);var vt=Math.abs(Q-V.left),Et=Math.abs(Q-V.right),_t=Math.min(vt,Et);this.data[T+Q]=Math.max(0,Math.min(255,(V.isDash?_t:-_t)+128))}},Ct.prototype.addDash=function(l,f){var c=f?7:0,m=2*c+1;if(this.nextRow+m>this.height)return s.warnOnce("LineAtlas out of space"),null;for(var E=0,P=0;P<l.length;P++)E+=l[P];if(0!==E){var T=this.width/E,R=this.getDashRanges(l,this.width,T);f?this.addRoundDash(R,T,c):this.addRegularDash(R)}var V={y:(this.nextRow+c+.5)/this.height,height:2*c/this.height,width:E};return this.nextRow+=m,this.dirty=!0,V},Ct.prototype.bind=function(l){var f=l.gl;this.texture?(f.bindTexture(f.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,f.texSubImage2D(f.TEXTURE_2D,0,0,0,this.width,this.height,f.ALPHA,f.UNSIGNED_BYTE,this.data))):(this.texture=f.createTexture(),f.bindTexture(f.TEXTURE_2D,this.texture),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.REPEAT),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.REPEAT),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.LINEAR),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.LINEAR),f.texImage2D(f.TEXTURE_2D,0,f.ALPHA,this.width,this.height,0,f.ALPHA,f.UNSIGNED_BYTE,this.data))};var kt=function l(f,c){this.workerPool=f,this.actors=[],this.currentActor=0,this.id=s.uniqueId();for(var m=this.workerPool.acquire(this.id),E=0;E<m.length;E++){var P=new l.Actor(m[E],c,this.id);P.name="Worker "+E,this.actors.push(P)}};function gt(l,f,c){var m=function(E,P){if(E)return c(E);if(P){var T=s.pick(s.extend(P,l),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);P.vector_layers&&(T.vectorLayers=P.vector_layers,T.vectorLayerIds=T.vectorLayers.map(function(R){return R.id})),T.tiles=f.canonicalizeTileset(T,l.url),c(null,T)}};return l.url?s.getJSON(f.transformRequest(f.normalizeSourceURL(l.url),s.ResourceType.Source),m):s.browser.frame(function(){return m(null,l)})}kt.prototype.broadcast=function(l,f,c){s.asyncAll(this.actors,function(m,E){m.send(l,f,E)},c=c||function(){})},kt.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},kt.prototype.remove=function(){this.actors.forEach(function(l){l.remove()}),this.actors=[],this.workerPool.release(this.id)},kt.Actor=s.Actor;var Fe=function(l,f,c){this.bounds=s.LngLatBounds.convert(this.validateBounds(l)),this.minzoom=f||0,this.maxzoom=c||24};Fe.prototype.validateBounds=function(l){return Array.isArray(l)&&4===l.length?[Math.max(-180,l[0]),Math.max(-90,l[1]),Math.min(180,l[2]),Math.min(90,l[3])]:[-180,-90,180,90]},Fe.prototype.contains=function(l){var f=Math.pow(2,l.z),c=Math.floor(s.mercatorXfromLng(this.bounds.getWest())*f),m=Math.floor(s.mercatorYfromLat(this.bounds.getNorth())*f),E=Math.ceil(s.mercatorXfromLng(this.bounds.getEast())*f),P=Math.ceil(s.mercatorYfromLat(this.bounds.getSouth())*f);return l.x>=c&&l.x<E&&l.y>=m&&l.y<P};var Ie=function(l){function f(c,m,E,P){if(l.call(this),this.id=c,this.dispatcher=E,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.extend(this,s.pick(m,["url","scheme","tileSize","promoteId"])),this._options=s.extend({type:"vector"},m),this._collectResourceTiming=m.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(P)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.load=function(){var c=this;this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=gt(this._options,this.map._requestManager,function(m,E){c._tileJSONRequest=null,c._loaded=!0,m?c.fire(new s.ErrorEvent(m)):E&&(s.extend(c,E),E.bounds&&(c.tileBounds=new Fe(E.bounds,c.minzoom,c.maxzoom)),s.postTurnstileEvent(E.tiles,c.map._requestManager._customAccessToken),s.postMapLoadEvent(E.tiles,c.map._getMapId(),c.map._requestManager._skuToken,c.map._requestManager._customAccessToken),c.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),c.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})))})},f.prototype.loaded=function(){return this._loaded},f.prototype.hasTile=function(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)},f.prototype.onAdd=function(c){this.map=c,this.load()},f.prototype.setSourceProperty=function(c){this._tileJSONRequest&&this._tileJSONRequest.cancel(),c(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},f.prototype.setTiles=function(c){var m=this;return this.setSourceProperty(function(){m._options.tiles=c}),this},f.prototype.setUrl=function(c){var m=this;return this.setSourceProperty(function(){m.url=c,m._options.url=c}),this},f.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},f.prototype.serialize=function(){return s.extend({},this._options)},f.prototype.loadTile=function(c,m){var E=this.map._requestManager.normalizeTileURL(c.tileID.canonical.url(this.tiles,this.scheme)),P={request:this.map._requestManager.transformRequest(E,s.ResourceType.Tile),uid:c.uid,tileID:c.tileID,zoom:c.tileID.overscaledZ,tileSize:this.tileSize*c.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:s.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function T(R,V){return delete c.request,c.aborted?m(null):R&&404!==R.status?m(R):(V&&V.resourceTiming&&(c.resourceTiming=V.resourceTiming),this.map._refreshExpiredTiles&&V&&c.setExpiryData(V),c.loadVectorData(V,this.map.painter),s.cacheEntryPossiblyAdded(this.dispatcher),m(null),void(c.reloadCallback&&(this.loadTile(c,c.reloadCallback),c.reloadCallback=null)))}P.request.collectResourceTiming=this._collectResourceTiming,c.actor&&"expired"!==c.state?"loading"===c.state?c.reloadCallback=m:c.request=c.actor.send("reloadTile",P,T.bind(this)):(c.actor=this.dispatcher.getActor(),c.request=c.actor.send("loadTile",P,T.bind(this)))},f.prototype.abortTile=function(c){c.request&&(c.request.cancel(),delete c.request),c.actor&&c.actor.send("abortTile",{uid:c.uid,type:this.type,source:this.id},void 0)},f.prototype.unloadTile=function(c){c.unloadVectorData(),c.actor&&c.actor.send("removeTile",{uid:c.uid,type:this.type,source:this.id},void 0)},f.prototype.hasTransition=function(){return!1},f}(s.Evented),It=function(l){function f(c,m,E,P){l.call(this),this.id=c,this.dispatcher=E,this.setEventedParent(P),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.extend({type:"raster"},m),s.extend(this,s.pick(m,["url","scheme","tileSize"]))}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.load=function(){var c=this;this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=gt(this._options,this.map._requestManager,function(m,E){c._tileJSONRequest=null,c._loaded=!0,m?c.fire(new s.ErrorEvent(m)):E&&(s.extend(c,E),E.bounds&&(c.tileBounds=new Fe(E.bounds,c.minzoom,c.maxzoom)),s.postTurnstileEvent(E.tiles),s.postMapLoadEvent(E.tiles,c.map._getMapId(),c.map._requestManager._skuToken),c.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),c.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})))})},f.prototype.loaded=function(){return this._loaded},f.prototype.onAdd=function(c){this.map=c,this.load()},f.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},f.prototype.serialize=function(){return s.extend({},this._options)},f.prototype.hasTile=function(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)},f.prototype.loadTile=function(c,m){var E=this,P=this.map._requestManager.normalizeTileURL(c.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);c.request=s.getImage(this.map._requestManager.transformRequest(P,s.ResourceType.Tile),function(T,R){if(delete c.request,c.aborted)c.state="unloaded",m(null);else if(T)c.state="errored",m(T);else if(R){E.map._refreshExpiredTiles&&c.setExpiryData(R),delete R.cacheControl,delete R.expires;var V=E.map.painter.context,Q=V.gl;c.texture=E.map.painter.getTileTexture(R.width),c.texture?c.texture.update(R,{useMipmap:!0}):(c.texture=new s.Texture(V,R,Q.RGBA,{useMipmap:!0}),c.texture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE,Q.LINEAR_MIPMAP_NEAREST),V.extTextureFilterAnisotropic&&Q.texParameterf(Q.TEXTURE_2D,V.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,V.extTextureFilterAnisotropicMax)),c.state="loaded",s.cacheEntryPossiblyAdded(E.dispatcher),m(null)}})},f.prototype.abortTile=function(c,m){c.request&&(c.request.cancel(),delete c.request),m()},f.prototype.unloadTile=function(c,m){c.texture&&this.map.painter.saveTileTexture(c.texture),m()},f.prototype.hasTransition=function(){return!1},f}(s.Evented),pe=function(l){function f(c,m,E,P){l.call(this,c,m,E,P),this.type="raster-dem",this.maxzoom=22,this._options=s.extend({type:"raster-dem"},m),this.encoding=m.encoding||"mapbox"}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},f.prototype.loadTile=function(c,m){var E=this.map._requestManager.normalizeTileURL(c.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function P(T,R){T&&(c.state="errored",m(T)),R&&(c.dem=R,c.needsHillshadePrepare=!0,c.state="loaded",m(null))}c.request=s.getImage(this.map._requestManager.transformRequest(E,s.ResourceType.Tile),function(T,R){if(delete c.request,c.aborted)c.state="unloaded",m(null);else if(T)c.state="errored",m(T);else if(R){this.map._refreshExpiredTiles&&c.setExpiryData(R),delete R.cacheControl,delete R.expires;var V=s.window.ImageBitmap&&R instanceof s.window.ImageBitmap&&s.offscreenCanvasSupported()?R:s.browser.getImageData(R,1),Q={uid:c.uid,coord:c.tileID,source:this.id,rawImageData:V,encoding:this.encoding};c.actor&&"expired"!==c.state||(c.actor=this.dispatcher.getActor(),c.actor.send("loadDEMTile",Q,P.bind(this)))}}.bind(this)),c.neighboringTiles=this._getNeighboringTiles(c.tileID)},f.prototype._getNeighboringTiles=function(c){var m=c.canonical,E=Math.pow(2,m.z),P=(m.x-1+E)%E,T=0===m.x?c.wrap-1:c.wrap,R=(m.x+1+E)%E,V=m.x+1===E?c.wrap+1:c.wrap,Q={};return Q[new s.OverscaledTileID(c.overscaledZ,T,m.z,P,m.y).key]={backfilled:!1},Q[new s.OverscaledTileID(c.overscaledZ,V,m.z,R,m.y).key]={backfilled:!1},m.y>0&&(Q[new s.OverscaledTileID(c.overscaledZ,T,m.z,P,m.y-1).key]={backfilled:!1},Q[new s.OverscaledTileID(c.overscaledZ,c.wrap,m.z,m.x,m.y-1).key]={backfilled:!1},Q[new s.OverscaledTileID(c.overscaledZ,V,m.z,R,m.y-1).key]={backfilled:!1}),m.y+1<E&&(Q[new s.OverscaledTileID(c.overscaledZ,T,m.z,P,m.y+1).key]={backfilled:!1},Q[new s.OverscaledTileID(c.overscaledZ,c.wrap,m.z,m.x,m.y+1).key]={backfilled:!1},Q[new s.OverscaledTileID(c.overscaledZ,V,m.z,R,m.y+1).key]={backfilled:!1}),Q},f.prototype.unloadTile=function(c){c.demTexture&&this.map.painter.saveTileTexture(c.demTexture),c.fbo&&(c.fbo.destroy(),delete c.fbo),c.dem&&delete c.dem,delete c.neighboringTiles,c.state="unloaded",c.actor&&c.actor.send("removeDEMTile",{uid:c.uid,source:this.id})},f}(It),Pt=function(l){function f(c,m,E,P){l.call(this),this.id=c,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=E.getActor(),this.setEventedParent(P),this._data=m.data,this._options=s.extend({},m),this._collectResourceTiming=m.collectResourceTiming,this._resourceTiming=[],void 0!==m.maxzoom&&(this.maxzoom=m.maxzoom),m.type&&(this.type=m.type),m.attribution&&(this.attribution=m.attribution),this.promoteId=m.promoteId;var T=s.EXTENT/this.tileSize;this.workerOptions=s.extend({source:this.id,cluster:m.cluster||!1,geojsonVtOptions:{buffer:(void 0!==m.buffer?m.buffer:128)*T,tolerance:(void 0!==m.tolerance?m.tolerance:.375)*T,extent:s.EXTENT,maxZoom:this.maxzoom,lineMetrics:m.lineMetrics||!1,generateId:m.generateId||!1},superclusterOptions:{maxZoom:void 0!==m.clusterMaxZoom?Math.min(m.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,m.clusterMinPoints||2),extent:s.EXTENT,radius:(m.clusterRadius||50)*T,log:!1,generateId:m.generateId||!1},clusterProperties:m.clusterProperties,filter:m.filter},m.workerOptions)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.load=function(){var c=this;this.fire(new s.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(m){if(m)c.fire(new s.ErrorEvent(m));else{var E={dataType:"source",sourceDataType:"metadata"};c._collectResourceTiming&&c._resourceTiming&&c._resourceTiming.length>0&&(E.resourceTiming=c._resourceTiming,c._resourceTiming=[]),c.fire(new s.Event("data",E))}})},f.prototype.onAdd=function(c){this.map=c,this.load()},f.prototype.setData=function(c){var m=this;return this._data=c,this.fire(new s.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(E){if(E)m.fire(new s.ErrorEvent(E));else{var P={dataType:"source",sourceDataType:"content"};m._collectResourceTiming&&m._resourceTiming&&m._resourceTiming.length>0&&(P.resourceTiming=m._resourceTiming,m._resourceTiming=[]),m.fire(new s.Event("data",P))}}),this},f.prototype.getClusterExpansionZoom=function(c,m){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:c,source:this.id},m),this},f.prototype.getClusterChildren=function(c,m){return this.actor.send("geojson.getClusterChildren",{clusterId:c,source:this.id},m),this},f.prototype.getClusterLeaves=function(c,m,E,P){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:c,limit:m,offset:E},P),this},f.prototype._updateWorkerData=function(c){var m=this;this._loaded=!1;var E=s.extend({},this.workerOptions),P=this._data;"string"==typeof P?(E.request=this.map._requestManager.transformRequest(s.browser.resolveURL(P),s.ResourceType.Source),E.request.collectResourceTiming=this._collectResourceTiming):E.data=JSON.stringify(P),this.actor.send(this.type+".loadData",E,function(T,R){m._removed||R&&R.abandoned||(m._loaded=!0,R&&R.resourceTiming&&R.resourceTiming[m.id]&&(m._resourceTiming=R.resourceTiming[m.id].slice(0)),m.actor.send(m.type+".coalesce",{source:E.source},null),c(T))})},f.prototype.loaded=function(){return this._loaded},f.prototype.loadTile=function(c,m){var E=this,P=c.actor?"reloadTile":"loadTile";c.actor=this.actor,c.request=this.actor.send(P,{type:this.type,uid:c.uid,tileID:c.tileID,zoom:c.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:s.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(T,R){return delete c.request,c.unloadVectorData(),c.aborted?m(null):T?m(T):(c.loadVectorData(R,E.map.painter,"reloadTile"===P),m(null))})},f.prototype.abortTile=function(c){c.request&&(c.request.cancel(),delete c.request),c.aborted=!0},f.prototype.unloadTile=function(c){c.unloadVectorData(),this.actor.send("removeTile",{uid:c.uid,type:this.type,source:this.id})},f.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},f.prototype.serialize=function(){return s.extend({},this._options,{type:this.type,data:this._data})},f.prototype.hasTransition=function(){return!1},f}(s.Evented),te=s.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),le=function(l){function f(c,m,E,P){l.call(this),this.id=c,this.dispatcher=E,this.coordinates=m.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(P),this.options=m}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.load=function(c,m){var E=this;this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this.url=this.options.url,s.getImage(this.map._requestManager.transformRequest(this.url,s.ResourceType.Image),function(P,T){E._loaded=!0,P?E.fire(new s.ErrorEvent(P)):T&&(E.image=T,c&&(E.coordinates=c),m&&m(),E._finishLoading())})},f.prototype.loaded=function(){return this._loaded},f.prototype.updateImage=function(c){var m=this;return this.image&&c.url?(this.options.url=c.url,this.load(c.coordinates,function(){m.texture=null}),this):this},f.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})))},f.prototype.onAdd=function(c){this.map=c,this.load()},f.prototype.setCoordinates=function(c){var m=this;this.coordinates=c;var E=c.map(s.MercatorCoordinate.fromLngLat);this.tileID=function(T){for(var R=1/0,V=1/0,Q=-1/0,vt=-1/0,Et=0,_t=T;Et<_t.length;Et+=1){var Jt=_t[Et];R=Math.min(R,Jt.x),V=Math.min(V,Jt.y),Q=Math.max(Q,Jt.x),vt=Math.max(vt,Jt.y)}var Gt=Math.max(Q-R,vt-V),ee=Math.max(0,Math.floor(-Math.log(Gt)/Math.LN2)),jt=Math.pow(2,ee);return new s.CanonicalTileID(ee,Math.floor((R+Q)/2*jt),Math.floor((V+vt)/2*jt))}(E),this.minzoom=this.maxzoom=this.tileID.z;var P=E.map(function(T){return m.tileID.getTilePoint(T)._round()});return this._boundsArray=new s.StructArrayLayout4i8,this._boundsArray.emplaceBack(P[0].x,P[0].y,0,0),this._boundsArray.emplaceBack(P[1].x,P[1].y,s.EXTENT,0),this._boundsArray.emplaceBack(P[3].x,P[3].y,0,s.EXTENT),this._boundsArray.emplaceBack(P[2].x,P[2].y,s.EXTENT,s.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})),this},f.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var c=this.map.painter.context,m=c.gl;for(var E in this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,te.members)),this.boundsSegments||(this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new s.Texture(c,this.image,m.RGBA),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE)),this.tiles){var P=this.tiles[E];"loaded"!==P.state&&(P.state="loaded",P.texture=this.texture)}}},f.prototype.loadTile=function(c,m){this.tileID&&this.tileID.equals(c.tileID.canonical)?(this.tiles[String(c.tileID.wrap)]=c,c.buckets={},m(null)):(c.state="errored",m(null))},f.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},f.prototype.hasTransition=function(){return!1},f}(s.Evented),Ot=function(l){function f(c,m,E,P){l.call(this,c,m,E,P),this.roundZoom=!0,this.type="video",this.options=m}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.load=function(){var c=this;this._loaded=!1;var m=this.options;this.urls=[];for(var E=0,P=m.urls;E<P.length;E+=1)this.urls.push(this.map._requestManager.transformRequest(P[E],s.ResourceType.Source).url);s.getVideo(this.urls,function(T,R){c._loaded=!0,T?c.fire(new s.ErrorEvent(T)):R&&(c.video=R,c.video.loop=!0,c.video.addEventListener("playing",function(){c.map.triggerRepaint()}),c.map&&c.video.play(),c._finishLoading())})},f.prototype.pause=function(){this.video&&this.video.pause()},f.prototype.play=function(){this.video&&this.video.play()},f.prototype.seek=function(c){if(this.video){var m=this.video.seekable;c<m.start(0)||c>m.end(0)?this.fire(new s.ErrorEvent(new s.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+m.start(0)+" and "+m.end(0)+"-second mark."))):this.video.currentTime=c}},f.prototype.getVideo=function(){return this.video},f.prototype.onAdd=function(c){this.map||(this.map=c,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},f.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var c=this.map.painter.context,m=c.gl;for(var E in this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,te.members)),this.boundsSegments||(this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE),m.texSubImage2D(m.TEXTURE_2D,0,0,0,m.RGBA,m.UNSIGNED_BYTE,this.video)):(this.texture=new s.Texture(c,this.video,m.RGBA),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE)),this.tiles){var P=this.tiles[E];"loaded"!==P.state&&(P.state="loaded",P.texture=this.texture)}}},f.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},f.prototype.hasTransition=function(){return this.video&&!this.video.paused},f}(le),Ue=function(l){function f(c,m,E,P){l.call(this,c,m,E,P),m.coordinates?Array.isArray(m.coordinates)&&4===m.coordinates.length&&!m.coordinates.some(function(T){return!Array.isArray(T)||2!==T.length||T.some(function(R){return"number"!=typeof R})})||this.fire(new s.ErrorEvent(new s.ValidationError("sources."+c,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.ErrorEvent(new s.ValidationError("sources."+c,null,'missing required property "coordinates"'))),m.animate&&"boolean"!=typeof m.animate&&this.fire(new s.ErrorEvent(new s.ValidationError("sources."+c,null,'optional "animate" property must be a boolean value'))),m.canvas?"string"==typeof m.canvas||m.canvas instanceof s.window.HTMLCanvasElement||this.fire(new s.ErrorEvent(new s.ValidationError("sources."+c,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.ErrorEvent(new s.ValidationError("sources."+c,null,'missing required property "canvas"'))),this.options=m,this.animate=void 0===m.animate||m.animate}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof s.window.HTMLCanvasElement?this.options.canvas:s.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},f.prototype.getCanvas=function(){return this.canvas},f.prototype.onAdd=function(c){this.map=c,this.load(),this.canvas&&this.animate&&this.play()},f.prototype.onRemove=function(){this.pause()},f.prototype.prepare=function(){var c=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,c=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,c=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var m=this.map.painter.context,E=m.gl;for(var P in this.boundsBuffer||(this.boundsBuffer=m.createVertexBuffer(this._boundsArray,te.members)),this.boundsSegments||(this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(c||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.Texture(m,this.canvas,E.RGBA,{premultiply:!0}),this.tiles){var T=this.tiles[P];"loaded"!==T.state&&(T.state="loaded",T.texture=this.texture)}}},f.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},f.prototype.hasTransition=function(){return this._playing},f.prototype._hasInvalidDimensions=function(){for(var c=0,m=[this.canvas.width,this.canvas.height];c<m.length;c+=1){var E=m[c];if(isNaN(E)||E<=0)return!0}return!1},f}(le),ze={vector:Ie,raster:It,"raster-dem":pe,geojson:Pt,video:Ot,image:le,canvas:Ue};function ar(l,f){var c=s.identity([]);return s.translate(c,c,[1,1,0]),s.scale(c,c,[.5*l.width,.5*l.height,1]),s.multiply(c,c,l.calculatePosMatrix(f.toUnwrapped()))}function Me(l,f,c,m,E,P){var T=function(ee,jt,ie){if(ee)for(var ye=0,we=ee;ye<we.length;ye+=1){var Ze=jt[we[ye]];if(Ze&&Ze.source===ie&&"fill-extrusion"===Ze.type)return!0}else for(var Ne in jt){var We=jt[Ne];if(We.source===ie&&"fill-extrusion"===We.type)return!0}return!1}(E&&E.layers,f,l.id),R=P.maxPitchScaleFactor(),V=l.tilesIn(m,R,T);V.sort(Mr);for(var Q=[],vt=0,Et=V;vt<Et.length;vt+=1){var _t=Et[vt];Q.push({wrappedTileID:_t.tileID.wrapped().key,queryResults:_t.tile.queryRenderedFeatures(f,c,l._state,_t.queryGeometry,_t.cameraQueryGeometry,_t.scale,E,P,R,ar(l.transform,_t.tileID))})}var Jt=function(ee){for(var jt={},ie={},ye=0,we=ee;ye<we.length;ye+=1){var Ze=we[ye],Ne=Ze.queryResults,We=Ze.wrappedTileID,er=ie[We]=ie[We]||{};for(var br in Ne)for(var fr=Ne[br],Br=er[br]=er[br]||{},cn=jt[br]=jt[br]||[],hn=0,rn=fr;hn<rn.length;hn+=1){var Pi=rn[hn];Br[Pi.featureIndex]||(Br[Pi.featureIndex]=!0,cn.push(Pi))}}return jt}(Q);for(var Gt in Jt)Jt[Gt].forEach(function(ee){var jt=ee.feature,ie=l.getFeatureState(jt.layer["source-layer"],jt.id);jt.source=jt.layer.source,jt.layer["source-layer"]&&(jt.sourceLayer=jt.layer["source-layer"]),jt.state=ie});return Jt}function Mr(l,f){var c=l.tileID,m=f.tileID;return c.overscaledZ-m.overscaledZ||c.canonical.y-m.canonical.y||c.wrap-m.wrap||c.canonical.x-m.canonical.x}var lr=function(l,f){this.max=l,this.onRemove=f,this.reset()};lr.prototype.reset=function(){for(var l in this.data)for(var f=0,c=this.data[l];f<c.length;f+=1){var m=c[f];m.timeout&&clearTimeout(m.timeout),this.onRemove(m.value)}return this.data={},this.order=[],this},lr.prototype.add=function(l,f,c){var m=this,E=l.wrapped().key;void 0===this.data[E]&&(this.data[E]=[]);var P={value:f,timeout:void 0};if(void 0!==c&&(P.timeout=setTimeout(function(){m.remove(l,P)},c)),this.data[E].push(P),this.order.push(E),this.order.length>this.max){var T=this._getAndRemoveByKey(this.order[0]);T&&this.onRemove(T)}return this},lr.prototype.has=function(l){return l.wrapped().key in this.data},lr.prototype.getAndRemove=function(l){return this.has(l)?this._getAndRemoveByKey(l.wrapped().key):null},lr.prototype._getAndRemoveByKey=function(l){var f=this.data[l].shift();return f.timeout&&clearTimeout(f.timeout),0===this.data[l].length&&delete this.data[l],this.order.splice(this.order.indexOf(l),1),f.value},lr.prototype.getByKey=function(l){var f=this.data[l];return f?f[0].value:null},lr.prototype.get=function(l){return this.has(l)?this.data[l.wrapped().key][0].value:null},lr.prototype.remove=function(l,f){if(!this.has(l))return this;var c=l.wrapped().key,m=void 0===f?0:this.data[c].indexOf(f),E=this.data[c][m];return this.data[c].splice(m,1),E.timeout&&clearTimeout(E.timeout),0===this.data[c].length&&delete this.data[c],this.onRemove(E.value),this.order.splice(this.order.indexOf(c),1),this},lr.prototype.setMaxSize=function(l){for(this.max=l;this.order.length>this.max;){var f=this._getAndRemoveByKey(this.order[0]);f&&this.onRemove(f)}return this},lr.prototype.filter=function(l){var f=[];for(var c in this.data)for(var m=0,E=this.data[c];m<E.length;m+=1){var P=E[m];l(P.value)||f.push(P)}for(var T=0,R=f;T<R.length;T+=1){var V=R[T];this.remove(V.value.tileID,V)}};var kr=function(l,f,c){this.context=l;var m=l.gl;this.buffer=m.createBuffer(),this.dynamicDraw=Boolean(c),this.context.unbindVAO(),l.bindElementBuffer.set(this.buffer),m.bufferData(m.ELEMENT_ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||delete f.arrayBuffer};kr.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},kr.prototype.updateData=function(l){var f=this.context.gl;this.context.unbindVAO(),this.bind(),f.bufferSubData(f.ELEMENT_ARRAY_BUFFER,0,l.arrayBuffer)},kr.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Xr={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Sr=function(l,f,c,m){this.length=f.length,this.attributes=c,this.itemSize=f.bytesPerElement,this.dynamicDraw=m,this.context=l;var E=l.gl;this.buffer=E.createBuffer(),l.bindVertexBuffer.set(this.buffer),E.bufferData(E.ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?E.DYNAMIC_DRAW:E.STATIC_DRAW),this.dynamicDraw||delete f.arrayBuffer};Sr.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Sr.prototype.updateData=function(l){var f=this.context.gl;this.bind(),f.bufferSubData(f.ARRAY_BUFFER,0,l.arrayBuffer)},Sr.prototype.enableAttributes=function(l,f){for(var c=0;c<this.attributes.length;c++){var m=f.attributes[this.attributes[c].name];void 0!==m&&l.enableVertexAttribArray(m)}},Sr.prototype.setVertexAttribPointers=function(l,f,c){for(var m=0;m<this.attributes.length;m++){var E=this.attributes[m],P=f.attributes[E.name];void 0!==P&&l.vertexAttribPointer(P,E.components,l[Xr[E.type]],!1,this.itemSize,E.offset+this.itemSize*(c||0))}},Sr.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var qe=function(l){this.gl=l.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};qe.prototype.get=function(){return this.current},qe.prototype.set=function(l){},qe.prototype.getDefault=function(){return this.default},qe.prototype.setDefault=function(){this.set(this.default)};var ti=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return s.Color.transparent},f.prototype.set=function(c){var m=this.current;(c.r!==m.r||c.g!==m.g||c.b!==m.b||c.a!==m.a||this.dirty)&&(this.gl.clearColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)},f}(qe),vn=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return 1},f.prototype.set=function(c){(c!==this.current||this.dirty)&&(this.gl.clearDepth(c),this.current=c,this.dirty=!1)},f}(qe),Un=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return 0},f.prototype.set=function(c){(c!==this.current||this.dirty)&&(this.gl.clearStencil(c),this.current=c,this.dirty=!1)},f}(qe),ae=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return[!0,!0,!0,!0]},f.prototype.set=function(c){var m=this.current;(c[0]!==m[0]||c[1]!==m[1]||c[2]!==m[2]||c[3]!==m[3]||this.dirty)&&(this.gl.colorMask(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)},f}(qe),Ve=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return!0},f.prototype.set=function(c){(c!==this.current||this.dirty)&&(this.gl.depthMask(c),this.current=c,this.dirty=!1)},f}(qe),Kt=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return 255},f.prototype.set=function(c){(c!==this.current||this.dirty)&&(this.gl.stencilMask(c),this.current=c,this.dirty=!1)},f}(qe),st=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},f.prototype.set=function(c){var m=this.current;(c.func!==m.func||c.ref!==m.ref||c.mask!==m.mask||this.dirty)&&(this.gl.stencilFunc(c.func,c.ref,c.mask),this.current=c,this.dirty=!1)},f}(qe),nt=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){var c=this.gl;return[c.KEEP,c.KEEP,c.KEEP]},f.prototype.set=function(c){var m=this.current;(c[0]!==m[0]||c[1]!==m[1]||c[2]!==m[2]||this.dirty)&&(this.gl.stencilOp(c[0],c[1],c[2]),this.current=c,this.dirty=!1)},f}(qe),ot=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(c){if(c!==this.current||this.dirty){var m=this.gl;c?m.enable(m.STENCIL_TEST):m.disable(m.STENCIL_TEST),this.current=c,this.dirty=!1}},f}(qe),Rt=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return[0,1]},f.prototype.set=function(c){var m=this.current;(c[0]!==m[0]||c[1]!==m[1]||this.dirty)&&(this.gl.depthRange(c[0],c[1]),this.current=c,this.dirty=!1)},f}(qe),ce=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(c){if(c!==this.current||this.dirty){var m=this.gl;c?m.enable(m.DEPTH_TEST):m.disable(m.DEPTH_TEST),this.current=c,this.dirty=!1}},f}(qe),De=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return this.gl.LESS},f.prototype.set=function(c){(c!==this.current||this.dirty)&&(this.gl.depthFunc(c),this.current=c,this.dirty=!1)},f}(qe),Qe=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(c){if(c!==this.current||this.dirty){var m=this.gl;c?m.enable(m.BLEND):m.disable(m.BLEND),this.current=c,this.dirty=!1}},f}(qe),nr=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){var c=this.gl;return[c.ONE,c.ZERO]},f.prototype.set=function(c){var m=this.current;(c[0]!==m[0]||c[1]!==m[1]||this.dirty)&&(this.gl.blendFunc(c[0],c[1]),this.current=c,this.dirty=!1)},f}(qe),Xe=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return s.Color.transparent},f.prototype.set=function(c){var m=this.current;(c.r!==m.r||c.g!==m.g||c.b!==m.b||c.a!==m.a||this.dirty)&&(this.gl.blendColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)},f}(qe),pn=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return this.gl.FUNC_ADD},f.prototype.set=function(c){(c!==this.current||this.dirty)&&(this.gl.blendEquation(c),this.current=c,this.dirty=!1)},f}(qe),Kr=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(c){if(c!==this.current||this.dirty){var m=this.gl;c?m.enable(m.CULL_FACE):m.disable(m.CULL_FACE),this.current=c,this.dirty=!1}},f}(qe),pr=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return this.gl.BACK},f.prototype.set=function(c){(c!==this.current||this.dirty)&&(this.gl.cullFace(c),this.current=c,this.dirty=!1)},f}(qe),un=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return this.gl.CCW},f.prototype.set=function(c){(c!==this.current||this.dirty)&&(this.gl.frontFace(c),this.current=c,this.dirty=!1)},f}(qe),ei=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(c){(c!==this.current||this.dirty)&&(this.gl.useProgram(c),this.current=c,this.dirty=!1)},f}(qe),Kn=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return this.gl.TEXTURE0},f.prototype.set=function(c){(c!==this.current||this.dirty)&&(this.gl.activeTexture(c),this.current=c,this.dirty=!1)},f}(qe),Gn=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){var c=this.gl;return[0,0,c.drawingBufferWidth,c.drawingBufferHeight]},f.prototype.set=function(c){var m=this.current;(c[0]!==m[0]||c[1]!==m[1]||c[2]!==m[2]||c[3]!==m[3]||this.dirty)&&(this.gl.viewport(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)},f}(qe),Mn=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(c){if(c!==this.current||this.dirty){var m=this.gl;m.bindFramebuffer(m.FRAMEBUFFER,c),this.current=c,this.dirty=!1}},f}(qe),on=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(c){if(c!==this.current||this.dirty){var m=this.gl;m.bindRenderbuffer(m.RENDERBUFFER,c),this.current=c,this.dirty=!1}},f}(qe),bi=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(c){if(c!==this.current||this.dirty){var m=this.gl;m.bindTexture(m.TEXTURE_2D,c),this.current=c,this.dirty=!1}},f}(qe),To=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(c){if(c!==this.current||this.dirty){var m=this.gl;m.bindBuffer(m.ARRAY_BUFFER,c),this.current=c,this.dirty=!1}},f}(qe),oa=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(c){var m=this.gl;m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,c),this.current=c,this.dirty=!1},f}(qe),gi=function(l){function f(c){l.call(this,c),this.vao=c.extVertexArrayObject}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(c){this.vao&&(c!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(c),this.current=c,this.dirty=!1)},f}(qe),vo=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return 4},f.prototype.set=function(c){if(c!==this.current||this.dirty){var m=this.gl;m.pixelStorei(m.UNPACK_ALIGNMENT,c),this.current=c,this.dirty=!1}},f}(qe),On=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(c){if(c!==this.current||this.dirty){var m=this.gl;m.pixelStorei(m.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c),this.current=c,this.dirty=!1}},f}(qe),or=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(c){if(c!==this.current||this.dirty){var m=this.gl;m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,c),this.current=c,this.dirty=!1}},f}(qe),wi=function(l){function f(c,m){l.call(this,c),this.context=c,this.parent=m}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f}(qe),Y=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.setDirty=function(){this.dirty=!0},f.prototype.set=function(c){if(c!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var m=this.gl;m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,c,0),this.current=c,this.dirty=!1}},f}(wi),W=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.set=function(c){if(c!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var m=this.gl;m.framebufferRenderbuffer(m.FRAMEBUFFER,m.DEPTH_ATTACHMENT,m.RENDERBUFFER,c),this.current=c,this.dirty=!1}},f}(wi),pt=function(l,f,c,m){this.context=l,this.width=f,this.height=c;var E=this.framebuffer=l.gl.createFramebuffer();this.colorAttachment=new Y(l,E),m&&(this.depthAttachment=new W(l,E))};pt.prototype.destroy=function(){var l=this.context.gl,f=this.colorAttachment.get();if(f&&l.deleteTexture(f),this.depthAttachment){var c=this.depthAttachment.get();c&&l.deleteRenderbuffer(c)}l.deleteFramebuffer(this.framebuffer)};var bt=function(l,f,c){this.func=l,this.mask=f,this.range=c};bt.ReadOnly=!1,bt.ReadWrite=!0,bt.disabled=new bt(519,bt.ReadOnly,[0,1]);var Ft=function(l,f,c,m,E,P){this.test=l,this.ref=f,this.mask=c,this.fail=m,this.depthFail=E,this.pass=P};Ft.disabled=new Ft({func:519,mask:0},0,0,7680,7680,7680);var se=function(l,f,c){this.blendFunction=l,this.blendColor=f,this.mask=c};se.disabled=new se(se.Replace=[1,0],s.Color.transparent,[!1,!1,!1,!1]),se.unblended=new se(se.Replace,s.Color.transparent,[!0,!0,!0,!0]),se.alphaBlended=new se([1,771],s.Color.transparent,[!0,!0,!0,!0]);var me=function(l,f,c){this.enable=l,this.mode=f,this.frontFace=c};me.disabled=new me(!1,1029,2305),me.backCCW=new me(!0,1029,2305);var ue=function(l){this.gl=l,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new ti(this),this.clearDepth=new vn(this),this.clearStencil=new Un(this),this.colorMask=new ae(this),this.depthMask=new Ve(this),this.stencilMask=new Kt(this),this.stencilFunc=new st(this),this.stencilOp=new nt(this),this.stencilTest=new ot(this),this.depthRange=new Rt(this),this.depthTest=new ce(this),this.depthFunc=new De(this),this.blend=new Qe(this),this.blendFunc=new nr(this),this.blendColor=new Xe(this),this.blendEquation=new pn(this),this.cullFace=new Kr(this),this.cullFaceSide=new pr(this),this.frontFace=new un(this),this.program=new ei(this),this.activeTexture=new Kn(this),this.viewport=new Gn(this),this.bindFramebuffer=new Mn(this),this.bindRenderbuffer=new on(this),this.bindTexture=new bi(this),this.bindVertexBuffer=new To(this),this.bindElementBuffer=new oa(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new gi(this),this.pixelStoreUnpack=new vo(this),this.pixelStoreUnpackPremultiplyAlpha=new On(this),this.pixelStoreUnpackFlipY=new or(this),this.extTextureFilterAnisotropic=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=l.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=l.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(l.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=l.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=l.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE)};ue.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},ue.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},ue.prototype.createIndexBuffer=function(l,f){return new kr(this,l,f)},ue.prototype.createVertexBuffer=function(l,f,c){return new Sr(this,l,f,c)},ue.prototype.createRenderbuffer=function(l,f,c){var m=this.gl,E=m.createRenderbuffer();return this.bindRenderbuffer.set(E),m.renderbufferStorage(m.RENDERBUFFER,l,f,c),this.bindRenderbuffer.set(null),E},ue.prototype.createFramebuffer=function(l,f,c){return new pt(this,l,f,c)},ue.prototype.clear=function(l){var f=l.color,c=l.depth,m=this.gl,E=0;f&&(E|=m.COLOR_BUFFER_BIT,this.clearColor.set(f),this.colorMask.set([!0,!0,!0,!0])),void 0!==c&&(E|=m.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(c),this.depthMask.set(!0)),m.clear(E)},ue.prototype.setCullFace=function(l){!1===l.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(l.mode),this.frontFace.set(l.frontFace))},ue.prototype.setDepthMode=function(l){l.func!==this.gl.ALWAYS||l.mask?(this.depthTest.set(!0),this.depthFunc.set(l.func),this.depthMask.set(l.mask),this.depthRange.set(l.range)):this.depthTest.set(!1)},ue.prototype.setStencilMode=function(l){l.test.func!==this.gl.ALWAYS||l.mask?(this.stencilTest.set(!0),this.stencilMask.set(l.mask),this.stencilOp.set([l.fail,l.depthFail,l.pass]),this.stencilFunc.set({func:l.test.func,ref:l.ref,mask:l.test.mask})):this.stencilTest.set(!1)},ue.prototype.setColorMode=function(l){s.deepEqual(l.blendFunction,se.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(l.blendFunction),this.blendColor.set(l.blendColor)),this.colorMask.set(l.mask)},ue.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Dt=function(l){function f(c,m,E){var P=this;l.call(this),this.id=c,this.dispatcher=E,this.on("data",function(T){"source"===T.dataType&&"metadata"===T.sourceDataType&&(P._sourceLoaded=!0),P._sourceLoaded&&!P._paused&&"source"===T.dataType&&"content"===T.sourceDataType&&(P.reload(),P.transform&&P.update(P.transform))}),this.on("error",function(){P._sourceErrored=!0}),this._source=function(T,R,V,Q){var vt=new ze[R.type](T,R,V,Q);if(vt.id!==T)throw new Error("Expected Source id to be "+T+" instead of "+vt.id);return s.bindAll(["load","abort","unload","serialize","prepare"],vt),vt}(c,m,E,this),this._tiles={},this._cache=new lr(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new s.SourceFeatureState}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.onAdd=function(c){this.map=c,this._maxTileCacheSize=c?c._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(c)},f.prototype.onRemove=function(c){this._source&&this._source.onRemove&&this._source.onRemove(c)},f.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var c in this._tiles){var m=this._tiles[c];if("loaded"!==m.state&&"errored"!==m.state)return!1}return!0},f.prototype.getSource=function(){return this._source},f.prototype.pause=function(){this._paused=!0},f.prototype.resume=function(){if(this._paused){var c=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,c&&this.reload(),this.transform&&this.update(this.transform)}},f.prototype._loadTile=function(c,m){return this._source.loadTile(c,m)},f.prototype._unloadTile=function(c){if(this._source.unloadTile)return this._source.unloadTile(c,function(){})},f.prototype._abortTile=function(c){if(this._source.abortTile)return this._source.abortTile(c,function(){})},f.prototype.serialize=function(){return this._source.serialize()},f.prototype.prepare=function(c){for(var m in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var E=this._tiles[m];E.upload(c),E.prepare(this.map.style.imageManager)}},f.prototype.getIds=function(){return s.values(this._tiles).map(function(c){return c.tileID}).sort(Ht).map(function(c){return c.key})},f.prototype.getRenderableIds=function(c){var m=this,E=[];for(var P in this._tiles)this._isIdRenderable(P,c)&&E.push(this._tiles[P]);return c?E.sort(function(T,R){var V=T.tileID,Q=R.tileID,vt=new s.Point(V.canonical.x,V.canonical.y)._rotate(m.transform.angle),Et=new s.Point(Q.canonical.x,Q.canonical.y)._rotate(m.transform.angle);return V.overscaledZ-Q.overscaledZ||Et.y-vt.y||Et.x-vt.x}).map(function(T){return T.tileID.key}):E.map(function(T){return T.tileID}).sort(Ht).map(function(T){return T.key})},f.prototype.hasRenderableParent=function(c){var m=this.findLoadedParent(c,0);return!!m&&this._isIdRenderable(m.tileID.key)},f.prototype._isIdRenderable=function(c,m){return this._tiles[c]&&this._tiles[c].hasData()&&!this._coveredTiles[c]&&(m||!this._tiles[c].holdingForFade())},f.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var c in this._cache.reset(),this._tiles)"errored"!==this._tiles[c].state&&this._reloadTile(c,"reloading")},f.prototype._reloadTile=function(c,m){var E=this._tiles[c];E&&("loading"!==E.state&&(E.state=m),this._loadTile(E,this._tileLoaded.bind(this,E,c,m)))},f.prototype._tileLoaded=function(c,m,E,P){if(P)return c.state="errored",void(404!==P.status?this._source.fire(new s.ErrorEvent(P,{tile:c})):this.update(this.transform));c.timeAdded=s.browser.now(),"expired"===E&&(c.refreshedUponExpiration=!0),this._setTileReloadTimer(m,c),"raster-dem"===this.getSource().type&&c.dem&&this._backfillDEM(c),this._state.initializeTileState(c,this.map?this.map.painter:null),this._source.fire(new s.Event("data",{dataType:"source",tile:c,coord:c.tileID}))},f.prototype._backfillDEM=function(c){for(var m=this.getRenderableIds(),E=0;E<m.length;E++){var P=m[E];if(c.neighboringTiles&&c.neighboringTiles[P]){var T=this.getTileByID(P);R(c,T),R(T,c)}}function R(V,Q){V.needsHillshadePrepare=!0;var vt=Q.tileID.canonical.x-V.tileID.canonical.x,Et=Q.tileID.canonical.y-V.tileID.canonical.y,_t=Math.pow(2,V.tileID.canonical.z),Jt=Q.tileID.key;0===vt&&0===Et||Math.abs(Et)>1||(Math.abs(vt)>1&&(1===Math.abs(vt+_t)?vt+=_t:1===Math.abs(vt-_t)&&(vt-=_t)),Q.dem&&V.dem&&(V.dem.backfillBorder(Q.dem,vt,Et),V.neighboringTiles&&V.neighboringTiles[Jt]&&(V.neighboringTiles[Jt].backfilled=!0)))}},f.prototype.getTile=function(c){return this.getTileByID(c.key)},f.prototype.getTileByID=function(c){return this._tiles[c]},f.prototype._retainLoadedChildren=function(c,m,E,P){for(var T in this._tiles){var R=this._tiles[T];if(!(P[T]||!R.hasData()||R.tileID.overscaledZ<=m||R.tileID.overscaledZ>E)){for(var V=R.tileID;R&&R.tileID.overscaledZ>m+1;){var Q=R.tileID.scaledTo(R.tileID.overscaledZ-1);(R=this._tiles[Q.key])&&R.hasData()&&(V=Q)}for(var vt=V;vt.overscaledZ>m;)if(c[(vt=vt.scaledTo(vt.overscaledZ-1)).key]){P[V.key]=V;break}}}},f.prototype.findLoadedParent=function(c,m){if(c.key in this._loadedParentTiles){var E=this._loadedParentTiles[c.key];return E&&E.tileID.overscaledZ>=m?E:null}for(var P=c.overscaledZ-1;P>=m;P--){var T=c.scaledTo(P),R=this._getLoadedTile(T);if(R)return R}},f.prototype._getLoadedTile=function(c){var m=this._tiles[c.key];return m&&m.hasData()?m:this._cache.getByKey(c.wrapped().key)},f.prototype.updateCacheSize=function(c){var m=Math.ceil(c.width/this._source.tileSize)+1,E=Math.ceil(c.height/this._source.tileSize)+1,P=Math.floor(m*E*5),T="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,P):P;this._cache.setMaxSize(T)},f.prototype.handleWrapJump=function(c){var m=Math.round((c-(void 0===this._prevLng?c:this._prevLng))/360);if(this._prevLng=c,m){var E={};for(var P in this._tiles){var T=this._tiles[P];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+m),E[T.tileID.key]=T}for(var R in this._tiles=E,this._timers)clearTimeout(this._timers[R]),delete this._timers[R];for(var V in this._tiles)this._setTileReloadTimer(V,this._tiles[V])}},f.prototype.update=function(c){var m=this;if(this.transform=c,this._sourceLoaded&&!this._paused){var E;this.updateCacheSize(c),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?E=c.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(er){return new s.OverscaledTileID(er.canonical.z,er.wrap,er.canonical.z,er.canonical.x,er.canonical.y)}):(E=c.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(E=E.filter(function(er){return m._source.hasTile(er)}))):E=[];var P=c.coveringZoomLevel(this._source),T=Math.max(P-f.maxOverzooming,this._source.minzoom),R=Math.max(P+f.maxUnderzooming,this._source.minzoom),V=this._updateRetainedTiles(E,P);if(ir(this._source.type)){for(var Q={},vt={},Et=0,_t=Object.keys(V);Et<_t.length;Et+=1){var Jt=_t[Et],Gt=V[Jt],ee=this._tiles[Jt];if(ee&&!(ee.fadeEndTime&&ee.fadeEndTime<=s.browser.now())){var jt=this.findLoadedParent(Gt,T);jt&&(this._addTile(jt.tileID),Q[jt.tileID.key]=jt.tileID),vt[Jt]=Gt}}for(var ie in this._retainLoadedChildren(vt,P,R,V),Q)V[ie]||(this._coveredTiles[ie]=!0,V[ie]=Q[ie])}for(var ye in V)this._tiles[ye].clearFadeHold();for(var we=0,Ze=s.keysDifference(this._tiles,V);we<Ze.length;we+=1){var Ne=Ze[we],We=this._tiles[Ne];We.hasSymbolBuckets&&!We.holdingForFade()?We.setHoldDuration(this.map._fadeDuration):We.hasSymbolBuckets&&!We.symbolFadeFinished()||this._removeTile(Ne)}this._updateLoadedParentTileCache()}},f.prototype.releaseSymbolFadeTiles=function(){for(var c in this._tiles)this._tiles[c].holdingForFade()&&this._removeTile(c)},f.prototype._updateRetainedTiles=function(c,m){for(var E={},P={},T=Math.max(m-f.maxOverzooming,this._source.minzoom),R=Math.max(m+f.maxUnderzooming,this._source.minzoom),V={},Q=0,vt=c;Q<vt.length;Q+=1){var Et=vt[Q],_t=this._addTile(Et);E[Et.key]=Et,_t.hasData()||m<this._source.maxzoom&&(V[Et.key]=Et)}this._retainLoadedChildren(V,m,R,E);for(var Jt=0,Gt=c;Jt<Gt.length;Jt+=1){var ee=Gt[Jt],jt=this._tiles[ee.key];if(!jt.hasData()){if(m+1>this._source.maxzoom){var ie=ee.children(this._source.maxzoom)[0],ye=this.getTile(ie);if(ye&&ye.hasData()){E[ie.key]=ie;continue}}else{var we=ee.children(this._source.maxzoom);if(E[we[0].key]&&E[we[1].key]&&E[we[2].key]&&E[we[3].key])continue}for(var Ze=jt.wasRequested(),Ne=ee.overscaledZ-1;Ne>=T;--Ne){var We=ee.scaledTo(Ne);if(P[We.key]||(P[We.key]=!0,!(jt=this.getTile(We))&&Ze&&(jt=this._addTile(We)),jt&&(E[We.key]=We,Ze=jt.wasRequested(),jt.hasData())))break}}}return E},f.prototype._updateLoadedParentTileCache=function(){for(var c in this._loadedParentTiles={},this._tiles){for(var m=[],E=void 0,P=this._tiles[c].tileID;P.overscaledZ>0;){if(P.key in this._loadedParentTiles){E=this._loadedParentTiles[P.key];break}m.push(P.key);var T=P.scaledTo(P.overscaledZ-1);if(E=this._getLoadedTile(T))break;P=T}for(var R=0,V=m;R<V.length;R+=1)this._loadedParentTiles[V[R]]=E}},f.prototype._addTile=function(c){var m=this._tiles[c.key];if(m)return m;(m=this._cache.getAndRemove(c))&&(this._setTileReloadTimer(c.key,m),m.tileID=c,this._state.initializeTileState(m,this.map?this.map.painter:null),this._cacheTimers[c.key]&&(clearTimeout(this._cacheTimers[c.key]),delete this._cacheTimers[c.key],this._setTileReloadTimer(c.key,m)));var E=Boolean(m);return E||(m=new s.Tile(c,this._source.tileSize*c.overscaleFactor()),this._loadTile(m,this._tileLoaded.bind(this,m,c.key,m.state))),m?(m.uses++,this._tiles[c.key]=m,E||this._source.fire(new s.Event("dataloading",{tile:m,coord:m.tileID,dataType:"source"})),m):null},f.prototype._setTileReloadTimer=function(c,m){var E=this;c in this._timers&&(clearTimeout(this._timers[c]),delete this._timers[c]);var P=m.getExpiryTimeout();P&&(this._timers[c]=setTimeout(function(){E._reloadTile(c,"expired"),delete E._timers[c]},P))},f.prototype._removeTile=function(c){var m=this._tiles[c];m&&(m.uses--,delete this._tiles[c],this._timers[c]&&(clearTimeout(this._timers[c]),delete this._timers[c]),m.uses>0||(m.hasData()&&"reloading"!==m.state?this._cache.add(m.tileID,m,m.getExpiryTimeout()):(m.aborted=!0,this._abortTile(m),this._unloadTile(m))))},f.prototype.clearTiles=function(){for(var c in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(c);this._cache.reset()},f.prototype.tilesIn=function(c,m,E){var P=this,T=[],R=this.transform;if(!R)return T;for(var V=E?R.getCameraQueryGeometry(c):c,Q=c.map(function(Ne){return R.pointCoordinate(Ne)}),vt=V.map(function(Ne){return R.pointCoordinate(Ne)}),Et=this.getIds(),_t=1/0,Jt=1/0,Gt=-1/0,ee=-1/0,jt=0,ie=vt;jt<ie.length;jt+=1){var ye=ie[jt];_t=Math.min(_t,ye.x),Jt=Math.min(Jt,ye.y),Gt=Math.max(Gt,ye.x),ee=Math.max(ee,ye.y)}for(var we=function(Ne){var We=P._tiles[Et[Ne]];if(!We.holdingForFade()){var er=We.tileID,br=Math.pow(2,R.zoom-We.tileID.overscaledZ),fr=m*We.queryPadding*s.EXTENT/We.tileSize/br,Br=[er.getTilePoint(new s.MercatorCoordinate(_t,Jt)),er.getTilePoint(new s.MercatorCoordinate(Gt,ee))];if(Br[0].x-fr<s.EXTENT&&Br[0].y-fr<s.EXTENT&&Br[1].x+fr>=0&&Br[1].y+fr>=0){var cn=Q.map(function(rn){return er.getTilePoint(rn)}),hn=vt.map(function(rn){return er.getTilePoint(rn)});T.push({tile:We,tileID:er,queryGeometry:cn,cameraQueryGeometry:hn,scale:br})}}},Ze=0;Ze<Et.length;Ze++)we(Ze);return T},f.prototype.getVisibleCoordinates=function(c){for(var m=this,E=this.getRenderableIds(c).map(function(V){return m._tiles[V].tileID}),P=0,T=E;P<T.length;P+=1){var R=T[P];R.posMatrix=this.transform.calculatePosMatrix(R.toUnwrapped())}return E},f.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(ir(this._source.type))for(var c in this._tiles){var m=this._tiles[c];if(void 0!==m.fadeEndTime&&m.fadeEndTime>=s.browser.now())return!0}return!1},f.prototype.setFeatureState=function(c,m,E){this._state.updateState(c=c||"_geojsonTileLayer",m,E)},f.prototype.removeFeatureState=function(c,m,E){this._state.removeFeatureState(c=c||"_geojsonTileLayer",m,E)},f.prototype.getFeatureState=function(c,m){return this._state.getState(c=c||"_geojsonTileLayer",m)},f.prototype.setDependencies=function(c,m,E){var P=this._tiles[c];P&&P.setDependencies(m,E)},f.prototype.reloadTilesForDependencies=function(c,m){for(var E in this._tiles)this._tiles[E].hasDependency(c,m)&&this._reloadTile(E,"reloading");this._cache.filter(function(P){return!P.hasDependency(c,m)})},f}(s.Evented);function Ht(l,f){var c=Math.abs(2*l.wrap)-+(l.wrap<0),m=Math.abs(2*f.wrap)-+(f.wrap<0);return l.overscaledZ-f.overscaledZ||m-c||f.canonical.y-l.canonical.y||f.canonical.x-l.canonical.x}function ir(l){return"raster"===l||"image"===l||"video"===l}function mr(){return new s.window.Worker(Mi.workerUrl)}Dt.maxOverzooming=10,Dt.maxUnderzooming=3;var Te="mapboxgl_preloaded_worker_pool",Ye=function(){this.active={}};Ye.prototype.acquire=function(l){if(!this.workers)for(this.workers=[];this.workers.length<Ye.workerCount;)this.workers.push(new mr);return this.active[l]=!0,this.workers.slice()},Ye.prototype.release=function(l){delete this.active[l],0===this.numActive()&&(this.workers.forEach(function(f){f.terminate()}),this.workers=null)},Ye.prototype.isPreloaded=function(){return!!this.active[Te]},Ye.prototype.numActive=function(){return Object.keys(this.active).length};var vr,_r=Math.floor(s.browser.hardwareConcurrency/2);function Pr(){return vr||(vr=new Ye),vr}function He(l,f){var c={};for(var m in l)"ref"!==m&&(c[m]=l[m]);return s.refProperties.forEach(function(E){E in f&&(c[E]=f[E])}),c}function yr(l){l=l.slice();for(var f=Object.create(null),c=0;c<l.length;c++)f[l[c].id]=l[c];for(var m=0;m<l.length;m++)"ref"in l[m]&&(l[m]=He(l[m],f[l[m].ref]));return l}Ye.workerCount=Math.max(Math.min(_r,6),1);var Ke={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function wn(l,f,c){c.push({command:Ke.addSource,args:[l,f[l]]})}function an(l,f,c){f.push({command:Ke.removeSource,args:[l]}),c[l]=!0}function Lr(l,f,c,m){an(l,c,m),wn(l,f,c)}function _n(l,f,c){var m;for(m in l[c])if(l[c].hasOwnProperty(m)&&"data"!==m&&!s.deepEqual(l[c][m],f[c][m]))return!1;for(m in f[c])if(f[c].hasOwnProperty(m)&&"data"!==m&&!s.deepEqual(l[c][m],f[c][m]))return!1;return!0}function Nr(l,f,c,m,E,P){var T;for(T in f=f||{},l=l||{})l.hasOwnProperty(T)&&(s.deepEqual(l[T],f[T])||c.push({command:P,args:[m,T,f[T],E]}));for(T in f)f.hasOwnProperty(T)&&!l.hasOwnProperty(T)&&(s.deepEqual(l[T],f[T])||c.push({command:P,args:[m,T,f[T],E]}))}function Gi(l){return l.id}function ri(l,f){return l[f.id]=f,l}var qn=function(l,f){this.reset(l,f)};qn.prototype.reset=function(l,f){this.points=l||[],this._distances=[0];for(var c=1;c<this.points.length;c++)this._distances[c]=this._distances[c-1]+this.points[c].dist(this.points[c-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(f||0,.5*this.length),this.paddedLength=this.length-2*this.padding},qn.prototype.lerp=function(l){if(1===this.points.length)return this.points[0];l=s.clamp(l,0,1);for(var f=1,c=this._distances[f],m=l*this.paddedLength+this.padding;c<m&&f<this._distances.length;)c=this._distances[++f];var E=f-1,P=this._distances[E],T=c-P,R=T>0?(m-P)/T:0;return this.points[E].mult(1-R).add(this.points[f].mult(R))};var En=function(l,f,c){var m=this.boxCells=[],E=this.circleCells=[];this.xCellCount=Math.ceil(l/c),this.yCellCount=Math.ceil(f/c);for(var P=0;P<this.xCellCount*this.yCellCount;P++)m.push([]),E.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=l,this.height=f,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/f,this.boxUid=0,this.circleUid=0};function ho(l,f,c,m,E){var P=s.create();return f?(s.scale(P,P,[1/E,1/E,1]),c||s.rotateZ(P,P,m.angle)):s.multiply(P,m.labelPlaneMatrix,l),P}function li(l,f,c,m,E){if(f){var P=s.clone(l);return s.scale(P,P,[E,E,1]),c||s.rotateZ(P,P,-m.angle),P}return m.glCoordMatrix}function Gr(l,f){var c=[l.x,l.y,0,1];Pn(c,c,f);var m=c[3];return{point:new s.Point(c[0]/m,c[1]/m),signedDistanceFromCamera:m}}function fa(l,f){return.5+l/f*.5}function Jn(l,f){var c=l[0]/l[3],m=l[1]/l[3];return c>=-f[0]&&c<=f[0]&&m>=-f[1]&&m<=f[1]}function Ra(l,f,c,m,E,P,T,R){var V=m?l.textSizeData:l.iconSizeData,Q=s.evaluateSizeForZoom(V,c.transform.zoom),vt=[256/c.width*2+1,256/c.height*2+1],Et=m?l.text.dynamicLayoutVertexArray:l.icon.dynamicLayoutVertexArray;Et.clear();for(var _t=l.lineVertexArray,Jt=m?l.text.placedSymbolArray:l.icon.placedSymbolArray,Gt=c.transform.width/c.transform.height,ee=!1,jt=0;jt<Jt.length;jt++){var ie=Jt.get(jt);if(ie.hidden||ie.writingMode===s.WritingMode.vertical&&!ee)su(ie.numGlyphs,Et);else{ee=!1;var ye=[ie.anchorX,ie.anchorY,0,1];if(s.transformMat4(ye,ye,f),Jn(ye,vt)){var we=fa(c.transform.cameraToCenterDistance,ye[3]),Ze=s.evaluateSizeForFeature(V,Q,ie),Ne=T?Ze/we:Ze*we,We=new s.Point(ie.anchorX,ie.anchorY),er=Gr(We,E).point,br={},fr=Hn(ie,Ne,!1,R,f,E,P,l.glyphOffsetArray,_t,Et,er,We,br,Gt);ee=fr.useVertical,(fr.notEnoughRoom||ee||fr.needsFlipping&&Hn(ie,Ne,!0,R,f,E,P,l.glyphOffsetArray,_t,Et,er,We,br,Gt).notEnoughRoom)&&su(ie.numGlyphs,Et)}else su(ie.numGlyphs,Et)}}m?l.text.dynamicLayoutVertexBuffer.updateData(Et):l.icon.dynamicLayoutVertexBuffer.updateData(Et)}function Ka(l,f,c,m,E,P,T,R,V,Q,vt){var Et=R.glyphStartIndex+R.numGlyphs,_t=R.lineStartIndex,Jt=R.lineStartIndex+R.lineLength,Gt=f.getoffsetX(R.glyphStartIndex),ee=f.getoffsetX(Et-1),jt=xa(l*Gt,c,m,E,P,T,R.segment,_t,Jt,V,Q,vt);if(!jt)return null;var ie=xa(l*ee,c,m,E,P,T,R.segment,_t,Jt,V,Q,vt);return ie?{first:jt,last:ie}:null}function Ro(l,f,c,m){return l===s.WritingMode.horizontal&&Math.abs(c.y-f.y)>Math.abs(c.x-f.x)*m?{useVertical:!0}:(l===s.WritingMode.vertical?f.y<c.y:f.x>c.x)?{needsFlipping:!0}:null}function Hn(l,f,c,m,E,P,T,R,V,Q,vt,Et,_t,Jt){var Gt,ee=f/24,jt=l.lineOffsetX*ee,ie=l.lineOffsetY*ee;if(l.numGlyphs>1){var ye=l.glyphStartIndex+l.numGlyphs,we=l.lineStartIndex,Ze=l.lineStartIndex+l.lineLength,Ne=Ka(ee,R,jt,ie,c,vt,Et,l,V,P,_t);if(!Ne)return{notEnoughRoom:!0};var We=Gr(Ne.first.point,T).point,er=Gr(Ne.last.point,T).point;if(m&&!c){var br=Ro(l.writingMode,We,er,Jt);if(br)return br}Gt=[Ne.first];for(var fr=l.glyphStartIndex+1;fr<ye-1;fr++)Gt.push(xa(ee*R.getoffsetX(fr),jt,ie,c,vt,Et,l.segment,we,Ze,V,P,_t));Gt.push(Ne.last)}else{if(m&&!c){var Br=Gr(Et,E).point,cn=l.lineStartIndex+l.segment+1,hn=new s.Point(V.getx(cn),V.gety(cn)),rn=Gr(hn,E),Pi=rn.signedDistanceFromCamera>0?rn.point:mu(Et,hn,Br,1,E),Ur=Ro(l.writingMode,Br,Pi,Jt);if(Ur)return Ur}var Zn=xa(ee*R.getoffsetX(l.glyphStartIndex),jt,ie,c,vt,Et,l.segment,l.lineStartIndex,l.lineStartIndex+l.lineLength,V,P,_t);if(!Zn)return{notEnoughRoom:!0};Gt=[Zn]}for(var si=0,Rn=Gt;si<Rn.length;si+=1){var Fn=Rn[si];s.addDynamicAttributes(Q,Fn.point,Fn.angle)}return{}}function mu(l,f,c,m,E){var P=Gr(l.add(l.sub(f)._unit()),E).point,T=c.sub(P);return c.add(T._mult(m/T.mag()))}function xa(l,f,c,m,E,P,T,R,V,Q,vt,Et){var _t=m?l-f:l+f,Jt=_t>0?1:-1,Gt=0;m&&(Jt*=-1,Gt=Math.PI),Jt<0&&(Gt+=Math.PI);for(var ee=Jt>0?R+T:R+T+1,jt=E,ie=E,ye=0,we=0,Ze=Math.abs(_t),Ne=[];ye+we<=Ze;){if((ee+=Jt)<R||ee>=V)return null;if(ie=jt,Ne.push(jt),void 0===(jt=Et[ee])){var We=new s.Point(Q.getx(ee),Q.gety(ee)),er=Gr(We,vt);if(er.signedDistanceFromCamera>0)jt=Et[ee]=er.point;else{var br=ee-Jt;jt=mu(0===ye?P:new s.Point(Q.getx(br),Q.gety(br)),We,ie,Ze-ye+1,vt)}}ye+=we,we=ie.dist(jt)}var fr=(Ze-ye)/we,Br=jt.sub(ie),cn=Br.mult(fr)._add(ie);cn._add(Br._unit()._perp()._mult(c*Jt));var hn=Gt+Math.atan2(jt.y-ie.y,jt.x-ie.x);return Ne.push(cn),{point:cn,angle:hn,path:Ne}}En.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},En.prototype.insert=function(l,f,c,m,E){this._forEachCell(f,c,m,E,this._insertBoxCell,this.boxUid++),this.boxKeys.push(l),this.bboxes.push(f),this.bboxes.push(c),this.bboxes.push(m),this.bboxes.push(E)},En.prototype.insertCircle=function(l,f,c,m){this._forEachCell(f-m,c-m,f+m,c+m,this._insertCircleCell,this.circleUid++),this.circleKeys.push(l),this.circles.push(f),this.circles.push(c),this.circles.push(m)},En.prototype._insertBoxCell=function(l,f,c,m,E,P){this.boxCells[E].push(P)},En.prototype._insertCircleCell=function(l,f,c,m,E,P){this.circleCells[E].push(P)},En.prototype._query=function(l,f,c,m,E,P){if(c<0||l>this.width||m<0||f>this.height)return!E&&[];var T=[];if(l<=0&&f<=0&&this.width<=c&&this.height<=m){if(E)return!0;for(var R=0;R<this.boxKeys.length;R++)T.push({key:this.boxKeys[R],x1:this.bboxes[4*R],y1:this.bboxes[4*R+1],x2:this.bboxes[4*R+2],y2:this.bboxes[4*R+3]});for(var V=0;V<this.circleKeys.length;V++){var Q=this.circles[3*V],vt=this.circles[3*V+1],Et=this.circles[3*V+2];T.push({key:this.circleKeys[V],x1:Q-Et,y1:vt-Et,x2:Q+Et,y2:vt+Et})}return P?T.filter(P):T}return this._forEachCell(l,f,c,m,this._queryCell,T,{hitTest:E,seenUids:{box:{},circle:{}}},P),E?T.length>0:T},En.prototype._queryCircle=function(l,f,c,m,E){var P=l-c,T=l+c,R=f-c,V=f+c;if(T<0||P>this.width||V<0||R>this.height)return!m&&[];var Q=[];return this._forEachCell(P,R,T,V,this._queryCellCircle,Q,{hitTest:m,circle:{x:l,y:f,radius:c},seenUids:{box:{},circle:{}}},E),m?Q.length>0:Q},En.prototype.query=function(l,f,c,m,E){return this._query(l,f,c,m,!1,E)},En.prototype.hitTest=function(l,f,c,m,E){return this._query(l,f,c,m,!0,E)},En.prototype.hitTestCircle=function(l,f,c,m){return this._queryCircle(l,f,c,!0,m)},En.prototype._queryCell=function(l,f,c,m,E,P,T,R){var V=T.seenUids,Q=this.boxCells[E];if(null!==Q)for(var vt=this.bboxes,Et=0,_t=Q;Et<_t.length;Et+=1){var Jt=_t[Et];if(!V.box[Jt]){V.box[Jt]=!0;var Gt=4*Jt;if(l<=vt[Gt+2]&&f<=vt[Gt+3]&&c>=vt[Gt+0]&&m>=vt[Gt+1]&&(!R||R(this.boxKeys[Jt]))){if(T.hitTest)return P.push(!0),!0;P.push({key:this.boxKeys[Jt],x1:vt[Gt],y1:vt[Gt+1],x2:vt[Gt+2],y2:vt[Gt+3]})}}}var ee=this.circleCells[E];if(null!==ee)for(var jt=this.circles,ie=0,ye=ee;ie<ye.length;ie+=1){var we=ye[ie];if(!V.circle[we]){V.circle[we]=!0;var Ze=3*we;if(this._circleAndRectCollide(jt[Ze],jt[Ze+1],jt[Ze+2],l,f,c,m)&&(!R||R(this.circleKeys[we]))){if(T.hitTest)return P.push(!0),!0;var Ne=jt[Ze],We=jt[Ze+1],er=jt[Ze+2];P.push({key:this.circleKeys[we],x1:Ne-er,y1:We-er,x2:Ne+er,y2:We+er})}}}},En.prototype._queryCellCircle=function(l,f,c,m,E,P,T,R){var V=T.circle,Q=T.seenUids,vt=this.boxCells[E];if(null!==vt)for(var Et=this.bboxes,_t=0,Jt=vt;_t<Jt.length;_t+=1){var Gt=Jt[_t];if(!Q.box[Gt]){Q.box[Gt]=!0;var ee=4*Gt;if(this._circleAndRectCollide(V.x,V.y,V.radius,Et[ee+0],Et[ee+1],Et[ee+2],Et[ee+3])&&(!R||R(this.boxKeys[Gt])))return P.push(!0),!0}}var jt=this.circleCells[E];if(null!==jt)for(var ie=this.circles,ye=0,we=jt;ye<we.length;ye+=1){var Ze=we[ye];if(!Q.circle[Ze]){Q.circle[Ze]=!0;var Ne=3*Ze;if(this._circlesCollide(ie[Ne],ie[Ne+1],ie[Ne+2],V.x,V.y,V.radius)&&(!R||R(this.circleKeys[Ze])))return P.push(!0),!0}}},En.prototype._forEachCell=function(l,f,c,m,E,P,T,R){for(var V=this._convertToXCellCoord(l),Q=this._convertToYCellCoord(f),vt=this._convertToXCellCoord(c),Et=this._convertToYCellCoord(m),_t=V;_t<=vt;_t++)for(var Jt=Q;Jt<=Et;Jt++)if(E.call(this,l,f,c,m,this.xCellCount*Jt+_t,P,T,R))return},En.prototype._convertToXCellCoord=function(l){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(l*this.xScale)))},En.prototype._convertToYCellCoord=function(l){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(l*this.yScale)))},En.prototype._circlesCollide=function(l,f,c,m,E,P){var T=m-l,R=E-f,V=c+P;return V*V>T*T+R*R},En.prototype._circleAndRectCollide=function(l,f,c,m,E,P,T){var R=(P-m)/2,V=Math.abs(l-(m+R));if(V>R+c)return!1;var Q=(T-E)/2,vt=Math.abs(f-(E+Q));if(vt>Q+c)return!1;if(V<=R||vt<=Q)return!0;var Et=V-R,_t=vt-Q;return Et*Et+_t*_t<=c*c};var $o=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function su(l,f){for(var c=0;c<l;c++){var m=f.length;f.resize(m+4),f.float32.set($o,3*m)}}function Pn(l,f,c){var m=f[0],E=f[1];return l[0]=c[0]*m+c[4]*E+c[12],l[1]=c[1]*m+c[5]*E+c[13],l[3]=c[3]*m+c[7]*E+c[15],l}var _o=function(l,f,c){void 0===f&&(f=new En(l.width+200,l.height+200,25)),void 0===c&&(c=new En(l.width+200,l.height+200,25)),this.transform=l,this.grid=f,this.ignoredGrid=c,this.pitchfactor=Math.cos(l._pitch)*l.cameraToCenterDistance,this.screenRightBoundary=l.width+100,this.screenBottomBoundary=l.height+100,this.gridRightBoundary=l.width+200,this.gridBottomBoundary=l.height+200};function Fo(l,f,c){return f*(s.EXTENT/(l.tileSize*Math.pow(2,c-l.tileID.overscaledZ)))}_o.prototype.placeCollisionBox=function(l,f,c,m,E){var P=this.projectAndGetPerspectiveRatio(m,l.anchorPointX,l.anchorPointY),T=c*P.perspectiveRatio,R=l.x1*T+P.point.x,V=l.y1*T+P.point.y,Q=l.x2*T+P.point.x,vt=l.y2*T+P.point.y;return!this.isInsideGrid(R,V,Q,vt)||!f&&this.grid.hitTest(R,V,Q,vt,E)?{box:[],offscreen:!1}:{box:[R,V,Q,vt],offscreen:this.isOffscreen(R,V,Q,vt)}},_o.prototype.placeCollisionCircles=function(l,f,c,m,E,P,T,R,V,Q,vt,Et,_t){var Jt=[],Gt=new s.Point(f.anchorX,f.anchorY),ee=Gr(Gt,P),jt=fa(this.transform.cameraToCenterDistance,ee.signedDistanceFromCamera),ie=(Q?E/jt:E*jt)/s.ONE_EM,ye=Gr(Gt,T).point,we=Ka(ie,m,f.lineOffsetX*ie,f.lineOffsetY*ie,!1,ye,Gt,f,c,T,{}),Ze=!1,Ne=!1,We=!0;if(we){for(var er=.5*Et*jt+_t,br=new s.Point(-100,-100),fr=new s.Point(this.screenRightBoundary,this.screenBottomBoundary),Br=new qn,cn=we.first,hn=we.last,rn=[],Pi=cn.path.length-1;Pi>=1;Pi--)rn.push(cn.path[Pi]);for(var Ur=1;Ur<hn.path.length;Ur++)rn.push(hn.path[Ur]);var Zn=2.5*er;if(R){var si=rn.map(function(Gu){return Gr(Gu,R)});rn=si.some(function(Gu){return Gu.signedDistanceFromCamera<=0})?[]:si.map(function(Gu){return Gu.point})}var Rn=[];if(rn.length>0){for(var Fn=rn[0].clone(),Dn=rn[0].clone(),Ln=1;Ln<rn.length;Ln++)Fn.x=Math.min(Fn.x,rn[Ln].x),Fn.y=Math.min(Fn.y,rn[Ln].y),Dn.x=Math.max(Dn.x,rn[Ln].x),Dn.y=Math.max(Dn.y,rn[Ln].y);Rn=Fn.x>=br.x&&Dn.x<=fr.x&&Fn.y>=br.y&&Dn.y<=fr.y?[rn]:Dn.x<br.x||Fn.x>fr.x||Dn.y<br.y||Fn.y>fr.y?[]:s.clipLine([rn],br.x,br.y,fr.x,fr.y)}for(var gn=0,qo=Rn;gn<qo.length;gn+=1){var Pa;Br.reset(qo[gn],.25*er),Pa=Br.length<=.5*er?1:Math.ceil(Br.paddedLength/Zn)+1;for(var Us=0;Us<Pa;Us++){var ms=Us/Math.max(Pa-1,1),Cs=Br.lerp(ms),Ya=Cs.x+100,Os=Cs.y+100;Jt.push(Ya,Os,er,0);var dl=Ya-er,hu=Os-er,ks=Ya+er,gl=Os+er;if(We=We&&this.isOffscreen(dl,hu,ks,gl),Ne=Ne||this.isInsideGrid(dl,hu,ks,gl),!l&&this.grid.hitTestCircle(Ya,Os,er,vt)&&(Ze=!0,!V))return{circles:[],offscreen:!1,collisionDetected:Ze}}}}return{circles:!V&&Ze||!Ne?[]:Jt,offscreen:We,collisionDetected:Ze}},_o.prototype.queryRenderedSymbols=function(l){if(0===l.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var f=[],c=1/0,m=1/0,E=-1/0,P=-1/0,T=0,R=l;T<R.length;T+=1){var V=R[T],Q=new s.Point(V.x+100,V.y+100);c=Math.min(c,Q.x),m=Math.min(m,Q.y),E=Math.max(E,Q.x),P=Math.max(P,Q.y),f.push(Q)}for(var vt={},Et={},_t=0,Jt=this.grid.query(c,m,E,P).concat(this.ignoredGrid.query(c,m,E,P));_t<Jt.length;_t+=1){var Gt=Jt[_t],ee=Gt.key;if(void 0===vt[ee.bucketInstanceId]&&(vt[ee.bucketInstanceId]={}),!vt[ee.bucketInstanceId][ee.featureIndex]){var jt=[new s.Point(Gt.x1,Gt.y1),new s.Point(Gt.x2,Gt.y1),new s.Point(Gt.x2,Gt.y2),new s.Point(Gt.x1,Gt.y2)];s.polygonIntersectsPolygon(f,jt)&&(vt[ee.bucketInstanceId][ee.featureIndex]=!0,void 0===Et[ee.bucketInstanceId]&&(Et[ee.bucketInstanceId]=[]),Et[ee.bucketInstanceId].push(ee.featureIndex))}}return Et},_o.prototype.insertCollisionBox=function(l,f,c,m,E){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:c,featureIndex:m,collisionGroupID:E},l[0],l[1],l[2],l[3])},_o.prototype.insertCollisionCircles=function(l,f,c,m,E){for(var P=f?this.ignoredGrid:this.grid,T={bucketInstanceId:c,featureIndex:m,collisionGroupID:E},R=0;R<l.length;R+=4)P.insertCircle(T,l[R],l[R+1],l[R+2])},_o.prototype.projectAndGetPerspectiveRatio=function(l,f,c){var m=[f,c,0,1];return Pn(m,m,l),{point:new s.Point((m[0]/m[3]+1)/2*this.transform.width+100,(-m[1]/m[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/m[3]*.5}},_o.prototype.isOffscreen=function(l,f,c,m){return c<100||l>=this.screenRightBoundary||m<100||f>this.screenBottomBoundary},_o.prototype.isInsideGrid=function(l,f,c,m){return c>=0&&l<this.gridRightBoundary&&m>=0&&f<this.gridBottomBoundary},_o.prototype.getViewportMatrix=function(){var l=s.identity([]);return s.translate(l,l,[-100,-100,0]),l};var Fa=function(l,f,c,m){this.opacity=l?Math.max(0,Math.min(1,l.opacity+(l.placed?f:-f))):m&&c?1:0,this.placed=c};Fa.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var xn=function(l,f,c,m,E){this.text=new Fa(l?l.text:null,f,c,E),this.icon=new Fa(l?l.icon:null,f,m,E)};xn.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Iu=function(l,f,c){this.text=l,this.icon=f,this.skipFade=c},oc=function(){this.invProjMatrix=s.create(),this.viewportMatrix=s.create(),this.circles=[]},A=function(l,f,c,m,E){this.bucketInstanceId=l,this.featureIndex=f,this.sourceLayerIndex=c,this.bucketIndex=m,this.tileID=E},U=function(l){this.crossSourceCollisions=l,this.maxGroupID=0,this.collisionGroups={}};function ct(l,f,c,m,E){var P=s.getAnchorAlignment(l),T=-(P.horizontalAlign-.5)*f,R=-(P.verticalAlign-.5)*c,V=s.evaluateVariableOffset(l,m);return new s.Point(T+V[0]*E,R+V[1]*E)}function oe(l,f,c,m,E,P){var T=l.x1,R=l.x2,V=l.y1,Q=l.y2,vt=l.anchorPointX,Et=l.anchorPointY,_t=new s.Point(f,c);return m&&_t._rotate(E?P:-P),{x1:T+_t.x,y1:V+_t.y,x2:R+_t.x,y2:Q+_t.y,anchorPointX:vt,anchorPointY:Et}}U.prototype.get=function(l){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[l]){var f=++this.maxGroupID;this.collisionGroups[l]={ID:f,predicate:function(c){return c.collisionGroupID===f}}}return this.collisionGroups[l]};var Se=function(l,f,c,m){this.transform=l.clone(),this.collisionIndex=new _o(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new U(c),this.collisionCircleArrays={},this.prevPlacement=m,m&&(m.prevPlacement=void 0),this.placedOrientations={}};function Bt(l,f,c,m,E){l.emplaceBack(f?1:0,c?1:0,m||0,E||0),l.emplaceBack(f?1:0,c?1:0,m||0,E||0),l.emplaceBack(f?1:0,c?1:0,m||0,E||0),l.emplaceBack(f?1:0,c?1:0,m||0,E||0)}Se.prototype.getBucketParts=function(l,f,c,m){var E=c.getBucket(f),P=c.latestFeatureIndex;if(E&&P&&f.id===E.layerIds[0]){var T=c.collisionBoxArray,R=E.layers[0].layout,V=Math.pow(2,this.transform.zoom-c.tileID.overscaledZ),Q=c.tileSize/s.EXTENT,vt=this.transform.calculatePosMatrix(c.tileID.toUnwrapped()),Et="map"===R.get("text-pitch-alignment"),_t="map"===R.get("text-rotation-alignment"),Jt=Fo(c,1,this.transform.zoom),Gt=ho(vt,Et,_t,this.transform,Jt),ee=null;if(Et){var jt=li(vt,Et,_t,this.transform,Jt);ee=s.multiply([],this.transform.labelPlaneMatrix,jt)}this.retainedQueryData[E.bucketInstanceId]=new A(E.bucketInstanceId,P,E.sourceLayerIndex,E.index,c.tileID);var ie={bucket:E,layout:R,posMatrix:vt,textLabelPlaneMatrix:Gt,labelToScreenMatrix:ee,scale:V,textPixelRatio:Q,holdingForFade:c.holdingForFade(),collisionBoxArray:T,partiallyEvaluatedTextSize:s.evaluateSizeForZoom(E.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(E.sourceID)};if(m)for(var ye=0,we=E.sortKeyRanges;ye<we.length;ye+=1){var Ze=we[ye];l.push({sortKey:Ze.sortKey,symbolInstanceStart:Ze.symbolInstanceStart,symbolInstanceEnd:Ze.symbolInstanceEnd,parameters:ie})}else l.push({symbolInstanceStart:0,symbolInstanceEnd:E.symbolInstances.length,parameters:ie})}},Se.prototype.attemptAnchorPlacement=function(l,f,c,m,E,P,T,R,V,Q,vt,Et,_t,Jt,Gt){var ee,jt=[Et.textOffset0,Et.textOffset1],ie=ct(l,c,m,jt,E),ye=this.collisionIndex.placeCollisionBox(oe(f,ie.x,ie.y,P,T,this.transform.angle),vt,R,V,Q.predicate);if(!Gt||0!==this.collisionIndex.placeCollisionBox(oe(Gt,ie.x,ie.y,P,T,this.transform.angle),vt,R,V,Q.predicate).box.length)return ye.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[Et.crossTileID]&&this.prevPlacement.placements[Et.crossTileID]&&this.prevPlacement.placements[Et.crossTileID].text&&(ee=this.prevPlacement.variableOffsets[Et.crossTileID].anchor),this.variableOffsets[Et.crossTileID]={textOffset:jt,width:c,height:m,anchor:l,textBoxScale:E,prevAnchor:ee},this.markUsedJustification(_t,l,Et,Jt),_t.allowVerticalPlacement&&(this.markUsedOrientation(_t,Jt,Et),this.placedOrientations[Et.crossTileID]=Jt),{shift:ie,placedGlyphBoxes:ye}):void 0},Se.prototype.placeLayerBucketPart=function(l,f,c){var m=this,E=l.parameters,P=E.bucket,T=E.layout,R=E.posMatrix,V=E.textLabelPlaneMatrix,Q=E.labelToScreenMatrix,vt=E.textPixelRatio,Et=E.holdingForFade,_t=E.collisionBoxArray,Jt=E.partiallyEvaluatedTextSize,Gt=E.collisionGroup,ee=T.get("text-optional"),jt=T.get("icon-optional"),ie=T.get("text-allow-overlap"),ye=T.get("icon-allow-overlap"),we="map"===T.get("text-rotation-alignment"),Ze="map"===T.get("text-pitch-alignment"),Ne="none"!==T.get("icon-text-fit"),We="viewport-y"===T.get("symbol-z-order"),er=ie&&(ye||!P.hasIconData()||jt),br=ye&&(ie||!P.hasTextData()||ee);!P.collisionArrays&&_t&&P.deserializeCollisionBoxes(_t);var fr=function(Ur,Zn){if(!f[Ur.crossTileID])if(Et)m.placements[Ur.crossTileID]=new Iu(!1,!1,!1);else{var si,Rn=!1,Fn=!1,Dn=!0,Ln=null,gn={box:null,offscreen:null},qo={box:null,offscreen:null},Pa=null,Us=null,ms=0,Cs=0,Ya=0;Zn.textFeatureIndex?ms=Zn.textFeatureIndex:Ur.useRuntimeCollisionCircles&&(ms=Ur.featureIndex),Zn.verticalTextFeatureIndex&&(Cs=Zn.verticalTextFeatureIndex);var Os=Zn.textBox;if(Os){var dl=function(na){var Oa=s.WritingMode.horizontal;if(P.allowVerticalPlacement&&!na&&m.prevPlacement){var pu=m.prevPlacement.placedOrientations[Ur.crossTileID];pu&&(m.placedOrientations[Ur.crossTileID]=pu,m.markUsedOrientation(P,Oa=pu,Ur))}return Oa},hu=function(na,Oa){if(P.allowVerticalPlacement&&Ur.numVerticalGlyphVertices>0&&Zn.verticalTextBox)for(var pu=0,Cc=P.writingModes;pu<Cc.length&&(Cc[pu]===s.WritingMode.vertical?(gn=Oa(),qo=gn):gn=na(),!(gn&&gn.box&&gn.box.length));pu+=1);else gn=na()};if(T.get("text-variable-anchor")){var ks=T.get("text-variable-anchor");if(m.prevPlacement&&m.prevPlacement.variableOffsets[Ur.crossTileID]){var gl=m.prevPlacement.variableOffsets[Ur.crossTileID];ks.indexOf(gl.anchor)>0&&(ks=ks.filter(function(na){return na!==gl.anchor})).unshift(gl.anchor)}var Gu=function(na,Oa,pu){for(var Cc=na.x2-na.x1,Fl=na.y2-na.y1,Sh=Ur.textBoxScale,hc=Ne&&!ye?Oa:null,Xc={box:[],offscreen:!1},Ch=ie?2*ks.length:ks.length,pc=0;pc<Ch;++pc){var Xl=m.attemptAnchorPlacement(ks[pc%ks.length],na,Cc,Fl,Sh,we,Ze,vt,R,Gt,pc>=ks.length,Ur,P,pu,hc);if(Xl&&(Xc=Xl.placedGlyphBoxes)&&Xc.box&&Xc.box.length){Rn=!0,Ln=Xl.shift;break}}return Xc};hu(function(){return Gu(Os,Zn.iconBox,s.WritingMode.horizontal)},function(){var na=Zn.verticalTextBox;return P.allowVerticalPlacement&&!(gn&&gn.box&&gn.box.length)&&Ur.numVerticalGlyphVertices>0&&na?Gu(na,Zn.verticalIconBox,s.WritingMode.vertical):{box:null,offscreen:null}}),gn&&(Rn=gn.box,Dn=gn.offscreen);var Ec=dl(gn&&gn.box);if(!Rn&&m.prevPlacement){var Nl=m.prevPlacement.variableOffsets[Ur.crossTileID];Nl&&(m.variableOffsets[Ur.crossTileID]=Nl,m.markUsedJustification(P,Nl.anchor,Ur,Ec))}}else{var uc=function(na,Oa){var pu=m.collisionIndex.placeCollisionBox(na,ie,vt,R,Gt.predicate);return pu&&pu.box&&pu.box.length&&(m.markUsedOrientation(P,Oa,Ur),m.placedOrientations[Ur.crossTileID]=Oa),pu};hu(function(){return uc(Os,s.WritingMode.horizontal)},function(){var na=Zn.verticalTextBox;return P.allowVerticalPlacement&&Ur.numVerticalGlyphVertices>0&&na?uc(na,s.WritingMode.vertical):{box:null,offscreen:null}}),dl(gn&&gn.box&&gn.box.length)}}if(Rn=(si=gn)&&si.box&&si.box.length>0,Dn=si&&si.offscreen,Ur.useRuntimeCollisionCircles){var El=P.text.placedSymbolArray.get(Ur.centerJustifiedTextSymbolIndex),Sc=s.evaluateSizeForFeature(P.textSizeData,Jt,El),lc=T.get("text-padding");Pa=m.collisionIndex.placeCollisionCircles(ie,El,P.lineVertexArray,P.glyphOffsetArray,Sc,R,V,Q,c,Ze,Gt.predicate,Ur.collisionCircleDiameter,lc),Rn=ie||Pa.circles.length>0&&!Pa.collisionDetected,Dn=Dn&&Pa.offscreen}if(Zn.iconFeatureIndex&&(Ya=Zn.iconFeatureIndex),Zn.iconBox){var il=function(na){var Oa=Ne&&Ln?oe(na,Ln.x,Ln.y,we,Ze,m.transform.angle):na;return m.collisionIndex.placeCollisionBox(Oa,ye,vt,R,Gt.predicate)};Fn=qo&&qo.box&&qo.box.length&&Zn.verticalIconBox?(Us=il(Zn.verticalIconBox)).box.length>0:(Us=il(Zn.iconBox)).box.length>0,Dn=Dn&&Us.offscreen}var cc=ee||0===Ur.numHorizontalGlyphVertices&&0===Ur.numVerticalGlyphVertices,ys=jt||0===Ur.numIconVertices;if(cc||ys?ys?cc||(Fn=Fn&&Rn):Rn=Fn&&Rn:Fn=Rn=Fn&&Rn,Rn&&si&&si.box&&m.collisionIndex.insertCollisionBox(si.box,T.get("text-ignore-placement"),P.bucketInstanceId,qo&&qo.box&&Cs?Cs:ms,Gt.ID),Fn&&Us&&m.collisionIndex.insertCollisionBox(Us.box,T.get("icon-ignore-placement"),P.bucketInstanceId,Ya,Gt.ID),Pa&&(Rn&&m.collisionIndex.insertCollisionCircles(Pa.circles,T.get("text-ignore-placement"),P.bucketInstanceId,ms,Gt.ID),c)){var ol=P.bucketInstanceId,Hu=m.collisionCircleArrays[ol];void 0===Hu&&(Hu=m.collisionCircleArrays[ol]=new oc);for(var Rl=0;Rl<Pa.circles.length;Rl+=4)Hu.circles.push(Pa.circles[Rl+0]),Hu.circles.push(Pa.circles[Rl+1]),Hu.circles.push(Pa.circles[Rl+2]),Hu.circles.push(Pa.collisionDetected?1:0)}m.placements[Ur.crossTileID]=new Iu(Rn||er,Fn||br,Dn||P.justReloaded),f[Ur.crossTileID]=!0}};if(We)for(var Br=P.getSortedSymbolIndexes(this.transform.angle),cn=Br.length-1;cn>=0;--cn){var hn=Br[cn];fr(P.symbolInstances.get(hn),P.collisionArrays[hn])}else for(var rn=l.symbolInstanceStart;rn<l.symbolInstanceEnd;rn++)fr(P.symbolInstances.get(rn),P.collisionArrays[rn]);if(c&&P.bucketInstanceId in this.collisionCircleArrays){var Pi=this.collisionCircleArrays[P.bucketInstanceId];s.invert(Pi.invProjMatrix,R),Pi.viewportMatrix=this.collisionIndex.getViewportMatrix()}P.justReloaded=!1},Se.prototype.markUsedJustification=function(l,f,c,m){var E;E=m===s.WritingMode.vertical?c.verticalPlacedTextSymbolIndex:{left:c.leftJustifiedTextSymbolIndex,center:c.centerJustifiedTextSymbolIndex,right:c.rightJustifiedTextSymbolIndex}[s.getAnchorJustification(f)];for(var P=0,T=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex,c.verticalPlacedTextSymbolIndex];P<T.length;P+=1){var R=T[P];R>=0&&(l.text.placedSymbolArray.get(R).crossTileID=E>=0&&R!==E?0:c.crossTileID)}},Se.prototype.markUsedOrientation=function(l,f,c){for(var m=f===s.WritingMode.horizontal||f===s.WritingMode.horizontalOnly?f:0,E=f===s.WritingMode.vertical?f:0,P=0,T=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex];P<T.length;P+=1)l.text.placedSymbolArray.get(T[P]).placedOrientation=m;c.verticalPlacedTextSymbolIndex&&(l.text.placedSymbolArray.get(c.verticalPlacedTextSymbolIndex).placedOrientation=E)},Se.prototype.commit=function(l){this.commitTime=l,this.zoomAtLastRecencyCheck=this.transform.zoom;var f=this.prevPlacement,c=!1;this.prevZoomAdjustment=f?f.zoomAdjustment(this.transform.zoom):0;var m=f?f.symbolFadeChange(l):1,E=f?f.opacities:{},P=f?f.variableOffsets:{},T=f?f.placedOrientations:{};for(var R in this.placements){var V=this.placements[R],Q=E[R];Q?(this.opacities[R]=new xn(Q,m,V.text,V.icon),c=c||V.text!==Q.text.placed||V.icon!==Q.icon.placed):(this.opacities[R]=new xn(null,m,V.text,V.icon,V.skipFade),c=c||V.text||V.icon)}for(var vt in E){var Et=E[vt];if(!this.opacities[vt]){var _t=new xn(Et,m,!1,!1);_t.isHidden()||(this.opacities[vt]=_t,c=c||Et.text.placed||Et.icon.placed)}}for(var Jt in P)this.variableOffsets[Jt]||!this.opacities[Jt]||this.opacities[Jt].isHidden()||(this.variableOffsets[Jt]=P[Jt]);for(var Gt in T)this.placedOrientations[Gt]||!this.opacities[Gt]||this.opacities[Gt].isHidden()||(this.placedOrientations[Gt]=T[Gt]);c?this.lastPlacementChangeTime=l:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=f?f.lastPlacementChangeTime:l)},Se.prototype.updateLayerOpacities=function(l,f){for(var c={},m=0,E=f;m<E.length;m+=1){var P=E[m],T=P.getBucket(l);T&&P.latestFeatureIndex&&l.id===T.layerIds[0]&&this.updateBucketOpacities(T,c,P.collisionBoxArray)}},Se.prototype.updateBucketOpacities=function(l,f,c){var m=this;l.hasTextData()&&l.text.opacityVertexArray.clear(),l.hasIconData()&&l.icon.opacityVertexArray.clear(),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexArray.clear(),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexArray.clear();var E=l.layers[0].layout,P=new xn(null,0,!1,!1,!0),T=E.get("text-allow-overlap"),R=E.get("icon-allow-overlap"),V=E.get("text-variable-anchor"),Q="map"===E.get("text-rotation-alignment"),vt="map"===E.get("text-pitch-alignment"),Et="none"!==E.get("icon-text-fit"),_t=new xn(null,0,T&&(R||!l.hasIconData()||E.get("icon-optional")),R&&(T||!l.hasTextData()||E.get("text-optional")),!0);!l.collisionArrays&&c&&(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData())&&l.deserializeCollisionBoxes(c);for(var Jt=function(ie,ye,we){for(var Ze=0;Ze<ye/4;Ze++)ie.opacityVertexArray.emplaceBack(we)},Gt=function(ie){var ye=l.symbolInstances.get(ie),we=ye.numHorizontalGlyphVertices,Ze=ye.numVerticalGlyphVertices,Ne=ye.crossTileID,We=m.opacities[Ne];f[Ne]?We=P:We||(m.opacities[Ne]=We=_t),f[Ne]=!0;var er=ye.numIconVertices>0,br=m.placedOrientations[ye.crossTileID],fr=br===s.WritingMode.vertical,Br=br===s.WritingMode.horizontal||br===s.WritingMode.horizontalOnly;if(we>0||Ze>0){var cn=Dr(We.text);Jt(l.text,we,fr?Tn:cn),Jt(l.text,Ze,Br?Tn:cn);var hn=We.text.isHidden();[ye.rightJustifiedTextSymbolIndex,ye.centerJustifiedTextSymbolIndex,ye.leftJustifiedTextSymbolIndex].forEach(function(gn){gn>=0&&(l.text.placedSymbolArray.get(gn).hidden=hn||fr?1:0)}),ye.verticalPlacedTextSymbolIndex>=0&&(l.text.placedSymbolArray.get(ye.verticalPlacedTextSymbolIndex).hidden=hn||Br?1:0);var rn=m.variableOffsets[ye.crossTileID];rn&&m.markUsedJustification(l,rn.anchor,ye,br);var Pi=m.placedOrientations[ye.crossTileID];Pi&&(m.markUsedJustification(l,"left",ye,Pi),m.markUsedOrientation(l,Pi,ye))}if(er){var Ur=Dr(We.icon),Zn=!(Et&&ye.verticalPlacedIconSymbolIndex&&fr);ye.placedIconSymbolIndex>=0&&(Jt(l.icon,ye.numIconVertices,Zn?Ur:Tn),l.icon.placedSymbolArray.get(ye.placedIconSymbolIndex).hidden=We.icon.isHidden()),ye.verticalPlacedIconSymbolIndex>=0&&(Jt(l.icon,ye.numVerticalIconVertices,Zn?Tn:Ur),l.icon.placedSymbolArray.get(ye.verticalPlacedIconSymbolIndex).hidden=We.icon.isHidden())}if(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData()){var si=l.collisionArrays[ie];if(si){var Rn=new s.Point(0,0);if(si.textBox||si.verticalTextBox){var Fn=!0;if(V){var Dn=m.variableOffsets[Ne];Dn?(Rn=ct(Dn.anchor,Dn.width,Dn.height,Dn.textOffset,Dn.textBoxScale),Q&&Rn._rotate(vt?m.transform.angle:-m.transform.angle)):Fn=!1}si.textBox&&Bt(l.textCollisionBox.collisionVertexArray,We.text.placed,!Fn||fr,Rn.x,Rn.y),si.verticalTextBox&&Bt(l.textCollisionBox.collisionVertexArray,We.text.placed,!Fn||Br,Rn.x,Rn.y)}var Ln=Boolean(!Br&&si.verticalIconBox);si.iconBox&&Bt(l.iconCollisionBox.collisionVertexArray,We.icon.placed,Ln,Et?Rn.x:0,Et?Rn.y:0),si.verticalIconBox&&Bt(l.iconCollisionBox.collisionVertexArray,We.icon.placed,!Ln,Et?Rn.x:0,Et?Rn.y:0)}}},ee=0;ee<l.symbolInstances.length;ee++)Gt(ee);if(l.sortFeatures(this.transform.angle),this.retainedQueryData[l.bucketInstanceId]&&(this.retainedQueryData[l.bucketInstanceId].featureSortOrder=l.featureSortOrder),l.hasTextData()&&l.text.opacityVertexBuffer&&l.text.opacityVertexBuffer.updateData(l.text.opacityVertexArray),l.hasIconData()&&l.icon.opacityVertexBuffer&&l.icon.opacityVertexBuffer.updateData(l.icon.opacityVertexArray),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexBuffer&&l.iconCollisionBox.collisionVertexBuffer.updateData(l.iconCollisionBox.collisionVertexArray),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexBuffer&&l.textCollisionBox.collisionVertexBuffer.updateData(l.textCollisionBox.collisionVertexArray),l.bucketInstanceId in this.collisionCircleArrays){var jt=this.collisionCircleArrays[l.bucketInstanceId];l.placementInvProjMatrix=jt.invProjMatrix,l.placementViewportMatrix=jt.viewportMatrix,l.collisionCircleArray=jt.circles,delete this.collisionCircleArrays[l.bucketInstanceId]}},Se.prototype.symbolFadeChange=function(l){return 0===this.fadeDuration?1:(l-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Se.prototype.zoomAdjustment=function(l){return Math.max(0,(this.transform.zoom-l)/1.5)},Se.prototype.hasTransitions=function(l){return this.stale||l-this.lastPlacementChangeTime<this.fadeDuration},Se.prototype.stillRecent=function(l,f){var c=this.zoomAtLastRecencyCheck===f?1-this.zoomAdjustment(f):1;return this.zoomAtLastRecencyCheck=f,this.commitTime+this.fadeDuration*c>l},Se.prototype.setStale=function(){this.stale=!0};var Pe=Math.pow(2,25),cr=Math.pow(2,24),ur=Math.pow(2,17),Rr=Math.pow(2,16),Ae=Math.pow(2,9),sr=Math.pow(2,8),hr=Math.pow(2,1);function Dr(l){if(0===l.opacity&&!l.placed)return 0;if(1===l.opacity&&l.placed)return 4294967295;var f=l.placed?1:0,c=Math.floor(127*l.opacity);return c*Pe+f*cr+c*ur+f*Rr+c*Ae+f*sr+c*hr+f}var Tn=0,zo=function(l){this._sortAcrossTiles="viewport-y"!==l.layout.get("symbol-z-order")&&!l.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};zo.prototype.continuePlacement=function(l,f,c,m,E){for(var P=this._bucketParts;this._currentTileIndex<l.length;)if(f.getBucketParts(P,m,l[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,E())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,P.sort(function(T,R){return T.sortKey-R.sortKey}));this._currentPartIndex<P.length;)if(f.placeLayerBucketPart(P[this._currentPartIndex],this._seenCrossTileIDs,c),this._currentPartIndex++,E())return!0;return!1};var $e=function(l,f,c,m,E,P,T){this.placement=new Se(l,E,P,T),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=c,this._showCollisionBoxes=m,this._done=!1};$e.prototype.isDone=function(){return this._done},$e.prototype.continuePlacement=function(l,f,c){for(var m=this,E=s.browser.now(),P=function(){var V=s.browser.now()-E;return!m._forceFullPlacement&&V>2};this._currentPlacementIndex>=0;){var T=f[l[this._currentPlacementIndex]],R=this.placement.collisionIndex.transform.zoom;if("symbol"===T.type&&(!T.minzoom||T.minzoom<=R)&&(!T.maxzoom||T.maxzoom>R)){if(this._inProgressLayer||(this._inProgressLayer=new zo(T)),this._inProgressLayer.continuePlacement(c[T.source],this.placement,this._showCollisionBoxes,T,P))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},$e.prototype.commit=function(l){return this.placement.commit(l),this.placement};var Vr=512/s.EXTENT/2,Qn=function(l,f,c){this.tileID=l,this.indexedSymbolInstances={},this.bucketInstanceId=c;for(var m=0;m<f.length;m++){var E=f.get(m),P=E.key;this.indexedSymbolInstances[P]||(this.indexedSymbolInstances[P]=[]),this.indexedSymbolInstances[P].push({crossTileID:E.crossTileID,coord:this.getScaledCoordinates(E,l)})}};Qn.prototype.getScaledCoordinates=function(l,f){var c=Vr/Math.pow(2,f.canonical.z-this.tileID.canonical.z);return{x:Math.floor((f.canonical.x*s.EXTENT+l.anchorX)*c),y:Math.floor((f.canonical.y*s.EXTENT+l.anchorY)*c)}},Qn.prototype.findMatches=function(l,f,c){for(var m=this.tileID.canonical.z<f.canonical.z?1:Math.pow(2,this.tileID.canonical.z-f.canonical.z),E=0;E<l.length;E++){var P=l.get(E);if(!P.crossTileID){var T=this.indexedSymbolInstances[P.key];if(T)for(var R=this.getScaledCoordinates(P,f),V=0,Q=T;V<Q.length;V+=1){var vt=Q[V];if(Math.abs(vt.coord.x-R.x)<=m&&Math.abs(vt.coord.y-R.y)<=m&&!c[vt.crossTileID]){c[vt.crossTileID]=!0,P.crossTileID=vt.crossTileID;break}}}}};var en=function(){this.maxCrossTileID=0};en.prototype.generate=function(){return++this.maxCrossTileID};var ci=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};ci.prototype.handleWrapJump=function(l){var f=Math.round((l-this.lng)/360);if(0!==f)for(var c in this.indexes){var m=this.indexes[c],E={};for(var P in m){var T=m[P];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+f),E[T.tileID.key]=T}this.indexes[c]=E}this.lng=l},ci.prototype.addBucket=function(l,f,c){if(this.indexes[l.overscaledZ]&&this.indexes[l.overscaledZ][l.key]){if(this.indexes[l.overscaledZ][l.key].bucketInstanceId===f.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(l.overscaledZ,this.indexes[l.overscaledZ][l.key])}for(var m=0;m<f.symbolInstances.length;m++)f.symbolInstances.get(m).crossTileID=0;this.usedCrossTileIDs[l.overscaledZ]||(this.usedCrossTileIDs[l.overscaledZ]={});var E=this.usedCrossTileIDs[l.overscaledZ];for(var P in this.indexes){var T=this.indexes[P];if(Number(P)>l.overscaledZ)for(var R in T){var V=T[R];V.tileID.isChildOf(l)&&V.findMatches(f.symbolInstances,l,E)}else{var Q=T[l.scaledTo(Number(P)).key];Q&&Q.findMatches(f.symbolInstances,l,E)}}for(var vt=0;vt<f.symbolInstances.length;vt++){var Et=f.symbolInstances.get(vt);Et.crossTileID||(Et.crossTileID=c.generate(),E[Et.crossTileID]=!0)}return void 0===this.indexes[l.overscaledZ]&&(this.indexes[l.overscaledZ]={}),this.indexes[l.overscaledZ][l.key]=new Qn(l,f.symbolInstances,f.bucketInstanceId),!0},ci.prototype.removeBucketCrossTileIDs=function(l,f){for(var c in f.indexedSymbolInstances)for(var m=0,E=f.indexedSymbolInstances[c];m<E.length;m+=1)delete this.usedCrossTileIDs[l][E[m].crossTileID]},ci.prototype.removeStaleBuckets=function(l){var f=!1;for(var c in this.indexes){var m=this.indexes[c];for(var E in m)l[m[E].bucketInstanceId]||(this.removeBucketCrossTileIDs(c,m[E]),delete m[E],f=!0)}return f};var zr=function(){this.layerIndexes={},this.crossTileIDs=new en,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};zr.prototype.addLayer=function(l,f,c){var m=this.layerIndexes[l.id];void 0===m&&(m=this.layerIndexes[l.id]=new ci);var E=!1,P={};m.handleWrapJump(c);for(var T=0,R=f;T<R.length;T+=1){var V=R[T],Q=V.getBucket(l);Q&&l.id===Q.layerIds[0]&&(Q.bucketInstanceId||(Q.bucketInstanceId=++this.maxBucketInstanceId),m.addBucket(V.tileID,Q,this.crossTileIDs)&&(E=!0),P[Q.bucketInstanceId]=!0)}return m.removeStaleBuckets(P)&&(E=!0),E},zr.prototype.pruneUnusedLayers=function(l){var f={};for(var c in l.forEach(function(m){f[m]=!0}),this.layerIndexes)f[c]||delete this.layerIndexes[c]};var Qo=function(l,f){return s.emitValidationErrors(l,f&&f.filter(function(c){return"source.canvas"!==c.identifier}))},ls=s.pick(Ke,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Qr=s.pick(Ke,["setCenter","setZoom","setBearing","setPitch"]),ni=function(){var l={},f=s.styleSpec.$version;for(var c in s.styleSpec.$root){var m,E=s.styleSpec.$root[c];E.required&&null!=(m="version"===c?f:"array"===E.type?[]:{})&&(l[c]=m)}return l}(),Ao=function(l){function f(c,m){var E=this;void 0===m&&(m={}),l.call(this),this.map=c,this.dispatcher=new kt(Pr(),this),this.imageManager=new Z,this.imageManager.setEventedParent(this),this.glyphManager=new et(c._requestManager,m.localIdeographFontFamily),this.lineAtlas=new Ct(256,512),this.crossTileSymbolIndex=new zr,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new s.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",s.getReferrer());var P=this;this._rtlTextPluginCallback=f.registerForPluginStateChange(function(T){P.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:T.pluginStatus,pluginURL:T.pluginURL},function(R,V){if(s.triggerPluginCompletionEvent(R),V&&V.every(function(vt){return vt}))for(var Q in P.sourceCaches)P.sourceCaches[Q].reload()})}),this.on("data",function(T){if("source"===T.dataType&&"metadata"===T.sourceDataType){var R=E.sourceCaches[T.sourceId];if(R){var V=R.getSource();if(V&&V.vectorLayerIds)for(var Q in E._layers){var vt=E._layers[Q];vt.source===V.id&&E._validateLayer(vt)}}}})}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.loadURL=function(c,m){var E=this;void 0===m&&(m={}),this.fire(new s.Event("dataloading",{dataType:"style"}));var P="boolean"==typeof m.validate?m.validate:!s.isMapboxURL(c);c=this.map._requestManager.normalizeStyleURL(c,m.accessToken);var T=this.map._requestManager.transformRequest(c,s.ResourceType.Style);this._request=s.getJSON(T,function(R,V){E._request=null,R?E.fire(new s.ErrorEvent(R)):V&&E._load(V,P)})},f.prototype.loadJSON=function(c,m){var E=this;void 0===m&&(m={}),this.fire(new s.Event("dataloading",{dataType:"style"})),this._request=s.browser.frame(function(){E._request=null,E._load(c,!1!==m.validate)})},f.prototype.loadEmpty=function(){this.fire(new s.Event("dataloading",{dataType:"style"})),this._load(ni,!1)},f.prototype._load=function(c,m){if(!m||!Qo(this,s.validateStyle(c))){for(var E in this._loaded=!0,this.stylesheet=c,c.sources)this.addSource(E,c.sources[E],{validate:!1});c.sprite?this._loadSprite(c.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(c.glyphs);var P=yr(this.stylesheet.layers);this._order=P.map(function(Q){return Q.id}),this._layers={},this._serializedLayers={};for(var T=0,R=P;T<R.length;T+=1){var V=R[T];(V=s.createStyleLayer(V)).setEventedParent(this,{layer:{id:V.id}}),this._layers[V.id]=V,this._serializedLayers[V.id]=V.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Wt(this.stylesheet.light),this.fire(new s.Event("data",{dataType:"style"})),this.fire(new s.Event("style.load"))}},f.prototype._loadSprite=function(c){var m=this;this._spriteRequest=function(E,P,T){var R,V,Q,vt=s.browser.devicePixelRatio>1?"@2x":"",Et=s.getJSON(P.transformRequest(P.normalizeSpriteURL(E,vt,".json"),s.ResourceType.SpriteJSON),function(Gt,ee){Et=null,Q||(Q=Gt,R=ee,Jt())}),_t=s.getImage(P.transformRequest(P.normalizeSpriteURL(E,vt,".png"),s.ResourceType.SpriteImage),function(Gt,ee){_t=null,Q||(Q=Gt,V=ee,Jt())});function Jt(){if(Q)T(Q);else if(R&&V){var Gt=s.browser.getImageData(V),ee={};for(var jt in R){var ie=R[jt],ye=ie.width,we=ie.height,Ze=ie.x,Ne=ie.y,We=ie.sdf,er=ie.pixelRatio,br=ie.stretchX,fr=ie.stretchY,Br=ie.content,cn=new s.RGBAImage({width:ye,height:we});s.RGBAImage.copy(Gt,cn,{x:Ze,y:Ne},{x:0,y:0},{width:ye,height:we}),ee[jt]={data:cn,pixelRatio:er,sdf:We,stretchX:br,stretchY:fr,content:Br}}T(null,ee)}}return{cancel:function(){Et&&(Et.cancel(),Et=null),_t&&(_t.cancel(),_t=null)}}}(c,this.map._requestManager,function(E,P){if(m._spriteRequest=null,E)m.fire(new s.ErrorEvent(E));else if(P)for(var T in P)m.imageManager.addImage(T,P[T]);m.imageManager.setLoaded(!0),m._availableImages=m.imageManager.listImages(),m.dispatcher.broadcast("setImages",m._availableImages),m.fire(new s.Event("data",{dataType:"style"}))})},f.prototype._validateLayer=function(c){var m=this.sourceCaches[c.source];if(m){var E=c.sourceLayer;if(E){var P=m.getSource();("geojson"===P.type||P.vectorLayerIds&&-1===P.vectorLayerIds.indexOf(E))&&this.fire(new s.ErrorEvent(new Error('Source layer "'+E+'" does not exist on source "'+P.id+'" as specified by style layer "'+c.id+'"')))}}},f.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var c in this.sourceCaches)if(!this.sourceCaches[c].loaded())return!1;return!!this.imageManager.isLoaded()},f.prototype._serializeLayers=function(c){for(var m=[],E=0,P=c;E<P.length;E+=1){var T=this._layers[P[E]];"custom"!==T.type&&m.push(T.serialize())}return m},f.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var c in this.sourceCaches)if(this.sourceCaches[c].hasTransition())return!0;for(var m in this._layers)if(this._layers[m].hasTransition())return!0;return!1},f.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},f.prototype.update=function(c){if(this._loaded){var m=this._changed;if(this._changed){var E=Object.keys(this._updatedLayers),P=Object.keys(this._removedLayers);for(var T in(E.length||P.length)&&this._updateWorkerLayers(E,P),this._updatedSources){var R=this._updatedSources[T];"reload"===R?this._reloadSource(T):"clear"===R&&this._clearSource(T)}for(var V in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[V].updateTransitions(c);this.light.updateTransitions(c),this._resetUpdates()}var Q={};for(var vt in this.sourceCaches){var Et=this.sourceCaches[vt];Q[vt]=Et.used,Et.used=!1}for(var _t=0,Jt=this._order;_t<Jt.length;_t+=1){var Gt=this._layers[Jt[_t]];Gt.recalculate(c,this._availableImages),!Gt.isHidden(c.zoom)&&Gt.source&&(this.sourceCaches[Gt.source].used=!0)}for(var ee in Q){var jt=this.sourceCaches[ee];Q[ee]!==jt.used&&jt.fire(new s.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:ee}))}this.light.recalculate(c),this.z=c.zoom,m&&this.fire(new s.Event("data",{dataType:"style"}))}},f.prototype._updateTilesForChangedImages=function(){var c=Object.keys(this._changedImages);if(c.length){for(var m in this.sourceCaches)this.sourceCaches[m].reloadTilesForDependencies(["icons","patterns"],c);this._changedImages={}}},f.prototype._updateWorkerLayers=function(c,m){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(c),removedIds:m})},f.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},f.prototype.setState=function(c){var m=this;if(this._checkLoaded(),Qo(this,s.validateStyle(c)))return!1;(c=s.clone$1(c)).layers=yr(c.layers);var E=function(T,R){if(!T)return[{command:Ke.setStyle,args:[R]}];var V=[];try{if(!s.deepEqual(T.version,R.version))return[{command:Ke.setStyle,args:[R]}];s.deepEqual(T.center,R.center)||V.push({command:Ke.setCenter,args:[R.center]}),s.deepEqual(T.zoom,R.zoom)||V.push({command:Ke.setZoom,args:[R.zoom]}),s.deepEqual(T.bearing,R.bearing)||V.push({command:Ke.setBearing,args:[R.bearing]}),s.deepEqual(T.pitch,R.pitch)||V.push({command:Ke.setPitch,args:[R.pitch]}),s.deepEqual(T.sprite,R.sprite)||V.push({command:Ke.setSprite,args:[R.sprite]}),s.deepEqual(T.glyphs,R.glyphs)||V.push({command:Ke.setGlyphs,args:[R.glyphs]}),s.deepEqual(T.transition,R.transition)||V.push({command:Ke.setTransition,args:[R.transition]}),s.deepEqual(T.light,R.light)||V.push({command:Ke.setLight,args:[R.light]});var Q={},vt=[];!function(_t,Jt,Gt,ee){var jt;for(jt in Jt=Jt||{},_t=_t||{})_t.hasOwnProperty(jt)&&(Jt.hasOwnProperty(jt)||an(jt,Gt,ee));for(jt in Jt)Jt.hasOwnProperty(jt)&&(_t.hasOwnProperty(jt)?s.deepEqual(_t[jt],Jt[jt])||("geojson"===_t[jt].type&&"geojson"===Jt[jt].type&&_n(_t,Jt,jt)?Gt.push({command:Ke.setGeoJSONSourceData,args:[jt,Jt[jt].data]}):Lr(jt,Jt,Gt,ee)):wn(jt,Jt,Gt))}(T.sources,R.sources,vt,Q);var Et=[];T.layers&&T.layers.forEach(function(_t){Q[_t.source]?V.push({command:Ke.removeLayer,args:[_t.id]}):Et.push(_t)}),V=V.concat(vt),function(_t,Jt,Gt){Jt=Jt||[];var ee,jt,ie,ye,we,Ze,Ne,We=(_t=_t||[]).map(Gi),er=Jt.map(Gi),br=_t.reduce(ri,{}),fr=Jt.reduce(ri,{}),Br=We.slice(),cn=Object.create(null);for(ee=0,jt=0;ee<We.length;ee++)fr.hasOwnProperty(ie=We[ee])?jt++:(Gt.push({command:Ke.removeLayer,args:[ie]}),Br.splice(Br.indexOf(ie,jt),1));for(ee=0,jt=0;ee<er.length;ee++)Br[Br.length-1-ee]!==(ie=er[er.length-1-ee])&&(br.hasOwnProperty(ie)?(Gt.push({command:Ke.removeLayer,args:[ie]}),Br.splice(Br.lastIndexOf(ie,Br.length-jt),1)):jt++,Gt.push({command:Ke.addLayer,args:[fr[ie],Ze=Br[Br.length-ee]]}),Br.splice(Br.length-ee,0,ie),cn[ie]=!0);for(ee=0;ee<er.length;ee++)if(ye=br[ie=er[ee]],we=fr[ie],!cn[ie]&&!s.deepEqual(ye,we))if(s.deepEqual(ye.source,we.source)&&s.deepEqual(ye["source-layer"],we["source-layer"])&&s.deepEqual(ye.type,we.type)){for(Ne in Nr(ye.layout,we.layout,Gt,ie,null,Ke.setLayoutProperty),Nr(ye.paint,we.paint,Gt,ie,null,Ke.setPaintProperty),s.deepEqual(ye.filter,we.filter)||Gt.push({command:Ke.setFilter,args:[ie,we.filter]}),s.deepEqual(ye.minzoom,we.minzoom)&&s.deepEqual(ye.maxzoom,we.maxzoom)||Gt.push({command:Ke.setLayerZoomRange,args:[ie,we.minzoom,we.maxzoom]}),ye)ye.hasOwnProperty(Ne)&&"layout"!==Ne&&"paint"!==Ne&&"filter"!==Ne&&"metadata"!==Ne&&"minzoom"!==Ne&&"maxzoom"!==Ne&&(0===Ne.indexOf("paint.")?Nr(ye[Ne],we[Ne],Gt,ie,Ne.slice(6),Ke.setPaintProperty):s.deepEqual(ye[Ne],we[Ne])||Gt.push({command:Ke.setLayerProperty,args:[ie,Ne,we[Ne]]}));for(Ne in we)we.hasOwnProperty(Ne)&&!ye.hasOwnProperty(Ne)&&"layout"!==Ne&&"paint"!==Ne&&"filter"!==Ne&&"metadata"!==Ne&&"minzoom"!==Ne&&"maxzoom"!==Ne&&(0===Ne.indexOf("paint.")?Nr(ye[Ne],we[Ne],Gt,ie,Ne.slice(6),Ke.setPaintProperty):s.deepEqual(ye[Ne],we[Ne])||Gt.push({command:Ke.setLayerProperty,args:[ie,Ne,we[Ne]]}))}else Gt.push({command:Ke.removeLayer,args:[ie]}),Ze=Br[Br.lastIndexOf(ie)+1],Gt.push({command:Ke.addLayer,args:[we,Ze]})}(Et,R.layers,V)}catch(_t){console.warn("Unable to compute style diff:",_t),V=[{command:Ke.setStyle,args:[R]}]}return V}(this.serialize(),c).filter(function(T){return!(T.command in Qr)});if(0===E.length)return!1;var P=E.filter(function(T){return!(T.command in ls)});if(P.length>0)throw new Error("Unimplemented: "+P.map(function(T){return T.command}).join(", ")+".");return E.forEach(function(T){"setTransition"!==T.command&&m[T.command].apply(m,T.args)}),this.stylesheet=c,!0},f.prototype.addImage=function(c,m){if(this.getImage(c))return this.fire(new s.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(c,m),this._afterImageUpdated(c)},f.prototype.updateImage=function(c,m){this.imageManager.updateImage(c,m)},f.prototype.getImage=function(c){return this.imageManager.getImage(c)},f.prototype.removeImage=function(c){if(!this.getImage(c))return this.fire(new s.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(c),this._afterImageUpdated(c)},f.prototype._afterImageUpdated=function(c){this._availableImages=this.imageManager.listImages(),this._changedImages[c]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new s.Event("data",{dataType:"style"}))},f.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},f.prototype.addSource=function(c,m,E){var P=this;if(void 0===E&&(E={}),this._checkLoaded(),void 0!==this.sourceCaches[c])throw new Error("There is already a source with this ID");if(!m.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(m).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(m.type)>=0&&this._validate(s.validateStyle.source,"sources."+c,m,null,E))){this.map&&this.map._collectResourceTiming&&(m.collectResourceTiming=!0);var T=this.sourceCaches[c]=new Dt(c,m,this.dispatcher);T.style=this,T.setEventedParent(this,function(){return{isSourceLoaded:P.loaded(),source:T.serialize(),sourceId:c}}),T.onAdd(this.map),this._changed=!0}},f.prototype.removeSource=function(c){if(this._checkLoaded(),void 0===this.sourceCaches[c])throw new Error("There is no source with this ID");for(var m in this._layers)if(this._layers[m].source===c)return this.fire(new s.ErrorEvent(new Error('Source "'+c+'" cannot be removed while layer "'+m+'" is using it.')));var E=this.sourceCaches[c];delete this.sourceCaches[c],delete this._updatedSources[c],E.fire(new s.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:c})),E.setEventedParent(null),E.clearTiles(),E.onRemove&&E.onRemove(this.map),this._changed=!0},f.prototype.setGeoJSONSourceData=function(c,m){this._checkLoaded(),this.sourceCaches[c].getSource().setData(m),this._changed=!0},f.prototype.getSource=function(c){return this.sourceCaches[c]&&this.sourceCaches[c].getSource()},f.prototype.addLayer=function(c,m,E){void 0===E&&(E={}),this._checkLoaded();var P=c.id;if(this.getLayer(P))this.fire(new s.ErrorEvent(new Error('Layer with id "'+P+'" already exists on this map')));else{var T;if("custom"===c.type){if(Qo(this,s.validateCustomStyleLayer(c)))return;T=s.createStyleLayer(c)}else{if("object"==typeof c.source&&(this.addSource(P,c.source),c=s.clone$1(c),c=s.extend(c,{source:P})),this._validate(s.validateStyle.layer,"layers."+P,c,{arrayIndex:-1},E))return;T=s.createStyleLayer(c),this._validateLayer(T),T.setEventedParent(this,{layer:{id:P}}),this._serializedLayers[T.id]=T.serialize()}var R=m?this._order.indexOf(m):this._order.length;if(m&&-1===R)this.fire(new s.ErrorEvent(new Error('Layer with id "'+m+'" does not exist on this map.')));else{if(this._order.splice(R,0,P),this._layerOrderChanged=!0,this._layers[P]=T,this._removedLayers[P]&&T.source&&"custom"!==T.type){var V=this._removedLayers[P];delete this._removedLayers[P],V.type!==T.type?this._updatedSources[T.source]="clear":(this._updatedSources[T.source]="reload",this.sourceCaches[T.source].pause())}this._updateLayer(T),T.onAdd&&T.onAdd(this.map)}}},f.prototype.moveLayer=function(c,m){if(this._checkLoaded(),this._changed=!0,this._layers[c]){if(c!==m){var E=this._order.indexOf(c);this._order.splice(E,1);var P=m?this._order.indexOf(m):this._order.length;m&&-1===P?this.fire(new s.ErrorEvent(new Error('Layer with id "'+m+'" does not exist on this map.'))):(this._order.splice(P,0,c),this._layerOrderChanged=!0)}}else this.fire(new s.ErrorEvent(new Error("The layer '"+c+"' does not exist in the map's style and cannot be moved.")))},f.prototype.removeLayer=function(c){this._checkLoaded();var m=this._layers[c];if(m){m.setEventedParent(null);var E=this._order.indexOf(c);this._order.splice(E,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[c]=m,delete this._layers[c],delete this._serializedLayers[c],delete this._updatedLayers[c],delete this._updatedPaintProps[c],m.onRemove&&m.onRemove(this.map)}else this.fire(new s.ErrorEvent(new Error("The layer '"+c+"' does not exist in the map's style and cannot be removed.")))},f.prototype.getLayer=function(c){return this._layers[c]},f.prototype.hasLayer=function(c){return c in this._layers},f.prototype.setLayerZoomRange=function(c,m,E){this._checkLoaded();var P=this.getLayer(c);P?P.minzoom===m&&P.maxzoom===E||(null!=m&&(P.minzoom=m),null!=E&&(P.maxzoom=E),this._updateLayer(P)):this.fire(new s.ErrorEvent(new Error("The layer '"+c+"' does not exist in the map's style and cannot have zoom extent.")))},f.prototype.setFilter=function(c,m,E){void 0===E&&(E={}),this._checkLoaded();var P=this.getLayer(c);if(P){if(!s.deepEqual(P.filter,m))return null==m?(P.filter=void 0,void this._updateLayer(P)):void(this._validate(s.validateStyle.filter,"layers."+P.id+".filter",m,null,E)||(P.filter=s.clone$1(m),this._updateLayer(P)))}else this.fire(new s.ErrorEvent(new Error("The layer '"+c+"' does not exist in the map's style and cannot be filtered.")))},f.prototype.getFilter=function(c){return s.clone$1(this.getLayer(c).filter)},f.prototype.setLayoutProperty=function(c,m,E,P){void 0===P&&(P={}),this._checkLoaded();var T=this.getLayer(c);T?s.deepEqual(T.getLayoutProperty(m),E)||(T.setLayoutProperty(m,E,P),this._updateLayer(T)):this.fire(new s.ErrorEvent(new Error("The layer '"+c+"' does not exist in the map's style and cannot be styled.")))},f.prototype.getLayoutProperty=function(c,m){var E=this.getLayer(c);if(E)return E.getLayoutProperty(m);this.fire(new s.ErrorEvent(new Error("The layer '"+c+"' does not exist in the map's style.")))},f.prototype.setPaintProperty=function(c,m,E,P){void 0===P&&(P={}),this._checkLoaded();var T=this.getLayer(c);T?s.deepEqual(T.getPaintProperty(m),E)||(T.setPaintProperty(m,E,P)&&this._updateLayer(T),this._changed=!0,this._updatedPaintProps[c]=!0):this.fire(new s.ErrorEvent(new Error("The layer '"+c+"' does not exist in the map's style and cannot be styled.")))},f.prototype.getPaintProperty=function(c,m){return this.getLayer(c).getPaintProperty(m)},f.prototype.setFeatureState=function(c,m){this._checkLoaded();var E=c.source,P=c.sourceLayer,T=this.sourceCaches[E];if(void 0!==T){var R=T.getSource().type;"geojson"===R&&P?this.fire(new s.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==R||P?(void 0===c.id&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),T.setFeatureState(P,c.id,m)):this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error("The source '"+E+"' does not exist in the map's style.")))},f.prototype.removeFeatureState=function(c,m){this._checkLoaded();var E=c.source,P=this.sourceCaches[E];if(void 0!==P){var T=P.getSource().type,R="vector"===T?c.sourceLayer:void 0;"vector"!==T||R?m&&"string"!=typeof c.id&&"number"!=typeof c.id?this.fire(new s.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):P.removeFeatureState(R,c.id,m):this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error("The source '"+E+"' does not exist in the map's style.")))},f.prototype.getFeatureState=function(c){this._checkLoaded();var m=c.source,E=c.sourceLayer,P=this.sourceCaches[m];if(void 0!==P){if("vector"!==P.getSource().type||E)return void 0===c.id&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),P.getFeatureState(E,c.id);this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error("The source '"+m+"' does not exist in the map's style.")))},f.prototype.getTransition=function(){return s.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},f.prototype.serialize=function(){return s.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:s.mapObject(this.sourceCaches,function(c){return c.serialize()}),layers:this._serializeLayers(this._order)},function(c){return void 0!==c})},f.prototype._updateLayer=function(c){this._updatedLayers[c.id]=!0,c.source&&!this._updatedSources[c.source]&&"raster"!==this.sourceCaches[c.source].getSource().type&&(this._updatedSources[c.source]="reload",this.sourceCaches[c.source].pause()),this._changed=!0},f.prototype._flattenAndSortRenderedFeatures=function(c){for(var m=this,E=function(br){return"fill-extrusion"===m._layers[br].type},P={},T=[],R=this._order.length-1;R>=0;R--){var V=this._order[R];if(E(V)){P[V]=R;for(var Q=0,vt=c;Q<vt.length;Q+=1){var Et=vt[Q][V];if(Et)for(var _t=0,Jt=Et;_t<Jt.length;_t+=1)T.push(Jt[_t])}}}T.sort(function(br,fr){return fr.intersectionZ-br.intersectionZ});for(var Gt=[],ee=this._order.length-1;ee>=0;ee--){var jt=this._order[ee];if(E(jt))for(var ie=T.length-1;ie>=0;ie--){var ye=T[ie].feature;if(P[ye.layer.id]<ee)break;Gt.push(ye),T.pop()}else for(var we=0,Ze=c;we<Ze.length;we+=1){var Ne=Ze[we][jt];if(Ne)for(var We=0,er=Ne;We<er.length;We+=1)Gt.push(er[We].feature)}}return Gt},f.prototype.queryRenderedFeatures=function(c,m,E){m&&m.filter&&this._validate(s.validateStyle.filter,"queryRenderedFeatures.filter",m.filter,null,m);var P={};if(m&&m.layers){if(!Array.isArray(m.layers))return this.fire(new s.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var T=0,R=m.layers;T<R.length;T+=1){var V=R[T],Q=this._layers[V];if(!Q)return this.fire(new s.ErrorEvent(new Error("The layer '"+V+"' does not exist in the map's style and cannot be queried for features."))),[];P[Q.source]=!0}}var vt=[];for(var Et in m.availableImages=this._availableImages,this.sourceCaches)m.layers&&!P[Et]||vt.push(Me(this.sourceCaches[Et],this._layers,this._serializedLayers,c,m,E));return this.placement&&vt.push(function(_t,Jt,Gt,ee,jt,ie,ye){for(var we={},Ze=ie.queryRenderedSymbols(ee),Ne=[],We=0,er=Object.keys(Ze).map(Number);We<er.length;We+=1)Ne.push(ye[er[We]]);Ne.sort(Mr);for(var br=function(){var rn=Br[fr],Pi=rn.featureIndex.lookupSymbolFeatures(Ze[rn.bucketInstanceId],Jt,rn.bucketIndex,rn.sourceLayerIndex,jt.filter,jt.layers,jt.availableImages,_t);for(var Ur in Pi){var Zn=we[Ur]=we[Ur]||[],si=Pi[Ur];si.sort(function(Dn,Ln){var gn=rn.featureSortOrder;if(gn){var qo=gn.indexOf(Dn.featureIndex);return gn.indexOf(Ln.featureIndex)-qo}return Ln.featureIndex-Dn.featureIndex});for(var Rn=0,Fn=si;Rn<Fn.length;Rn+=1)Zn.push(Fn[Rn])}},fr=0,Br=Ne;fr<Br.length;fr+=1)br();var cn=function(rn){we[rn].forEach(function(Pi){var Ur=Pi.feature,Zn=Gt[_t[rn].source].getFeatureState(Ur.layer["source-layer"],Ur.id);Ur.source=Ur.layer.source,Ur.layer["source-layer"]&&(Ur.sourceLayer=Ur.layer["source-layer"]),Ur.state=Zn})};for(var hn in we)cn(hn);return we}(this._layers,this._serializedLayers,this.sourceCaches,c,m,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(vt)},f.prototype.querySourceFeatures=function(c,m){m&&m.filter&&this._validate(s.validateStyle.filter,"querySourceFeatures.filter",m.filter,null,m);var E=this.sourceCaches[c];return E?function(P,T){for(var R=P.getRenderableIds().map(function(Jt){return P.getTileByID(Jt)}),V=[],Q={},vt=0;vt<R.length;vt++){var Et=R[vt],_t=Et.tileID.canonical.key;Q[_t]||(Q[_t]=!0,Et.querySourceFeatures(V,T))}return V}(E,m):[]},f.prototype.addSourceType=function(c,m,E){return f.getSourceType(c)?E(new Error('A source type called "'+c+'" already exists.')):(f.setSourceType(c,m),m.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:c,url:m.workerSourceURL},E):E(null,null))},f.prototype.getLight=function(){return this.light.getLight()},f.prototype.setLight=function(c,m){void 0===m&&(m={}),this._checkLoaded();var E=this.light.getLight(),P=!1;for(var T in c)if(!s.deepEqual(c[T],E[T])){P=!0;break}if(P){var R={now:s.browser.now(),transition:s.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(c,m),this.light.updateTransitions(R)}},f.prototype._validate=function(c,m,E,P,T){return void 0===T&&(T={}),(!T||!1!==T.validate)&&Qo(this,c.call(s.validateStyle,s.extend({key:m,style:this.serialize(),value:E,styleSpec:s.styleSpec},P)))},f.prototype._remove=function(){for(var c in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),s.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[c].setEventedParent(null);for(var m in this.sourceCaches)this.sourceCaches[m].clearTiles(),this.sourceCaches[m].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},f.prototype._clearSource=function(c){this.sourceCaches[c].clearTiles()},f.prototype._reloadSource=function(c){this.sourceCaches[c].resume(),this.sourceCaches[c].reload()},f.prototype._updateSources=function(c){for(var m in this.sourceCaches)this.sourceCaches[m].update(c)},f.prototype._generateCollisionBoxes=function(){for(var c in this.sourceCaches)this._reloadSource(c)},f.prototype._updatePlacement=function(c,m,E,P,T){void 0===T&&(T=!1);for(var R=!1,V=!1,Q={},vt=0,Et=this._order;vt<Et.length;vt+=1){var _t=this._layers[Et[vt]];if("symbol"===_t.type){if(!Q[_t.source]){var Jt=this.sourceCaches[_t.source];Q[_t.source]=Jt.getRenderableIds(!0).map(function(ye){return Jt.getTileByID(ye)}).sort(function(ye,we){return we.tileID.overscaledZ-ye.tileID.overscaledZ||(ye.tileID.isLessThan(we.tileID)?-1:1)})}var Gt=this.crossTileSymbolIndex.addLayer(_t,Q[_t.source],c.center.lng);R=R||Gt}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((T=T||this._layerOrderChanged||0===E)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(s.browser.now(),c.zoom))&&(this.pauseablePlacement=new $e(c,this._order,T,m,E,P,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,Q),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(s.browser.now()),V=!0),R&&this.pauseablePlacement.placement.setStale()),V||R)for(var ee=0,jt=this._order;ee<jt.length;ee+=1){var ie=this._layers[jt[ee]];"symbol"===ie.type&&this.placement.updateLayerOpacities(ie,Q[ie.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(s.browser.now())},f.prototype._releaseSymbolFadeTiles=function(){for(var c in this.sourceCaches)this.sourceCaches[c].releaseSymbolFadeTiles()},f.prototype.getImages=function(c,m,E){this.imageManager.getImages(m.icons,E),this._updateTilesForChangedImages();var P=this.sourceCaches[m.source];P&&P.setDependencies(m.tileID.key,m.type,m.icons)},f.prototype.getGlyphs=function(c,m,E){this.glyphManager.getGlyphs(m.stacks,E)},f.prototype.getResource=function(c,m,E){return s.makeRequest(m,E)},f}(s.Evented);Ao.getSourceType=function(l){return ze[l]},Ao.setSourceType=function(l,f){ze[l]=f},Ao.registerForPluginStateChange=s.registerForPluginStateChange;var Lo=s.createLayout([{name:"a_pos",type:"Int16",components:2}]),io=Vi("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),ba=Vi("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),yu=Vi("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Do=Vi("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),jl=Vi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Vn=Vi("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),wo=Vi("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Ho=Vi("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),zu=Vi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Dl=Vi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),xs=Vi("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),Ol=Vi("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),tl=Vi("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),da=Vi("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),Ys=Vi("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),yi=Vi("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),uu=Vi("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),wa=Vi("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Rs=Vi("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),Fi=Vi("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),Jr=Vi("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),vu=Vi("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),Js=Vi("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),aa=Vi("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),za=Vi("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),Mu=Vi("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}");function Vi(l,f){var c=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,m=f.match(/attribute ([\w]+) ([\w]+)/g),E=l.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),P=f.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),T=P?P.concat(E):E,R={};return{fragmentSource:l=l.replace(c,function(V,Q,vt,Et,_t){return R[_t]=!0,"define"===Q?"\n#ifndef HAS_UNIFORM_u_"+_t+"\nvarying "+vt+" "+Et+" "+_t+";\n#else\nuniform "+vt+" "+Et+" u_"+_t+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+_t+"\n    "+vt+" "+Et+" "+_t+" = u_"+_t+";\n#endif\n"}),vertexSource:f=f.replace(c,function(V,Q,vt,Et,_t){var Jt="float"===Et?"vec2":"vec4",Gt=_t.match(/color/)?"color":Jt;return R[_t]?"define"===Q?"\n#ifndef HAS_UNIFORM_u_"+_t+"\nuniform lowp float u_"+_t+"_t;\nattribute "+vt+" "+Jt+" a_"+_t+";\nvarying "+vt+" "+Et+" "+_t+";\n#else\nuniform "+vt+" "+Et+" u_"+_t+";\n#endif\n":"vec4"===Gt?"\n#ifndef HAS_UNIFORM_u_"+_t+"\n    "+_t+" = a_"+_t+";\n#else\n    "+vt+" "+Et+" "+_t+" = u_"+_t+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+_t+"\n    "+_t+" = unpack_mix_"+Gt+"(a_"+_t+", u_"+_t+"_t);\n#else\n    "+vt+" "+Et+" "+_t+" = u_"+_t+";\n#endif\n":"define"===Q?"\n#ifndef HAS_UNIFORM_u_"+_t+"\nuniform lowp float u_"+_t+"_t;\nattribute "+vt+" "+Jt+" a_"+_t+";\n#else\nuniform "+vt+" "+Et+" u_"+_t+";\n#endif\n":"vec4"===Gt?"\n#ifndef HAS_UNIFORM_u_"+_t+"\n    "+vt+" "+Et+" "+_t+" = a_"+_t+";\n#else\n    "+vt+" "+Et+" "+_t+" = u_"+_t+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+_t+"\n    "+vt+" "+Et+" "+_t+" = unpack_mix_"+Gt+"(a_"+_t+", u_"+_t+"_t);\n#else\n    "+vt+" "+Et+" "+_t+" = u_"+_t+";\n#endif\n"}),staticAttributes:m,staticUniforms:T}}var Ms=Object.freeze({__proto__:null,prelude:io,background:ba,backgroundPattern:yu,circle:Do,clippingMask:jl,heatmap:Vn,heatmapTexture:wo,collisionBox:Ho,collisionCircle:zu,debug:Dl,fill:xs,fillOutline:Ol,fillOutlinePattern:tl,fillPattern:da,fillExtrusion:Ys,fillExtrusionPattern:yi,hillshadePrepare:uu,hillshade:wa,line:Rs,lineGradient:Fi,linePattern:Jr,lineSDF:vu,raster:Js,symbolIcon:aa,symbolSDF:za,symbolTextAndIcon:Mu}),Hs=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function $n(l){for(var f=[],c=0;c<l.length;c++)if(null!==l[c]){var m=l[c].split(" ");f.push(m.pop())}return f}Hs.prototype.bind=function(l,f,c,m,E,P,T,R){this.context=l;for(var V=this.boundPaintVertexBuffers.length!==m.length,Q=0;!V&&Q<m.length;Q++)this.boundPaintVertexBuffers[Q]!==m[Q]&&(V=!0);l.extVertexArrayObject&&this.vao&&this.boundProgram===f&&this.boundLayoutVertexBuffer===c&&!V&&this.boundIndexBuffer===E&&this.boundVertexOffset===P&&this.boundDynamicVertexBuffer===T&&this.boundDynamicVertexBuffer2===R?(l.bindVertexArrayOES.set(this.vao),T&&T.bind(),E&&E.dynamicDraw&&E.bind(),R&&R.bind()):this.freshBind(f,c,m,E,P,T,R)},Hs.prototype.freshBind=function(l,f,c,m,E,P,T){var R,V=l.numAttributes,Q=this.context,vt=Q.gl;if(Q.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Q.extVertexArrayObject.createVertexArrayOES(),Q.bindVertexArrayOES.set(this.vao),R=0,this.boundProgram=l,this.boundLayoutVertexBuffer=f,this.boundPaintVertexBuffers=c,this.boundIndexBuffer=m,this.boundVertexOffset=E,this.boundDynamicVertexBuffer=P,this.boundDynamicVertexBuffer2=T;else{R=Q.currentNumAttributes||0;for(var Et=V;Et<R;Et++)vt.disableVertexAttribArray(Et)}f.enableAttributes(vt,l);for(var _t=0,Jt=c;_t<Jt.length;_t+=1)Jt[_t].enableAttributes(vt,l);P&&P.enableAttributes(vt,l),T&&T.enableAttributes(vt,l),f.bind(),f.setVertexAttribPointers(vt,l,E);for(var Gt=0,ee=c;Gt<ee.length;Gt+=1){var jt=ee[Gt];jt.bind(),jt.setVertexAttribPointers(vt,l,E)}P&&(P.bind(),P.setVertexAttribPointers(vt,l,E)),m&&m.bind(),T&&(T.bind(),T.setVertexAttribPointers(vt,l,E)),Q.currentNumAttributes=V},Hs.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var Ps=function(l,f,c,m,E,P){var T=l.gl;this.program=T.createProgram();for(var R=$n(c.staticAttributes),V=m?m.getBinderAttributes():[],Q=R.concat(V),vt=c.staticUniforms?$n(c.staticUniforms):[],Et=m?m.getBinderUniforms():[],_t=[],Jt=0,Gt=vt.concat(Et);Jt<Gt.length;Jt+=1){var ee=Gt[Jt];_t.indexOf(ee)<0&&_t.push(ee)}var jt=m?m.defines():[];P&&jt.push("#define OVERDRAW_INSPECTOR;");var ie=jt.concat(io.fragmentSource,c.fragmentSource).join("\n"),ye=jt.concat(io.vertexSource,c.vertexSource).join("\n"),we=T.createShader(T.FRAGMENT_SHADER);if(T.isContextLost())this.failedToCreate=!0;else{T.shaderSource(we,ie),T.compileShader(we),T.attachShader(this.program,we);var Ze=T.createShader(T.VERTEX_SHADER);if(T.isContextLost())this.failedToCreate=!0;else{T.shaderSource(Ze,ye),T.compileShader(Ze),T.attachShader(this.program,Ze),this.attributes={};var Ne={};this.numAttributes=Q.length;for(var We=0;We<this.numAttributes;We++)Q[We]&&(T.bindAttribLocation(this.program,We,Q[We]),this.attributes[Q[We]]=We);T.linkProgram(this.program),T.deleteShader(Ze),T.deleteShader(we);for(var er=0;er<_t.length;er++){var br=_t[er];if(br&&!Ne[br]){var fr=T.getUniformLocation(this.program,br);fr&&(Ne[br]=fr)}}this.fixedUniforms=E(l,Ne),this.binderUniforms=m?m.getUniforms(l,Ne):[]}}};function zi(l,f,c){var m=1/Fo(c,1,f.transform.tileZoom),E=Math.pow(2,c.tileID.overscaledZ),P=c.tileSize*Math.pow(2,f.transform.tileZoom)/E,T=P*(c.tileID.canonical.x+c.tileID.wrap*E),R=P*c.tileID.canonical.y;return{u_image:0,u_texsize:c.imageAtlasTexture.size,u_scale:[m,l.fromScale,l.toScale],u_fade:l.t,u_pixel_coord_upper:[T>>16,R>>16],u_pixel_coord_lower:[65535&T,65535&R]}}Ps.prototype.draw=function(l,f,c,m,E,P,T,R,V,Q,vt,Et,_t,Jt,Gt,ee){var jt,ie=l.gl;if(!this.failedToCreate){for(var ye in l.program.set(this.program),l.setDepthMode(c),l.setStencilMode(m),l.setColorMode(E),l.setCullFace(P),this.fixedUniforms)this.fixedUniforms[ye].set(T[ye]);Jt&&Jt.setUniforms(l,this.binderUniforms,Et,{zoom:_t});for(var we=(jt={},jt[ie.LINES]=2,jt[ie.TRIANGLES]=3,jt[ie.LINE_STRIP]=1,jt)[f],Ze=0,Ne=vt.get();Ze<Ne.length;Ze+=1){var We=Ne[Ze],er=We.vaos||(We.vaos={});(er[R]||(er[R]=new Hs)).bind(l,this,V,Jt?Jt.getPaintVertexBuffers():[],Q,We.vertexOffset,Gt,ee),ie.drawElements(f,We.primitiveLength*we,ie.UNSIGNED_SHORT,We.primitiveOffset*we*2)}}};var el=function(l,f,c,m){var E=f.style.light,P=E.properties.get("position"),T=[P.x,P.y,P.z],R=s.create$1();"viewport"===E.properties.get("anchor")&&s.fromRotation(R,-f.transform.angle),s.transformMat3(T,T,R);var V=E.properties.get("color");return{u_matrix:l,u_lightpos:T,u_lightintensity:E.properties.get("intensity"),u_lightcolor:[V.r,V.g,V.b],u_vertical_gradient:+c,u_opacity:m}},$a=function(l,f,c,m,E,P,T){return s.extend(el(l,f,c,m),zi(P,f,T),{u_height_factor:-Math.pow(2,E.overscaledZ)/T.tileSize/8})},cs=function(l){return{u_matrix:l}},Nn=function(l,f,c,m){return s.extend(cs(l),zi(c,f,m))},Ws=function(l,f){return{u_matrix:l,u_world:f}},Eo=function(l,f,c,m,E){return s.extend(Nn(l,f,c,m),{u_world:E})},pl=function(l,f,c,m){var E,P,T=l.transform;if("map"===m.paint.get("circle-pitch-alignment")){var R=Fo(c,1,T.zoom);E=!0,P=[R,R]}else E=!1,P=T.pixelsToGLUnits;return{u_camera_to_center_distance:T.cameraToCenterDistance,u_scale_with_map:+("map"===m.paint.get("circle-pitch-scale")),u_matrix:l.translatePosMatrix(f.posMatrix,c,m.paint.get("circle-translate"),m.paint.get("circle-translate-anchor")),u_pitch_with_map:+E,u_device_pixel_ratio:s.browser.devicePixelRatio,u_extrude_scale:P}},ga=function(l,f,c){var m=Fo(c,1,f.zoom),E=Math.pow(2,f.zoom-c.tileID.overscaledZ),P=c.tileID.overscaleFactor();return{u_matrix:l,u_camera_to_center_distance:f.cameraToCenterDistance,u_pixels_to_tile_units:m,u_extrude_scale:[f.pixelsToGLUnits[0]/(m*E),f.pixelsToGLUnits[1]/(m*E)],u_overscale_factor:P}},bs=function(l,f,c){return{u_matrix:l,u_inv_matrix:f,u_camera_to_center_distance:c.cameraToCenterDistance,u_viewport_size:[c.width,c.height]}},_u=function(l,f,c){return void 0===c&&(c=1),{u_matrix:l,u_color:f,u_overlay:0,u_overlay_scale:c}},Ba=function(l){return{u_matrix:l}},hi=function(l,f,c,m){return{u_matrix:l,u_extrude_scale:Fo(f,1,c),u_intensity:m}},ta=function(l,f,c){var m=l.transform;return{u_matrix:Uu(l,f,c),u_ratio:1/Fo(f,1,m.zoom),u_device_pixel_ratio:s.browser.devicePixelRatio,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},Bu=function(l,f,c,m){return s.extend(ta(l,f,c),{u_image:0,u_image_height:m})},jn=function(l,f,c,m){var E=l.transform,P=Da(f,E);return{u_matrix:Uu(l,f,c),u_texsize:f.imageAtlasTexture.size,u_ratio:1/Fo(f,1,E.zoom),u_device_pixel_ratio:s.browser.devicePixelRatio,u_image:0,u_scale:[P,m.fromScale,m.toScale],u_fade:m.t,u_units_to_pixels:[1/E.pixelsToGLUnits[0],1/E.pixelsToGLUnits[1]]}},Ua=function(l,f,c,m,E){var P=l.lineAtlas,T=Da(f,l.transform),R="round"===c.layout.get("line-cap"),V=P.getDash(m.from,R),Q=P.getDash(m.to,R),vt=V.width*E.fromScale,Et=Q.width*E.toScale;return s.extend(ta(l,f,c),{u_patternscale_a:[T/vt,-V.height/2],u_patternscale_b:[T/Et,-Q.height/2],u_sdfgamma:P.width/(256*Math.min(vt,Et)*s.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:V.y,u_tex_y_b:Q.y,u_mix:E.t})};function Da(l,f){return 1/Fo(l,1,f.tileZoom)}function Uu(l,f,c){return l.translatePosMatrix(f.tileID.posMatrix,f,c.paint.get("line-translate"),c.paint.get("line-translate-anchor"))}var kl=function(l,f,c,m,E){return{u_matrix:l,u_tl_parent:f,u_scale_parent:c,u_buffer_scale:1,u_fade_t:m.mix,u_opacity:m.opacity*E.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:E.paint.get("raster-brightness-min"),u_brightness_high:E.paint.get("raster-brightness-max"),u_saturation_factor:(T=E.paint.get("raster-saturation"),T>0?1-1/(1.001-T):-T),u_contrast_factor:(P=E.paint.get("raster-contrast"),P>0?1/(1-P):1+P),u_spin_weights:xu(E.paint.get("raster-hue-rotate"))};var P,T};function xu(l){l*=Math.PI/180;var f=Math.sin(l),c=Math.cos(l);return[(2*c+1)/3,(-Math.sqrt(3)*f-c+1)/3,(Math.sqrt(3)*f-c+1)/3]}var qa,Pu=function(l,f,c,m,E,P,T,R,V,Q){var vt=E.transform;return{u_is_size_zoom_constant:+("constant"===l||"source"===l),u_is_size_feature_constant:+("constant"===l||"camera"===l),u_size_t:f?f.uSizeT:0,u_size:f?f.uSize:0,u_camera_to_center_distance:vt.cameraToCenterDistance,u_pitch:vt.pitch/360*2*Math.PI,u_rotate_symbol:+c,u_aspect_ratio:vt.width/vt.height,u_fade_change:E.options.fadeDuration?E.symbolFadeChange:1,u_matrix:P,u_label_plane_matrix:T,u_coord_matrix:R,u_is_text:+V,u_pitch_with_map:+m,u_texsize:Q,u_texture:0}},ea=function(l,f,c,m,E,P,T,R,V,Q,vt){var Et=E.transform;return s.extend(Pu(l,f,c,m,E,P,T,R,V,Q),{u_gamma_scale:m?Math.cos(Et._pitch)*Et.cameraToCenterDistance:1,u_device_pixel_ratio:s.browser.devicePixelRatio,u_is_halo:+vt})},hs=function(l,f,c,m,E,P,T,R,V,Q){return s.extend(ea(l,f,c,m,E,P,T,R,!0,V,!0),{u_texsize_icon:Q,u_texture_icon:1})},Fs=function(l,f,c){return{u_matrix:l,u_opacity:f,u_color:c}},be=function(l,f,c,m,E,P){return s.extend((R=P,Q=E,vt=(V=c).imageManager.getPattern((T=m).from.toString()),Et=V.imageManager.getPattern(T.to.toString()),Jt=(_t=V.imageManager.getPixelSize()).width,Gt=_t.height,ee=Math.pow(2,Q.tileID.overscaledZ),ie=(jt=Q.tileSize*Math.pow(2,V.transform.tileZoom)/ee)*(Q.tileID.canonical.x+Q.tileID.wrap*ee),ye=jt*Q.tileID.canonical.y,{u_image:0,u_pattern_tl_a:vt.tl,u_pattern_br_a:vt.br,u_pattern_tl_b:Et.tl,u_pattern_br_b:Et.br,u_texsize:[Jt,Gt],u_mix:R.t,u_pattern_size_a:vt.displaySize,u_pattern_size_b:Et.displaySize,u_scale_a:R.fromScale,u_scale_b:R.toScale,u_tile_units_to_pixels:1/Fo(Q,1,V.transform.tileZoom),u_pixel_coord_upper:[ie>>16,ye>>16],u_pixel_coord_lower:[65535&ie,65535&ye]}),{u_matrix:l,u_opacity:f});var T,R,V,Q,vt,Et,_t,Jt,Gt,ee,jt,ie,ye},je={fillExtrusion:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_lightpos:new s.Uniform3f(l,f.u_lightpos),u_lightintensity:new s.Uniform1f(l,f.u_lightintensity),u_lightcolor:new s.Uniform3f(l,f.u_lightcolor),u_vertical_gradient:new s.Uniform1f(l,f.u_vertical_gradient),u_opacity:new s.Uniform1f(l,f.u_opacity)}},fillExtrusionPattern:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_lightpos:new s.Uniform3f(l,f.u_lightpos),u_lightintensity:new s.Uniform1f(l,f.u_lightintensity),u_lightcolor:new s.Uniform3f(l,f.u_lightcolor),u_vertical_gradient:new s.Uniform1f(l,f.u_vertical_gradient),u_height_factor:new s.Uniform1f(l,f.u_height_factor),u_image:new s.Uniform1i(l,f.u_image),u_texsize:new s.Uniform2f(l,f.u_texsize),u_pixel_coord_upper:new s.Uniform2f(l,f.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(l,f.u_pixel_coord_lower),u_scale:new s.Uniform3f(l,f.u_scale),u_fade:new s.Uniform1f(l,f.u_fade),u_opacity:new s.Uniform1f(l,f.u_opacity)}},fill:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix)}},fillPattern:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_image:new s.Uniform1i(l,f.u_image),u_texsize:new s.Uniform2f(l,f.u_texsize),u_pixel_coord_upper:new s.Uniform2f(l,f.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(l,f.u_pixel_coord_lower),u_scale:new s.Uniform3f(l,f.u_scale),u_fade:new s.Uniform1f(l,f.u_fade)}},fillOutline:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_world:new s.Uniform2f(l,f.u_world)}},fillOutlinePattern:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_world:new s.Uniform2f(l,f.u_world),u_image:new s.Uniform1i(l,f.u_image),u_texsize:new s.Uniform2f(l,f.u_texsize),u_pixel_coord_upper:new s.Uniform2f(l,f.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(l,f.u_pixel_coord_lower),u_scale:new s.Uniform3f(l,f.u_scale),u_fade:new s.Uniform1f(l,f.u_fade)}},circle:function(l,f){return{u_camera_to_center_distance:new s.Uniform1f(l,f.u_camera_to_center_distance),u_scale_with_map:new s.Uniform1i(l,f.u_scale_with_map),u_pitch_with_map:new s.Uniform1i(l,f.u_pitch_with_map),u_extrude_scale:new s.Uniform2f(l,f.u_extrude_scale),u_device_pixel_ratio:new s.Uniform1f(l,f.u_device_pixel_ratio),u_matrix:new s.UniformMatrix4f(l,f.u_matrix)}},collisionBox:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_camera_to_center_distance:new s.Uniform1f(l,f.u_camera_to_center_distance),u_pixels_to_tile_units:new s.Uniform1f(l,f.u_pixels_to_tile_units),u_extrude_scale:new s.Uniform2f(l,f.u_extrude_scale),u_overscale_factor:new s.Uniform1f(l,f.u_overscale_factor)}},collisionCircle:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_inv_matrix:new s.UniformMatrix4f(l,f.u_inv_matrix),u_camera_to_center_distance:new s.Uniform1f(l,f.u_camera_to_center_distance),u_viewport_size:new s.Uniform2f(l,f.u_viewport_size)}},debug:function(l,f){return{u_color:new s.UniformColor(l,f.u_color),u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_overlay:new s.Uniform1i(l,f.u_overlay),u_overlay_scale:new s.Uniform1f(l,f.u_overlay_scale)}},clippingMask:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix)}},heatmap:function(l,f){return{u_extrude_scale:new s.Uniform1f(l,f.u_extrude_scale),u_intensity:new s.Uniform1f(l,f.u_intensity),u_matrix:new s.UniformMatrix4f(l,f.u_matrix)}},heatmapTexture:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_world:new s.Uniform2f(l,f.u_world),u_image:new s.Uniform1i(l,f.u_image),u_color_ramp:new s.Uniform1i(l,f.u_color_ramp),u_opacity:new s.Uniform1f(l,f.u_opacity)}},hillshade:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_image:new s.Uniform1i(l,f.u_image),u_latrange:new s.Uniform2f(l,f.u_latrange),u_light:new s.Uniform2f(l,f.u_light),u_shadow:new s.UniformColor(l,f.u_shadow),u_highlight:new s.UniformColor(l,f.u_highlight),u_accent:new s.UniformColor(l,f.u_accent)}},hillshadePrepare:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_image:new s.Uniform1i(l,f.u_image),u_dimension:new s.Uniform2f(l,f.u_dimension),u_zoom:new s.Uniform1f(l,f.u_zoom),u_unpack:new s.Uniform4f(l,f.u_unpack)}},line:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_ratio:new s.Uniform1f(l,f.u_ratio),u_device_pixel_ratio:new s.Uniform1f(l,f.u_device_pixel_ratio),u_units_to_pixels:new s.Uniform2f(l,f.u_units_to_pixels)}},lineGradient:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_ratio:new s.Uniform1f(l,f.u_ratio),u_device_pixel_ratio:new s.Uniform1f(l,f.u_device_pixel_ratio),u_units_to_pixels:new s.Uniform2f(l,f.u_units_to_pixels),u_image:new s.Uniform1i(l,f.u_image),u_image_height:new s.Uniform1f(l,f.u_image_height)}},linePattern:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_texsize:new s.Uniform2f(l,f.u_texsize),u_ratio:new s.Uniform1f(l,f.u_ratio),u_device_pixel_ratio:new s.Uniform1f(l,f.u_device_pixel_ratio),u_image:new s.Uniform1i(l,f.u_image),u_units_to_pixels:new s.Uniform2f(l,f.u_units_to_pixels),u_scale:new s.Uniform3f(l,f.u_scale),u_fade:new s.Uniform1f(l,f.u_fade)}},lineSDF:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_ratio:new s.Uniform1f(l,f.u_ratio),u_device_pixel_ratio:new s.Uniform1f(l,f.u_device_pixel_ratio),u_units_to_pixels:new s.Uniform2f(l,f.u_units_to_pixels),u_patternscale_a:new s.Uniform2f(l,f.u_patternscale_a),u_patternscale_b:new s.Uniform2f(l,f.u_patternscale_b),u_sdfgamma:new s.Uniform1f(l,f.u_sdfgamma),u_image:new s.Uniform1i(l,f.u_image),u_tex_y_a:new s.Uniform1f(l,f.u_tex_y_a),u_tex_y_b:new s.Uniform1f(l,f.u_tex_y_b),u_mix:new s.Uniform1f(l,f.u_mix)}},raster:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_tl_parent:new s.Uniform2f(l,f.u_tl_parent),u_scale_parent:new s.Uniform1f(l,f.u_scale_parent),u_buffer_scale:new s.Uniform1f(l,f.u_buffer_scale),u_fade_t:new s.Uniform1f(l,f.u_fade_t),u_opacity:new s.Uniform1f(l,f.u_opacity),u_image0:new s.Uniform1i(l,f.u_image0),u_image1:new s.Uniform1i(l,f.u_image1),u_brightness_low:new s.Uniform1f(l,f.u_brightness_low),u_brightness_high:new s.Uniform1f(l,f.u_brightness_high),u_saturation_factor:new s.Uniform1f(l,f.u_saturation_factor),u_contrast_factor:new s.Uniform1f(l,f.u_contrast_factor),u_spin_weights:new s.Uniform3f(l,f.u_spin_weights)}},symbolIcon:function(l,f){return{u_is_size_zoom_constant:new s.Uniform1i(l,f.u_is_size_zoom_constant),u_is_size_feature_constant:new s.Uniform1i(l,f.u_is_size_feature_constant),u_size_t:new s.Uniform1f(l,f.u_size_t),u_size:new s.Uniform1f(l,f.u_size),u_camera_to_center_distance:new s.Uniform1f(l,f.u_camera_to_center_distance),u_pitch:new s.Uniform1f(l,f.u_pitch),u_rotate_symbol:new s.Uniform1i(l,f.u_rotate_symbol),u_aspect_ratio:new s.Uniform1f(l,f.u_aspect_ratio),u_fade_change:new s.Uniform1f(l,f.u_fade_change),u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_label_plane_matrix:new s.UniformMatrix4f(l,f.u_label_plane_matrix),u_coord_matrix:new s.UniformMatrix4f(l,f.u_coord_matrix),u_is_text:new s.Uniform1i(l,f.u_is_text),u_pitch_with_map:new s.Uniform1i(l,f.u_pitch_with_map),u_texsize:new s.Uniform2f(l,f.u_texsize),u_texture:new s.Uniform1i(l,f.u_texture)}},symbolSDF:function(l,f){return{u_is_size_zoom_constant:new s.Uniform1i(l,f.u_is_size_zoom_constant),u_is_size_feature_constant:new s.Uniform1i(l,f.u_is_size_feature_constant),u_size_t:new s.Uniform1f(l,f.u_size_t),u_size:new s.Uniform1f(l,f.u_size),u_camera_to_center_distance:new s.Uniform1f(l,f.u_camera_to_center_distance),u_pitch:new s.Uniform1f(l,f.u_pitch),u_rotate_symbol:new s.Uniform1i(l,f.u_rotate_symbol),u_aspect_ratio:new s.Uniform1f(l,f.u_aspect_ratio),u_fade_change:new s.Uniform1f(l,f.u_fade_change),u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_label_plane_matrix:new s.UniformMatrix4f(l,f.u_label_plane_matrix),u_coord_matrix:new s.UniformMatrix4f(l,f.u_coord_matrix),u_is_text:new s.Uniform1i(l,f.u_is_text),u_pitch_with_map:new s.Uniform1i(l,f.u_pitch_with_map),u_texsize:new s.Uniform2f(l,f.u_texsize),u_texture:new s.Uniform1i(l,f.u_texture),u_gamma_scale:new s.Uniform1f(l,f.u_gamma_scale),u_device_pixel_ratio:new s.Uniform1f(l,f.u_device_pixel_ratio),u_is_halo:new s.Uniform1i(l,f.u_is_halo)}},symbolTextAndIcon:function(l,f){return{u_is_size_zoom_constant:new s.Uniform1i(l,f.u_is_size_zoom_constant),u_is_size_feature_constant:new s.Uniform1i(l,f.u_is_size_feature_constant),u_size_t:new s.Uniform1f(l,f.u_size_t),u_size:new s.Uniform1f(l,f.u_size),u_camera_to_center_distance:new s.Uniform1f(l,f.u_camera_to_center_distance),u_pitch:new s.Uniform1f(l,f.u_pitch),u_rotate_symbol:new s.Uniform1i(l,f.u_rotate_symbol),u_aspect_ratio:new s.Uniform1f(l,f.u_aspect_ratio),u_fade_change:new s.Uniform1f(l,f.u_fade_change),u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_label_plane_matrix:new s.UniformMatrix4f(l,f.u_label_plane_matrix),u_coord_matrix:new s.UniformMatrix4f(l,f.u_coord_matrix),u_is_text:new s.Uniform1i(l,f.u_is_text),u_pitch_with_map:new s.Uniform1i(l,f.u_pitch_with_map),u_texsize:new s.Uniform2f(l,f.u_texsize),u_texsize_icon:new s.Uniform2f(l,f.u_texsize_icon),u_texture:new s.Uniform1i(l,f.u_texture),u_texture_icon:new s.Uniform1i(l,f.u_texture_icon),u_gamma_scale:new s.Uniform1f(l,f.u_gamma_scale),u_device_pixel_ratio:new s.Uniform1f(l,f.u_device_pixel_ratio),u_is_halo:new s.Uniform1i(l,f.u_is_halo)}},background:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_opacity:new s.Uniform1f(l,f.u_opacity),u_color:new s.UniformColor(l,f.u_color)}},backgroundPattern:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_opacity:new s.Uniform1f(l,f.u_opacity),u_image:new s.Uniform1i(l,f.u_image),u_pattern_tl_a:new s.Uniform2f(l,f.u_pattern_tl_a),u_pattern_br_a:new s.Uniform2f(l,f.u_pattern_br_a),u_pattern_tl_b:new s.Uniform2f(l,f.u_pattern_tl_b),u_pattern_br_b:new s.Uniform2f(l,f.u_pattern_br_b),u_texsize:new s.Uniform2f(l,f.u_texsize),u_mix:new s.Uniform1f(l,f.u_mix),u_pattern_size_a:new s.Uniform2f(l,f.u_pattern_size_a),u_pattern_size_b:new s.Uniform2f(l,f.u_pattern_size_b),u_scale_a:new s.Uniform1f(l,f.u_scale_a),u_scale_b:new s.Uniform1f(l,f.u_scale_b),u_pixel_coord_upper:new s.Uniform2f(l,f.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(l,f.u_pixel_coord_lower),u_tile_units_to_pixels:new s.Uniform1f(l,f.u_tile_units_to_pixels)}}};function dr(l,f,c,m,E,P,T){for(var R=l.context,V=R.gl,Q=l.useProgram("collisionBox"),vt=[],Et=0,_t=0,Jt=0;Jt<m.length;Jt++){var Gt=m[Jt],ee=f.getTile(Gt),jt=ee.getBucket(c);if(jt){var ie=Gt.posMatrix;0===E[0]&&0===E[1]||(ie=l.translatePosMatrix(Gt.posMatrix,ee,E,P));var ye=T?jt.textCollisionBox:jt.iconCollisionBox,we=jt.collisionCircleArray;if(we.length>0){var Ze=s.create(),Ne=ie;s.mul(Ze,jt.placementInvProjMatrix,l.transform.glCoordMatrix),s.mul(Ze,Ze,jt.placementViewportMatrix),vt.push({circleArray:we,circleOffset:_t,transform:Ne,invTransform:Ze}),_t=Et+=we.length/4}ye&&Q.draw(R,V.LINES,bt.disabled,Ft.disabled,l.colorModeForRenderPass(),me.disabled,ga(ie,l.transform,ee),c.id,ye.layoutVertexBuffer,ye.indexBuffer,ye.segments,null,l.transform.zoom,null,null,ye.collisionVertexBuffer)}}if(T&&vt.length){var We=l.useProgram("collisionCircle"),er=new s.StructArrayLayout2f1f2i16;er.resize(4*Et),er._trim();for(var br=0,fr=0,Br=vt;fr<Br.length;fr+=1)for(var cn=Br[fr],hn=0;hn<cn.circleArray.length/4;hn++){var rn=4*hn,Pi=cn.circleArray[rn+0],Ur=cn.circleArray[rn+1],Zn=cn.circleArray[rn+2],si=cn.circleArray[rn+3];er.emplace(br++,Pi,Ur,Zn,si,0),er.emplace(br++,Pi,Ur,Zn,si,1),er.emplace(br++,Pi,Ur,Zn,si,2),er.emplace(br++,Pi,Ur,Zn,si,3)}(!qa||qa.length<2*Et)&&(qa=function(Pa){var Us=2*Pa,ms=new s.StructArrayLayout3ui6;ms.resize(Us),ms._trim();for(var Cs=0;Cs<Us;Cs++){var Ya=6*Cs;ms.uint16[Ya+0]=4*Cs+0,ms.uint16[Ya+1]=4*Cs+1,ms.uint16[Ya+2]=4*Cs+2,ms.uint16[Ya+3]=4*Cs+2,ms.uint16[Ya+4]=4*Cs+3,ms.uint16[Ya+5]=4*Cs+0}return ms}(Et));for(var Rn=R.createIndexBuffer(qa,!0),Fn=R.createVertexBuffer(er,s.collisionCircleLayout.members,!0),Dn=0,Ln=vt;Dn<Ln.length;Dn+=1){var gn=Ln[Dn],qo=bs(gn.transform,gn.invTransform,l.transform);We.draw(R,V.TRIANGLES,bt.disabled,Ft.disabled,l.colorModeForRenderPass(),me.disabled,qo,c.id,Fn,Rn,s.SegmentVector.simpleSegment(0,2*gn.circleOffset,gn.circleArray.length,gn.circleArray.length/2),null,l.transform.zoom,null,null,null)}Fn.destroy(),Rn.destroy()}}var fn=s.identity(new Float32Array(16));function Ei(l,f,c,m,E,P){var T=s.getAnchorAlignment(l),R=-(T.horizontalAlign-.5)*f,V=-(T.verticalAlign-.5)*c,Q=s.evaluateVariableOffset(l,m);return new s.Point((R/E+Q[0])*P,(V/E+Q[1])*P)}function An(l,f,c,m,E,P,T,R,V,Q,vt){var Et=l.text.placedSymbolArray,_t=l.text.dynamicLayoutVertexArray,Jt=l.icon.dynamicLayoutVertexArray,Gt={};_t.clear();for(var ee=0;ee<Et.length;ee++){var jt=Et.get(ee),ie=jt.hidden||!jt.crossTileID||l.allowVerticalPlacement&&!jt.placedOrientation?null:m[jt.crossTileID];if(ie){var ye=new s.Point(jt.anchorX,jt.anchorY),we=Gr(ye,c?R:T),Ze=fa(P.cameraToCenterDistance,we.signedDistanceFromCamera),Ne=E.evaluateSizeForFeature(l.textSizeData,Q,jt)*Ze/s.ONE_EM;c&&(Ne*=l.tilePixelRatio/V);for(var We=Ei(ie.anchor,ie.width,ie.height,ie.textOffset,ie.textBoxScale,Ne),er=c?Gr(ye.add(We),T).point:we.point.add(f?We.rotate(-P.angle):We),br=l.allowVerticalPlacement&&jt.placedOrientation===s.WritingMode.vertical?Math.PI/2:0,fr=0;fr<jt.numGlyphs;fr++)s.addDynamicAttributes(_t,er,br);vt&&jt.associatedIconIndex>=0&&(Gt[jt.associatedIconIndex]={shiftedAnchor:er,angle:br})}else su(jt.numGlyphs,_t)}if(vt){Jt.clear();for(var Br=l.icon.placedSymbolArray,cn=0;cn<Br.length;cn++){var hn=Br.get(cn);if(hn.hidden)su(hn.numGlyphs,Jt);else{var rn=Gt[cn];if(rn)for(var Pi=0;Pi<hn.numGlyphs;Pi++)s.addDynamicAttributes(Jt,rn.shiftedAnchor,rn.angle);else su(hn.numGlyphs,Jt)}}l.icon.dynamicLayoutVertexBuffer.updateData(Jt)}l.text.dynamicLayoutVertexBuffer.updateData(_t)}function xo(l,f,c){return c.iconsInText&&f?"symbolTextAndIcon":l?"symbolSDF":"symbolIcon"}function oo(l,f,c,m,E,P,T,R,V,Q,vt,Et){for(var _t=l.context,Jt=_t.gl,Gt=l.transform,ee="map"===R,jt="map"===V,ie=ee&&"point"!==c.layout.get("symbol-placement"),ye=ee&&!jt&&!ie,we=!c.layout.get("symbol-sort-key").isConstant(),Ze=!1,Ne=l.depthModeForSublayer(0,bt.ReadOnly),We=c.layout.get("text-variable-anchor"),er=[],br=0,fr=m;br<fr.length;br+=1){var Br=fr[br],cn=f.getTile(Br),hn=cn.getBucket(c);if(hn){var rn=E?hn.text:hn.icon;if(rn&&rn.segments.get().length){var Pi=rn.programConfigurations.get(c.id),Ur=E||hn.sdfIcons,Zn=E?hn.textSizeData:hn.iconSizeData,si=jt||0!==Gt.pitch,Rn=l.useProgram(xo(Ur,E,hn),Pi),Fn=s.evaluateSizeForZoom(Zn,Gt.zoom),Dn=void 0,Ln=[0,0],gn=void 0,qo=void 0,Pa=null,Us=void 0;if(E)gn=cn.glyphAtlasTexture,qo=Jt.LINEAR,Dn=cn.glyphAtlasTexture.size,hn.iconsInText&&(Ln=cn.imageAtlasTexture.size,Pa=cn.imageAtlasTexture,Us=si||l.options.rotating||l.options.zooming||"composite"===Zn.kind||"camera"===Zn.kind?Jt.LINEAR:Jt.NEAREST);else{var ms=1!==c.layout.get("icon-size").constantOr(0)||hn.iconsNeedLinear;gn=cn.imageAtlasTexture,qo=Ur||l.options.rotating||l.options.zooming||ms||si?Jt.LINEAR:Jt.NEAREST,Dn=cn.imageAtlasTexture.size}var Cs=Fo(cn,1,l.transform.zoom),Ya=ho(Br.posMatrix,jt,ee,l.transform,Cs),Os=li(Br.posMatrix,jt,ee,l.transform,Cs),dl=We&&hn.hasTextData(),hu="none"!==c.layout.get("icon-text-fit")&&dl&&hn.hasIconData();ie&&Ra(hn,Br.posMatrix,l,E,Ya,Os,jt,Q);var ks=l.translatePosMatrix(Br.posMatrix,cn,P,T),gl=ie||E&&We||hu?fn:Ya,Gu=l.translatePosMatrix(Os,cn,P,T,!0),Ec=Ur&&0!==c.paint.get(E?"text-halo-width":"icon-halo-width").constantOr(1),Nl={program:Rn,buffers:rn,uniformValues:Ur?hn.iconsInText?hs(Zn.kind,Fn,ye,jt,l,ks,gl,Gu,Dn,Ln):ea(Zn.kind,Fn,ye,jt,l,ks,gl,Gu,E,Dn,!0):Pu(Zn.kind,Fn,ye,jt,l,ks,gl,Gu,E,Dn),atlasTexture:gn,atlasTextureIcon:Pa,atlasInterpolation:qo,atlasInterpolationIcon:Us,isSDF:Ur,hasHalo:Ec};if(we&&hn.canOverlap){Ze=!0;for(var uc=0,El=rn.segments.get();uc<El.length;uc+=1){var Sc=El[uc];er.push({segments:new s.SegmentVector([Sc]),sortKey:Sc.sortKey,state:Nl})}}else er.push({segments:rn.segments,sortKey:0,state:Nl})}}}Ze&&er.sort(function(Hu,Rl){return Hu.sortKey-Rl.sortKey});for(var lc=0,il=er;lc<il.length;lc+=1){var cc=il[lc],ys=cc.state;if(_t.activeTexture.set(Jt.TEXTURE0),ys.atlasTexture.bind(ys.atlasInterpolation,Jt.CLAMP_TO_EDGE),ys.atlasTextureIcon&&(_t.activeTexture.set(Jt.TEXTURE1),ys.atlasTextureIcon&&ys.atlasTextureIcon.bind(ys.atlasInterpolationIcon,Jt.CLAMP_TO_EDGE)),ys.isSDF){var ol=ys.uniformValues;ys.hasHalo&&(ol.u_is_halo=1,Ga(ys.buffers,cc.segments,c,l,ys.program,Ne,vt,Et,ol)),ol.u_is_halo=0}Ga(ys.buffers,cc.segments,c,l,ys.program,Ne,vt,Et,ys.uniformValues)}}function Ga(l,f,c,m,E,P,T,R,V){var Q=m.context;E.draw(Q,Q.gl.TRIANGLES,P,T,R,me.disabled,V,c.id,l.layoutVertexBuffer,l.indexBuffer,f,c.paint,m.transform.zoom,l.programConfigurations.get(c.id),l.dynamicLayoutVertexBuffer,l.opacityVertexBuffer)}function mi(l,f,c,m,E,P,T){var R,V,Q,vt,Et,_t=l.context.gl,Jt=c.paint.get("fill-pattern"),Gt=Jt&&Jt.constantOr(1),ee=c.getCrossfadeParameters();T?(V=Gt&&!c.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",R=_t.LINES):(V=Gt?"fillPattern":"fill",R=_t.TRIANGLES);for(var jt=0,ie=m;jt<ie.length;jt+=1){var ye=ie[jt],we=f.getTile(ye);if(!Gt||we.patternsLoaded()){var Ze=we.getBucket(c);if(Ze){var Ne=Ze.programConfigurations.get(c.id),We=l.useProgram(V,Ne);Gt&&(l.context.activeTexture.set(_t.TEXTURE0),we.imageAtlasTexture.bind(_t.LINEAR,_t.CLAMP_TO_EDGE),Ne.updatePaintBuffers(ee));var er=Jt.constantOr(null);if(er&&we.imageAtlas){var br=we.imageAtlas,fr=br.patternPositions[er.to.toString()],Br=br.patternPositions[er.from.toString()];fr&&Br&&Ne.setConstantPatternPositions(fr,Br)}var cn=l.translatePosMatrix(ye.posMatrix,we,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor"));if(T){vt=Ze.indexBuffer2,Et=Ze.segments2;var hn=[_t.drawingBufferWidth,_t.drawingBufferHeight];Q="fillOutlinePattern"===V&&Gt?Eo(cn,l,ee,we,hn):Ws(cn,hn)}else vt=Ze.indexBuffer,Et=Ze.segments,Q=Gt?Nn(cn,l,ee,we):cs(cn);We.draw(l.context,R,E,l.stencilModeForClipping(ye),P,me.disabled,Q,c.id,Ze.layoutVertexBuffer,vt,Et,c.paint,l.transform.zoom,Ne)}}}}function Wo(l,f,c,m,E,P,T){for(var R=l.context,V=R.gl,Q=c.paint.get("fill-extrusion-pattern"),vt=Q.constantOr(1),Et=c.getCrossfadeParameters(),_t=c.paint.get("fill-extrusion-opacity"),Jt=0,Gt=m;Jt<Gt.length;Jt+=1){var ee=Gt[Jt],jt=f.getTile(ee),ie=jt.getBucket(c);if(ie){var ye=ie.programConfigurations.get(c.id),we=l.useProgram(vt?"fillExtrusionPattern":"fillExtrusion",ye);vt&&(l.context.activeTexture.set(V.TEXTURE0),jt.imageAtlasTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE),ye.updatePaintBuffers(Et));var Ze=Q.constantOr(null);if(Ze&&jt.imageAtlas){var Ne=jt.imageAtlas,We=Ne.patternPositions[Ze.to.toString()],er=Ne.patternPositions[Ze.from.toString()];We&&er&&ye.setConstantPatternPositions(We,er)}var br=l.translatePosMatrix(ee.posMatrix,jt,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),fr=c.paint.get("fill-extrusion-vertical-gradient"),Br=vt?$a(br,l,fr,_t,ee,Et,jt):el(br,l,fr,_t);we.draw(R,R.gl.TRIANGLES,E,P,T,me.backCCW,Br,c.id,ie.layoutVertexBuffer,ie.indexBuffer,ie.segments,c.paint,l.transform.zoom,ye)}}}function Ts(l,f,c,m,E,P){var T=l.context,R=T.gl,V=f.fbo;if(V){var Q=l.useProgram("hillshade");T.activeTexture.set(R.TEXTURE0),R.bindTexture(R.TEXTURE_2D,V.colorAttachment.get());var vt=function(Et,_t,Jt){var Gt=Jt.paint.get("hillshade-shadow-color"),ee=Jt.paint.get("hillshade-highlight-color"),jt=Jt.paint.get("hillshade-accent-color"),ie=Jt.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===Jt.paint.get("hillshade-illumination-anchor")&&(ie-=Et.transform.angle);var ye,we,Ze,Ne=!Et.options.moving;return{u_matrix:Et.transform.calculatePosMatrix(_t.tileID.toUnwrapped(),Ne),u_image:0,u_latrange:(ye=_t.tileID,we=Math.pow(2,ye.canonical.z),Ze=ye.canonical.y,[new s.MercatorCoordinate(0,Ze/we).toLngLat().lat,new s.MercatorCoordinate(0,(Ze+1)/we).toLngLat().lat]),u_light:[Jt.paint.get("hillshade-exaggeration"),ie],u_shadow:Gt,u_highlight:ee,u_accent:jt}}(l,f,c);Q.draw(T,R.TRIANGLES,m,E,P,me.disabled,vt,c.id,l.rasterBoundsBuffer,l.quadTriangleIndexBuffer,l.rasterBoundsSegments)}}function Qa(l,f,c,m,E,P){var ee,jt,ie,ye,T=l.context,R=T.gl,V=f.dem;if(V&&V.data){var Q=V.dim,vt=V.stride,Et=V.getPixels();if(T.activeTexture.set(R.TEXTURE1),T.pixelStoreUnpackPremultiplyAlpha.set(!1),f.demTexture=f.demTexture||l.getTileTexture(vt),f.demTexture){var _t=f.demTexture;_t.update(Et,{premultiply:!1}),_t.bind(R.NEAREST,R.CLAMP_TO_EDGE)}else f.demTexture=new s.Texture(T,Et,R.RGBA,{premultiply:!1}),f.demTexture.bind(R.NEAREST,R.CLAMP_TO_EDGE);T.activeTexture.set(R.TEXTURE0);var Jt=f.fbo;if(!Jt){var Gt=new s.Texture(T,{width:Q,height:Q,data:null},R.RGBA);Gt.bind(R.LINEAR,R.CLAMP_TO_EDGE),(Jt=f.fbo=T.createFramebuffer(Q,Q,!0)).colorAttachment.set(Gt.texture)}T.bindFramebuffer.set(Jt.framebuffer),T.viewport.set([0,0,Q,Q]),l.useProgram("hillshadePrepare").draw(T,R.TRIANGLES,m,E,P,me.disabled,(ee=f.tileID,ie=(jt=V).stride,ye=s.create(),s.ortho(ye,0,s.EXTENT,-s.EXTENT,0,0,1),s.translate(ye,ye,[0,-s.EXTENT,0]),{u_matrix:ye,u_image:1,u_dimension:[ie,ie],u_zoom:ee.overscaledZ,u_unpack:jt.getUnpackVector()}),c.id,l.rasterBoundsBuffer,l.quadTriangleIndexBuffer,l.rasterBoundsSegments),f.needsHillshadePrepare=!1}}function ps(l,f,c,m,E){var P=m.paint.get("raster-fade-duration");if(P>0){var T=s.browser.now(),R=(T-l.timeAdded)/P,V=f?(T-f.timeAdded)/P:-1,Q=c.getSource(),vt=E.coveringZoomLevel({tileSize:Q.tileSize,roundZoom:Q.roundZoom}),Et=!f||Math.abs(f.tileID.overscaledZ-vt)>Math.abs(l.tileID.overscaledZ-vt),_t=Et&&l.refreshedUponExpiration?1:s.clamp(Et?R:1-V,0,1);return l.refreshedUponExpiration&&R>=1&&(l.refreshedUponExpiration=!1),f?{opacity:1,mix:1-_t}:{opacity:_t,mix:0}}return{opacity:1,mix:0}}var Ks=new s.Color(1,0,0,1),zs=new s.Color(0,1,0,1),As=new s.Color(0,0,1,1),Bo=new s.Color(1,0,1,1),$s=new s.Color(0,1,1,1);function sa(l,f,c,m){Qs(l,0,f+c/2,l.transform.width,c,m)}function Bs(l,f,c,m){Qs(l,f-c/2,0,c,l.transform.height,m)}function Qs(l,f,c,m,E,P){var T=l.context,R=T.gl;R.enable(R.SCISSOR_TEST),R.scissor(f*s.browser.devicePixelRatio,c*s.browser.devicePixelRatio,m*s.browser.devicePixelRatio,E*s.browser.devicePixelRatio),T.clear({color:P}),R.disable(R.SCISSOR_TEST)}function So(l,f,c){var m=l.context,E=m.gl,P=c.posMatrix,T=l.useProgram("debug"),R=bt.disabled,V=Ft.disabled,Q=l.colorModeForRenderPass();m.activeTexture.set(E.TEXTURE0),l.emptyTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),T.draw(m,E.LINE_STRIP,R,V,Q,me.disabled,_u(P,s.Color.red),"$debug",l.debugBuffer,l.tileBorderIndexBuffer,l.debugSegments);var vt=f.getTileByID(c.key).latestRawTileData,Et=Math.floor((vt&&vt.byteLength||0)/1024),_t=f.getTile(c).tileSize,Jt=512/Math.min(_t,512)*(c.overscaledZ/l.transform.zoom)*.5,Gt=c.canonical.toString();c.overscaledZ!==c.canonical.z&&(Gt+=" => "+c.overscaledZ),function(ee,jt){ee.initDebugOverlayCanvas();var ie=ee.debugOverlayCanvas,ye=ee.context.gl,we=ee.debugOverlayCanvas.getContext("2d");we.clearRect(0,0,ie.width,ie.height),we.shadowColor="white",we.shadowBlur=2,we.lineWidth=1.5,we.strokeStyle="white",we.textBaseline="top",we.font="bold 36px Open Sans, sans-serif",we.fillText(jt,5,5),we.strokeText(jt,5,5),ee.debugOverlayTexture.update(ie),ee.debugOverlayTexture.bind(ye.LINEAR,ye.CLAMP_TO_EDGE)}(l,Gt+" "+Et+"kb"),T.draw(m,E.TRIANGLES,R,V,se.alphaBlended,me.disabled,_u(P,s.Color.transparent,Jt),"$debug",l.debugBuffer,l.quadTriangleIndexBuffer,l.debugSegments)}var Ii={symbol:function(l,f,c,m,E){if("translucent"===l.renderPass){var P=Ft.disabled,T=l.colorModeForRenderPass();c.layout.get("text-variable-anchor")&&function(R,V,Q,vt,Et,_t,Jt){for(var Gt=V.transform,ee="map"===Et,jt="map"===_t,ie=0,ye=R;ie<ye.length;ie+=1){var we=ye[ie],Ze=vt.getTile(we),Ne=Ze.getBucket(Q);if(Ne&&Ne.text&&Ne.text.segments.get().length){var We=s.evaluateSizeForZoom(Ne.textSizeData,Gt.zoom),er=Fo(Ze,1,V.transform.zoom),br=ho(we.posMatrix,jt,ee,V.transform,er),fr="none"!==Q.layout.get("icon-text-fit")&&Ne.hasIconData();if(We){var Br=Math.pow(2,Gt.zoom-Ze.tileID.overscaledZ);An(Ne,ee,jt,Jt,s.symbolSize,Gt,br,we.posMatrix,Br,We,fr)}}}}(m,l,c,f,c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),E),0!==c.paint.get("icon-opacity").constantOr(1)&&oo(l,f,c,m,!1,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),c.layout.get("icon-rotation-alignment"),c.layout.get("icon-pitch-alignment"),c.layout.get("icon-keep-upright"),P,T),0!==c.paint.get("text-opacity").constantOr(1)&&oo(l,f,c,m,!0,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),c.layout.get("text-keep-upright"),P,T),f.map.showCollisionBoxes&&(dr(l,f,c,m,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),!0),dr(l,f,c,m,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),!1))}},circle:function(l,f,c,m){if("translucent"===l.renderPass){var E=c.paint.get("circle-opacity"),P=c.paint.get("circle-stroke-width"),T=c.paint.get("circle-stroke-opacity"),R=!c.layout.get("circle-sort-key").isConstant();if(0!==E.constantOr(1)||0!==P.constantOr(1)&&0!==T.constantOr(1)){for(var V=l.context,Q=V.gl,vt=l.depthModeForSublayer(0,bt.ReadOnly),Et=Ft.disabled,_t=l.colorModeForRenderPass(),Jt=[],Gt=0;Gt<m.length;Gt++){var ee=m[Gt],jt=f.getTile(ee),ie=jt.getBucket(c);if(ie){var ye=ie.programConfigurations.get(c.id),we={programConfiguration:ye,program:l.useProgram("circle",ye),layoutVertexBuffer:ie.layoutVertexBuffer,indexBuffer:ie.indexBuffer,uniformValues:pl(l,ee,jt,c)};if(R)for(var Ze=0,Ne=ie.segments.get();Ze<Ne.length;Ze+=1){var We=Ne[Ze];Jt.push({segments:new s.SegmentVector([We]),sortKey:We.sortKey,state:we})}else Jt.push({segments:ie.segments,sortKey:0,state:we})}}R&&Jt.sort(function(cn,hn){return cn.sortKey-hn.sortKey});for(var er=0,br=Jt;er<br.length;er+=1){var fr=br[er],Br=fr.state;Br.program.draw(V,Q.TRIANGLES,vt,Et,_t,me.disabled,Br.uniformValues,c.id,Br.layoutVertexBuffer,Br.indexBuffer,fr.segments,c.paint,l.transform.zoom,Br.programConfiguration)}}}},heatmap:function(l,f,c,m){if(0!==c.paint.get("heatmap-opacity"))if("offscreen"===l.renderPass){var E=l.context,P=E.gl,T=Ft.disabled,R=new se([P.ONE,P.ONE],s.Color.transparent,[!0,!0,!0,!0]);(function(Jt,Gt,ee){var jt=Jt.gl;Jt.activeTexture.set(jt.TEXTURE1),Jt.viewport.set([0,0,Gt.width/4,Gt.height/4]);var we,Ze,Ne,We,er,ie=ee.heatmapFbo;if(ie)jt.bindTexture(jt.TEXTURE_2D,ie.colorAttachment.get()),Jt.bindFramebuffer.set(ie.framebuffer);else{var ye=jt.createTexture();jt.bindTexture(jt.TEXTURE_2D,ye),jt.texParameteri(jt.TEXTURE_2D,jt.TEXTURE_WRAP_S,jt.CLAMP_TO_EDGE),jt.texParameteri(jt.TEXTURE_2D,jt.TEXTURE_WRAP_T,jt.CLAMP_TO_EDGE),jt.texParameteri(jt.TEXTURE_2D,jt.TEXTURE_MIN_FILTER,jt.LINEAR),jt.texParameteri(jt.TEXTURE_2D,jt.TEXTURE_MAG_FILTER,jt.LINEAR),Ne=ye,We=ie=ee.heatmapFbo=Jt.createFramebuffer(Gt.width/4,Gt.height/4,!1),(er=(we=Jt).gl).texImage2D(er.TEXTURE_2D,0,er.RGBA,(Ze=Gt).width/4,Ze.height/4,0,er.RGBA,we.extRenderToTextureHalfFloat?we.extTextureHalfFloat.HALF_FLOAT_OES:er.UNSIGNED_BYTE,null),We.colorAttachment.set(Ne)}})(E,l,c),E.clear({color:s.Color.transparent});for(var V=0;V<m.length;V++){var Q=m[V];if(!f.hasRenderableParent(Q)){var vt=f.getTile(Q),Et=vt.getBucket(c);if(Et){var _t=Et.programConfigurations.get(c.id);l.useProgram("heatmap",_t).draw(E,P.TRIANGLES,bt.disabled,T,R,me.disabled,hi(Q.posMatrix,vt,l.transform.zoom,c.paint.get("heatmap-intensity")),c.id,Et.layoutVertexBuffer,Et.indexBuffer,Et.segments,c.paint,l.transform.zoom,_t)}}}E.viewport.set([0,0,l.width,l.height])}else"translucent"===l.renderPass&&(l.context.setColorMode(l.colorModeForRenderPass()),function(Jt,Gt){var ee=Jt.context,jt=ee.gl,ie=Gt.heatmapFbo;if(ie){ee.activeTexture.set(jt.TEXTURE0),jt.bindTexture(jt.TEXTURE_2D,ie.colorAttachment.get()),ee.activeTexture.set(jt.TEXTURE1);var ye=Gt.colorRampTexture;ye||(ye=Gt.colorRampTexture=new s.Texture(ee,Gt.colorRamp,jt.RGBA)),ye.bind(jt.LINEAR,jt.CLAMP_TO_EDGE),Jt.useProgram("heatmapTexture").draw(ee,jt.TRIANGLES,bt.disabled,Ft.disabled,Jt.colorModeForRenderPass(),me.disabled,function(we,Ze,Ne,We){var er=s.create();s.ortho(er,0,we.width,we.height,0,0,1);var br=we.context.gl;return{u_matrix:er,u_world:[br.drawingBufferWidth,br.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Ze.paint.get("heatmap-opacity")}}(Jt,Gt),Gt.id,Jt.viewportBuffer,Jt.quadTriangleIndexBuffer,Jt.viewportSegments,Gt.paint,Jt.transform.zoom)}}(l,c))},line:function(l,f,c,m){if("translucent"===l.renderPass){var E=c.paint.get("line-opacity"),P=c.paint.get("line-width");if(0!==E.constantOr(1)&&0!==P.constantOr(1))for(var T=l.depthModeForSublayer(0,bt.ReadOnly),R=l.colorModeForRenderPass(),V=c.paint.get("line-dasharray"),Q=c.paint.get("line-pattern"),vt=Q.constantOr(1),Et=c.paint.get("line-gradient"),_t=c.getCrossfadeParameters(),Jt=vt?"linePattern":V?"lineSDF":Et?"lineGradient":"line",Gt=l.context,ee=Gt.gl,jt=!0,ie=0,ye=m;ie<ye.length;ie+=1){var we=ye[ie],Ze=f.getTile(we);if(!vt||Ze.patternsLoaded()){var Ne=Ze.getBucket(c);if(Ne){var We=Ne.programConfigurations.get(c.id),er=l.context.program.get(),br=l.useProgram(Jt,We),fr=jt||br.program!==er,Br=Q.constantOr(null);if(Br&&Ze.imageAtlas){var cn=Ze.imageAtlas,hn=cn.patternPositions[Br.to.toString()],rn=cn.patternPositions[Br.from.toString()];hn&&rn&&We.setConstantPatternPositions(hn,rn)}var Pi=vt?jn(l,Ze,c,_t):V?Ua(l,Ze,c,V,_t):Et?Bu(l,Ze,c,Ne.lineClipsArray.length):ta(l,Ze,c);if(vt)Gt.activeTexture.set(ee.TEXTURE0),Ze.imageAtlasTexture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE),We.updatePaintBuffers(_t);else if(V&&(fr||l.lineAtlas.dirty))Gt.activeTexture.set(ee.TEXTURE0),l.lineAtlas.bind(Gt);else if(Et){var Ur=Ne.gradients[c.id],Zn=Ur.texture;if(c.gradientVersion!==Ur.version){var si=256;if(c.stepInterpolant){var Rn=f.getSource().maxzoom,Fn=we.canonical.z===Rn?Math.ceil(1<<l.transform.maxZoom-we.canonical.z):1;si=s.clamp(s.nextPowerOfTwo(Ne.maxLineLength/s.EXTENT*1024*Fn),256,Gt.maxTextureSize)}Ur.gradient=s.renderColorRamp({expression:c.gradientExpression(),evaluationKey:"lineProgress",resolution:si,image:Ur.gradient||void 0,clips:Ne.lineClipsArray}),Ur.texture?Ur.texture.update(Ur.gradient):Ur.texture=new s.Texture(Gt,Ur.gradient,ee.RGBA),Ur.version=c.gradientVersion,Zn=Ur.texture}Gt.activeTexture.set(ee.TEXTURE0),Zn.bind(c.stepInterpolant?ee.NEAREST:ee.LINEAR,ee.CLAMP_TO_EDGE)}br.draw(Gt,ee.TRIANGLES,T,l.stencilModeForClipping(we),R,me.disabled,Pi,c.id,Ne.layoutVertexBuffer,Ne.indexBuffer,Ne.segments,c.paint,l.transform.zoom,We,Ne.layoutVertexBuffer2),jt=!1}}}}},fill:function(l,f,c,m){var E=c.paint.get("fill-color"),P=c.paint.get("fill-opacity");if(0!==P.constantOr(1)){var T=l.colorModeForRenderPass(),R=c.paint.get("fill-pattern"),V=l.opaquePassEnabledForLayer()&&!R.constantOr(1)&&1===E.constantOr(s.Color.transparent).a&&1===P.constantOr(0)?"opaque":"translucent";if(l.renderPass===V){var Q=l.depthModeForSublayer(1,"opaque"===l.renderPass?bt.ReadWrite:bt.ReadOnly);mi(l,f,c,m,Q,T,!1)}if("translucent"===l.renderPass&&c.paint.get("fill-antialias")){var vt=l.depthModeForSublayer(c.getPaintProperty("fill-outline-color")?2:0,bt.ReadOnly);mi(l,f,c,m,vt,T,!0)}}},"fill-extrusion":function(l,f,c,m){var E=c.paint.get("fill-extrusion-opacity");if(0!==E&&"translucent"===l.renderPass){var P=new bt(l.context.gl.LEQUAL,bt.ReadWrite,l.depthRangeFor3D);if(1!==E||c.paint.get("fill-extrusion-pattern").constantOr(1))Wo(l,f,c,m,P,Ft.disabled,se.disabled),Wo(l,f,c,m,P,l.stencilModeFor3D(),l.colorModeForRenderPass());else{var T=l.colorModeForRenderPass();Wo(l,f,c,m,P,Ft.disabled,T)}}},hillshade:function(l,f,c,m){if("offscreen"===l.renderPass||"translucent"===l.renderPass){for(var E=l.context,P=l.depthModeForSublayer(0,bt.ReadOnly),T=l.colorModeForRenderPass(),R="translucent"===l.renderPass?l.stencilConfigForOverlap(m):[{},m],V=R[0],Q=0,vt=R[1];Q<vt.length;Q+=1){var Et=vt[Q],_t=f.getTile(Et);_t.needsHillshadePrepare&&"offscreen"===l.renderPass?Qa(l,_t,c,P,Ft.disabled,T):"translucent"===l.renderPass&&Ts(l,_t,c,P,V[Et.overscaledZ],T)}E.viewport.set([0,0,l.width,l.height])}},raster:function(l,f,c,m){if("translucent"===l.renderPass&&0!==c.paint.get("raster-opacity")&&m.length)for(var E=l.context,P=E.gl,T=f.getSource(),R=l.useProgram("raster"),V=l.colorModeForRenderPass(),Q=T instanceof le?[{},m]:l.stencilConfigForOverlap(m),vt=Q[0],Et=Q[1],_t=Et[Et.length-1].overscaledZ,Jt=!l.options.moving,Gt=0,ee=Et;Gt<ee.length;Gt+=1){var jt=ee[Gt],ie=l.depthModeForSublayer(jt.overscaledZ-_t,1===c.paint.get("raster-opacity")?bt.ReadWrite:bt.ReadOnly,P.LESS),ye=f.getTile(jt),we=l.transform.calculatePosMatrix(jt.toUnwrapped(),Jt);ye.registerFadeDuration(c.paint.get("raster-fade-duration"));var Ze=f.findLoadedParent(jt,0),Ne=ps(ye,Ze,f,c,l.transform),We=void 0,er=void 0,br="nearest"===c.paint.get("raster-resampling")?P.NEAREST:P.LINEAR;E.activeTexture.set(P.TEXTURE0),ye.texture.bind(br,P.CLAMP_TO_EDGE,P.LINEAR_MIPMAP_NEAREST),E.activeTexture.set(P.TEXTURE1),Ze?(Ze.texture.bind(br,P.CLAMP_TO_EDGE,P.LINEAR_MIPMAP_NEAREST),We=Math.pow(2,Ze.tileID.overscaledZ-ye.tileID.overscaledZ),er=[ye.tileID.canonical.x*We%1,ye.tileID.canonical.y*We%1]):ye.texture.bind(br,P.CLAMP_TO_EDGE,P.LINEAR_MIPMAP_NEAREST);var fr=kl(we,er||[0,0],We||1,Ne,c);T instanceof le?R.draw(E,P.TRIANGLES,ie,Ft.disabled,V,me.disabled,fr,c.id,T.boundsBuffer,l.quadTriangleIndexBuffer,T.boundsSegments):R.draw(E,P.TRIANGLES,ie,vt[jt.overscaledZ],V,me.disabled,fr,c.id,l.rasterBoundsBuffer,l.quadTriangleIndexBuffer,l.rasterBoundsSegments)}},background:function(l,f,c){var m=c.paint.get("background-color"),E=c.paint.get("background-opacity");if(0!==E){var P=l.context,T=P.gl,R=l.transform,V=R.tileSize,Q=c.paint.get("background-pattern");if(!l.isPatternMissing(Q)){var vt=!Q&&1===m.a&&1===E&&l.opaquePassEnabledForLayer()?"opaque":"translucent";if(l.renderPass===vt){var Et=Ft.disabled,_t=l.depthModeForSublayer(0,"opaque"===vt?bt.ReadWrite:bt.ReadOnly),Jt=l.colorModeForRenderPass(),Gt=l.useProgram(Q?"backgroundPattern":"background"),ee=R.coveringTiles({tileSize:V});Q&&(P.activeTexture.set(T.TEXTURE0),l.imageManager.bind(l.context));for(var jt=c.getCrossfadeParameters(),ie=0,ye=ee;ie<ye.length;ie+=1){var we=ye[ie],Ze=l.transform.calculatePosMatrix(we.toUnwrapped()),Ne=Q?be(Ze,E,l,Q,{tileID:we,tileSize:V},jt):Fs(Ze,E,m);Gt.draw(P,T.TRIANGLES,_t,Et,Jt,me.disabled,Ne,c.id,l.tileExtentBuffer,l.quadTriangleIndexBuffer,l.tileExtentSegments)}}}}},debug:function(l,f,c){for(var m=0;m<c.length;m++)So(l,f,c[m])},custom:function(l,f,c){var m=l.context,E=c.implementation;if("offscreen"===l.renderPass){var P=E.prerender;P&&(l.setCustomLayerDefaults(),m.setColorMode(l.colorModeForRenderPass()),P.call(E,m.gl,l.transform.customLayerMatrix()),m.setDirty(),l.setBaseState())}else if("translucent"===l.renderPass){l.setCustomLayerDefaults(),m.setColorMode(l.colorModeForRenderPass()),m.setStencilMode(Ft.disabled);var T="3d"===E.renderingMode?new bt(l.context.gl.LEQUAL,bt.ReadWrite,l.depthRangeFor3D):l.depthModeForSublayer(0,bt.ReadOnly);m.setDepthMode(T),E.render(m.gl,l.transform.customLayerMatrix()),m.setDirty(),l.setBaseState(),m.bindFramebuffer.set(null)}}},oi=function(l,f){this.context=new ue(l),this.transform=f,this._tileTextures={},this.setup(),this.numSublayers=Dt.maxUnderzooming+Dt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new zr,this.gpuTimers={}};oi.prototype.resize=function(l,f){if(this.width=l*s.browser.devicePixelRatio,this.height=f*s.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var c=0,m=this.style._order;c<m.length;c+=1)this.style._layers[m[c]].resize()},oi.prototype.setup=function(){var l=this.context,f=new s.StructArrayLayout2i4;f.emplaceBack(0,0),f.emplaceBack(s.EXTENT,0),f.emplaceBack(0,s.EXTENT),f.emplaceBack(s.EXTENT,s.EXTENT),this.tileExtentBuffer=l.createVertexBuffer(f,Lo.members),this.tileExtentSegments=s.SegmentVector.simpleSegment(0,0,4,2);var c=new s.StructArrayLayout2i4;c.emplaceBack(0,0),c.emplaceBack(s.EXTENT,0),c.emplaceBack(0,s.EXTENT),c.emplaceBack(s.EXTENT,s.EXTENT),this.debugBuffer=l.createVertexBuffer(c,Lo.members),this.debugSegments=s.SegmentVector.simpleSegment(0,0,4,5);var m=new s.StructArrayLayout4i8;m.emplaceBack(0,0,0,0),m.emplaceBack(s.EXTENT,0,s.EXTENT,0),m.emplaceBack(0,s.EXTENT,0,s.EXTENT),m.emplaceBack(s.EXTENT,s.EXTENT,s.EXTENT,s.EXTENT),this.rasterBoundsBuffer=l.createVertexBuffer(m,te.members),this.rasterBoundsSegments=s.SegmentVector.simpleSegment(0,0,4,2);var E=new s.StructArrayLayout2i4;E.emplaceBack(0,0),E.emplaceBack(1,0),E.emplaceBack(0,1),E.emplaceBack(1,1),this.viewportBuffer=l.createVertexBuffer(E,Lo.members),this.viewportSegments=s.SegmentVector.simpleSegment(0,0,4,2);var P=new s.StructArrayLayout1ui2;P.emplaceBack(0),P.emplaceBack(1),P.emplaceBack(3),P.emplaceBack(2),P.emplaceBack(0),this.tileBorderIndexBuffer=l.createIndexBuffer(P);var T=new s.StructArrayLayout3ui6;T.emplaceBack(0,1,2),T.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=l.createIndexBuffer(T),this.emptyTexture=new s.Texture(l,{width:1,height:1,data:new Uint8Array([0,0,0,0])},l.gl.RGBA);var R=this.context.gl;this.stencilClearMode=new Ft({func:R.ALWAYS,mask:0},0,255,R.ZERO,R.ZERO,R.ZERO)},oi.prototype.clearStencil=function(){var l=this.context,f=l.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var c=s.create();s.ortho(c,0,this.width,this.height,0,0,1),s.scale(c,c,[f.drawingBufferWidth,f.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(l,f.TRIANGLES,bt.disabled,this.stencilClearMode,se.disabled,me.disabled,Ba(c),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},oi.prototype._renderTileClippingMasks=function(l,f){if(this.currentStencilSource!==l.source&&l.isTileClipped()&&f&&f.length){this.currentStencilSource=l.source;var c=this.context,m=c.gl;this.nextStencilID+f.length>256&&this.clearStencil(),c.setColorMode(se.disabled),c.setDepthMode(bt.disabled);var E=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var P=0,T=f;P<T.length;P+=1){var R=T[P],V=this._tileClippingMaskIDs[R.key]=this.nextStencilID++;E.draw(c,m.TRIANGLES,bt.disabled,new Ft({func:m.ALWAYS,mask:0},V,255,m.KEEP,m.KEEP,m.REPLACE),se.disabled,me.disabled,Ba(R.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},oi.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var l=this.nextStencilID++,f=this.context.gl;return new Ft({func:f.NOTEQUAL,mask:255},l,255,f.KEEP,f.KEEP,f.REPLACE)},oi.prototype.stencilModeForClipping=function(l){var f=this.context.gl;return new Ft({func:f.EQUAL,mask:255},this._tileClippingMaskIDs[l.key],0,f.KEEP,f.KEEP,f.REPLACE)},oi.prototype.stencilConfigForOverlap=function(l){var f,c=this.context.gl,m=l.sort(function(V,Q){return Q.overscaledZ-V.overscaledZ}),E=m[m.length-1].overscaledZ,P=m[0].overscaledZ-E+1;if(P>1){this.currentStencilSource=void 0,this.nextStencilID+P>256&&this.clearStencil();for(var T={},R=0;R<P;R++)T[R+E]=new Ft({func:c.GEQUAL,mask:255},R+this.nextStencilID,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID+=P,[T,m]}return[(f={},f[E]=Ft.disabled,f),m]},oi.prototype.colorModeForRenderPass=function(){var l=this.context.gl;return this._showOverdrawInspector?new se([l.CONSTANT_COLOR,l.ONE],new s.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?se.unblended:se.alphaBlended},oi.prototype.depthModeForSublayer=function(l,f,c){if(!this.opaquePassEnabledForLayer())return bt.disabled;var m=1-((1+this.currentLayer)*this.numSublayers+l)*this.depthEpsilon;return new bt(c||this.context.gl.LEQUAL,f,[m,m])},oi.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},oi.prototype.render=function(l,f){var c=this;this.style=l,this.options=f,this.lineAtlas=l.lineAtlas,this.imageManager=l.imageManager,this.glyphManager=l.glyphManager,this.symbolFadeChange=l.placement.symbolFadeChange(s.browser.now()),this.imageManager.beginFrame();var m=this.style._order,E=this.style.sourceCaches;for(var P in E){var T=E[P];T.used&&T.prepare(this.context)}var R,V,Q={},vt={},Et={};for(var _t in E){var Jt=E[_t];Q[_t]=Jt.getVisibleCoordinates(),vt[_t]=Q[_t].slice().reverse(),Et[_t]=Jt.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Gt=0;Gt<m.length;Gt++)if(this.style._layers[m[Gt]].is3D()){this.opaquePassCutoff=Gt;break}this.renderPass="offscreen";for(var ee=0,jt=m;ee<jt.length;ee+=1){var ie=this.style._layers[jt[ee]];if(ie.hasOffscreenPass()&&!ie.isHidden(this.transform.zoom)){var ye=vt[ie.source];("custom"===ie.type||ye.length)&&this.renderLayer(this,E[ie.source],ie,ye)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:f.showOverdrawInspector?s.Color.black:s.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=f.showOverdrawInspector,this.depthRangeFor3D=[0,1-(l._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=m.length-1;this.currentLayer>=0;this.currentLayer--){var we=this.style._layers[m[this.currentLayer]],Ze=E[we.source],Ne=Q[we.source];this._renderTileClippingMasks(we,Ne),this.renderLayer(this,Ze,we,Ne)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<m.length;this.currentLayer++){var We=this.style._layers[m[this.currentLayer]],er=E[We.source],br=("symbol"===We.type?Et:vt)[We.source];this._renderTileClippingMasks(We,Q[We.source]),this.renderLayer(this,er,We,br)}this.options.showTileBoundaries&&(s.values(this.style._layers).forEach(function(fr){fr.source&&!fr.isHidden(c.transform.zoom)&&(fr.source!==(V&&V.id)&&(V=c.style.sourceCaches[fr.source]),(!R||R.getSource().maxzoom<V.getSource().maxzoom)&&(R=V))}),R&&Ii.debug(this,R,R.getVisibleCoordinates())),this.options.showPadding&&function(fr){var Br=fr.transform.padding;sa(fr,fr.transform.height-(Br.top||0),3,Ks),sa(fr,Br.bottom||0,3,zs),Bs(fr,Br.left||0,3,As),Bs(fr,fr.transform.width-(Br.right||0),3,Bo);var hn,rn,Pi,Ur,cn=fr.transform.centerPoint;Qs(hn=fr,(rn=cn.x)-1,(Pi=fr.transform.height-cn.y)-10,2,20,Ur=$s),Qs(hn,rn-10,Pi-1,20,2,Ur)}(this),this.context.setDefault()},oi.prototype.renderLayer=function(l,f,c,m){c.isHidden(this.transform.zoom)||("background"===c.type||"custom"===c.type||m.length)&&(this.id=c.id,this.gpuTimingStart(c),Ii[c.type](l,f,c,m,this.style.placement.variableOffsets),this.gpuTimingEnd())},oi.prototype.gpuTimingStart=function(l){if(this.options.gpuTiming){var f=this.context.extTimerQuery,c=this.gpuTimers[l.id];c||(c=this.gpuTimers[l.id]={calls:0,cpuTime:0,query:f.createQueryEXT()}),c.calls++,f.beginQueryEXT(f.TIME_ELAPSED_EXT,c.query)}},oi.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var l=this.context.extTimerQuery;l.endQueryEXT(l.TIME_ELAPSED_EXT)}},oi.prototype.collectGpuTimers=function(){var l=this.gpuTimers;return this.gpuTimers={},l},oi.prototype.queryGpuTimers=function(l){var f={};for(var c in l){var m=l[c],E=this.context.extTimerQuery,P=E.getQueryObjectEXT(m.query,E.QUERY_RESULT_EXT)/1e6;E.deleteQueryEXT(m.query),f[c]=P}return f},oi.prototype.translatePosMatrix=function(l,f,c,m,E){if(!c[0]&&!c[1])return l;var P=E?"map"===m?this.transform.angle:0:"viewport"===m?-this.transform.angle:0;if(P){var T=Math.sin(P),R=Math.cos(P);c=[c[0]*R-c[1]*T,c[0]*T+c[1]*R]}var V=[E?c[0]:Fo(f,c[0],this.transform.zoom),E?c[1]:Fo(f,c[1],this.transform.zoom),0],Q=new Float32Array(16);return s.translate(Q,l,V),Q},oi.prototype.saveTileTexture=function(l){var f=this._tileTextures[l.size[0]];f?f.push(l):this._tileTextures[l.size[0]]=[l]},oi.prototype.getTileTexture=function(l){var f=this._tileTextures[l];return f&&f.length>0?f.pop():null},oi.prototype.isPatternMissing=function(l){if(!l)return!1;if(!l.from||!l.to)return!0;var f=this.imageManager.getPattern(l.from.toString()),c=this.imageManager.getPattern(l.to.toString());return!f||!c},oi.prototype.useProgram=function(l,f){this.cache=this.cache||{};var c=""+l+(f?f.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[c]||(this.cache[c]=new Ps(this.context,l,Ms[l],f,je[l],this._showOverdrawInspector)),this.cache[c]},oi.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},oi.prototype.setBaseState=function(){var l=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(l.FUNC_ADD)},oi.prototype.initDebugOverlayCanvas=function(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=s.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},oi.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Ea=function(l,f){this.points=l,this.planes=f};Ea.fromInvProjectionMatrix=function(l,f,c){var m=Math.pow(2,c),E=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(T){return s.transformMat4([],T,l)}).map(function(T){return s.scale$1([],T,1/T[3]/f*m)}),P=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(T){var R=s.sub([],E[T[0]],E[T[1]]),V=s.sub([],E[T[2]],E[T[1]]),Q=s.normalize([],s.cross([],R,V)),vt=-s.dot(Q,E[T[1]]);return Q.concat(vt)});return new Ea(E,P)};var Po=function(l,f){this.min=l,this.max=f,this.center=s.scale$2([],s.add([],this.min,this.max),.5)};Po.prototype.quadrant=function(l){for(var f=[l%2==0,l<2],c=s.clone$2(this.min),m=s.clone$2(this.max),E=0;E<f.length;E++)c[E]=f[E]?this.min[E]:this.center[E],m[E]=f[E]?this.center[E]:this.max[E];return m[2]=this.max[2],new Po(c,m)},Po.prototype.distanceX=function(l){return Math.max(Math.min(this.max[0],l[0]),this.min[0])-l[0]},Po.prototype.distanceY=function(l){return Math.max(Math.min(this.max[1],l[1]),this.min[1])-l[1]},Po.prototype.intersects=function(l){for(var f=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],c=!0,m=0;m<l.planes.length;m++){for(var E=l.planes[m],P=0,T=0;T<f.length;T++)P+=s.dot$1(E,f[T])>=0;if(0===P)return 0;P!==f.length&&(c=!1)}if(c)return 2;for(var R=0;R<3;R++){for(var V=Number.MAX_VALUE,Q=-Number.MAX_VALUE,vt=0;vt<l.points.length;vt++){var Et=l.points[vt][R]-this.min[R];V=Math.min(V,Et),Q=Math.max(Q,Et)}if(Q<0||V>this.max[R]-this.min[R])return 0}return 1};var po=function(l,f,c,m){if(void 0===l&&(l=0),void 0===f&&(f=0),void 0===c&&(c=0),void 0===m&&(m=0),isNaN(l)||l<0||isNaN(f)||f<0||isNaN(c)||c<0||isNaN(m)||m<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=l,this.bottom=f,this.left=c,this.right=m};po.prototype.interpolate=function(l,f,c){return null!=f.top&&null!=l.top&&(this.top=s.number(l.top,f.top,c)),null!=f.bottom&&null!=l.bottom&&(this.bottom=s.number(l.bottom,f.bottom,c)),null!=f.left&&null!=l.left&&(this.left=s.number(l.left,f.left,c)),null!=f.right&&null!=l.right&&(this.right=s.number(l.right,f.right,c)),this},po.prototype.getCenter=function(l,f){var c=s.clamp((this.left+l-this.right)/2,0,l),m=s.clamp((this.top+f-this.bottom)/2,0,f);return new s.Point(c,m)},po.prototype.equals=function(l){return this.top===l.top&&this.bottom===l.bottom&&this.left===l.left&&this.right===l.right},po.prototype.clone=function(){return new po(this.top,this.bottom,this.left,this.right)},po.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var bn=function(l,f,c,m,E){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===E||E,this._minZoom=l||0,this._maxZoom=f||22,this._minPitch=c??0,this._maxPitch=m??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new s.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new po,this._posMatrixCache={},this._alignedPosMatrixCache={}},Wn={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};bn.prototype.clone=function(){var l=new bn(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return l.tileSize=this.tileSize,l.latRange=this.latRange,l.width=this.width,l.height=this.height,l._center=this._center,l.zoom=this.zoom,l.angle=this.angle,l._fov=this._fov,l._pitch=this._pitch,l._unmodified=this._unmodified,l._edgeInsets=this._edgeInsets.clone(),l._calcMatrices(),l},Wn.minZoom.get=function(){return this._minZoom},Wn.minZoom.set=function(l){this._minZoom!==l&&(this._minZoom=l,this.zoom=Math.max(this.zoom,l))},Wn.maxZoom.get=function(){return this._maxZoom},Wn.maxZoom.set=function(l){this._maxZoom!==l&&(this._maxZoom=l,this.zoom=Math.min(this.zoom,l))},Wn.minPitch.get=function(){return this._minPitch},Wn.minPitch.set=function(l){this._minPitch!==l&&(this._minPitch=l,this.pitch=Math.max(this.pitch,l))},Wn.maxPitch.get=function(){return this._maxPitch},Wn.maxPitch.set=function(l){this._maxPitch!==l&&(this._maxPitch=l,this.pitch=Math.min(this.pitch,l))},Wn.renderWorldCopies.get=function(){return this._renderWorldCopies},Wn.renderWorldCopies.set=function(l){void 0===l?l=!0:null===l&&(l=!1),this._renderWorldCopies=l},Wn.worldSize.get=function(){return this.tileSize*this.scale},Wn.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Wn.size.get=function(){return new s.Point(this.width,this.height)},Wn.bearing.get=function(){return-this.angle/Math.PI*180},Wn.bearing.set=function(l){var f=-s.wrap(l,-180,180)*Math.PI/180;this.angle!==f&&(this._unmodified=!1,this.angle=f,this._calcMatrices(),this.rotationMatrix=s.create$2(),s.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Wn.pitch.get=function(){return this._pitch/Math.PI*180},Wn.pitch.set=function(l){var f=s.clamp(l,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==f&&(this._unmodified=!1,this._pitch=f,this._calcMatrices())},Wn.fov.get=function(){return this._fov/Math.PI*180},Wn.fov.set=function(l){l=Math.max(.01,Math.min(60,l)),this._fov!==l&&(this._unmodified=!1,this._fov=l/180*Math.PI,this._calcMatrices())},Wn.zoom.get=function(){return this._zoom},Wn.zoom.set=function(l){var f=Math.min(Math.max(l,this.minZoom),this.maxZoom);this._zoom!==f&&(this._unmodified=!1,this._zoom=f,this.scale=this.zoomScale(f),this.tileZoom=Math.floor(f),this.zoomFraction=f-this.tileZoom,this._constrain(),this._calcMatrices())},Wn.center.get=function(){return this._center},Wn.center.set=function(l){l.lat===this._center.lat&&l.lng===this._center.lng||(this._unmodified=!1,this._center=l,this._constrain(),this._calcMatrices())},Wn.padding.get=function(){return this._edgeInsets.toJSON()},Wn.padding.set=function(l){this._edgeInsets.equals(l)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,l,1),this._calcMatrices())},Wn.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},bn.prototype.isPaddingEqual=function(l){return this._edgeInsets.equals(l)},bn.prototype.interpolatePadding=function(l,f,c){this._unmodified=!1,this._edgeInsets.interpolate(l,f,c),this._constrain(),this._calcMatrices()},bn.prototype.coveringZoomLevel=function(l){var f=(l.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/l.tileSize));return Math.max(0,f)},bn.prototype.getVisibleUnwrappedCoordinates=function(l){var f=[new s.UnwrappedTileID(0,l)];if(this._renderWorldCopies)for(var c=this.pointCoordinate(new s.Point(0,0)),m=this.pointCoordinate(new s.Point(this.width,0)),E=this.pointCoordinate(new s.Point(this.width,this.height)),P=this.pointCoordinate(new s.Point(0,this.height)),T=Math.floor(Math.min(c.x,m.x,E.x,P.x)),R=Math.floor(Math.max(c.x,m.x,E.x,P.x)),V=T-1;V<=R+1;V++)0!==V&&f.push(new s.UnwrappedTileID(V,l));return f},bn.prototype.coveringTiles=function(l){var f=this.coveringZoomLevel(l),c=f;if(void 0!==l.minzoom&&f<l.minzoom)return[];void 0!==l.maxzoom&&f>l.maxzoom&&(f=l.maxzoom);var m=s.MercatorCoordinate.fromLngLat(this.center),E=Math.pow(2,f),P=[E*m.x,E*m.y,0],T=Ea.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,f),R=l.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(R=f);var V=function(fr){return{aabb:new Po([fr*E,0,0],[(fr+1)*E,E,0]),zoom:0,x:0,y:0,wrap:fr,fullyVisible:!1}},Q=[],vt=[],Et=f,_t=l.reparseOverscaled?c:f;if(this._renderWorldCopies)for(var Jt=1;Jt<=3;Jt++)Q.push(V(-Jt)),Q.push(V(Jt));for(Q.push(V(0));Q.length>0;){var Gt=Q.pop(),ee=Gt.x,jt=Gt.y,ie=Gt.fullyVisible;if(!ie){var ye=Gt.aabb.intersects(T);if(0===ye)continue;ie=2===ye}var we=Gt.aabb.distanceX(P),Ze=Gt.aabb.distanceY(P),Ne=Math.max(Math.abs(we),Math.abs(Ze));if(Gt.zoom===Et||Ne>3+(1<<Et-Gt.zoom)-2&&Gt.zoom>=R)vt.push({tileID:new s.OverscaledTileID(Gt.zoom===Et?_t:Gt.zoom,Gt.wrap,Gt.zoom,ee,jt),distanceSq:s.sqrLen([P[0]-.5-ee,P[1]-.5-jt])});else for(var We=0;We<4;We++){var er=(ee<<1)+We%2,br=(jt<<1)+(We>>1);Q.push({aabb:Gt.aabb.quadrant(We),zoom:Gt.zoom+1,x:er,y:br,wrap:Gt.wrap,fullyVisible:ie})}}return vt.sort(function(fr,Br){return fr.distanceSq-Br.distanceSq}).map(function(fr){return fr.tileID})},bn.prototype.resize=function(l,f){this.width=l,this.height=f,this.pixelsToGLUnits=[2/l,-2/f],this._constrain(),this._calcMatrices()},Wn.unmodified.get=function(){return this._unmodified},bn.prototype.zoomScale=function(l){return Math.pow(2,l)},bn.prototype.scaleZoom=function(l){return Math.log(l)/Math.LN2},bn.prototype.project=function(l){var f=s.clamp(l.lat,-this.maxValidLatitude,this.maxValidLatitude);return new s.Point(s.mercatorXfromLng(l.lng)*this.worldSize,s.mercatorYfromLat(f)*this.worldSize)},bn.prototype.unproject=function(l){return new s.MercatorCoordinate(l.x/this.worldSize,l.y/this.worldSize).toLngLat()},Wn.point.get=function(){return this.project(this.center)},bn.prototype.setLocationAtPoint=function(l,f){var c=this.pointCoordinate(f),m=this.pointCoordinate(this.centerPoint),E=this.locationCoordinate(l),P=new s.MercatorCoordinate(E.x-(c.x-m.x),E.y-(c.y-m.y));this.center=this.coordinateLocation(P),this._renderWorldCopies&&(this.center=this.center.wrap())},bn.prototype.locationPoint=function(l){return this.coordinatePoint(this.locationCoordinate(l))},bn.prototype.pointLocation=function(l){return this.coordinateLocation(this.pointCoordinate(l))},bn.prototype.locationCoordinate=function(l){return s.MercatorCoordinate.fromLngLat(l)},bn.prototype.coordinateLocation=function(l){return l.toLngLat()},bn.prototype.pointCoordinate=function(l){var f=[l.x,l.y,0,1],c=[l.x,l.y,1,1];s.transformMat4(f,f,this.pixelMatrixInverse),s.transformMat4(c,c,this.pixelMatrixInverse);var m=f[3],E=c[3],P=f[1]/m,T=c[1]/E,R=f[2]/m,V=c[2]/E,Q=R===V?0:(0-R)/(V-R);return new s.MercatorCoordinate(s.number(f[0]/m,c[0]/E,Q)/this.worldSize,s.number(P,T,Q)/this.worldSize)},bn.prototype.coordinatePoint=function(l){var f=[l.x*this.worldSize,l.y*this.worldSize,0,1];return s.transformMat4(f,f,this.pixelMatrix),new s.Point(f[0]/f[3],f[1]/f[3])},bn.prototype.getBounds=function(){return(new s.LngLatBounds).extend(this.pointLocation(new s.Point(0,0))).extend(this.pointLocation(new s.Point(this.width,0))).extend(this.pointLocation(new s.Point(this.width,this.height))).extend(this.pointLocation(new s.Point(0,this.height)))},bn.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new s.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},bn.prototype.setMaxBounds=function(l){l?(this.lngRange=[l.getWest(),l.getEast()],this.latRange=[l.getSouth(),l.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},bn.prototype.calculatePosMatrix=function(l,f){void 0===f&&(f=!1);var c=l.key,m=f?this._alignedPosMatrixCache:this._posMatrixCache;if(m[c])return m[c];var E=l.canonical,P=this.worldSize/this.zoomScale(E.z),T=E.x+Math.pow(2,E.z)*l.wrap,R=s.identity(new Float64Array(16));return s.translate(R,R,[T*P,E.y*P,0]),s.scale(R,R,[P/s.EXTENT,P/s.EXTENT,1]),s.multiply(R,f?this.alignedProjMatrix:this.projMatrix,R),m[c]=new Float32Array(R),m[c]},bn.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},bn.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var l,f,c,m,E=-90,P=90,T=-180,R=180,V=this.size,Q=this._unmodified;if(this.latRange){var vt=this.latRange;E=s.mercatorYfromLat(vt[1])*this.worldSize,l=(P=s.mercatorYfromLat(vt[0])*this.worldSize)-E<V.y?V.y/(P-E):0}if(this.lngRange){var Et=this.lngRange;T=s.mercatorXfromLng(Et[0])*this.worldSize,f=(R=s.mercatorXfromLng(Et[1])*this.worldSize)-T<V.x?V.x/(R-T):0}var _t=this.point,Jt=Math.max(f||0,l||0);if(Jt)return this.center=this.unproject(new s.Point(f?(R+T)/2:_t.x,l?(P+E)/2:_t.y)),this.zoom+=this.scaleZoom(Jt),this._unmodified=Q,void(this._constraining=!1);if(this.latRange){var Gt=_t.y,ee=V.y/2;Gt-ee<E&&(m=E+ee),Gt+ee>P&&(m=P-ee)}if(this.lngRange){var jt=_t.x,ie=V.x/2;jt-ie<T&&(c=T+ie),jt+ie>R&&(c=R-ie)}void 0===c&&void 0===m||(this.center=this.unproject(new s.Point(void 0!==c?c:_t.x,void 0!==m?m:_t.y))),this._unmodified=Q,this._constraining=!1}},bn.prototype._calcMatrices=function(){if(this.height){var l=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var f=Math.PI/2+this._pitch,c=this._fov*(.5+l.y/this.height),m=Math.sin(c)*this.cameraToCenterDistance/Math.sin(s.clamp(Math.PI-f-c,.01,Math.PI-.01)),E=this.point,P=E.x,T=E.y,R=1.01*(Math.cos(Math.PI/2-this._pitch)*m+this.cameraToCenterDistance),V=this.height/50,Q=new Float64Array(16);s.perspective(Q,this._fov,this.width/this.height,V,R),Q[8]=2*-l.x/this.width,Q[9]=2*l.y/this.height,s.scale(Q,Q,[1,-1,1]),s.translate(Q,Q,[0,0,-this.cameraToCenterDistance]),s.rotateX(Q,Q,this._pitch),s.rotateZ(Q,Q,this.angle),s.translate(Q,Q,[-P,-T,0]),this.mercatorMatrix=s.scale([],Q,[this.worldSize,this.worldSize,this.worldSize]),s.scale(Q,Q,[1,1,s.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=Q,this.invProjMatrix=s.invert([],this.projMatrix);var vt=this.width%2/2,Et=this.height%2/2,_t=Math.cos(this.angle),Jt=Math.sin(this.angle),Gt=P-Math.round(P)+_t*vt+Jt*Et,ee=T-Math.round(T)+_t*Et+Jt*vt,jt=new Float64Array(Q);if(s.translate(jt,jt,[Gt>.5?Gt-1:Gt,ee>.5?ee-1:ee,0]),this.alignedProjMatrix=jt,Q=s.create(),s.scale(Q,Q,[this.width/2,-this.height/2,1]),s.translate(Q,Q,[1,-1,0]),this.labelPlaneMatrix=Q,Q=s.create(),s.scale(Q,Q,[1,-1,1]),s.translate(Q,Q,[-1,-1,0]),s.scale(Q,Q,[2/this.width,2/this.height,1]),this.glCoordMatrix=Q,this.pixelMatrix=s.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(Q=s.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=Q,this._posMatrixCache={},this._alignedPosMatrixCache={}}},bn.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var l=this.pointCoordinate(new s.Point(0,0)),f=[l.x*this.worldSize,l.y*this.worldSize,0,1];return s.transformMat4(f,f,this.pixelMatrix)[3]/this.cameraToCenterDistance},bn.prototype.getCameraPoint=function(){var l=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.Point(0,l))},bn.prototype.getCameraQueryGeometry=function(l){var f=this.getCameraPoint();if(1===l.length)return[l[0],f];for(var c=f.x,m=f.y,E=f.x,P=f.y,T=0,R=l;T<R.length;T+=1){var V=R[T];c=Math.min(c,V.x),m=Math.min(m,V.y),E=Math.max(E,V.x),P=Math.max(P,V.y)}return[new s.Point(c,m),new s.Point(E,m),new s.Point(E,P),new s.Point(c,P),new s.Point(c,m)]},Object.defineProperties(bn.prototype,Wn);var Va=function(l){var f,c,m,E;this._hashName=l&&encodeURIComponent(l),s.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(f=this._updateHashUnthrottled.bind(this),c=!1,m=null,E=function(){m=null,c&&(f(),m=setTimeout(E,300),c=!1)},function(){return c=!0,m||E(),m})};Va.prototype.addTo=function(l){return this._map=l,s.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Va.prototype.remove=function(){return s.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Va.prototype.getHashString=function(l){var f=this._map.getCenter(),c=Math.round(100*this._map.getZoom())/100,m=Math.ceil((c*Math.LN2+Math.log(512/360/.5))/Math.LN10),E=Math.pow(10,m),P=Math.round(f.lng*E)/E,T=Math.round(f.lat*E)/E,R=this._map.getBearing(),V=this._map.getPitch(),Q="";if(Q+=l?"/"+P+"/"+T+"/"+c:c+"/"+T+"/"+P,(R||V)&&(Q+="/"+Math.round(10*R)/10),V&&(Q+="/"+Math.round(V)),this._hashName){var vt=this._hashName,Et=!1,_t=s.window.location.hash.slice(1).split("&").map(function(Jt){var Gt=Jt.split("=")[0];return Gt===vt?(Et=!0,Gt+"="+Q):Jt}).filter(function(Jt){return Jt});return Et||_t.push(vt+"="+Q),"#"+_t.join("&")}return"#"+Q},Va.prototype._getCurrentHash=function(){var l,f=this,c=s.window.location.hash.replace("#","");return this._hashName?(c.split("&").map(function(m){return m.split("=")}).forEach(function(m){m[0]===f._hashName&&(l=m)}),(l&&l[1]||"").split("/")):c.split("/")},Va.prototype._onHashChange=function(){var l=this._getCurrentHash();if(l.length>=3&&!l.some(function(c){return isNaN(c)})){var f=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(l[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+l[2],+l[1]],zoom:+l[0],bearing:f,pitch:+(l[4]||0)}),!0}return!1},Va.prototype._updateHashUnthrottled=function(){var l=s.window.location.href.replace(/(#.+)?$/,this.getHashString());try{s.window.history.replaceState(s.window.history.state,null,l)}catch{}};var ja={linearity:.3,easing:s.bezier(0,0,.3,1)},Zo=s.extend({deceleration:2500,maxSpeed:1400},ja),fo=s.extend({deceleration:20,maxSpeed:1400},ja),ts=s.extend({deceleration:1e3,maxSpeed:360},ja),es=s.extend({deceleration:1e3,maxSpeed:90},ja),qu=function(l){this._map=l,this.clear()};function tu(l,f){(!l.duration||l.duration<f.duration)&&(l.duration=f.duration,l.easing=f.easing)}function ws(l,f,c){var m=c.maxSpeed,E=c.linearity,P=c.deceleration,T=s.clamp(l*E/(f/1e3),-m,m),R=Math.abs(T)/(P*E);return{easing:c.easing,duration:1e3*R,amount:T*(R/2)}}qu.prototype.clear=function(){this._inertiaBuffer=[]},qu.prototype.record=function(l){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:s.browser.now(),settings:l})},qu.prototype._drainInertiaBuffer=function(){for(var l=this._inertiaBuffer,f=s.browser.now();l.length>0&&f-l[0].time>160;)l.shift()},qu.prototype._onMoveEnd=function(l){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var f={zoom:0,bearing:0,pitch:0,pan:new s.Point(0,0),pinchAround:void 0,around:void 0},c=0,m=this._inertiaBuffer;c<m.length;c+=1){var E=m[c].settings;f.zoom+=E.zoomDelta||0,f.bearing+=E.bearingDelta||0,f.pitch+=E.pitchDelta||0,E.panDelta&&f.pan._add(E.panDelta),E.around&&(f.around=E.around),E.pinchAround&&(f.pinchAround=E.pinchAround)}var P=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,T={};if(f.pan.mag()){var R=ws(f.pan.mag(),P,s.extend({},Zo,l||{}));T.offset=f.pan.mult(R.amount/f.pan.mag()),T.center=this._map.transform.center,tu(T,R)}if(f.zoom){var V=ws(f.zoom,P,fo);T.zoom=this._map.transform.zoom+V.amount,tu(T,V)}if(f.bearing){var Q=ws(f.bearing,P,ts);T.bearing=this._map.transform.bearing+s.clamp(Q.amount,-179,179),tu(T,Q)}if(f.pitch){var vt=ws(f.pitch,P,es);T.pitch=this._map.transform.pitch+vt.amount,tu(T,vt)}if(T.zoom||T.bearing){var Et=void 0===f.pinchAround?f.around:f.pinchAround;T.around=Et?this._map.unproject(Et):this._map.getCenter()}return this.clear(),s.extend(T,{noMoveStart:!0})}};var ao=function(l){function f(m,E,P,T){void 0===T&&(T={});var R=ht.mousePos(E.getCanvasContainer(),P),V=E.unproject(R);l.call(this,m,s.extend({point:R,lngLat:V,originalEvent:P},T)),this._defaultPrevented=!1,this.target=E}l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f;var c={defaultPrevented:{configurable:!0}};return f.prototype.preventDefault=function(){this._defaultPrevented=!0},c.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(f.prototype,c),f}(s.Event),rs=function(l){function f(m,E,P){var T="touchend"===m?P.changedTouches:P.touches,R=ht.touchPos(E.getCanvasContainer(),T),V=R.map(function(Et){return E.unproject(Et)}),Q=R.reduce(function(Et,_t,Jt,Gt){return Et.add(_t.div(Gt.length))},new s.Point(0,0)),vt=E.unproject(Q);l.call(this,m,{points:R,point:Q,lngLats:V,lngLat:vt,originalEvent:P}),this._defaultPrevented=!1}l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f;var c={defaultPrevented:{configurable:!0}};return f.prototype.preventDefault=function(){this._defaultPrevented=!0},c.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(f.prototype,c),f}(s.Event),ra=function(l){function f(m,E,P){l.call(this,m,{originalEvent:P}),this._defaultPrevented=!1}l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f;var c={defaultPrevented:{configurable:!0}};return f.prototype.preventDefault=function(){this._defaultPrevented=!0},c.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(f.prototype,c),f}(s.Event),Za=function(l,f){this._map=l,this._clickTolerance=f.clickTolerance};Za.prototype.reset=function(){delete this._mousedownPos},Za.prototype.wheel=function(l){return this._firePreventable(new ra(l.type,this._map,l))},Za.prototype.mousedown=function(l,f){return this._mousedownPos=f,this._firePreventable(new ao(l.type,this._map,l))},Za.prototype.mouseup=function(l){this._map.fire(new ao(l.type,this._map,l))},Za.prototype.click=function(l,f){this._mousedownPos&&this._mousedownPos.dist(f)>=this._clickTolerance||this._map.fire(new ao(l.type,this._map,l))},Za.prototype.dblclick=function(l){return this._firePreventable(new ao(l.type,this._map,l))},Za.prototype.mouseover=function(l){this._map.fire(new ao(l.type,this._map,l))},Za.prototype.mouseout=function(l){this._map.fire(new ao(l.type,this._map,l))},Za.prototype.touchstart=function(l){return this._firePreventable(new rs(l.type,this._map,l))},Za.prototype.touchmove=function(l){this._map.fire(new rs(l.type,this._map,l))},Za.prototype.touchend=function(l){this._map.fire(new rs(l.type,this._map,l))},Za.prototype.touchcancel=function(l){this._map.fire(new rs(l.type,this._map,l))},Za.prototype._firePreventable=function(l){if(this._map.fire(l),l.defaultPrevented)return{}},Za.prototype.isEnabled=function(){return!0},Za.prototype.isActive=function(){return!1},Za.prototype.enable=function(){},Za.prototype.disable=function(){};var Ko=function(l){this._map=l};Ko.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Ko.prototype.mousemove=function(l){this._map.fire(new ao(l.type,this._map,l))},Ko.prototype.mousedown=function(){this._delayContextMenu=!0},Ko.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ao("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Ko.prototype.contextmenu=function(l){this._delayContextMenu?this._contextMenuEvent=l:this._map.fire(new ao(l.type,this._map,l)),this._map.listens("contextmenu")&&l.preventDefault()},Ko.prototype.isEnabled=function(){return!0},Ko.prototype.isActive=function(){return!1},Ko.prototype.enable=function(){},Ko.prototype.disable=function(){};var xr=function(l,f){this._map=l,this._el=l.getCanvasContainer(),this._container=l.getContainer(),this._clickTolerance=f.clickTolerance||1};function Ls(l,f){for(var c={},m=0;m<l.length;m++)c[l[m].identifier]=f[m];return c}xr.prototype.isEnabled=function(){return!!this._enabled},xr.prototype.isActive=function(){return!!this._active},xr.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},xr.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},xr.prototype.mousedown=function(l,f){this.isEnabled()&&l.shiftKey&&0===l.button&&(ht.disableDrag(),this._startPos=this._lastPos=f,this._active=!0)},xr.prototype.mousemoveWindow=function(l,f){if(this._active){var c=f;if(!(this._lastPos.equals(c)||!this._box&&c.dist(this._startPos)<this._clickTolerance)){var m=this._startPos;this._lastPos=c,this._box||(this._box=ht.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",l));var E=Math.min(m.x,c.x),P=Math.max(m.x,c.x),T=Math.min(m.y,c.y),R=Math.max(m.y,c.y);ht.setTransform(this._box,"translate("+E+"px,"+T+"px)"),this._box.style.width=P-E+"px",this._box.style.height=R-T+"px"}}},xr.prototype.mouseupWindow=function(l,f){var c=this;if(this._active&&0===l.button){var m=this._startPos,E=f;if(this.reset(),ht.suppressClick(),m.x!==E.x||m.y!==E.y)return this._map.fire(new s.Event("boxzoomend",{originalEvent:l})),{cameraAnimation:function(P){return P.fitScreenCoordinates(m,E,c._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",l)}},xr.prototype.keydown=function(l){this._active&&27===l.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",l))},xr.prototype.reset=function(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(ht.remove(this._box),this._box=null),ht.enableDrag(),delete this._startPos,delete this._lastPos},xr.prototype._fireEvent=function(l,f){return this._map.fire(new s.Event(l,{originalEvent:f}))};var bu=function(l){this.reset(),this.numTouches=l.numTouches};bu.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},bu.prototype.touchstart=function(l,f,c){(this.centroid||c.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=l.timeStamp),c.length===this.numTouches&&(this.centroid=function(m){for(var E=new s.Point(0,0),P=0,T=m;P<T.length;P+=1)E._add(T[P]);return E.div(m.length)}(f),this.touches=Ls(c,f)))},bu.prototype.touchmove=function(l,f,c){if(!this.aborted&&this.centroid){var m=Ls(c,f);for(var E in this.touches){var P=m[E];(!P||P.dist(this.touches[E])>30)&&(this.aborted=!0)}}},bu.prototype.touchend=function(l,f,c){if((!this.centroid||l.timeStamp-this.startTime>500)&&(this.aborted=!0),0===c.length){var m=!this.aborted&&this.centroid;if(this.reset(),m)return m}};var lu=function(l){this.singleTap=new bu(l),this.numTaps=l.numTaps,this.reset()};lu.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},lu.prototype.touchstart=function(l,f,c){this.singleTap.touchstart(l,f,c)},lu.prototype.touchmove=function(l,f,c){this.singleTap.touchmove(l,f,c)},lu.prototype.touchend=function(l,f,c){var m=this.singleTap.touchend(l,f,c);if(m){var E=l.timeStamp-this.lastTime<500,P=!this.lastTap||this.lastTap.dist(m)<30;if(E&&P||this.reset(),this.count++,this.lastTime=l.timeStamp,this.lastTap=m,this.count===this.numTaps)return this.reset(),m}};var ua=function(){this._zoomIn=new lu({numTouches:1,numTaps:2}),this._zoomOut=new lu({numTouches:2,numTaps:1}),this.reset()};ua.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},ua.prototype.touchstart=function(l,f,c){this._zoomIn.touchstart(l,f,c),this._zoomOut.touchstart(l,f,c)},ua.prototype.touchmove=function(l,f,c){this._zoomIn.touchmove(l,f,c),this._zoomOut.touchmove(l,f,c)},ua.prototype.touchend=function(l,f,c){var m=this,E=this._zoomIn.touchend(l,f,c),P=this._zoomOut.touchend(l,f,c);return E?(this._active=!0,l.preventDefault(),setTimeout(function(){return m.reset()},0),{cameraAnimation:function(T){return T.easeTo({duration:300,zoom:T.getZoom()+1,around:T.unproject(E)},{originalEvent:l})}}):P?(this._active=!0,l.preventDefault(),setTimeout(function(){return m.reset()},0),{cameraAnimation:function(T){return T.easeTo({duration:300,zoom:T.getZoom()-1,around:T.unproject(P)},{originalEvent:l})}}):void 0},ua.prototype.touchcancel=function(){this.reset()},ua.prototype.enable=function(){this._enabled=!0},ua.prototype.disable=function(){this._enabled=!1,this.reset()},ua.prototype.isEnabled=function(){return this._enabled},ua.prototype.isActive=function(){return this._active};var Tu={0:1,2:2},Co=function(l){this.reset(),this._clickTolerance=l.clickTolerance||1};Co.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Co.prototype._correctButton=function(l,f){return!1},Co.prototype._move=function(l,f){return{}},Co.prototype.mousedown=function(l,f){if(!this._lastPoint){var c=ht.mouseButton(l);this._correctButton(l,c)&&(this._lastPoint=f,this._eventButton=c)}},Co.prototype.mousemoveWindow=function(l,f){var m,P,c=this._lastPoint;if(c)if(l.preventDefault(),P=Tu[this._eventButton],void 0===(m=l).buttons||(m.buttons&P)!==P)this.reset();else if(this._moved||!(f.dist(c)<this._clickTolerance))return this._moved=!0,this._lastPoint=f,this._move(c,f)},Co.prototype.mouseupWindow=function(l){this._lastPoint&&ht.mouseButton(l)===this._eventButton&&(this._moved&&ht.suppressClick(),this.reset())},Co.prototype.enable=function(){this._enabled=!0},Co.prototype.disable=function(){this._enabled=!1,this.reset()},Co.prototype.isEnabled=function(){return this._enabled},Co.prototype.isActive=function(){return this._active};var Cr=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.mousedown=function(c,m){l.prototype.mousedown.call(this,c,m),this._lastPoint&&(this._active=!0)},f.prototype._correctButton=function(c,m){return 0===m&&!c.ctrlKey},f.prototype._move=function(c,m){return{around:m,panDelta:m.sub(c)}},f}(Co),Xo=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype._correctButton=function(c,m){return 0===m&&c.ctrlKey||2===m},f.prototype._move=function(c,m){var E=.8*(m.x-c.x);if(E)return this._active=!0,{bearingDelta:E}},f.prototype.contextmenu=function(c){c.preventDefault()},f}(Co),Zl=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype._correctButton=function(c,m){return 0===m&&c.ctrlKey||2===m},f.prototype._move=function(c,m){var E=-.5*(m.y-c.y);if(E)return this._active=!0,{pitchDelta:E}},f.prototype.contextmenu=function(c){c.preventDefault()},f}(Co),wu=function(l){this._minTouches=1,this._clickTolerance=l.clickTolerance||1,this.reset()};wu.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new s.Point(0,0)},wu.prototype.touchstart=function(l,f,c){return this._calculateTransform(l,f,c)},wu.prototype.touchmove=function(l,f,c){if(this._active&&!(c.length<this._minTouches))return l.preventDefault(),this._calculateTransform(l,f,c)},wu.prototype.touchend=function(l,f,c){this._calculateTransform(l,f,c),this._active&&c.length<this._minTouches&&this.reset()},wu.prototype.touchcancel=function(){this.reset()},wu.prototype._calculateTransform=function(l,f,c){c.length>0&&(this._active=!0);var m=Ls(c,f),E=new s.Point(0,0),P=new s.Point(0,0),T=0;for(var R in m){var V=m[R],Q=this._touches[R];Q&&(E._add(V),P._add(V.sub(Q)),T++,m[R]=V)}if(this._touches=m,!(T<this._minTouches)&&P.mag()){var vt=P.div(T);if(this._sum._add(vt),!(this._sum.mag()<this._clickTolerance))return{around:E.div(T),panDelta:vt}}},wu.prototype.enable=function(){this._enabled=!0},wu.prototype.disable=function(){this._enabled=!1,this.reset()},wu.prototype.isEnabled=function(){return this._enabled},wu.prototype.isActive=function(){return this._active};var go=function(){this.reset()};function Au(l,f,c){for(var m=0;m<l.length;m++)if(l[m].identifier===c)return f[m]}function ac(l,f){return Math.log(l/f)/Math.LN2}go.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},go.prototype._start=function(l){},go.prototype._move=function(l,f,c){return{}},go.prototype.touchstart=function(l,f,c){this._firstTwoTouches||c.length<2||(this._firstTwoTouches=[c[0].identifier,c[1].identifier],this._start([f[0],f[1]]))},go.prototype.touchmove=function(l,f,c){if(this._firstTwoTouches){l.preventDefault();var m=this._firstTwoTouches,E=m[1],P=Au(c,f,m[0]),T=Au(c,f,E);if(P&&T){var R=this._aroundCenter?null:P.add(T).div(2);return this._move([P,T],R,l)}}},go.prototype.touchend=function(l,f,c){if(this._firstTwoTouches){var m=this._firstTwoTouches,E=m[1],P=Au(c,f,m[0]),T=Au(c,f,E);P&&T||(this._active&&ht.suppressClick(),this.reset())}},go.prototype.touchcancel=function(){this.reset()},go.prototype.enable=function(l){this._enabled=!0,this._aroundCenter=!!l&&"center"===l.around},go.prototype.disable=function(){this._enabled=!1,this.reset()},go.prototype.isEnabled=function(){return this._enabled},go.prototype.isActive=function(){return this._active};var rl=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.reset=function(){l.prototype.reset.call(this),delete this._distance,delete this._startDistance},f.prototype._start=function(c){this._startDistance=this._distance=c[0].dist(c[1])},f.prototype._move=function(c,m){var E=this._distance;if(this._distance=c[0].dist(c[1]),this._active||!(Math.abs(ac(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ac(this._distance,E),pinchAround:m}},f}(go);function Sa(l,f){return 180*l.angleWith(f)/Math.PI}var Uo=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.reset=function(){l.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},f.prototype._start=function(c){this._startVector=this._vector=c[0].sub(c[1]),this._minDiameter=c[0].dist(c[1])},f.prototype._move=function(c,m){var E=this._vector;if(this._vector=c[0].sub(c[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Sa(this._vector,E),pinchAround:m}},f.prototype._isBelowThreshold=function(c){this._minDiameter=Math.min(this._minDiameter,c.mag());var m=25/(Math.PI*this._minDiameter)*360,E=Sa(c,this._startVector);return Math.abs(E)<m},f}(go);function Xa(l){return Math.abs(l.y)>Math.abs(l.x)}var bl=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.reset=function(){l.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},f.prototype._start=function(c){this._lastPoints=c,Xa(c[0].sub(c[1]))&&(this._valid=!1)},f.prototype._move=function(c,m,E){var P=c[0].sub(this._lastPoints[0]),T=c[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(P,T,E.timeStamp),this._valid)return this._lastPoints=c,this._active=!0,{pitchDelta:(P.y+T.y)/2*-.5}},f.prototype.gestureBeginsVertically=function(c,m,E){if(void 0!==this._valid)return this._valid;var P=c.mag()>=2,T=m.mag()>=2;if(P||T){if(!P||!T)return void 0===this._firstMove&&(this._firstMove=E),E-this._firstMove<100&&void 0;var R=c.y>0==m.y>0;return Xa(c)&&Xa(m)&&R}},f}(go),fs={panStep:100,bearingStep:15,pitchStep:10},eu=function(){var l=fs;this._panStep=l.panStep,this._bearingStep=l.bearingStep,this._pitchStep=l.pitchStep,this._rotationDisabled=!1};function fl(l){return l*(2-l)}eu.prototype.reset=function(){this._active=!1},eu.prototype.keydown=function(l){var f=this;if(!(l.altKey||l.ctrlKey||l.metaKey)){var c=0,m=0,E=0,P=0,T=0;switch(l.keyCode){case 61:case 107:case 171:case 187:c=1;break;case 189:case 109:case 173:c=-1;break;case 37:l.shiftKey?m=-1:(l.preventDefault(),P=-1);break;case 39:l.shiftKey?m=1:(l.preventDefault(),P=1);break;case 38:l.shiftKey?E=1:(l.preventDefault(),T=-1);break;case 40:l.shiftKey?E=-1:(l.preventDefault(),T=1);break;default:return}return this._rotationDisabled&&(m=0,E=0),{cameraAnimation:function(R){var V=R.getZoom();R.easeTo({duration:300,easeId:"keyboardHandler",easing:fl,zoom:c?Math.round(V)+c*(l.shiftKey?2:1):V,bearing:R.getBearing()+m*f._bearingStep,pitch:R.getPitch()+E*f._pitchStep,offset:[-P*f._panStep,-T*f._panStep],center:R.getCenter()},{originalEvent:l})}}}},eu.prototype.enable=function(){this._enabled=!0},eu.prototype.disable=function(){this._enabled=!1,this.reset()},eu.prototype.isEnabled=function(){return this._enabled},eu.prototype.isActive=function(){return this._active},eu.prototype.disableRotation=function(){this._rotationDisabled=!0},eu.prototype.enableRotation=function(){this._rotationDisabled=!1};var ai=function(l,f){this._map=l,this._el=l.getCanvasContainer(),this._handler=f,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,s.bindAll(["_onTimeout"],this)};ai.prototype.setZoomRate=function(l){this._defaultZoomRate=l},ai.prototype.setWheelZoomRate=function(l){this._wheelZoomRate=l},ai.prototype.isEnabled=function(){return!!this._enabled},ai.prototype.isActive=function(){return!!this._active||void 0!==this._finishTimeout},ai.prototype.isZooming=function(){return!!this._zooming},ai.prototype.enable=function(l){this.isEnabled()||(this._enabled=!0,this._aroundCenter=l&&"center"===l.around)},ai.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},ai.prototype.wheel=function(l){if(this.isEnabled()){var f=l.deltaMode===s.window.WheelEvent.DOM_DELTA_LINE?40*l.deltaY:l.deltaY,c=s.browser.now(),m=c-(this._lastWheelEventTime||0);this._lastWheelEventTime=c,0!==f&&f%4.000244140625==0?this._type="wheel":0!==f&&Math.abs(f)<4?this._type="trackpad":m>400?(this._type=null,this._lastValue=f,this._timeout=setTimeout(this._onTimeout,40,l)):this._type||(this._type=Math.abs(m*f)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,f+=this._lastValue)),l.shiftKey&&f&&(f/=4),this._type&&(this._lastWheelEvent=l,this._delta-=f,this._active||this._start(l)),l.preventDefault()}},ai.prototype._onTimeout=function(l){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)},ai.prototype._start=function(l){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var f=ht.mousePos(this._el,l);this._around=s.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(f)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},ai.prototype.renderFrame=function(){var l=this;if(this._frameId&&(this._frameId=null,this.isActive())){var f=this._map.transform;if(0!==this._delta){var c="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,m=2/(1+Math.exp(-Math.abs(this._delta*c)));this._delta<0&&0!==m&&(m=1/m);var E="number"==typeof this._targetZoom?f.zoomScale(this._targetZoom):f.scale;this._targetZoom=Math.min(f.maxZoom,Math.max(f.minZoom,f.scaleZoom(E*m))),"wheel"===this._type&&(this._startZoom=f.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var P,T="number"==typeof this._targetZoom?this._targetZoom:f.zoom,R=this._startZoom,V=this._easing,Q=!1;if("wheel"===this._type&&R&&V){var vt=Math.min((s.browser.now()-this._lastWheelEventTime)/200,1),Et=V(vt);P=s.number(R,T,Et),vt<1?this._frameId||(this._frameId=!0):Q=!0}else P=T,Q=!0;return this._active=!0,Q&&(this._active=!1,this._finishTimeout=setTimeout(function(){l._zooming=!1,l._handler._triggerRenderFrame(),delete l._targetZoom,delete l._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Q,zoomDelta:P-f.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},ai.prototype._smoothOutEasing=function(l){var f=s.ease;if(this._prevEase){var c=this._prevEase,m=(s.browser.now()-c.start)/c.duration,E=c.easing(m+.01)-c.easing(m),P=.27/Math.sqrt(E*E+1e-4)*.01,T=Math.sqrt(.0729-P*P);f=s.bezier(P,T,.25,1)}return this._prevEase={start:s.browser.now(),duration:l,easing:f},f},ai.prototype.reset=function(){this._active=!1};var mo=function(l,f){this._clickZoom=l,this._tapZoom=f};mo.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},mo.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},mo.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},mo.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Ca=function(){this.reset()};Ca.prototype.reset=function(){this._active=!1},Ca.prototype.dblclick=function(l,f){return l.preventDefault(),{cameraAnimation:function(c){c.easeTo({duration:300,zoom:c.getZoom()+(l.shiftKey?-1:1),around:c.unproject(f)},{originalEvent:l})}}},Ca.prototype.enable=function(){this._enabled=!0},Ca.prototype.disable=function(){this._enabled=!1,this.reset()},Ca.prototype.isEnabled=function(){return this._enabled},Ca.prototype.isActive=function(){return this._active};var ru=function(){this._tap=new lu({numTouches:1,numTaps:1}),this.reset()};ru.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},ru.prototype.touchstart=function(l,f,c){this._swipePoint||(this._tapTime&&l.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?c.length>0&&(this._swipePoint=f[0],this._swipeTouch=c[0].identifier):this._tap.touchstart(l,f,c))},ru.prototype.touchmove=function(l,f,c){if(this._tapTime){if(this._swipePoint){if(c[0].identifier!==this._swipeTouch)return;var m=f[0],E=m.y-this._swipePoint.y;return this._swipePoint=m,l.preventDefault(),this._active=!0,{zoomDelta:E/128}}}else this._tap.touchmove(l,f,c)},ru.prototype.touchend=function(l,f,c){this._tapTime?this._swipePoint&&0===c.length&&this.reset():this._tap.touchend(l,f,c)&&(this._tapTime=l.timeStamp)},ru.prototype.touchcancel=function(){this.reset()},ru.prototype.enable=function(){this._enabled=!0},ru.prototype.disable=function(){this._enabled=!1,this.reset()},ru.prototype.isEnabled=function(){return this._enabled},ru.prototype.isActive=function(){return this._active};var Ds=function(l,f,c){this._el=l,this._mousePan=f,this._touchPan=c};Ds.prototype.enable=function(l){this._inertiaOptions=l||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")},Ds.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")},Ds.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},Ds.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var wl=function(l,f,c){this._pitchWithRotate=l.pitchWithRotate,this._mouseRotate=f,this._mousePitch=c};wl.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},wl.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},wl.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},wl.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var Ju=function(l,f,c,m){this._el=l,this._touchZoom=f,this._touchRotate=c,this._tapDragZoom=m,this._rotationDisabled=!1,this._enabled=!0};Ju.prototype.enable=function(l){this._touchZoom.enable(l),this._rotationDisabled||this._touchRotate.enable(l),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")},Ju.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")},Ju.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},Ju.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},Ju.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},Ju.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var ds=function(l){return l.zoom||l.drag||l.pitch||l.rotate},Es=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f}(s.Event);function Eu(l){return l.panDelta&&l.panDelta.mag()||l.zoomDelta||l.bearingDelta||l.pitchDelta}var Tr=function(l,f){this._map=l,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new qu(l),this._bearingSnap=f.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(f),s.bindAll(["handleEvent","handleWindowEvent"],this);var c=this._el;this._listeners=[[c,"touchstart",{passive:!0}],[c,"touchmove",{passive:!1}],[c,"touchend",void 0],[c,"touchcancel",void 0],[c,"mousedown",void 0],[c,"mousemove",void 0],[c,"mouseup",void 0],[s.window.document,"mousemove",{capture:!0}],[s.window.document,"mouseup",void 0],[c,"mouseover",void 0],[c,"mouseout",void 0],[c,"dblclick",void 0],[c,"click",void 0],[c,"keydown",{capture:!1}],[c,"keyup",void 0],[c,"wheel",{passive:!1}],[c,"contextmenu",void 0],[s.window,"blur",void 0]];for(var m=0,E=this._listeners;m<E.length;m+=1){var P=E[m],T=P[0];ht.addEventListener(T,P[1],T===s.window.document?this.handleWindowEvent:this.handleEvent,P[2])}};Tr.prototype.destroy=function(){for(var l=0,f=this._listeners;l<f.length;l+=1){var c=f[l],m=c[0];ht.removeEventListener(m,c[1],m===s.window.document?this.handleWindowEvent:this.handleEvent,c[2])}},Tr.prototype._addDefaultHandlers=function(l){var f=this._map,c=f.getCanvasContainer();this._add("mapEvent",new Za(f,l));var m=f.boxZoom=new xr(f,l);this._add("boxZoom",m);var E=new ua,P=new Ca;f.doubleClickZoom=new mo(P,E),this._add("tapZoom",E),this._add("clickZoom",P);var T=new ru;this._add("tapDragZoom",T);var R=f.touchPitch=new bl;this._add("touchPitch",R);var V=new Xo(l),Q=new Zl(l);f.dragRotate=new wl(l,V,Q),this._add("mouseRotate",V,["mousePitch"]),this._add("mousePitch",Q,["mouseRotate"]);var vt=new Cr(l),Et=new wu(l);f.dragPan=new Ds(c,vt,Et),this._add("mousePan",vt),this._add("touchPan",Et,["touchZoom","touchRotate"]);var _t=new Uo,Jt=new rl;f.touchZoomRotate=new Ju(c,Jt,_t,T),this._add("touchRotate",_t,["touchPan","touchZoom"]),this._add("touchZoom",Jt,["touchPan","touchRotate"]);var Gt=f.scrollZoom=new ai(f,this);this._add("scrollZoom",Gt,["mousePan"]);var ee=f.keyboard=new eu;this._add("keyboard",ee),this._add("blockableMapEvent",new Ko(f));for(var jt=0,ie=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];jt<ie.length;jt+=1){var ye=ie[jt];l.interactive&&l[ye]&&f[ye].enable(l[ye])}},Tr.prototype._add=function(l,f,c){this._handlers.push({handlerName:l,handler:f,allowed:c}),this._handlersById[l]=f},Tr.prototype.stop=function(l){if(!this._updatingCamera){for(var f=0,c=this._handlers;f<c.length;f+=1)c[f].handler.reset();this._inertia.clear(),this._fireEvents({},{},l),this._changes=[]}},Tr.prototype.isActive=function(){for(var l=0,f=this._handlers;l<f.length;l+=1)if(f[l].handler.isActive())return!0;return!1},Tr.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Tr.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Tr.prototype.isMoving=function(){return Boolean(ds(this._eventsInProgress))||this.isZooming()},Tr.prototype._blockedByActive=function(l,f,c){for(var m in l)if(m!==c&&(!f||f.indexOf(m)<0))return!0;return!1},Tr.prototype.handleWindowEvent=function(l){this.handleEvent(l,l.type+"Window")},Tr.prototype._getMapTouches=function(l){for(var f=[],c=0,m=l;c<m.length;c+=1){var E=m[c];this._el.contains(E.target)&&f.push(E)}return f},Tr.prototype.handleEvent=function(l,f){if("blur"!==l.type){this._updatingCamera=!0;for(var c="renderFrame"===l.type?void 0:l,m={needsRenderFrame:!1},E={},P={},T=l.touches?this._getMapTouches(l.touches):void 0,R=T?ht.touchPos(this._el,T):ht.mousePos(this._el,l),V=0,Q=this._handlers;V<Q.length;V+=1){var vt=Q[V],Et=vt.handlerName,_t=vt.handler,Jt=vt.allowed;if(_t.isEnabled()){var Gt=void 0;this._blockedByActive(P,Jt,Et)?_t.reset():_t[f||l.type]&&(Gt=_t[f||l.type](l,R,T),this.mergeHandlerResult(m,E,Gt,Et,c),Gt&&Gt.needsRenderFrame&&this._triggerRenderFrame()),(Gt||_t.isActive())&&(P[Et]=_t)}}var ee={};for(var jt in this._previousActiveHandlers)P[jt]||(ee[jt]=c);this._previousActiveHandlers=P,(Object.keys(ee).length||Eu(m))&&(this._changes.push([m,E,ee]),this._triggerRenderFrame()),(Object.keys(P).length||Eu(m))&&this._map._stop(!0),this._updatingCamera=!1;var ie=m.cameraAnimation;ie&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ie(this._map))}else this.stop(!0)},Tr.prototype.mergeHandlerResult=function(l,f,c,m,E){if(c){s.extend(l,c);var P={handlerName:m,originalEvent:c.originalEvent||E};void 0!==c.zoomDelta&&(f.zoom=P),void 0!==c.panDelta&&(f.drag=P),void 0!==c.pitchDelta&&(f.pitch=P),void 0!==c.bearingDelta&&(f.rotate=P)}},Tr.prototype._applyChanges=function(){for(var l={},f={},c={},m=0,E=this._changes;m<E.length;m+=1){var P=E[m],T=P[0],R=P[1],V=P[2];T.panDelta&&(l.panDelta=(l.panDelta||new s.Point(0,0))._add(T.panDelta)),T.zoomDelta&&(l.zoomDelta=(l.zoomDelta||0)+T.zoomDelta),T.bearingDelta&&(l.bearingDelta=(l.bearingDelta||0)+T.bearingDelta),T.pitchDelta&&(l.pitchDelta=(l.pitchDelta||0)+T.pitchDelta),void 0!==T.around&&(l.around=T.around),void 0!==T.pinchAround&&(l.pinchAround=T.pinchAround),T.noInertia&&(l.noInertia=T.noInertia),s.extend(f,R),s.extend(c,V)}this._updateMapTransform(l,f,c),this._changes=[]},Tr.prototype._updateMapTransform=function(l,f,c){var m=this._map,E=m.transform;if(!Eu(l))return this._fireEvents(f,c,!0);var P=l.panDelta,T=l.zoomDelta,R=l.bearingDelta,V=l.pitchDelta,Q=l.around,vt=l.pinchAround;void 0!==vt&&(Q=vt),m._stop(!0),Q=Q||m.transform.centerPoint;var Et=E.pointLocation(P?Q.sub(P):Q);R&&(E.bearing+=R),V&&(E.pitch+=V),T&&(E.zoom+=T),E.setLocationAtPoint(Et,Q),this._map._update(),l.noInertia||this._inertia.record(l),this._fireEvents(f,c,!0)},Tr.prototype._fireEvents=function(l,f,c){var m=this,E=ds(this._eventsInProgress),P=ds(l),T={};for(var R in l)this._eventsInProgress[R]||(T[R+"start"]=l[R].originalEvent),this._eventsInProgress[R]=l[R];for(var V in!E&&P&&this._fireEvent("movestart",P.originalEvent),T)this._fireEvent(V,T[V]);for(var Q in P&&this._fireEvent("move",P.originalEvent),l)this._fireEvent(Q,l[Q].originalEvent);var vt,Et={};for(var _t in this._eventsInProgress){var Jt=this._eventsInProgress[_t],Gt=Jt.handlerName,ee=Jt.originalEvent;this._handlersById[Gt].isActive()||(delete this._eventsInProgress[_t],Et[_t+"end"]=vt=f[Gt]||ee)}for(var jt in Et)this._fireEvent(jt,Et[jt]);var ie=ds(this._eventsInProgress);if(c&&(E||P)&&!ie){this._updatingCamera=!0;var ye=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),we=function(Ze){return 0!==Ze&&-m._bearingSnap<Ze&&Ze<m._bearingSnap};ye?(we(ye.bearing||this._map.getBearing())&&(ye.bearing=0),this._map.easeTo(ye,{originalEvent:vt})):(this._map.fire(new s.Event("moveend",{originalEvent:vt})),we(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},Tr.prototype._fireEvent=function(l,f){this._map.fire(new s.Event(l,f?{originalEvent:f}:{}))},Tr.prototype._requestFrame=function(){var l=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(f){delete l._frameId,l.handleEvent(new Es("renderFrame",{timeStamp:f})),l._applyChanges()})},Tr.prototype._triggerRenderFrame=function(){void 0===this._frameId&&(this._frameId=this._requestFrame())};var mn=function(l){function f(c,m){l.call(this),this._moving=!1,this._zooming=!1,this.transform=c,this._bearingSnap=m.bearingSnap,s.bindAll(["_renderFrameCallback"],this)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getCenter=function(){return new s.LngLat(this.transform.center.lng,this.transform.center.lat)},f.prototype.setCenter=function(c,m){return this.jumpTo({center:c},m)},f.prototype.panBy=function(c,m,E){return c=s.Point.convert(c).mult(-1),this.panTo(this.transform.center,s.extend({offset:c},m),E)},f.prototype.panTo=function(c,m,E){return this.easeTo(s.extend({center:c},m),E)},f.prototype.getZoom=function(){return this.transform.zoom},f.prototype.setZoom=function(c,m){return this.jumpTo({zoom:c},m),this},f.prototype.zoomTo=function(c,m,E){return this.easeTo(s.extend({zoom:c},m),E)},f.prototype.zoomIn=function(c,m){return this.zoomTo(this.getZoom()+1,c,m),this},f.prototype.zoomOut=function(c,m){return this.zoomTo(this.getZoom()-1,c,m),this},f.prototype.getBearing=function(){return this.transform.bearing},f.prototype.setBearing=function(c,m){return this.jumpTo({bearing:c},m),this},f.prototype.getPadding=function(){return this.transform.padding},f.prototype.setPadding=function(c,m){return this.jumpTo({padding:c},m),this},f.prototype.rotateTo=function(c,m,E){return this.easeTo(s.extend({bearing:c},m),E)},f.prototype.resetNorth=function(c,m){return this.rotateTo(0,s.extend({duration:1e3},c),m),this},f.prototype.resetNorthPitch=function(c,m){return this.easeTo(s.extend({bearing:0,pitch:0,duration:1e3},c),m),this},f.prototype.snapToNorth=function(c,m){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(c,m):this},f.prototype.getPitch=function(){return this.transform.pitch},f.prototype.setPitch=function(c,m){return this.jumpTo({pitch:c},m),this},f.prototype.cameraForBounds=function(c,m){c=s.LngLatBounds.convert(c);var E=m&&m.bearing||0;return this._cameraForBoxAndBearing(c.getNorthWest(),c.getSouthEast(),E,m)},f.prototype._cameraForBoxAndBearing=function(c,m,E,P){var T={top:0,bottom:0,right:0,left:0};if("number"==typeof(P=s.extend({padding:T,offset:[0,0],maxZoom:this.transform.maxZoom},P)).padding){var R=P.padding;P.padding={top:R,bottom:R,right:R,left:R}}P.padding=s.extend(T,P.padding);var V=this.transform,Q=V.padding,vt=V.project(s.LngLat.convert(c)),Et=V.project(s.LngLat.convert(m)),_t=vt.rotate(-E*Math.PI/180),Jt=Et.rotate(-E*Math.PI/180),Gt=new s.Point(Math.max(_t.x,Jt.x),Math.max(_t.y,Jt.y)),ee=new s.Point(Math.min(_t.x,Jt.x),Math.min(_t.y,Jt.y)),jt=Gt.sub(ee),ie=(V.width-(Q.left+Q.right+P.padding.left+P.padding.right))/jt.x,ye=(V.height-(Q.top+Q.bottom+P.padding.top+P.padding.bottom))/jt.y;if(!(ye<0||ie<0)){var we=Math.min(V.scaleZoom(V.scale*Math.min(ie,ye)),P.maxZoom),Ze="number"==typeof P.offset.x?new s.Point(P.offset.x,P.offset.y):s.Point.convert(P.offset),Ne=new s.Point((P.padding.left-P.padding.right)/2,(P.padding.top-P.padding.bottom)/2).rotate(E*Math.PI/180),We=Ze.add(Ne).mult(V.scale/V.zoomScale(we));return{center:V.unproject(vt.add(Et).div(2).sub(We)),zoom:we,bearing:E}}s.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},f.prototype.fitBounds=function(c,m,E){return this._fitInternal(this.cameraForBounds(c,m),m,E)},f.prototype.fitScreenCoordinates=function(c,m,E,P,T){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(s.Point.convert(c)),this.transform.pointLocation(s.Point.convert(m)),E,P),P,T)},f.prototype._fitInternal=function(c,m,E){return c?(delete(m=s.extend(c,m)).padding,m.linear?this.easeTo(m,E):this.flyTo(m,E)):this},f.prototype.jumpTo=function(c,m){this.stop();var E=this.transform,P=!1,T=!1,R=!1;return"zoom"in c&&E.zoom!==+c.zoom&&(P=!0,E.zoom=+c.zoom),void 0!==c.center&&(E.center=s.LngLat.convert(c.center)),"bearing"in c&&E.bearing!==+c.bearing&&(T=!0,E.bearing=+c.bearing),"pitch"in c&&E.pitch!==+c.pitch&&(R=!0,E.pitch=+c.pitch),null==c.padding||E.isPaddingEqual(c.padding)||(E.padding=c.padding),this.fire(new s.Event("movestart",m)).fire(new s.Event("move",m)),P&&this.fire(new s.Event("zoomstart",m)).fire(new s.Event("zoom",m)).fire(new s.Event("zoomend",m)),T&&this.fire(new s.Event("rotatestart",m)).fire(new s.Event("rotate",m)).fire(new s.Event("rotateend",m)),R&&this.fire(new s.Event("pitchstart",m)).fire(new s.Event("pitch",m)).fire(new s.Event("pitchend",m)),this.fire(new s.Event("moveend",m))},f.prototype.easeTo=function(c,m){var E=this;this._stop(!1,c.easeId),(!1===(c=s.extend({offset:[0,0],duration:500,easing:s.ease},c)).animate||!c.essential&&s.browser.prefersReducedMotion)&&(c.duration=0);var P=this.transform,T=this.getZoom(),R=this.getBearing(),V=this.getPitch(),Q=this.getPadding(),vt="zoom"in c?+c.zoom:T,Et="bearing"in c?this._normalizeBearing(c.bearing,R):R,_t="pitch"in c?+c.pitch:V,Jt="padding"in c?c.padding:P.padding,Gt=s.Point.convert(c.offset),ee=P.centerPoint.add(Gt),jt=P.pointLocation(ee),ie=s.LngLat.convert(c.center||jt);this._normalizeCenter(ie);var ye,we,Ze=P.project(jt),Ne=P.project(ie).sub(Ze),We=P.zoomScale(vt-T);c.around&&(ye=s.LngLat.convert(c.around),we=P.locationPoint(ye));var er={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||vt!==T,this._rotating=this._rotating||R!==Et,this._pitching=this._pitching||_t!==V,this._padding=!P.isPaddingEqual(Jt),this._easeId=c.easeId,this._prepareEase(m,c.noMoveStart,er),this._ease(function(br){if(E._zooming&&(P.zoom=s.number(T,vt,br)),E._rotating&&(P.bearing=s.number(R,Et,br)),E._pitching&&(P.pitch=s.number(V,_t,br)),E._padding&&(P.interpolatePadding(Q,Jt,br),ee=P.centerPoint.add(Gt)),ye)P.setLocationAtPoint(ye,we);else{var fr=P.zoomScale(P.zoom-T),Br=vt>T?Math.min(2,We):Math.max(.5,We),cn=Math.pow(Br,1-br),hn=P.unproject(Ze.add(Ne.mult(br*cn)).mult(fr));P.setLocationAtPoint(P.renderWorldCopies?hn.wrap():hn,ee)}E._fireMoveEvents(m)},function(br){E._afterEase(m,br)},c),this},f.prototype._prepareEase=function(c,m,E){void 0===E&&(E={}),this._moving=!0,m||E.moving||this.fire(new s.Event("movestart",c)),this._zooming&&!E.zooming&&this.fire(new s.Event("zoomstart",c)),this._rotating&&!E.rotating&&this.fire(new s.Event("rotatestart",c)),this._pitching&&!E.pitching&&this.fire(new s.Event("pitchstart",c))},f.prototype._fireMoveEvents=function(c){this.fire(new s.Event("move",c)),this._zooming&&this.fire(new s.Event("zoom",c)),this._rotating&&this.fire(new s.Event("rotate",c)),this._pitching&&this.fire(new s.Event("pitch",c))},f.prototype._afterEase=function(c,m){if(!this._easeId||!m||this._easeId!==m){delete this._easeId;var E=this._zooming,P=this._rotating,T=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,E&&this.fire(new s.Event("zoomend",c)),P&&this.fire(new s.Event("rotateend",c)),T&&this.fire(new s.Event("pitchend",c)),this.fire(new s.Event("moveend",c))}},f.prototype.flyTo=function(c,m){var E=this;if(!c.essential&&s.browser.prefersReducedMotion){var P=s.pick(c,["center","zoom","bearing","pitch","around"]);return this.jumpTo(P,m)}this.stop(),c=s.extend({offset:[0,0],speed:1.2,curve:1.42,easing:s.ease},c);var T=this.transform,R=this.getZoom(),V=this.getBearing(),Q=this.getPitch(),vt=this.getPadding(),Et="zoom"in c?s.clamp(+c.zoom,T.minZoom,T.maxZoom):R,_t="bearing"in c?this._normalizeBearing(c.bearing,V):V,Jt="pitch"in c?+c.pitch:Q,Gt="padding"in c?c.padding:T.padding,ee=T.zoomScale(Et-R),jt=s.Point.convert(c.offset),ie=T.centerPoint.add(jt),ye=T.pointLocation(ie),we=s.LngLat.convert(c.center||ye);this._normalizeCenter(we);var Ze=T.project(ye),Ne=T.project(we).sub(Ze),We=c.curve,er=Math.max(T.width,T.height),br=er/ee,fr=Ne.mag();if("minZoom"in c){var Br=s.clamp(Math.min(c.minZoom,R,Et),T.minZoom,T.maxZoom),cn=er/T.zoomScale(Br-R);We=Math.sqrt(cn/fr*2)}var hn=We*We;function rn(Ln){var gn=(br*br-er*er+(Ln?-1:1)*hn*hn*fr*fr)/(2*(Ln?br:er)*hn*fr);return Math.log(Math.sqrt(gn*gn+1)-gn)}function Pi(Ln){return(Math.exp(Ln)-Math.exp(-Ln))/2}function Ur(Ln){return(Math.exp(Ln)+Math.exp(-Ln))/2}var Zn=rn(0),si=function(Ln){return Ur(Zn)/Ur(Zn+We*Ln)},Rn=function(Ln){return er*((Ur(Zn)*(Pi(gn=Zn+We*Ln)/Ur(gn))-Pi(Zn))/hn)/fr;var gn},Fn=(rn(1)-Zn)/We;if(Math.abs(fr)<1e-6||!isFinite(Fn)){if(Math.abs(er-br)<1e-6)return this.easeTo(c,m);var Dn=br<er?-1:1;Fn=Math.abs(Math.log(br/er))/We,Rn=function(){return 0},si=function(Ln){return Math.exp(Dn*We*Ln)}}return c.duration="duration"in c?+c.duration:1e3*Fn/("screenSpeed"in c?+c.screenSpeed/We:+c.speed),c.maxDuration&&c.duration>c.maxDuration&&(c.duration=0),this._zooming=!0,this._rotating=V!==_t,this._pitching=Jt!==Q,this._padding=!T.isPaddingEqual(Gt),this._prepareEase(m,!1),this._ease(function(Ln){var gn=Ln*Fn,qo=1/si(gn);T.zoom=1===Ln?Et:R+T.scaleZoom(qo),E._rotating&&(T.bearing=s.number(V,_t,Ln)),E._pitching&&(T.pitch=s.number(Q,Jt,Ln)),E._padding&&(T.interpolatePadding(vt,Gt,Ln),ie=T.centerPoint.add(jt));var Pa=1===Ln?we:T.unproject(Ze.add(Ne.mult(Rn(gn))).mult(qo));T.setLocationAtPoint(T.renderWorldCopies?Pa.wrap():Pa,ie),E._fireMoveEvents(m)},function(){return E._afterEase(m)},c),this},f.prototype.isEasing=function(){return!!this._easeFrameId},f.prototype.stop=function(){return this._stop()},f.prototype._stop=function(c,m){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var E=this._onEaseEnd;delete this._onEaseEnd,E.call(this,m)}if(!c){var P=this.handlers;P&&P.stop(!1)}return this},f.prototype._ease=function(c,m,E){!1===E.animate||0===E.duration?(c(1),m()):(this._easeStart=s.browser.now(),this._easeOptions=E,this._onEaseFrame=c,this._onEaseEnd=m,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},f.prototype._renderFrameCallback=function(){var c=Math.min((s.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(c)),c<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},f.prototype._normalizeBearing=function(c,m){c=s.wrap(c,-180,180);var E=Math.abs(c-m);return Math.abs(c-360-m)<E&&(c-=360),Math.abs(c+360-m)<E&&(c+=360),c},f.prototype._normalizeCenter=function(c){var m=this.transform;if(m.renderWorldCopies&&!m.lngRange){var E=c.lng-m.center.lng;c.lng+=E>180?-360:E<-180?360:0}},f}(s.Evented),Ia=function(l){void 0===l&&(l={}),this.options=l,s.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};Ia.prototype.getDefaultPosition=function(){return"bottom-right"},Ia.prototype.onAdd=function(l){var f=this.options&&this.options.compact;return this._map=l,this._container=ht.create("div","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=ht.create("button","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.type="button",this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ht.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),f&&this._container.classList.add("maplibregl-compact","mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===f&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Ia.prototype.onRemove=function(){ht.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Ia.prototype._setElementTitle=function(l,f){var c=this._map._getUIString("AttributionControl."+f);l.title=c,l.setAttribute("aria-label",c)},Ia.prototype._toggleAttribution=function(){this._container.classList.contains("maplibregl-compact-show")||this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},Ia.prototype._updateEditLink=function(){var l=this._editLink;l||(l=this._editLink=this._container.querySelector(".mapbox-improve-map"));var f=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||s.config.ACCESS_TOKEN}];if(l){var c=f.reduce(function(m,E,P){return E.value&&(m+=E.key+"="+E.value+(P<f.length-1?"&":"")),m},"?");l.href=s.config.FEEDBACK_URL+"/"+c+(this._map._hash?this._map._hash.getHashString(!0):""),l.rel="noopener nofollow",this._setElementTitle(l,"MapFeedback")}},Ia.prototype._updateData=function(l){!l||"metadata"!==l.sourceDataType&&"visibility"!==l.sourceDataType&&"style"!==l.dataType||(this._updateAttributions(),this._updateEditLink())},Ia.prototype._updateAttributions=function(){if(this._map.style){var l=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?l=l.concat(this.options.customAttribution.map(function(R){return"string"!=typeof R?"":R})):"string"==typeof this.options.customAttribution&&l.push(this.options.customAttribution)),this._map.style.stylesheet){var f=this._map.style.stylesheet;this.styleOwner=f.owner,this.styleId=f.id}var c=this._map.style.sourceCaches;for(var m in c){var E=c[m];if(E.used){var P=E.getSource();P.attribution&&l.indexOf(P.attribution)<0&&l.push(P.attribution)}}l.sort(function(R,V){return R.length-V.length});var T=(l=l.filter(function(R,V){for(var Q=V+1;Q<l.length;Q++)if(l[Q].indexOf(R)>=0)return!1;return!0})).join(" | ");T!==this._attribHTML&&(this._attribHTML=T,l.length?(this._innerContainer.innerHTML=T,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._editLink=null)}},Ia.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("maplibregl-compact","mapboxgl-compact"):this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show")};var Ss=function(){s.bindAll(["_updateLogo"],this),s.bindAll(["_updateCompact"],this)};Ss.prototype.onAdd=function(l){this._map=l,this._container=ht.create("div","maplibregl-ctrl mapboxgl-ctrl");var f=ht.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return f.target="_blank",f.rel="noopener nofollow",f.href="https://maplibre.org/",f.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),f.setAttribute("rel","noopener nofollow"),this._container.appendChild(f),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Ss.prototype.onRemove=function(){ht.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Ss.prototype.getDefaultPosition=function(){return"bottom-left"},Ss.prototype._updateLogo=function(l){l&&"metadata"!==l.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},Ss.prototype._logoRequired=function(){if(this._map.style){var l=this._map.style.sourceCaches;for(var f in l)if(l[f].getSource().mapbox_logo)return!0;return!1}},Ss.prototype._updateCompact=function(){var l=this._container.children;if(l.length){var f=l[0];this._map.getCanvasContainer().offsetWidth<250?f.classList.add("maplibregl-compact","mapboxgl-compact"):f.classList.remove("maplibregl-compact","mapboxgl-compact")}};var nu=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};nu.prototype.add=function(l){var f=++this._id;return this._queue.push({callback:l,id:f,cancelled:!1}),f},nu.prototype.remove=function(l){for(var f=this._currentlyRunning,c=0,m=f?this._queue.concat(f):this._queue;c<m.length;c+=1){var E=m[c];if(E.id===l)return void(E.cancelled=!0)}},nu.prototype.run=function(l){void 0===l&&(l=0);var f=this._currentlyRunning=this._queue;this._queue=[];for(var c=0,m=f;c<m.length;c+=1){var E=m[c];if(!E.cancelled&&(E.callback(l),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},nu.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Ma={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},dn=s.window.HTMLImageElement,Lu=s.window.HTMLElement,cu=s.window.ImageBitmap,Si={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},bo=function(l){function f(m){var E=this;if(null!=(m=s.extend({},Si,m)).minZoom&&null!=m.maxZoom&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=m.minPitch&&null!=m.maxPitch&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=m.minPitch&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=m.maxPitch&&m.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var P=new bn(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies);if(l.call(this,P,m),this._interactive=m.interactive,this._maxTileCacheSize=m.maxTileCacheSize,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._crossSourceCollisions=m.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=m.collectResourceTiming,this._renderTaskQueue=new nu,this._controls=[],this._mapId=s.uniqueId(),this._locale=s.extend({},Ma,m.locale),this._clickTolerance=m.clickTolerance,this._requestManager=new s.RequestManager(m.transformRequest,m.accessToken),"string"==typeof m.container){if(this._container=s.window.document.getElementById(m.container),!this._container)throw new Error("Container '"+m.container+"' not found.")}else{if(!(m.container instanceof Lu))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(m.maxBounds&&this.setMaxBounds(m.maxBounds),s.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return E._update(!1)}),this.on("moveend",function(){return E._update(!1)}),this.on("zoom",function(){return E._update(!0)}),void 0!==s.window&&(s.window.addEventListener("online",this._onWindowOnline,!1),s.window.addEventListener("resize",this._onWindowResize,!1),s.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Tr(this,m),this._hash=m.hash&&new Va("string"==typeof m.hash&&m.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch}),m.bounds&&(this.resize(),this.fitBounds(m.bounds,s.extend({},m.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=m.localIdeographFontFamily,m.style&&this.setStyle(m.style,{localIdeographFontFamily:m.localIdeographFontFamily}),m.attributionControl&&this.addControl(new Ia({customAttribution:m.customAttribution})),this.addControl(new Ss,m.logoPosition),this.on("style.load",function(){E.transform.unmodified&&E.jumpTo(E.style.stylesheet)}),this.on("data",function(T){E._update("style"===T.dataType),E.fire(new s.Event(T.dataType+"data",T))}),this.on("dataloading",function(T){E.fire(new s.Event(T.dataType+"dataloading",T))})}l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f;var c={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return f.prototype._getMapId=function(){return this._mapId},f.prototype.addControl=function(m,E){if(void 0===E&&(E=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var P=m.onAdd(this);this._controls.push(m);var T=this._controlPositions[E];return-1!==E.indexOf("bottom")?T.insertBefore(P,T.firstChild):T.appendChild(P),this},f.prototype.removeControl=function(m){if(!m||!m.onRemove)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var E=this._controls.indexOf(m);return E>-1&&this._controls.splice(E,1),m.onRemove(this),this},f.prototype.hasControl=function(m){return this._controls.indexOf(m)>-1},f.prototype.resize=function(m){var E=this._containerDimensions(),P=E[0],T=E[1];this._resizeCanvas(P,T),this.transform.resize(P,T),this.painter.resize(P,T);var R=!this._moving;return R&&(this.stop(),this.fire(new s.Event("movestart",m)).fire(new s.Event("move",m))),this.fire(new s.Event("resize",m)),R&&this.fire(new s.Event("moveend",m)),this},f.prototype.getBounds=function(){return this.transform.getBounds()},f.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},f.prototype.setMaxBounds=function(m){return this.transform.setMaxBounds(s.LngLatBounds.convert(m)),this._update()},f.prototype.setMinZoom=function(m){if((m=m??-2)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m&&this.setZoom(m),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},f.prototype.getMinZoom=function(){return this.transform.minZoom},f.prototype.setMaxZoom=function(m){if((m=m??22)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m&&this.setZoom(m),this;throw new Error("maxZoom must be greater than the current minZoom")},f.prototype.getMaxZoom=function(){return this.transform.maxZoom},f.prototype.setMinPitch=function(m){if((m=m??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m&&this.setPitch(m),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},f.prototype.getMinPitch=function(){return this.transform.minPitch},f.prototype.setMaxPitch=function(m){if((m=m??60)>60)throw new Error("maxPitch must be less than or equal to 60");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m&&this.setPitch(m),this;throw new Error("maxPitch must be greater than the current minPitch")},f.prototype.getMaxPitch=function(){return this.transform.maxPitch},f.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},f.prototype.setRenderWorldCopies=function(m){return this.transform.renderWorldCopies=m,this._update()},f.prototype.project=function(m){return this.transform.locationPoint(s.LngLat.convert(m))},f.prototype.unproject=function(m){return this.transform.pointLocation(s.Point.convert(m))},f.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},f.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},f.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},f.prototype._createDelegatedListener=function(m,E,P){var T,R=this;if("mouseenter"===m||"mouseover"===m){var V=!1;return{layer:E,listener:P,delegates:{mousemove:function(vt){var Et=R.getLayer(E)?R.queryRenderedFeatures(vt.point,{layers:[E]}):[];Et.length?V||(V=!0,P.call(R,new ao(m,R,vt.originalEvent,{features:Et}))):V=!1},mouseout:function(){V=!1}}}}if("mouseleave"===m||"mouseout"===m){var Q=!1;return{layer:E,listener:P,delegates:{mousemove:function(vt){(R.getLayer(E)?R.queryRenderedFeatures(vt.point,{layers:[E]}):[]).length?Q=!0:Q&&(Q=!1,P.call(R,new ao(m,R,vt.originalEvent)))},mouseout:function(vt){Q&&(Q=!1,P.call(R,new ao(m,R,vt.originalEvent)))}}}}return{layer:E,listener:P,delegates:(T={},T[m]=function(vt){var Et=R.getLayer(E)?R.queryRenderedFeatures(vt.point,{layers:[E]}):[];Et.length&&(vt.features=Et,P.call(R,vt),delete vt.features)},T)}},f.prototype.on=function(m,E,P){if(void 0===P)return l.prototype.on.call(this,m,E);var T=this._createDelegatedListener(m,E,P);for(var R in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(T),T.delegates)this.on(R,T.delegates[R]);return this},f.prototype.once=function(m,E,P){if(void 0===P)return l.prototype.once.call(this,m,E);var T=this._createDelegatedListener(m,E,P);for(var R in T.delegates)this.once(R,T.delegates[R]);return this},f.prototype.off=function(m,E,P){var T=this;return void 0===P?l.prototype.off.call(this,m,E):(this._delegatedListeners&&this._delegatedListeners[m]&&function(R){for(var V=R[m],Q=0;Q<V.length;Q++){var vt=V[Q];if(vt.layer===E&&vt.listener===P){for(var Et in vt.delegates)T.off(Et,vt.delegates[Et]);return V.splice(Q,1),T}}}(this._delegatedListeners),this)},f.prototype.queryRenderedFeatures=function(m,E){if(!this.style)return[];var P;if(void 0!==E||void 0===m||m instanceof s.Point||Array.isArray(m)||(E=m,m=void 0),E=E||{},(m=m||[[0,0],[this.transform.width,this.transform.height]])instanceof s.Point||"number"==typeof m[0])P=[s.Point.convert(m)];else{var T=s.Point.convert(m[0]),R=s.Point.convert(m[1]);P=[T,new s.Point(R.x,T.y),R,new s.Point(T.x,R.y),T]}return this.style.queryRenderedFeatures(P,E,this.transform)},f.prototype.querySourceFeatures=function(m,E){return this.style.querySourceFeatures(m,E)},f.prototype.setStyle=function(m,E){return!1!==(E=s.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},E)).diff&&E.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&m?(this._diffStyle(m,E),this):(this._localIdeographFontFamily=E.localIdeographFontFamily,this._updateStyle(m,E))},f.prototype.setTransformRequest=function(m){return this._requestManager.setTransformRequest(m),this},f.prototype._getUIString=function(m){var E=this._locale[m];if(null==E)throw new Error("Missing UI string '"+m+"'");return E},f.prototype._updateStyle=function(m,E){return this.style&&(this.style.setEventedParent(null),this.style._remove()),m?(this.style=new Ao(this,E||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof m?this.style.loadURL(m):this.style.loadJSON(m),this):(delete this.style,this)},f.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Ao(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},f.prototype._diffStyle=function(m,E){var P=this;if("string"==typeof m){var T=this._requestManager.normalizeStyleURL(m),R=this._requestManager.transformRequest(T,s.ResourceType.Style);s.getJSON(R,function(V,Q){V?P.fire(new s.ErrorEvent(V)):Q&&P._updateDiff(Q,E)})}else"object"==typeof m&&this._updateDiff(m,E)},f.prototype._updateDiff=function(m,E){try{this.style.setState(m)&&this._update(!0)}catch(P){s.warnOnce("Unable to perform style diff: "+(P.message||P.error||P)+".  Rebuilding the style from scratch."),this._updateStyle(m,E)}},f.prototype.getStyle=function(){if(this.style)return this.style.serialize()},f.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():s.warnOnce("There is no style added to the map.")},f.prototype.addSource=function(m,E){return this._lazyInitEmptyStyle(),this.style.addSource(m,E),this._update(!0)},f.prototype.isSourceLoaded=function(m){var E=this.style&&this.style.sourceCaches[m];if(void 0!==E)return E.loaded();this.fire(new s.ErrorEvent(new Error("There is no source with ID '"+m+"'")))},f.prototype.areTilesLoaded=function(){var m=this.style&&this.style.sourceCaches;for(var E in m){var P=m[E]._tiles;for(var T in P){var R=P[T];if("loaded"!==R.state&&"errored"!==R.state)return!1}}return!0},f.prototype.addSourceType=function(m,E,P){return this._lazyInitEmptyStyle(),this.style.addSourceType(m,E,P)},f.prototype.removeSource=function(m){return this.style.removeSource(m),this._update(!0)},f.prototype.getSource=function(m){return this.style.getSource(m)},f.prototype.addImage=function(m,E,P){void 0===P&&(P={});var T=P.pixelRatio;void 0===T&&(T=1);var R=P.sdf;void 0===R&&(R=!1);var V=P.stretchX,Q=P.stretchY,vt=P.content;if(this._lazyInitEmptyStyle(),E instanceof dn||cu&&E instanceof cu){var Et=s.browser.getImageData(E);this.style.addImage(m,{data:new s.RGBAImage({width:Et.width,height:Et.height},Et.data),pixelRatio:T,stretchX:V,stretchY:Q,content:vt,sdf:R,version:0})}else{if(void 0===E.width||void 0===E.height)return this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var _t=E;this.style.addImage(m,{data:new s.RGBAImage({width:E.width,height:E.height},new Uint8Array(E.data)),pixelRatio:T,stretchX:V,stretchY:Q,content:vt,sdf:R,version:0,userImage:_t}),_t.onAdd&&_t.onAdd(this,m)}},f.prototype.updateImage=function(m,E){var P=this.style.getImage(m);if(!P)return this.fire(new s.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var T=E instanceof dn||cu&&E instanceof cu?s.browser.getImageData(E):E,R=T.width,V=T.height,Q=T.data;return void 0===R||void 0===V?this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):R!==P.data.width||V!==P.data.height?this.fire(new s.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(P.data.replace(Q,!(E instanceof dn||cu&&E instanceof cu)),void this.style.updateImage(m,P))},f.prototype.hasImage=function(m){return m?!!this.style.getImage(m):(this.fire(new s.ErrorEvent(new Error("Missing required image id"))),!1)},f.prototype.removeImage=function(m){this.style.removeImage(m)},f.prototype.loadImage=function(m,E){s.getImage(this._requestManager.transformRequest(m,s.ResourceType.Image),E)},f.prototype.listImages=function(){return this.style.listImages()},f.prototype.addLayer=function(m,E){return this._lazyInitEmptyStyle(),this.style.addLayer(m,E),this._update(!0)},f.prototype.moveLayer=function(m,E){return this.style.moveLayer(m,E),this._update(!0)},f.prototype.removeLayer=function(m){return this.style.removeLayer(m),this._update(!0)},f.prototype.getLayer=function(m){return this.style.getLayer(m)},f.prototype.setLayerZoomRange=function(m,E,P){return this.style.setLayerZoomRange(m,E,P),this._update(!0)},f.prototype.setFilter=function(m,E,P){return void 0===P&&(P={}),this.style.setFilter(m,E,P),this._update(!0)},f.prototype.getFilter=function(m){return this.style.getFilter(m)},f.prototype.setPaintProperty=function(m,E,P,T){return void 0===T&&(T={}),this.style.setPaintProperty(m,E,P,T),this._update(!0)},f.prototype.getPaintProperty=function(m,E){return this.style.getPaintProperty(m,E)},f.prototype.setLayoutProperty=function(m,E,P,T){return void 0===T&&(T={}),this.style.setLayoutProperty(m,E,P,T),this._update(!0)},f.prototype.getLayoutProperty=function(m,E){return this.style.getLayoutProperty(m,E)},f.prototype.setLight=function(m,E){return void 0===E&&(E={}),this._lazyInitEmptyStyle(),this.style.setLight(m,E),this._update(!0)},f.prototype.getLight=function(){return this.style.getLight()},f.prototype.setFeatureState=function(m,E){return this.style.setFeatureState(m,E),this._update()},f.prototype.removeFeatureState=function(m,E){return this.style.removeFeatureState(m,E),this._update()},f.prototype.getFeatureState=function(m){return this.style.getFeatureState(m)},f.prototype.getContainer=function(){return this._container},f.prototype.getCanvasContainer=function(){return this._canvasContainer},f.prototype.getCanvas=function(){return this._canvas},f.prototype._containerDimensions=function(){var m=0,E=0;return this._container&&(m=this._container.clientWidth||400,E=this._container.clientHeight||300),[m,E]},f.prototype._setupContainer=function(){var m=this._container;m.classList.add("maplibregl-map","mapboxgl-map");var E=this._canvasContainer=ht.create("div","maplibregl-canvas-container mapboxgl-canvas-container",m);this._interactive&&E.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=ht.create("canvas","maplibregl-canvas mapboxgl-canvas",E),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var P=this._containerDimensions();this._resizeCanvas(P[0],P[1]);var T=this._controlContainer=ht.create("div","maplibregl-control-container mapboxgl-control-container",m),R=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(V){R[V]=ht.create("div","maplibregl-ctrl-"+V+" mapboxgl-ctrl-"+V,T)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},f.prototype._resizeCanvas=function(m,E){var P=s.browser.devicePixelRatio||1;this._canvas.width=P*m,this._canvas.height=P*E,this._canvas.style.width=m+"px",this._canvas.style.height=E+"px"},f.prototype._setupPainter=function(){var m=s.extend({},lt.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),E=this._canvas.getContext("webgl",m)||this._canvas.getContext("experimental-webgl",m);E?(this.painter=new oi(E,this.transform),s.webpSupported.testSupport(E)):this.fire(new s.ErrorEvent(new Error("Failed to initialize WebGL")))},f.prototype._contextLost=function(m){m.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new s.Event("webglcontextlost",{originalEvent:m}))},f.prototype._contextRestored=function(m){this._setupPainter(),this.resize(),this._update(),this.fire(new s.Event("webglcontextrestored",{originalEvent:m}))},f.prototype._onMapScroll=function(m){if(m.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},f.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},f.prototype._update=function(m){return this.style?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this},f.prototype._requestRenderFrame=function(m){return this._update(),this._renderTaskQueue.add(m)},f.prototype._cancelRenderFrame=function(m){this._renderTaskQueue.remove(m)},f.prototype._render=function(m){var E,P=this,T=0,R=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(E=R.createQueryEXT(),R.beginQueryEXT(R.TIME_ELAPSED_EXT,E),T=s.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(m),!this._removed){var V=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var Q=this.transform.zoom,vt=s.browser.now();this.style.zoomHistory.update(Q,vt);var Et=new s.EvaluationParameters(Q,{now:vt,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),_t=Et.crossFadingFactor();1===_t&&_t===this._crossFadingFactor||(V=!0,this._crossFadingFactor=_t),this.style.update(Et)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new s.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new s.Event("load"))),this.style&&(this.style.hasTransitions()||V)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Jt=s.browser.now()-T;R.endQueryEXT(R.TIME_ELAPSED_EXT,E),setTimeout(function(){var jt=R.getQueryObjectEXT(E,R.QUERY_RESULT_EXT)/1e6;R.deleteQueryEXT(E),P.fire(new s.Event("gpu-timing-frame",{cpuTime:Jt,gpuTime:jt}))},50)}if(this.listens("gpu-timing-layer")){var Gt=this.painter.collectGpuTimers();setTimeout(function(){var jt=P.painter.queryGpuTimers(Gt);P.fire(new s.Event("gpu-timing-layer",{layerTimes:jt}))},50)}var ee=this._sourcesDirty||this._styleDirty||this._placementDirty;return ee||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new s.Event("idle")),!this._loaded||this._fullyLoaded||ee||(this._fullyLoaded=!0),this}},f.prototype.remove=function(){this._hash&&this._hash.remove();for(var m=0,E=this._controls;m<E.length;m+=1)E[m].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==s.window&&(s.window.removeEventListener("resize",this._onWindowResize,!1),s.window.removeEventListener("orientationchange",this._onWindowResize,!1),s.window.removeEventListener("online",this._onWindowOnline,!1));var P=this.painter.context.gl.getExtension("WEBGL_lose_context");P&&P.loseContext(),sc(this._canvasContainer),sc(this._controlContainer),this._container.classList.remove("maplibregl-map","mapboxgl-map"),this._removed=!0,this.fire(new s.Event("remove"))},f.prototype.triggerRepaint=function(){var m=this;this.style&&!this._frame&&(this._frame=s.browser.frame(function(E){m._frame=null,m._render(E)}))},f.prototype._onWindowOnline=function(){this._update()},f.prototype._onWindowResize=function(m){this._trackResize&&this.resize({originalEvent:m})._update()},c.showTileBoundaries.get=function(){return!!this._showTileBoundaries},c.showTileBoundaries.set=function(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._update())},c.showPadding.get=function(){return!!this._showPadding},c.showPadding.set=function(m){this._showPadding!==m&&(this._showPadding=m,this._update())},c.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},c.showCollisionBoxes.set=function(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,m?this.style._generateCollisionBoxes():this._update())},c.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},c.showOverdrawInspector.set=function(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._update())},c.repaint.get=function(){return!!this._repaint},c.repaint.set=function(m){this._repaint!==m&&(this._repaint=m,this.triggerRepaint())},c.vertices.get=function(){return!!this._vertices},c.vertices.set=function(m){this._vertices=m,this._update()},f.prototype._setCacheLimits=function(m,E){s.setCacheLimits(m,E)},c.version.get=function(){return s.version},Object.defineProperties(f.prototype,c),f}(mn);function sc(l){l.parentNode&&l.parentNode.removeChild(l)}var gs={showCompass:!0,showZoom:!0,visualizePitch:!1},Io=function(l){var f=this;this.options=s.extend({},gs,l),this._container=ht.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(c){return c.preventDefault()}),this.options.showZoom&&(s.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",function(c){return f._map.zoomIn({},{originalEvent:c})}),ht.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",function(c){return f._map.zoomOut({},{originalEvent:c})}),ht.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(s.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",function(c){f.options.visualizePitch?f._map.resetNorthPitch({},{originalEvent:c}):f._map.resetNorth({},{originalEvent:c})}),this._compassIcon=ht.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Io.prototype._updateZoomButtons=function(){var l=this._map.getZoom(),f=l===this._map.getMaxZoom(),c=l===this._map.getMinZoom();this._zoomInButton.disabled=f,this._zoomOutButton.disabled=c,this._zoomInButton.setAttribute("aria-disabled",f.toString()),this._zoomOutButton.setAttribute("aria-disabled",c.toString())},Io.prototype._rotateCompassArrow=function(){var l=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=l},Io.prototype.onAdd=function(l){return this._map=l,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new iu(this._map,this._compass,this.options.visualizePitch)),this._container},Io.prototype.onRemove=function(){ht.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Io.prototype._createButton=function(l,f){var c=ht.create("button",l,this._container);return c.type="button",c.addEventListener("click",f),c},Io.prototype._setButtonTitle=function(l,f){var c=this._map._getUIString("NavigationControl."+f);l.title=c,l.setAttribute("aria-label",c)};var iu=function(l,f,c){void 0===c&&(c=!1),this._clickTolerance=10,this.element=f,this.mouseRotate=new Xo({clickTolerance:l.dragRotate._mouseRotate._clickTolerance}),this.map=l,c&&(this.mousePitch=new Zl({clickTolerance:l.dragRotate._mousePitch._clickTolerance})),s.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),ht.addEventListener(f,"mousedown",this.mousedown),ht.addEventListener(f,"touchstart",this.touchstart,{passive:!1}),ht.addEventListener(f,"touchmove",this.touchmove),ht.addEventListener(f,"touchend",this.touchend),ht.addEventListener(f,"touchcancel",this.reset)};function nl(l,f,c){if(l=new s.LngLat(l.lng,l.lat),f){var m=new s.LngLat(l.lng-360,l.lat),E=new s.LngLat(l.lng+360,l.lat),P=c.locationPoint(l).distSqr(f);c.locationPoint(m).distSqr(f)<P?l=m:c.locationPoint(E).distSqr(f)<P&&(l=E)}for(;Math.abs(l.lng-c.center.lng)>180;){var T=c.locationPoint(l);if(T.x>=0&&T.y>=0&&T.x<=c.width&&T.y<=c.height)break;l.lng>c.center.lng?l.lng-=360:l.lng+=360}return l}iu.prototype.down=function(l,f){this.mouseRotate.mousedown(l,f),this.mousePitch&&this.mousePitch.mousedown(l,f),ht.disableDrag()},iu.prototype.move=function(l,f){var c=this.map,m=this.mouseRotate.mousemoveWindow(l,f);if(m&&m.bearingDelta&&c.setBearing(c.getBearing()+m.bearingDelta),this.mousePitch){var E=this.mousePitch.mousemoveWindow(l,f);E&&E.pitchDelta&&c.setPitch(c.getPitch()+E.pitchDelta)}},iu.prototype.off=function(){var l=this.element;ht.removeEventListener(l,"mousedown",this.mousedown),ht.removeEventListener(l,"touchstart",this.touchstart,{passive:!1}),ht.removeEventListener(l,"touchmove",this.touchmove),ht.removeEventListener(l,"touchend",this.touchend),ht.removeEventListener(l,"touchcancel",this.reset),this.offTemp()},iu.prototype.offTemp=function(){ht.enableDrag(),ht.removeEventListener(s.window,"mousemove",this.mousemove),ht.removeEventListener(s.window,"mouseup",this.mouseup)},iu.prototype.mousedown=function(l){this.down(s.extend({},l,{ctrlKey:!0,preventDefault:function(){return l.preventDefault()}}),ht.mousePos(this.element,l)),ht.addEventListener(s.window,"mousemove",this.mousemove),ht.addEventListener(s.window,"mouseup",this.mouseup)},iu.prototype.mousemove=function(l){this.move(l,ht.mousePos(this.element,l))},iu.prototype.mouseup=function(l){this.mouseRotate.mouseupWindow(l),this.mousePitch&&this.mousePitch.mouseupWindow(l),this.offTemp()},iu.prototype.touchstart=function(l){1!==l.targetTouches.length?this.reset():(this._startPos=this._lastPos=ht.touchPos(this.element,l.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return l.preventDefault()}},this._startPos))},iu.prototype.touchmove=function(l){1!==l.targetTouches.length?this.reset():(this._lastPos=ht.touchPos(this.element,l.targetTouches)[0],this.move({preventDefault:function(){return l.preventDefault()}},this._lastPos))},iu.prototype.touchend=function(l){0===l.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},iu.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var e={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function i(l,f,c){var m=l.classList;for(var E in e)m.remove("maplibregl-"+c+"-anchor-"+E,"mapboxgl-"+c+"-anchor-"+E);m.add("maplibregl-"+c+"-anchor-"+f,"mapboxgl-"+c+"-anchor-"+f)}var h,d=function(l){function f(c,m){if(l.call(this),(c instanceof s.window.HTMLElement||m)&&(c=s.extend({element:c},m)),s.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=c&&c.anchor||"center",this._color=c&&c.color||"#3FB1CE",this._scale=c&&c.scale||1,this._draggable=c&&c.draggable||!1,this._clickTolerance=c&&c.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=c&&c.rotation||0,this._rotationAlignment=c&&c.rotationAlignment||"auto",this._pitchAlignment=c&&c.pitchAlignment&&"auto"!==c.pitchAlignment?c.pitchAlignment:this._rotationAlignment,c&&c.element)this._element=c.element,this._offset=s.Point.convert(c&&c.offset||[0,0]);else{this._defaultMarker=!0,this._element=ht.create("div"),this._element.setAttribute("aria-label","Map marker");var E=ht.createNS("http://www.w3.org/2000/svg","svg");E.setAttributeNS(null,"display","block"),E.setAttributeNS(null,"height","41px"),E.setAttributeNS(null,"width","27px"),E.setAttributeNS(null,"viewBox","0 0 27 41");var P=ht.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"stroke","none"),P.setAttributeNS(null,"stroke-width","1"),P.setAttributeNS(null,"fill","none"),P.setAttributeNS(null,"fill-rule","evenodd");var T=ht.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"fill-rule","nonzero");var R=ht.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"transform","translate(3.0, 29.0)"),R.setAttributeNS(null,"fill","#000000");for(var V=0,Q=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];V<Q.length;V+=1){var vt=Q[V],Et=ht.createNS("http://www.w3.org/2000/svg","ellipse");Et.setAttributeNS(null,"opacity","0.04"),Et.setAttributeNS(null,"cx","10.5"),Et.setAttributeNS(null,"cy","5.80029008"),Et.setAttributeNS(null,"rx",vt.rx),Et.setAttributeNS(null,"ry",vt.ry),R.appendChild(Et)}var _t=ht.createNS("http://www.w3.org/2000/svg","g");_t.setAttributeNS(null,"fill",this._color);var Jt=ht.createNS("http://www.w3.org/2000/svg","path");Jt.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),_t.appendChild(Jt);var Gt=ht.createNS("http://www.w3.org/2000/svg","g");Gt.setAttributeNS(null,"opacity","0.25"),Gt.setAttributeNS(null,"fill","#000000");var ee=ht.createNS("http://www.w3.org/2000/svg","path");ee.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Gt.appendChild(ee);var jt=ht.createNS("http://www.w3.org/2000/svg","g");jt.setAttributeNS(null,"transform","translate(6.0, 7.0)"),jt.setAttributeNS(null,"fill","#FFFFFF");var ie=ht.createNS("http://www.w3.org/2000/svg","g");ie.setAttributeNS(null,"transform","translate(8.0, 8.0)");var ye=ht.createNS("http://www.w3.org/2000/svg","circle");ye.setAttributeNS(null,"fill","#000000"),ye.setAttributeNS(null,"opacity","0.25"),ye.setAttributeNS(null,"cx","5.5"),ye.setAttributeNS(null,"cy","5.5"),ye.setAttributeNS(null,"r","5.4999962");var we=ht.createNS("http://www.w3.org/2000/svg","circle");we.setAttributeNS(null,"fill","#FFFFFF"),we.setAttributeNS(null,"cx","5.5"),we.setAttributeNS(null,"cy","5.5"),we.setAttributeNS(null,"r","5.4999962"),ie.appendChild(ye),ie.appendChild(we),T.appendChild(R),T.appendChild(_t),T.appendChild(Gt),T.appendChild(jt),T.appendChild(ie),E.appendChild(T),E.setAttributeNS(null,"height",41*this._scale+"px"),E.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(E),this._offset=s.Point.convert(c&&c.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",function(Ze){Ze.preventDefault()}),this._element.addEventListener("mousedown",function(Ze){Ze.preventDefault()}),i(this._element,this._anchor,"marker"),this._popup=null}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.addTo=function(c){return this.remove(),this._map=c,c.getCanvasContainer().appendChild(this._element),c.on("move",this._update),c.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},f.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),ht.remove(this._element),this._popup&&this._popup.remove(),this},f.prototype.getLngLat=function(){return this._lngLat},f.prototype.setLngLat=function(c){return this._lngLat=s.LngLat.convert(c),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},f.prototype.getElement=function(){return this._element},f.prototype.setPopup=function(c){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),c){if(!("offset"in c.options)){var m=Math.sqrt(Math.pow(13.5,2)/2);c.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[m,-1*(24.6+m)],"bottom-right":[-m,-1*(24.6+m)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=c,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},f.prototype._onKeyPress=function(c){var m=c.code,E=c.charCode||c.keyCode;"Space"!==m&&"Enter"!==m&&32!==E&&13!==E||this.togglePopup()},f.prototype._onMapClick=function(c){var m=c.originalEvent.target,E=this._element;this._popup&&(m===E||E.contains(m))&&this.togglePopup()},f.prototype.getPopup=function(){return this._popup},f.prototype.togglePopup=function(){var c=this._popup;return c?(c.isOpen()?c.remove():c.addTo(this._map),this):this},f.prototype._update=function(c){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=nl(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var m="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?m="rotateZ("+this._rotation+"deg)":"map"===this._rotationAlignment&&(m="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var E="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?E="rotateX(0deg)":"map"===this._pitchAlignment&&(E="rotateX("+this._map.getPitch()+"deg)"),c&&"moveend"!==c.type||(this._pos=this._pos.round()),ht.setTransform(this._element,e[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+E+" "+m)}},f.prototype.getOffset=function(){return this._offset},f.prototype.setOffset=function(c){return this._offset=s.Point.convert(c),this._update(),this},f.prototype._onMove=function(c){if(!this._isDragging){var m=this._clickTolerance||this._map._clickTolerance;this._isDragging=c.point.dist(this._pointerdownPos)>=m}this._isDragging&&(this._pos=c.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new s.Event("dragstart"))),this.fire(new s.Event("drag")))},f.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new s.Event("dragend")),this._state="inactive"},f.prototype._addDragHandler=function(c){this._element.contains(c.originalEvent.target)&&(c.preventDefault(),this._positionDelta=c.point.sub(this._pos).add(this._offset),this._pointerdownPos=c.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},f.prototype.setDraggable=function(c){return this._draggable=!!c,this._map&&(c?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},f.prototype.isDraggable=function(){return this._draggable},f.prototype.setRotation=function(c){return this._rotation=c||0,this._update(),this},f.prototype.getRotation=function(){return this._rotation},f.prototype.setRotationAlignment=function(c){return this._rotationAlignment=c||"auto",this._update(),this},f.prototype.getRotationAlignment=function(){return this._rotationAlignment},f.prototype.setPitchAlignment=function(c){return this._pitchAlignment=c&&"auto"!==c?c:this._rotationAlignment,this._update(),this},f.prototype.getPitchAlignment=function(){return this._pitchAlignment},f}(s.Evented),x={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},L=0,F=!1,K=function(l){function f(c){l.call(this),this.options=s.extend({},x,c),s.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.onAdd=function(c){var m;return this._map=c,this._container=ht.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),m=this._setupUI,void 0!==h?m(h):void 0!==s.window.navigator.permissions?s.window.navigator.permissions.query({name:"geolocation"}).then(function(E){m(h="denied"!==E.state)}):m(h=!!s.window.navigator.geolocation),this._container},f.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(s.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),ht.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,L=0,F=!1},f.prototype._isOutOfMapMaxBounds=function(c){var m=this._map.getMaxBounds(),E=c.coords;return m&&(E.longitude<m.getWest()||E.longitude>m.getEast()||E.latitude<m.getSouth()||E.latitude>m.getNorth())},f.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting")}},f.prototype._onSuccess=function(c){if(this._map){if(this._isOutOfMapMaxBounds(c))return this._setErrorState(),this.fire(new s.Event("outofmaxbounds",c)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=c,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(c),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(c),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new s.Event("geolocate",c)),this._finish()}},f.prototype._updateCamera=function(c){var m=new s.LngLat(c.coords.longitude,c.coords.latitude),E=c.coords.accuracy,P=this._map.getBearing(),T=s.extend({bearing:P},this.options.fitBoundsOptions);this._map.fitBounds(m.toBounds(E),T,{geolocateSource:!0})},f.prototype._updateMarker=function(c){if(c){var m=new s.LngLat(c.coords.longitude,c.coords.latitude);this._accuracyCircleMarker.setLngLat(m).addTo(this._map),this._userLocationDotMarker.setLngLat(m).addTo(this._map),this._accuracy=c.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},f.prototype._updateCircleRadius=function(){var c=this._map._container.clientHeight/2,m=this._map.unproject([0,c]),E=this._map.unproject([1,c]),P=m.distanceTo(E),T=Math.ceil(2*this._accuracy/P);this._circleElement.style.width=T+"px",this._circleElement.style.height=T+"px"},f.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},f.prototype._onError=function(c){if(this._map){if(this.options.trackUserLocation)if(1===c.code){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var m=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=m,this._geolocateButton.setAttribute("aria-label",m),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===c.code&&F)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new s.Event("error",c)),this._finish()}},f.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},f.prototype._setupUI=function(c){var m=this;if(this._container.addEventListener("contextmenu",function(T){return T.preventDefault()}),this._geolocateButton=ht.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),ht.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===c){s.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var E=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=E,this._geolocateButton.setAttribute("aria-label",E)}else{var P=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=P,this._geolocateButton.setAttribute("aria-label",P)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ht.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new d(this._dotElement),this._circleElement=ht.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new d({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(T){T.geolocateSource||"ACTIVE_LOCK"!==m._watchState||T.originalEvent&&"resize"===T.originalEvent.type||(m._watchState="BACKGROUND",m._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),m._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),m.fire(new s.Event("trackuserlocationend")))})},f.prototype.trigger=function(){if(!this._setup)return s.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":L--,F=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new s.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var c;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++L>1?(c={maximumAge:6e5,timeout:0},F=!0):(c=this.options.positionOptions,F=!1),this._geolocationWatchID=s.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,c)}}else s.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},f.prototype._clearWatch=function(){s.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},f}(s.Evented),Mt={maxWidth:100,unit:"metric"},Qt=function(l){this.options=s.extend({},Mt,l),s.bindAll(["_onMove","setUnit"],this)};function ke(l,f,c){var m=c&&c.maxWidth||100,E=l._container.clientHeight/2,P=l.unproject([0,E]),T=l.unproject([m,E]),R=P.distanceTo(T);if(c&&"imperial"===c.unit){var V=3.2808*R;V>5280?Ge(f,m,V/5280,l._getUIString("ScaleControl.Miles")):Ge(f,m,V,l._getUIString("ScaleControl.Feet"))}else c&&"nautical"===c.unit?Ge(f,m,R/1852,l._getUIString("ScaleControl.NauticalMiles")):R>=1e3?Ge(f,m,R/1e3,l._getUIString("ScaleControl.Kilometers")):Ge(f,m,R,l._getUIString("ScaleControl.Meters"))}function Ge(l,f,c,m){var E,P,T,V,Q,R=(E=c,(P=Math.pow(10,(""+Math.floor(E)).length-1))*(T=(T=E/P)>=10?10:T>=5?5:T>=3?3:T>=2?2:T>=1?1:(V=T,Q=Math.pow(10,Math.ceil(-Math.log(V)/Math.LN10)),Math.round(V*Q)/Q)));l.style.width=f*(R/c)+"px",l.innerHTML=R+"&nbsp;"+m}Qt.prototype.getDefaultPosition=function(){return"bottom-left"},Qt.prototype._onMove=function(){ke(this._map,this._container,this.options)},Qt.prototype.onAdd=function(l){return this._map=l,this._container=ht.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",l.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Qt.prototype.onRemove=function(){ht.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Qt.prototype.setUnit=function(l){this.options.unit=l,ke(this._map,this._container,this.options)};var gr=function(l){this._fullscreen=!1,l&&l.container&&(l.container instanceof s.window.HTMLElement?this._container=l.container:s.warnOnce("Full screen control 'container' must be a DOM element.")),s.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in s.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in s.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in s.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in s.window.document&&(this._fullscreenchange="MSFullscreenChange")};gr.prototype.onAdd=function(l){return this._map=l,this._container||(this._container=this._map.getContainer()),this._controlContainer=ht.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",s.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},gr.prototype.onRemove=function(){ht.remove(this._controlContainer),this._map=null,s.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},gr.prototype._checkFullscreenSupport=function(){return!!(s.window.document.fullscreenEnabled||s.window.document.mozFullScreenEnabled||s.window.document.msFullscreenEnabled||s.window.document.webkitFullscreenEnabled)},gr.prototype._setupUI=function(){var l=this._fullscreenButton=ht.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);ht.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",l).setAttribute("aria-hidden",!0),l.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),s.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},gr.prototype._updateTitle=function(){var l=this._getTitle();this._fullscreenButton.setAttribute("aria-label",l),this._fullscreenButton.title=l},gr.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},gr.prototype._isFullscreen=function(){return this._fullscreen},gr.prototype._changeIcon=function(){(s.window.document.fullscreenElement||s.window.document.mozFullScreenElement||s.window.document.webkitFullscreenElement||s.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},gr.prototype._onClickFullscreen=function(){this._isFullscreen()?s.window.document.exitFullscreen?s.window.document.exitFullscreen():s.window.document.mozCancelFullScreen?s.window.document.mozCancelFullScreen():s.window.document.msExitFullscreen?s.window.document.msExitFullscreen():s.window.document.webkitCancelFullScreen&&s.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Ir={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},jr=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),ln=function(l){function f(c){l.call(this),this.options=s.extend(Object.create(Ir),c),s.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.addTo=function(c){return this._map&&this.remove(),this._map=c,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new s.Event("open")),this},f.prototype.isOpen=function(){return!!this._map},f.prototype.remove=function(){return this._content&&ht.remove(this._content),this._container&&(ht.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new s.Event("close")),this},f.prototype.getLngLat=function(){return this._lngLat},f.prototype.setLngLat=function(c){return this._lngLat=s.LngLat.convert(c),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this},f.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this},f.prototype.getElement=function(){return this._container},f.prototype.setText=function(c){return this.setDOMContent(s.window.document.createTextNode(c))},f.prototype.setHTML=function(c){var m,E=s.window.document.createDocumentFragment(),P=s.window.document.createElement("body");for(P.innerHTML=c;m=P.firstChild;)E.appendChild(m);return this.setDOMContent(E)},f.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},f.prototype.setMaxWidth=function(c){return this.options.maxWidth=c,this._update(),this},f.prototype.setDOMContent=function(c){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=ht.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(c),this._createCloseButton(),this._update(),this._focusFirstElement(),this},f.prototype.addClassName=function(c){this._container&&this._container.classList.add(c)},f.prototype.removeClassName=function(c){this._container&&this._container.classList.remove(c)},f.prototype.setOffset=function(c){return this.options.offset=c,this._update(),this},f.prototype.toggleClassName=function(c){if(this._container)return this._container.classList.toggle(c)},f.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=ht.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},f.prototype._onMouseUp=function(c){this._update(c.point)},f.prototype._onMouseMove=function(c){this._update(c.point)},f.prototype._onDrag=function(c){this._update(c.point)},f.prototype._update=function(c){var m=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=ht.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=ht.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(Et){return m._container.classList.add(Et)}),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=nl(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||c)){var E=this._pos=this._trackPointer&&c?c:this._map.project(this._lngLat),P=this.options.anchor,T=function Et(_t){if(_t){if("number"==typeof _t){var Jt=Math.round(Math.sqrt(.5*Math.pow(_t,2)));return{center:new s.Point(0,0),top:new s.Point(0,_t),"top-left":new s.Point(Jt,Jt),"top-right":new s.Point(-Jt,Jt),bottom:new s.Point(0,-_t),"bottom-left":new s.Point(Jt,-Jt),"bottom-right":new s.Point(-Jt,-Jt),left:new s.Point(_t,0),right:new s.Point(-_t,0)}}if(_t instanceof s.Point||Array.isArray(_t)){var Gt=s.Point.convert(_t);return{center:Gt,top:Gt,"top-left":Gt,"top-right":Gt,bottom:Gt,"bottom-left":Gt,"bottom-right":Gt,left:Gt,right:Gt}}return{center:s.Point.convert(_t.center||[0,0]),top:s.Point.convert(_t.top||[0,0]),"top-left":s.Point.convert(_t["top-left"]||[0,0]),"top-right":s.Point.convert(_t["top-right"]||[0,0]),bottom:s.Point.convert(_t.bottom||[0,0]),"bottom-left":s.Point.convert(_t["bottom-left"]||[0,0]),"bottom-right":s.Point.convert(_t["bottom-right"]||[0,0]),left:s.Point.convert(_t.left||[0,0]),right:s.Point.convert(_t.right||[0,0])}}return Et(new s.Point(0,0))}(this.options.offset);if(!P){var R,V=this._container.offsetWidth,Q=this._container.offsetHeight;R=E.y+T.bottom.y<Q?["top"]:E.y>this._map.transform.height-Q?["bottom"]:[],E.x<V/2?R.push("left"):E.x>this._map.transform.width-V/2&&R.push("right"),P=0===R.length?"bottom":R.join("-")}var vt=E.add(T[P]).round();ht.setTransform(this._container,e[P]+" translate("+vt.x+"px,"+vt.y+"px)"),i(this._container,P,"popup")}},f.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var c=this._container.querySelector(jr);c&&c.focus()}},f.prototype._onClose=function(){this.remove()},f}(s.Evented),Mi={version:s.version,supported:lt,setRTLTextPlugin:s.setRTLTextPlugin,getRTLTextPluginStatus:s.getRTLTextPluginStatus,Map:bo,NavigationControl:Io,GeolocateControl:K,AttributionControl:Ia,ScaleControl:Qt,FullscreenControl:gr,Popup:ln,Marker:d,Style:Ao,LngLat:s.LngLat,LngLatBounds:s.LngLatBounds,Point:s.Point,MercatorCoordinate:s.MercatorCoordinate,Evented:s.Evented,config:s.config,prewarm:function(){Pr().acquire(Te)},clearPrewarmedResources:function(){var l=vr;l&&(l.isPreloaded()&&1===l.numActive()?(l.release(Te),vr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return s.config.ACCESS_TOKEN},set accessToken(l){s.config.ACCESS_TOKEN=l},get baseApiUrl(){return s.config.API_URL},set baseApiUrl(l){s.config.API_URL=l},get workerCount(){return Ye.workerCount},set workerCount(l){Ye.workerCount=l},get maxParallelImageRequests(){return s.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(l){s.config.MAX_PARALLEL_IMAGE_REQUESTS=l},clearStorage:function(l){s.clearTileCache(l)},workerUrl:"",addProtocol:function(l,f){s.config.REGISTERED_PROTOCOLS[l]=f},removeProtocol:function(l){delete s.config.REGISTERED_PROTOCOLS[l]}};return Mi}),dt}()},3990:function(tr,he,St){var dt,Tt;dt=function(){var s,lt,yt,xt,ge,Lt={},Nt={},$t={currentLocale:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:!0},qt={currentLocale:$t.currentLocale,zeroFormat:$t.zeroFormat,nullFormat:$t.nullFormat,defaultFormat:$t.defaultFormat,scalePercentBy100:$t.scalePercentBy100};function _e(yt,xt){this._input=yt,this._value=xt}return(s=function(yt){var xt,Yt,ge,Z;if(s.isNumeral(yt))xt=yt.value();else if(0===yt||typeof yt>"u")xt=0;else if(null===yt||lt.isNaN(yt))xt=null;else if("string"==typeof yt)if(qt.zeroFormat&&yt===qt.zeroFormat)xt=0;else if(qt.nullFormat&&yt===qt.nullFormat||!yt.replace(/[^0-9]+/g,"").length)xt=null;else{for(Yt in Lt)if((Z="function"==typeof Lt[Yt].regexps.unformat?Lt[Yt].regexps.unformat():Lt[Yt].regexps.unformat)&&yt.match(Z)){ge=Lt[Yt].unformat;break}xt=(ge=ge||s._.stringToNumber)(yt)}else xt=Number(yt)||null;return new _e(yt,xt)}).version="2.0.6",s.isNumeral=function(yt){return yt instanceof _e},s._=lt={numberToFormat:function(yt,xt,Yt){var Wt,Ct,Ie,It,pe,Pt,te,$,ge=Nt[s.options.currentLocale],Z=!1,it=!1,tt="",X=1e12,rt=1e9,H=1e6,at="",j=!1;if(yt=yt||0,Ct=Math.abs(yt),s._.includes(xt,"(")?(Z=!0,xt=xt.replace(/[\(|\)]/g,"")):(s._.includes(xt,"+")||s._.includes(xt,"-"))&&(pe=s._.includes(xt,"+")?xt.indexOf("+"):yt<0?xt.indexOf("-"):-1,xt=xt.replace(/[\+|\-]/g,"")),s._.includes(xt,"a")&&(Wt=!!(Wt=xt.match(/a(k|m|b|t)?/))&&Wt[1],s._.includes(xt," a")&&(tt=" "),xt=xt.replace(new RegExp(tt+"a[kmbt]?"),""),Ct>=X&&!Wt||"t"===Wt?(tt+=ge.abbreviations.trillion,yt/=X):Ct<X&&Ct>=rt&&!Wt||"b"===Wt?(tt+=ge.abbreviations.billion,yt/=rt):Ct<rt&&Ct>=H&&!Wt||"m"===Wt?(tt+=ge.abbreviations.million,yt/=H):(Ct<H&&Ct>=1e3&&!Wt||"k"===Wt)&&(tt+=ge.abbreviations.thousand,yt/=1e3)),s._.includes(xt,"[.]")&&(it=!0,xt=xt.replace("[.]",".")),Ie=yt.toString().split(".")[0],It=xt.split(".")[1],Pt=xt.indexOf(","),$=(xt.split(".")[0].split(",")[0].match(/0/g)||[]).length,It?(s._.includes(It,"[")?(It=(It=It.replace("]","")).split("["),at=s._.toFixed(yt,It[0].length+It[1].length,Yt,It[1].length)):at=s._.toFixed(yt,It.length,Yt),Ie=at.split(".")[0],at=s._.includes(at,".")?ge.delimiters.decimal+at.split(".")[1]:"",it&&0===Number(at.slice(1))&&(at="")):Ie=s._.toFixed(yt,0,Yt),tt&&!Wt&&Number(Ie)>=1e3&&tt!==ge.abbreviations.trillion)switch(Ie=String(Number(Ie)/1e3),tt){case ge.abbreviations.thousand:tt=ge.abbreviations.million;break;case ge.abbreviations.million:tt=ge.abbreviations.billion;break;case ge.abbreviations.billion:tt=ge.abbreviations.trillion}if(s._.includes(Ie,"-")&&(Ie=Ie.slice(1),j=!0),Ie.length<$)for(var le=$-Ie.length;le>0;le--)Ie="0"+Ie;return Pt>-1&&(Ie=Ie.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+ge.delimiters.thousands)),0===xt.indexOf(".")&&(Ie=""),te=Ie+at+(tt||""),Z?te=(Z&&j?"(":"")+te+(Z&&j?")":""):pe>=0?te=0===pe?(j?"-":"+")+te:te+(j?"-":"+"):j&&(te="-"+te),te},stringToNumber:function(yt){var Z,it,tt,xt=Nt[qt.currentLocale],Yt=yt,ge={thousand:3,million:6,billion:9,trillion:12};if(qt.zeroFormat&&yt===qt.zeroFormat)it=0;else if(qt.nullFormat&&yt===qt.nullFormat||!yt.replace(/[^0-9]+/g,"").length)it=null;else{for(Z in it=1,"."!==xt.delimiters.decimal&&(yt=yt.replace(/\./g,"").replace(xt.delimiters.decimal,".")),ge)if(tt=new RegExp("[^a-zA-Z]"+xt.abbreviations[Z]+"(?:\\)|(\\"+xt.currency.symbol+")?(?:\\))?)?$"),Yt.match(tt)){it*=Math.pow(10,ge[Z]);break}it*=(yt.split("-").length+Math.min(yt.split("(").length-1,yt.split(")").length-1))%2?1:-1,yt=yt.replace(/[^0-9\.]+/g,""),it*=Number(yt)}return it},isNaN:function(yt){return"number"==typeof yt&&isNaN(yt)},includes:function(yt,xt){return-1!==yt.indexOf(xt)},insert:function(yt,xt,Yt){return yt.slice(0,Yt)+xt+yt.slice(Yt)},reduce:function(yt,xt){if(null===this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof xt)throw new TypeError(xt+" is not a function");var it,Yt=Object(yt),ge=Yt.length>>>0,Z=0;if(3===arguments.length)it=arguments[2];else{for(;Z<ge&&!(Z in Yt);)Z++;if(Z>=ge)throw new TypeError("Reduce of empty array with no initial value");it=Yt[Z++]}for(;Z<ge;Z++)Z in Yt&&(it=xt(it,Yt[Z],Z,Yt));return it},multiplier:function(yt){var xt=yt.toString().split(".");return xt.length<2?1:Math.pow(10,xt[1].length)},correctionFactor:function(){return Array.prototype.slice.call(arguments).reduce(function(xt,Yt){var ge=lt.multiplier(Yt);return xt>ge?xt:ge},1)},toFixed:function(yt,xt,Yt,ge){var $,tt,X,rt,Z=yt.toString().split("."),it=xt-(ge||0);return $=2===Z.length?Math.min(Math.max(Z[1].length,it),xt):it,X=Math.pow(10,$),rt=(Yt(yt+"e+"+$)/X).toFixed($),ge>xt-$&&(tt=new RegExp("\\.?0{1,"+(ge-(xt-$))+"}$"),rt=rt.replace(tt,"")),rt}},s.options=qt,s.formats=Lt,s.locales=Nt,s.locale=function(yt){return yt&&(qt.currentLocale=yt.toLowerCase()),qt.currentLocale},s.localeData=function(yt){if(!yt)return Nt[qt.currentLocale];if(yt=yt.toLowerCase(),!Nt[yt])throw new Error("Unknown locale : "+yt);return Nt[yt]},s.reset=function(){for(var yt in $t)qt[yt]=$t[yt]},s.zeroFormat=function(yt){qt.zeroFormat="string"==typeof yt?yt:null},s.nullFormat=function(yt){qt.nullFormat="string"==typeof yt?yt:null},s.defaultFormat=function(yt){qt.defaultFormat="string"==typeof yt?yt:"0.0"},s.register=function(yt,xt,Yt){if(xt=xt.toLowerCase(),this[yt+"s"][xt])throw new TypeError(xt+" "+yt+" already registered.");return this[yt+"s"][xt]=Yt,Yt},s.validate=function(yt,xt){var Yt,ge,Z,it,$,tt,X,rt;if("string"!=typeof yt&&(yt+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",yt)),(yt=yt.trim()).match(/^\d+$/))return!0;if(""===yt)return!1;try{X=s.localeData(xt)}catch{X=s.localeData(s.locale())}return Z=X.currency.symbol,$=X.abbreviations,Yt=X.delimiters.decimal,ge="."===X.delimiters.thousands?"\\.":X.delimiters.thousands,!(null!==(rt=yt.match(/^[^\d]+/))&&(yt=yt.substr(1),rt[0]!==Z)||null!==(rt=yt.match(/[^\d]+$/))&&(yt=yt.slice(0,-1),rt[0]!==$.thousand&&rt[0]!==$.million&&rt[0]!==$.billion&&rt[0]!==$.trillion)||(tt=new RegExp(ge+"{2}"),yt.match(/[^\d.,]/g)||(it=yt.split(Yt)).length>2||(it.length<2?!it[0].match(/^\d+.*\d$/)||it[0].match(tt):1===it[0].length?!it[0].match(/^\d+$/)||it[0].match(tt)||!it[1].match(/^\d+$/):!it[0].match(/^\d+.*\d$/)||it[0].match(tt)||!it[1].match(/^\d+$/))))},s.fn=_e.prototype={clone:function(){return s(this)},format:function(yt,xt){var Z,it,$,Yt=this._value,ge=yt||qt.defaultFormat;if(xt=xt||Math.round,0===Yt&&null!==qt.zeroFormat)it=qt.zeroFormat;else if(null===Yt&&null!==qt.nullFormat)it=qt.nullFormat;else{for(Z in Lt)if(ge.match(Lt[Z].regexps.format)){$=Lt[Z].format;break}it=($=$||s._.numberToFormat)(Yt,ge,xt)}return it},value:function(){return this._value},input:function(){return this._input},set:function(yt){return this._value=Number(yt),this},add:function(yt){var xt=lt.correctionFactor.call(null,this._value,yt);return this._value=lt.reduce([this._value,yt],function Yt(ge,Z,it,$){return ge+Math.round(xt*Z)},0)/xt,this},subtract:function(yt){var xt=lt.correctionFactor.call(null,this._value,yt);return this._value=lt.reduce([yt],function Yt(ge,Z,it,$){return ge-Math.round(xt*Z)},Math.round(this._value*xt))/xt,this},multiply:function(yt){return this._value=lt.reduce([this._value,yt],function xt(Yt,ge,Z,it){var $=lt.correctionFactor(Yt,ge);return Math.round(Yt*$)*Math.round(ge*$)/Math.round($*$)},1),this},divide:function(yt){return this._value=lt.reduce([this._value,yt],function xt(Yt,ge,Z,it){var $=lt.correctionFactor(Yt,ge);return Math.round(Yt*$)/Math.round(ge*$)}),this},difference:function(yt){return Math.abs(s(this._value).subtract(yt).value())}},s.register("locale","en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(yt){var xt=yt%10;return 1==~~(yt%100/10)?"th":1===xt?"st":2===xt?"nd":3===xt?"rd":"th"},currency:{symbol:"$"}}),s.register("format","bps",{regexps:{format:/(BPS)/,unformat:/(BPS)/},format:function(yt,xt,Yt){var Z,ge=s._.includes(xt," BPS")?" ":"";return yt*=1e4,xt=xt.replace(/\s?BPS/,""),Z=s._.numberToFormat(yt,xt,Yt),s._.includes(Z,")")?((Z=Z.split("")).splice(-1,0,ge+"BPS"),Z=Z.join("")):Z=Z+ge+"BPS",Z},unformat:function(yt){return+(1e-4*s._.stringToNumber(yt)).toFixed(15)}}),ge="("+(ge=(yt={base:1e3,suffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]}).suffixes.concat((xt={base:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]}).suffixes.filter(function(Z){return yt.suffixes.indexOf(Z)<0})).join("|")).replace("B","B(?!PS)")+")",s.register("format","bytes",{regexps:{format:/([0\s]i?b)/,unformat:new RegExp(ge)},format:function(Z,it,$){var H,et,at,X=s._.includes(it,"ib")?xt:yt,rt=s._.includes(it," b")||s._.includes(it," ib")?" ":"";for(it=it.replace(/\s?i?b/,""),H=0;H<=X.suffixes.length;H++)if(et=Math.pow(X.base,H),at=Math.pow(X.base,H+1),null===Z||0===Z||Z>=et&&Z<at){rt+=X.suffixes[H],et>0&&(Z/=et);break}return s._.numberToFormat(Z,it,$)+rt},unformat:function(Z){var $,tt,it=s._.stringToNumber(Z);if(it){for($=yt.suffixes.length-1;$>=0;$--){if(s._.includes(Z,yt.suffixes[$])){tt=Math.pow(yt.base,$);break}if(s._.includes(Z,xt.suffixes[$])){tt=Math.pow(xt.base,$);break}}it*=tt||1}return it}}),s.register("format","currency",{regexps:{format:/(\$)/},format:function(yt,xt,Yt){var it,$,tt,ge=s.locales[s.options.currentLocale],Z={before:xt.match(/^([\+|\-|\(|\s|\$]*)/)[0],after:xt.match(/([\+|\-|\)|\s|\$]*)$/)[0]};for(xt=xt.replace(/\s?\$\s?/,""),it=s._.numberToFormat(yt,xt,Yt),yt>=0?(Z.before=Z.before.replace(/[\-\(]/,""),Z.after=Z.after.replace(/[\-\)]/,"")):yt<0&&!s._.includes(Z.before,"-")&&!s._.includes(Z.before,"(")&&(Z.before="-"+Z.before),tt=0;tt<Z.before.length;tt++)switch($=Z.before[tt],$){case"$":it=s._.insert(it,ge.currency.symbol,tt);break;case" ":it=s._.insert(it," ",tt+ge.currency.symbol.length-1)}for(tt=Z.after.length-1;tt>=0;tt--)switch($=Z.after[tt],$){case"$":it=tt===Z.after.length-1?it+ge.currency.symbol:s._.insert(it,ge.currency.symbol,-(Z.after.length-(1+tt)));break;case" ":it=tt===Z.after.length-1?it+" ":s._.insert(it," ",-(Z.after.length-(1+tt)+ge.currency.symbol.length-1))}return it}}),s.register("format","exponential",{regexps:{format:/(e\+|e-)/,unformat:/(e\+|e-)/},format:function(yt,xt,Yt){var it=("number"!=typeof yt||s._.isNaN(yt)?"0e+0":yt.toExponential()).split("e");return xt=xt.replace(/e[\+|\-]{1}0/,""),s._.numberToFormat(Number(it[0]),xt,Yt)+"e"+it[1]},unformat:function(yt){var xt=s._.includes(yt,"e+")?yt.split("e+"):yt.split("e-"),Yt=Number(xt[0]),ge=Number(xt[1]);return ge=s._.includes(yt,"e-")?ge*=-1:ge,s._.reduce([Yt,Math.pow(10,ge)],function Z(it,$,tt,X){var rt=s._.correctionFactor(it,$);return it*rt*($*rt)/(rt*rt)},1)}}),s.register("format","ordinal",{regexps:{format:/(o)/},format:function(yt,xt,Yt){var ge=s.locales[s.options.currentLocale],it=s._.includes(xt," o")?" ":"";return xt=xt.replace(/\s?o/,""),it+=ge.ordinal(yt),s._.numberToFormat(yt,xt,Yt)+it}}),s.register("format","percentage",{regexps:{format:/(%)/,unformat:/(%)/},format:function(yt,xt,Yt){var Z,ge=s._.includes(xt," %")?" ":"";return s.options.scalePercentBy100&&(yt*=100),xt=xt.replace(/\s?\%/,""),Z=s._.numberToFormat(yt,xt,Yt),s._.includes(Z,")")?((Z=Z.split("")).splice(-1,0,ge+"%"),Z=Z.join("")):Z=Z+ge+"%",Z},unformat:function(yt){var xt=s._.stringToNumber(yt);return s.options.scalePercentBy100?.01*xt:xt}}),s.register("format","time",{regexps:{format:/(:)/,unformat:/(:)/},format:function(yt,xt,Yt){var ge=Math.floor(yt/60/60),Z=Math.floor((yt-60*ge*60)/60),it=Math.round(yt-60*ge*60-60*Z);return ge+":"+(Z<10?"0"+Z:Z)+":"+(it<10?"0"+it:it)},unformat:function(yt){var xt=yt.split(":"),Yt=0;return 3===xt.length?(Yt+=60*Number(xt[0])*60,Yt+=60*Number(xt[1]),Yt+=Number(xt[2])):2===xt.length&&(Yt+=60*Number(xt[0]),Yt+=Number(xt[1])),Number(Yt)}}),s},void 0!==(Tt=dt.call(he,St,he,tr))&&(tr.exports=Tt)},5943:tr=>{"use strict";var he=Object.getOwnPropertySymbols,St=Object.prototype.hasOwnProperty,dt=Object.prototype.propertyIsEnumerable;function Tt(lt){if(null==lt)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(lt)}tr.exports=function s(){try{if(!Object.assign)return!1;var lt=new String("abc");if(lt[5]="de","5"===Object.getOwnPropertyNames(lt)[0])return!1;for(var ht={},Lt=0;Lt<10;Lt++)ht["_"+String.fromCharCode(Lt)]=Lt;if("0123456789"!==Object.getOwnPropertyNames(ht).map(function(qt){return ht[qt]}).join(""))return!1;var $t={};return"abcdefghijklmnopqrst".split("").forEach(function(qt){$t[qt]=qt}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},$t)).join("")}catch{return!1}}()?Object.assign:function(lt,ht){for(var Lt,$t,Nt=Tt(lt),qt=1;qt<arguments.length;qt++){for(var _e in Lt=Object(arguments[qt]))St.call(Lt,_e)&&(Nt[_e]=Lt[_e]);if(he){$t=he(Lt);for(var yt=0;yt<$t.length;yt++)dt.call(Lt,$t[yt])&&(Nt[$t[yt]]=Lt[$t[yt]])}}return Nt}},1175:tr=>{"use strict";var he=function(St){return St!=St};tr.exports=function(dt,Tt){return 0===dt&&0===Tt?1/dt==1/Tt:!!(dt===Tt||he(dt)&&he(Tt))}},2e3:(tr,he,St)=>{"use strict";var dt=St(2358),Tt=St(5685),s=St(1175),lt=St(6305),ht=St(3859),Lt=Tt(lt(),Object);dt(Lt,{getPolyfill:lt,implementation:s,shim:ht}),tr.exports=Lt},6305:(tr,he,St)=>{"use strict";var dt=St(1175);tr.exports=function(){return"function"==typeof Object.is?Object.is:dt}},3859:(tr,he,St)=>{"use strict";var dt=St(6305),Tt=St(2358);tr.exports=function(){var lt=dt();return Tt(Object,{is:lt},{is:function(){return Object.is!==lt}}),lt}},2450:(tr,he,St)=>{"use strict";var dt;if(!Object.keys){var Tt=Object.prototype.hasOwnProperty,s=Object.prototype.toString,lt=St(9978),ht=Object.prototype.propertyIsEnumerable,Lt=!ht.call({toString:null},"toString"),Nt=ht.call(function(){},"prototype"),$t=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],qt=function(Yt){var ge=Yt.constructor;return ge&&ge.prototype===Yt},_e={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},yt=function(){if(typeof window>"u")return!1;for(var Yt in window)try{if(!_e["$"+Yt]&&Tt.call(window,Yt)&&null!==window[Yt]&&"object"==typeof window[Yt])try{qt(window[Yt])}catch{return!0}}catch{return!0}return!1}();dt=function(ge){var Z=null!==ge&&"object"==typeof ge,it="[object Function]"===s.call(ge),$=lt(ge),tt=Z&&"[object String]"===s.call(ge),X=[];if(!Z&&!it&&!$)throw new TypeError("Object.keys called on a non-object");var rt=Nt&&it;if(tt&&ge.length>0&&!Tt.call(ge,0))for(var H=0;H<ge.length;++H)X.push(String(H));if($&&ge.length>0)for(var et=0;et<ge.length;++et)X.push(String(et));else for(var at in ge)(!rt||"prototype"!==at)&&Tt.call(ge,at)&&X.push(String(at));if(Lt)for(var j=function(Yt){if(typeof window>"u"||!yt)return qt(Yt);try{return qt(Yt)}catch{return!1}}(ge),Wt=0;Wt<$t.length;++Wt)(!j||"constructor"!==$t[Wt])&&Tt.call(ge,$t[Wt])&&X.push($t[Wt]);return X}}tr.exports=dt},1356:(tr,he,St)=>{"use strict";var dt=Array.prototype.slice,Tt=St(9978),s=Object.keys,lt=s?function(Nt){return s(Nt)}:St(2450),ht=Object.keys;lt.shim=function(){if(Object.keys){var Nt=function(){var $t=Object.keys(arguments);return $t&&$t.length===arguments.length}(1,2);Nt||(Object.keys=function(qt){return Tt(qt)?ht(dt.call(qt)):ht(qt)})}else Object.keys=lt;return Object.keys||lt},tr.exports=lt},9978:tr=>{"use strict";var he=Object.prototype.toString;tr.exports=function(dt){var Tt=he.call(dt),s="[object Arguments]"===Tt;return s||(s="[object Array]"!==Tt&&null!==dt&&"object"==typeof dt&&"number"==typeof dt.length&&dt.length>=0&&"[object Function]"===he.call(dt.callee)),s}},1766:tr=>{tr.exports=function(St,dt,Tt,s){var lt=St[0],ht=St[1],Lt=!1;void 0===Tt&&(Tt=0),void 0===s&&(s=dt.length);for(var Nt=(s-Tt)/2,$t=0,qt=Nt-1;$t<Nt;qt=$t++){var _e=dt[Tt+2*$t+0],yt=dt[Tt+2*$t+1],Yt=dt[Tt+2*qt+1];yt>ht!=Yt>ht&&lt<(dt[Tt+2*qt+0]-_e)*(ht-yt)/(Yt-yt)+_e&&(Lt=!Lt)}return Lt}},3870:(tr,he,St)=>{var dt=St(1766),Tt=St(2260);tr.exports=function(lt,ht,Lt,Nt){return ht.length>0&&Array.isArray(ht[0])?Tt(lt,ht,Lt,Nt):dt(lt,ht,Lt,Nt)},tr.exports.nested=Tt,tr.exports.flat=dt},2260:tr=>{tr.exports=function(St,dt,Tt,s){var lt=St[0],ht=St[1],Lt=!1;void 0===Tt&&(Tt=0),void 0===s&&(s=dt.length);for(var Nt=s-Tt,$t=0,qt=Nt-1;$t<Nt;qt=$t++){var _e=dt[$t+Tt][0],yt=dt[$t+Tt][1],Yt=dt[qt+Tt][1];yt>ht!=Yt>ht&&lt<(dt[qt+Tt][0]-_e)*(ht-yt)/(Yt-yt)+_e&&(Lt=!Lt)}return Lt}},9855:function(tr){tr.exports=function(){"use strict";function he(Kt,st){if(!(Kt instanceof st))throw new TypeError("Cannot call a class as a function")}function St(Kt,st){for(var nt=0;nt<st.length;nt++){var ot=st[nt];ot.enumerable=ot.enumerable||!1,ot.configurable=!0,"value"in ot&&(ot.writable=!0),Object.defineProperty(Kt,ot.key,ot)}}function dt(Kt,st,nt){return st&&St(Kt.prototype,st),nt&&St(Kt,nt),Kt}var Tt=function Kt(st,nt){this.next=null,this.key=st,this.data=nt,this.left=null,this.right=null};function s(Kt,st){return Kt>st?1:Kt<st?-1:0}function lt(Kt,st,nt){for(var ot=new Tt(null,null),Rt=ot,ce=ot;;){var De=nt(Kt,st.key);if(De<0){if(null===st.left)break;if(nt(Kt,st.left.key)<0&&(st.left=(Qe=st.left).right,Qe.right=st,null===(st=Qe).left))break;ce.left=st,ce=st,st=st.left}else{if(!(De>0))break;if(null===st.right)break;var Qe;if(nt(Kt,st.right.key)>0&&(st.right=(Qe=st.right).left,Qe.left=st,null===(st=Qe).right))break;Rt.right=st,Rt=st,st=st.right}}return Rt.right=st.left,ce.left=st.right,st.left=ot.right,st.right=ot.left,st}function ht(Kt,st,nt,ot){var Rt=new Tt(Kt,st);if(null===nt)return Rt.left=Rt.right=null,Rt;var ce=ot(Kt,(nt=lt(Kt,nt,ot)).key);return ce<0?(Rt.left=nt.left,Rt.right=nt,nt.left=null):ce>=0&&(Rt.right=nt.right,Rt.left=nt,nt.right=null),Rt}function Lt(Kt,st,nt){var ot=null,Rt=null;if(st){var ce=nt((st=lt(Kt,st,nt)).key,Kt);0===ce?(ot=st.left,Rt=st.right):ce<0?(Rt=st.right,st.right=null,ot=st):(ot=st.left,st.left=null,Rt=st)}return{left:ot,right:Rt}}function $t(Kt,st,nt,ot,Rt){if(Kt){ot(st+(nt?"\u2514\u2500\u2500 ":"\u251c\u2500\u2500 ")+Rt(Kt)+"\n");var ce=st+(nt?"    ":"\u2502   ");Kt.left&&$t(Kt.left,ce,!1,ot,Rt),Kt.right&&$t(Kt.right,ce,!0,ot,Rt)}}var qt=function(){function Kt(st){void 0===st&&(st=s),this._root=null,this._size=0,this._comparator=st}return Kt.prototype.insert=function(st,nt){return this._size++,this._root=ht(st,nt,this._root,this._comparator)},Kt.prototype.add=function(st,nt){var ot=new Tt(st,nt);null===this._root&&(ot.left=ot.right=null,this._size++,this._root=ot);var Rt=this._comparator,ce=lt(st,this._root,Rt),De=Rt(st,ce.key);return 0===De?this._root=ce:(De<0?(ot.left=ce.left,ot.right=ce,ce.left=null):De>0&&(ot.right=ce.right,ot.left=ce,ce.right=null),this._size++,this._root=ot),this._root},Kt.prototype.remove=function(st){this._root=this._remove(st,this._root,this._comparator)},Kt.prototype._remove=function(st,nt,ot){var Rt;return null===nt?null:0===ot(st,(nt=lt(st,nt,ot)).key)?(null===nt.left?Rt=nt.right:(Rt=lt(st,nt.left,ot)).right=nt.right,this._size--,Rt):nt},Kt.prototype.pop=function(){var st=this._root;if(st){for(;st.left;)st=st.left;return this._root=lt(st.key,this._root,this._comparator),this._root=this._remove(st.key,this._root,this._comparator),{key:st.key,data:st.data}}return null},Kt.prototype.findStatic=function(st){for(var nt=this._root,ot=this._comparator;nt;){var Rt=ot(st,nt.key);if(0===Rt)return nt;nt=Rt<0?nt.left:nt.right}return null},Kt.prototype.find=function(st){return this._root&&(this._root=lt(st,this._root,this._comparator),0!==this._comparator(st,this._root.key))?null:this._root},Kt.prototype.contains=function(st){for(var nt=this._root,ot=this._comparator;nt;){var Rt=ot(st,nt.key);if(0===Rt)return!0;nt=Rt<0?nt.left:nt.right}return!1},Kt.prototype.forEach=function(st,nt){for(var ot=this._root,Rt=[],ce=!1;!ce;)null!==ot?(Rt.push(ot),ot=ot.left):0!==Rt.length?(ot=Rt.pop(),st.call(nt,ot),ot=ot.right):ce=!0;return this},Kt.prototype.range=function(st,nt,ot,Rt){for(var ce=[],De=this._comparator,Qe=this._root;0!==ce.length||Qe;)if(Qe)ce.push(Qe),Qe=Qe.left;else{if(De((Qe=ce.pop()).key,nt)>0)break;if(De(Qe.key,st)>=0&&ot.call(Rt,Qe))return this;Qe=Qe.right}return this},Kt.prototype.keys=function(){var st=[];return this.forEach(function(nt){return st.push(nt.key)}),st},Kt.prototype.values=function(){var st=[];return this.forEach(function(nt){return st.push(nt.data)}),st},Kt.prototype.min=function(){return this._root?this.minNode(this._root).key:null},Kt.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},Kt.prototype.minNode=function(st){if(void 0===st&&(st=this._root),st)for(;st.left;)st=st.left;return st},Kt.prototype.maxNode=function(st){if(void 0===st&&(st=this._root),st)for(;st.right;)st=st.right;return st},Kt.prototype.at=function(st){for(var nt=this._root,ot=!1,Rt=0,ce=[];!ot;)if(nt)ce.push(nt),nt=nt.left;else if(ce.length>0){if(nt=ce.pop(),Rt===st)return nt;Rt++,nt=nt.right}else ot=!0;return null},Kt.prototype.next=function(st){var nt=this._root,ot=null;if(st.right){for(ot=st.right;ot.left;)ot=ot.left;return ot}for(var Rt=this._comparator;nt;){var ce=Rt(st.key,nt.key);if(0===ce)break;ce<0?(ot=nt,nt=nt.left):nt=nt.right}return ot},Kt.prototype.prev=function(st){var nt=this._root,ot=null;if(null!==st.left){for(ot=st.left;ot.right;)ot=ot.right;return ot}for(var Rt=this._comparator;nt;){var ce=Rt(st.key,nt.key);if(0===ce)break;ce<0?nt=nt.left:(ot=nt,nt=nt.right)}return ot},Kt.prototype.clear=function(){return this._root=null,this._size=0,this},Kt.prototype.toList=function(){return function xt(Kt){for(var st=Kt,nt=[],ot=!1,Rt=new Tt(null,null),ce=Rt;!ot;)st?(nt.push(st),st=st.left):nt.length>0?st=(st=ce=ce.next=nt.pop()).right:ot=!0;return ce.next=null,Rt.next}(this._root)},Kt.prototype.load=function(st,nt,ot){void 0===nt&&(nt=[]),void 0===ot&&(ot=!1);var Rt=st.length,ce=this._comparator;if(ot&&Z(st,nt,0,Rt-1,ce),null===this._root)this._root=_e(st,nt,0,Rt),this._size=Rt;else{var De=function ge(Kt,st,nt){for(var ot=new Tt(null,null),Rt=ot,ce=Kt,De=st;null!==ce&&null!==De;)nt(ce.key,De.key)<0?(Rt.next=ce,ce=ce.next):(Rt.next=De,De=De.next),Rt=Rt.next;return null!==ce?Rt.next=ce:null!==De&&(Rt.next=De),ot.next}(this.toList(),function yt(Kt,st){for(var nt=new Tt(null,null),ot=nt,Rt=0;Rt<Kt.length;Rt++)ot=ot.next=new Tt(Kt[Rt],st[Rt]);return ot.next=null,nt.next}(st,nt),ce);this._root=Yt({head:De},0,Rt=this._size+Rt)}return this},Kt.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(Kt.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(Kt.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),Kt.prototype.toString=function(st){void 0===st&&(st=function(Rt){return String(Rt.key)});var nt=[];return $t(this._root,"",!0,function(ot){return nt.push(ot)},st),nt.join("")},Kt.prototype.update=function(st,nt,ot){var Rt=this._comparator,ce=Lt(st,this._root,Rt),De=ce.left,Qe=ce.right;Rt(st,nt)<0?Qe=ht(nt,ot,Qe,Rt):De=ht(nt,ot,De,Rt),this._root=function Nt(Kt,st,nt){return null===st?Kt:(null===Kt||((st=lt(Kt.key,st,nt)).left=Kt),st)}(De,Qe,Rt)},Kt.prototype.split=function(st){return Lt(st,this._root,this._comparator)},Kt}();function _e(Kt,st,nt,ot){var Rt=ot-nt;if(Rt>0){var ce=nt+Math.floor(Rt/2),nr=new Tt(Kt[ce],st[ce]);return nr.left=_e(Kt,st,nt,ce),nr.right=_e(Kt,st,ce+1,ot),nr}return null}function Yt(Kt,st,nt){var ot=nt-st;if(ot>0){var Rt=st+Math.floor(ot/2),ce=Yt(Kt,st,Rt),De=Kt.head;return De.left=ce,Kt.head=Kt.head.next,De.right=Yt(Kt,Rt+1,nt),De}return null}function Z(Kt,st,nt,ot,Rt){if(!(nt>=ot)){for(var ce=Kt[nt+ot>>1],De=nt-1,Qe=ot+1;;){do{De++}while(Rt(Kt[De],ce)<0);do{Qe--}while(Rt(Kt[Qe],ce)>0);if(De>=Qe)break;var nr=Kt[De];Kt[De]=Kt[Qe],Kt[Qe]=nr,nr=st[De],st[De]=st[Qe],st[Qe]=nr}Z(Kt,st,nt,Qe,Rt),Z(Kt,st,Qe+1,ot,Rt)}}var it=function(st,nt){return st.ll.x<=nt.x&&nt.x<=st.ur.x&&st.ll.y<=nt.y&&nt.y<=st.ur.y},$=function(st,nt){return nt.ur.x<st.ll.x||st.ur.x<nt.ll.x||nt.ur.y<st.ll.y||st.ur.y<nt.ll.y?null:{ll:{x:st.ll.x<nt.ll.x?nt.ll.x:st.ll.x,y:st.ll.y<nt.ll.y?nt.ll.y:st.ll.y},ur:{x:st.ur.x<nt.ur.x?st.ur.x:nt.ur.x,y:st.ur.y<nt.ur.y?st.ur.y:nt.ur.y}}},tt=Number.EPSILON;void 0===tt&&(tt=Math.pow(2,-52));var X=tt*tt,rt=function(st,nt){if(-tt<st&&st<tt&&-tt<nt&&nt<tt)return 0;var ot=st-nt;return ot*ot<X*st*nt?0:st<nt?-1:1},H=function(){function Kt(){he(this,Kt),this.reset()}return dt(Kt,[{key:"reset",value:function(){this.xRounder=new et,this.yRounder=new et}},{key:"round",value:function(nt,ot){return{x:this.xRounder.round(nt),y:this.yRounder.round(ot)}}}]),Kt}(),et=function(){function Kt(){he(this,Kt),this.tree=new qt,this.round(0)}return dt(Kt,[{key:"round",value:function(nt){var ot=this.tree.add(nt),Rt=this.tree.prev(ot);if(null!==Rt&&0===rt(ot.key,Rt.key))return this.tree.remove(nt),Rt.key;var ce=this.tree.next(ot);return null!==ce&&0===rt(ot.key,ce.key)?(this.tree.remove(nt),ce.key):nt}}]),Kt}(),at=new H,j=function(st,nt){return st.x*nt.y-st.y*nt.x},Wt=function(st,nt){return st.x*nt.x+st.y*nt.y},Ct=function(st,nt,ot){var De=j({x:nt.x-st.x,y:nt.y-st.y},{x:ot.x-st.x,y:ot.y-st.y});return rt(De,0)},kt=function(st){return Math.sqrt(Wt(st,st))},gt=function(st,nt,ot){var Rt={x:nt.x-st.x,y:nt.y-st.y},ce={x:ot.x-st.x,y:ot.y-st.y};return j(ce,Rt)/kt(ce)/kt(Rt)},Fe=function(st,nt,ot){var Rt={x:nt.x-st.x,y:nt.y-st.y},ce={x:ot.x-st.x,y:ot.y-st.y};return Wt(ce,Rt)/kt(ce)/kt(Rt)},Ie=function(st,nt,ot){return 0===nt.y?null:{x:st.x+nt.x/nt.y*(ot-st.y),y:ot}},It=function(st,nt,ot){return 0===nt.x?null:{x:ot,y:st.y+nt.y/nt.x*(ot-st.x)}},Pt=function(){function Kt(st,nt){he(this,Kt),void 0===st.events?st.events=[this]:st.events.push(this),this.point=st,this.isLeft=nt}return dt(Kt,null,[{key:"compare",value:function(nt,ot){var Rt=Kt.comparePoints(nt.point,ot.point);return 0!==Rt?Rt:(nt.point!==ot.point&&nt.link(ot),nt.isLeft!==ot.isLeft?nt.isLeft?1:-1:le.compare(nt.segment,ot.segment))}},{key:"comparePoints",value:function(nt,ot){return nt.x<ot.x?-1:nt.x>ot.x?1:nt.y<ot.y?-1:nt.y>ot.y?1:0}}]),dt(Kt,[{key:"link",value:function(nt){if(nt.point===this.point)throw new Error("Tried to link already linked events");for(var ot=nt.point.events,Rt=0,ce=ot.length;Rt<ce;Rt++){var De=ot[Rt];this.point.events.push(De),De.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var nt=this.point.events.length,ot=0;ot<nt;ot++){var Rt=this.point.events[ot];if(void 0===Rt.segment.consumedBy)for(var ce=ot+1;ce<nt;ce++){var De=this.point.events[ce];void 0===De.consumedBy&&Rt.otherSE.point.events===De.otherSE.point.events&&Rt.segment.consume(De.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var nt=[],ot=0,Rt=this.point.events.length;ot<Rt;ot++){var ce=this.point.events[ot];ce!==this&&!ce.segment.ringOut&&ce.segment.isInResult()&&nt.push(ce)}return nt}},{key:"getLeftmostComparator",value:function(nt){var ot=this,Rt=new Map,ce=function(Qe){var nr=Qe.otherSE;Rt.set(Qe,{sine:gt(ot.point,nt.point,nr.point),cosine:Fe(ot.point,nt.point,nr.point)})};return function(De,Qe){Rt.has(De)||ce(De),Rt.has(Qe)||ce(Qe);var nr=Rt.get(De),Xe=nr.sine,pn=nr.cosine,Kr=Rt.get(Qe),pr=Kr.sine,un=Kr.cosine;return Xe>=0&&pr>=0?pn<un?1:pn>un?-1:0:Xe<0&&pr<0?pn<un?-1:pn>un?1:0:pr<Xe?-1:pr>Xe?1:0}}}]),Kt}(),te=0,le=function(){function Kt(st,nt,ot,Rt){he(this,Kt),this.id=++te,this.leftSE=st,st.segment=this,st.otherSE=nt,this.rightSE=nt,nt.segment=this,nt.otherSE=st,this.rings=ot,this.windings=Rt}return dt(Kt,null,[{key:"compare",value:function(nt,ot){var Rt=nt.leftSE.point.x,ce=ot.leftSE.point.x,De=nt.rightSE.point.x,Qe=ot.rightSE.point.x;if(Qe<Rt)return 1;if(De<ce)return-1;var nr=nt.leftSE.point.y,Xe=ot.leftSE.point.y,pn=nt.rightSE.point.y,Kr=ot.rightSE.point.y;if(Rt<ce){if(Xe<nr&&Xe<pn)return 1;if(Xe>nr&&Xe>pn)return-1;var pr=nt.comparePoint(ot.leftSE.point);if(pr<0)return 1;if(pr>0)return-1;var un=ot.comparePoint(nt.rightSE.point);return 0!==un?un:-1}if(Rt>ce){if(nr<Xe&&nr<Kr)return-1;if(nr>Xe&&nr>Kr)return 1;var ei=ot.comparePoint(nt.leftSE.point);if(0!==ei)return ei;var Kn=nt.comparePoint(ot.rightSE.point);return Kn<0?1:Kn>0?-1:1}if(nr<Xe)return-1;if(nr>Xe)return 1;if(De<Qe){var Gn=ot.comparePoint(nt.rightSE.point);if(0!==Gn)return Gn}if(De>Qe){var Mn=nt.comparePoint(ot.rightSE.point);if(Mn<0)return 1;if(Mn>0)return-1}if(De!==Qe){var on=pn-nr,bi=De-Rt,To=Kr-Xe,oa=Qe-ce;if(on>bi&&To<oa)return 1;if(on<bi&&To>oa)return-1}return De>Qe?1:De<Qe||pn<Kr?-1:pn>Kr?1:nt.id<ot.id?-1:nt.id>ot.id?1:0}}]),dt(Kt,[{key:"replaceRightSE",value:function(nt){this.rightSE=nt,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var nt=this.leftSE.point.y,ot=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:nt<ot?nt:ot},ur:{x:this.rightSE.point.x,y:nt>ot?nt:ot}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(nt){return nt.x===this.leftSE.point.x&&nt.y===this.leftSE.point.y||nt.x===this.rightSE.point.x&&nt.y===this.rightSE.point.y}},{key:"comparePoint",value:function(nt){if(this.isAnEndpoint(nt))return 0;var ot=this.leftSE.point,Rt=this.rightSE.point,ce=this.vector();if(ot.x===Rt.x)return nt.x===ot.x?0:nt.x<ot.x?1:-1;if(nt.x===ot.x+(nt.y-ot.y)/ce.y*ce.x)return 0;var Xe=ot.y+(nt.x-ot.x)/ce.x*ce.y;return nt.y===Xe?0:nt.y<Xe?-1:1}},{key:"getIntersection",value:function(nt){var ot=this.bbox(),Rt=nt.bbox(),ce=$(ot,Rt);if(null===ce)return null;var De=this.leftSE.point,Qe=this.rightSE.point,nr=nt.leftSE.point,Xe=nt.rightSE.point,pn=it(ot,nr)&&0===this.comparePoint(nr),Kr=it(Rt,De)&&0===nt.comparePoint(De),pr=it(ot,Xe)&&0===this.comparePoint(Xe),un=it(Rt,Qe)&&0===nt.comparePoint(Qe);if(Kr&&pn)return un&&!pr?Qe:!un&&pr?Xe:null;if(Kr)return pr&&De.x===Xe.x&&De.y===Xe.y?null:De;if(pn)return un&&Qe.x===nr.x&&Qe.y===nr.y?null:nr;if(un&&pr)return null;if(un)return Qe;if(pr)return Xe;var ei=function(st,nt,ot,Rt){if(0===nt.x)return It(ot,Rt,st.x);if(0===Rt.x)return It(st,nt,ot.x);if(0===nt.y)return Ie(ot,Rt,st.y);if(0===Rt.y)return Ie(st,nt,ot.y);var ce=j(nt,Rt);if(0==ce)return null;var De={x:ot.x-st.x,y:ot.y-st.y},Qe=j(De,nt)/ce,nr=j(De,Rt)/ce;return{x:(st.x+nr*nt.x+(ot.x+Qe*Rt.x))/2,y:(st.y+nr*nt.y+(ot.y+Qe*Rt.y))/2}}(De,this.vector(),nr,nt.vector());return null!==ei&&it(ce,ei)?at.round(ei.x,ei.y):null}},{key:"split",value:function(nt){var ot=[],Rt=void 0!==nt.events,ce=new Pt(nt,!0),De=new Pt(nt,!1),Qe=this.rightSE;this.replaceRightSE(De),ot.push(De),ot.push(ce);var nr=new Kt(ce,Qe,this.rings.slice(),this.windings.slice());return Pt.comparePoints(nr.leftSE.point,nr.rightSE.point)>0&&nr.swapEvents(),Pt.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),Rt&&(ce.checkForConsuming(),De.checkForConsuming()),ot}},{key:"swapEvents",value:function(){var nt=this.rightSE;this.rightSE=this.leftSE,this.leftSE=nt,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var ot=0,Rt=this.windings.length;ot<Rt;ot++)this.windings[ot]*=-1}},{key:"consume",value:function(nt){for(var ot=this,Rt=nt;ot.consumedBy;)ot=ot.consumedBy;for(;Rt.consumedBy;)Rt=Rt.consumedBy;var ce=Kt.compare(ot,Rt);if(0!==ce){if(ce>0){var De=ot;ot=Rt,Rt=De}if(ot.prev===Rt){var Qe=ot;ot=Rt,Rt=Qe}for(var nr=0,Xe=Rt.rings.length;nr<Xe;nr++){var pn=Rt.rings[nr],Kr=Rt.windings[nr],pr=ot.rings.indexOf(pn);-1===pr?(ot.rings.push(pn),ot.windings.push(Kr)):ot.windings[pr]+=Kr}Rt.rings=null,Rt.windings=null,Rt.consumedBy=ot,Rt.leftSE.consumedBy=ot.leftSE,Rt.rightSE.consumedBy=ot.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult||(this._prevInResult=this.prev?this.prev.isInResult()?this.prev:this.prev.prevInResult():null),this._prevInResult}},{key:"beforeState",value:function(){return void 0!==this._beforeState||(this._beforeState=this.prev?(this.prev.consumedBy||this.prev).afterState():{rings:[],windings:[],multiPolys:[]}),this._beforeState}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var nt=this.beforeState();this._afterState={rings:nt.rings.slice(0),windings:nt.windings.slice(0),multiPolys:[]};for(var ot=this._afterState.rings,Rt=this._afterState.windings,ce=this._afterState.multiPolys,De=0,Qe=this.rings.length;De<Qe;De++){var nr=this.rings[De],Xe=this.windings[De],pn=ot.indexOf(nr);-1===pn?(ot.push(nr),Rt.push(Xe)):Rt[pn]+=Xe}for(var Kr=[],pr=[],un=0,ei=ot.length;un<ei;un++)if(0!==Rt[un]){var Kn=ot[un],Gn=Kn.poly;if(-1===pr.indexOf(Gn))if(Kn.isExterior)Kr.push(Gn);else{-1===pr.indexOf(Gn)&&pr.push(Gn);var Mn=Kr.indexOf(Kn.poly);-1!==Mn&&Kr.splice(Mn,1)}}for(var on=0,bi=Kr.length;on<bi;on++){var To=Kr[on].multiPoly;-1===ce.indexOf(To)&&ce.push(To)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var nt=this.beforeState().multiPolys,ot=this.afterState().multiPolys;switch(qe.type){case"union":this._isInResult=0===nt.length!=(0===ot.length);break;case"intersection":var De,Qe;nt.length<ot.length?(De=nt.length,Qe=ot.length):(De=ot.length,Qe=nt.length),this._isInResult=Qe===qe.numMultiPolys&&De<Qe;break;case"xor":var nr=Math.abs(nt.length-ot.length);this._isInResult=nr%2==1;break;case"difference":var Xe=function(Kr){return 1===Kr.length&&Kr[0].isSubject};this._isInResult=Xe(nt)!==Xe(ot);break;default:throw new Error("Unrecognized operation type found ".concat(qe.type))}return this._isInResult}}],[{key:"fromRing",value:function(nt,ot,Rt){var ce,De,Qe,nr=Pt.comparePoints(nt,ot);if(nr<0)ce=nt,De=ot,Qe=1;else{if(!(nr>0))throw new Error("Tried to create degenerate segment at [".concat(nt.x,", ").concat(nt.y,"]"));ce=ot,De=nt,Qe=-1}return new Kt(new Pt(ce,!0),new Pt(De,!1),[Rt],[Qe])}}]),Kt}(),Ot=function(){function Kt(st,nt,ot){if(he(this,Kt),!Array.isArray(st)||0===st.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=nt,this.isExterior=ot,this.segments=[],"number"!=typeof st[0][0]||"number"!=typeof st[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var Rt=at.round(st[0][0],st[0][1]);this.bbox={ll:{x:Rt.x,y:Rt.y},ur:{x:Rt.x,y:Rt.y}};for(var ce=Rt,De=1,Qe=st.length;De<Qe;De++){if("number"!=typeof st[De][0]||"number"!=typeof st[De][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var nr=at.round(st[De][0],st[De][1]);nr.x===ce.x&&nr.y===ce.y||(this.segments.push(le.fromRing(ce,nr,this)),nr.x<this.bbox.ll.x&&(this.bbox.ll.x=nr.x),nr.y<this.bbox.ll.y&&(this.bbox.ll.y=nr.y),nr.x>this.bbox.ur.x&&(this.bbox.ur.x=nr.x),nr.y>this.bbox.ur.y&&(this.bbox.ur.y=nr.y),ce=nr)}(Rt.x!==ce.x||Rt.y!==ce.y)&&this.segments.push(le.fromRing(ce,Rt,this))}return dt(Kt,[{key:"getSweepEvents",value:function(){for(var nt=[],ot=0,Rt=this.segments.length;ot<Rt;ot++){var ce=this.segments[ot];nt.push(ce.leftSE),nt.push(ce.rightSE)}return nt}}]),Kt}(),Ue=function(){function Kt(st,nt){if(he(this,Kt),!Array.isArray(st))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Ot(st[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var ot=1,Rt=st.length;ot<Rt;ot++){var ce=new Ot(st[ot],this,!1);ce.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=ce.bbox.ll.x),ce.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=ce.bbox.ll.y),ce.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=ce.bbox.ur.x),ce.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=ce.bbox.ur.y),this.interiorRings.push(ce)}this.multiPoly=nt}return dt(Kt,[{key:"getSweepEvents",value:function(){for(var nt=this.exteriorRing.getSweepEvents(),ot=0,Rt=this.interiorRings.length;ot<Rt;ot++)for(var ce=this.interiorRings[ot].getSweepEvents(),De=0,Qe=ce.length;De<Qe;De++)nt.push(ce[De]);return nt}}]),Kt}(),ze=function(){function Kt(st,nt){if(he(this,Kt),!Array.isArray(st))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof st[0][0][0]&&(st=[st])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var ot=0,Rt=st.length;ot<Rt;ot++){var ce=new Ue(st[ot],this);ce.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=ce.bbox.ll.x),ce.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=ce.bbox.ll.y),ce.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=ce.bbox.ur.x),ce.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=ce.bbox.ur.y),this.polys.push(ce)}this.isSubject=nt}return dt(Kt,[{key:"getSweepEvents",value:function(){for(var nt=[],ot=0,Rt=this.polys.length;ot<Rt;ot++)for(var ce=this.polys[ot].getSweepEvents(),De=0,Qe=ce.length;De<Qe;De++)nt.push(ce[De]);return nt}}]),Kt}(),ar=function(){function Kt(st){he(this,Kt),this.events=st;for(var nt=0,ot=st.length;nt<ot;nt++)st[nt].segment.ringOut=this;this.poly=null}return dt(Kt,null,[{key:"factory",value:function(nt){for(var ot=[],Rt=0,ce=nt.length;Rt<ce;Rt++){var De=nt[Rt];if(De.isInResult()&&!De.ringOut){for(var Qe=null,nr=De.leftSE,Xe=De.rightSE,pn=[nr],Kr=nr.point,pr=[];Qe=nr,pn.push(nr=Xe),nr.point!==Kr;)for(;;){var un=nr.getAvailableLinkedEvents();if(0===un.length){var ei=pn[0].point,Kn=pn[pn.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(ei.x,",")+" ".concat(ei.y,"]. Last matching segment found ends at")+" [".concat(Kn.x,", ").concat(Kn.y,"]."))}if(1===un.length){Xe=un[0].otherSE;break}for(var Gn=null,Mn=0,on=pr.length;Mn<on;Mn++)if(pr[Mn].point===nr.point){Gn=Mn;break}if(null===Gn){pr.push({index:pn.length,point:nr.point});var oa=nr.getLeftmostComparator(Qe);Xe=un.sort(oa)[0].otherSE;break}var bi=pr.splice(Gn)[0],To=pn.splice(bi.index);To.unshift(To[0].otherSE),ot.push(new Kt(To.reverse()))}ot.push(new Kt(pn))}}return ot}}]),dt(Kt,[{key:"getGeom",value:function(){for(var nt=this.events[0].point,ot=[nt],Rt=1,ce=this.events.length-1;Rt<ce;Rt++){var De=this.events[Rt].point;0!==Ct(De,nt,this.events[Rt+1].point)&&(ot.push(De),nt=De)}if(1===ot.length)return null;0===Ct(ot[0],nt,ot[1])&&ot.shift(),ot.push(ot[0]);for(var pn=this.isExteriorRing()?1:-1,Kr=this.isExteriorRing()?0:ot.length-1,pr=this.isExteriorRing()?ot.length:-1,un=[],ei=Kr;ei!=pr;ei+=pn)un.push([ot[ei].x,ot[ei].y]);return un}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var nt=this.enclosingRing();this._isExteriorRing=!nt||!nt.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var nt=this.events[0],ot=1,Rt=this.events.length;ot<Rt;ot++){var ce=this.events[ot];Pt.compare(nt,ce)>0&&(nt=ce)}for(var De=nt.segment.prevInResult(),Qe=De?De.prevInResult():null;;){if(!De)return null;if(!Qe)return De.ringOut;if(Qe.ringOut!==De.ringOut)return Qe.ringOut.enclosingRing()!==De.ringOut?De.ringOut:De.ringOut.enclosingRing();De=Qe.prevInResult(),Qe=De?De.prevInResult():null}}}]),Kt}(),Me=function(){function Kt(st){he(this,Kt),this.exteriorRing=st,st.poly=this,this.interiorRings=[]}return dt(Kt,[{key:"addInterior",value:function(nt){this.interiorRings.push(nt),nt.poly=this}},{key:"getGeom",value:function(){var nt=[this.exteriorRing.getGeom()];if(null===nt[0])return null;for(var ot=0,Rt=this.interiorRings.length;ot<Rt;ot++){var ce=this.interiorRings[ot].getGeom();null!==ce&&nt.push(ce)}return nt}}]),Kt}(),Mr=function(){function Kt(st){he(this,Kt),this.rings=st,this.polys=this._composePolys(st)}return dt(Kt,[{key:"getGeom",value:function(){for(var nt=[],ot=0,Rt=this.polys.length;ot<Rt;ot++){var ce=this.polys[ot].getGeom();null!==ce&&nt.push(ce)}return nt}},{key:"_composePolys",value:function(nt){for(var ot=[],Rt=0,ce=nt.length;Rt<ce;Rt++){var De=nt[Rt];if(!De.poly)if(De.isExteriorRing())ot.push(new Me(De));else{var Qe=De.enclosingRing();Qe.poly||ot.push(new Me(Qe)),Qe.poly.addInterior(De)}}return ot}}]),Kt}(),lr=function(){function Kt(st){var nt=arguments.length>1&&void 0!==arguments[1]?arguments[1]:le.compare;he(this,Kt),this.queue=st,this.tree=new qt(nt),this.segments=[]}return dt(Kt,[{key:"process",value:function(nt){var ot=nt.segment,Rt=[];if(nt.consumedBy)return nt.isLeft?this.queue.remove(nt.otherSE):this.tree.remove(ot),Rt;var ce=nt.isLeft?this.tree.insert(ot):this.tree.find(ot);if(!ce)throw new Error("Unable to find segment #".concat(ot.id," ")+"[".concat(ot.leftSE.point.x,", ").concat(ot.leftSE.point.y,"] -> ")+"[".concat(ot.rightSE.point.x,", ").concat(ot.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var De=ce,Qe=ce,nr=void 0,Xe=void 0;void 0===nr;)null===(De=this.tree.prev(De))?nr=null:void 0===De.key.consumedBy&&(nr=De.key);for(;void 0===Xe;)null===(Qe=this.tree.next(Qe))?Xe=null:void 0===Qe.key.consumedBy&&(Xe=Qe.key);if(nt.isLeft){var pn=null;if(nr){var Kr=nr.getIntersection(ot);if(null!==Kr&&(ot.isAnEndpoint(Kr)||(pn=Kr),!nr.isAnEndpoint(Kr)))for(var pr=this._splitSafely(nr,Kr),un=0,ei=pr.length;un<ei;un++)Rt.push(pr[un])}var Kn=null;if(Xe){var Gn=Xe.getIntersection(ot);if(null!==Gn&&(ot.isAnEndpoint(Gn)||(Kn=Gn),!Xe.isAnEndpoint(Gn)))for(var Mn=this._splitSafely(Xe,Gn),on=0,bi=Mn.length;on<bi;on++)Rt.push(Mn[on])}if(null!==pn||null!==Kn){var To;To=null===pn?Kn:null===Kn||Pt.comparePoints(pn,Kn)<=0?pn:Kn,this.queue.remove(ot.rightSE),Rt.push(ot.rightSE);for(var gi=ot.split(To),vo=0,On=gi.length;vo<On;vo++)Rt.push(gi[vo])}Rt.length>0?(this.tree.remove(ot),Rt.push(nt)):(this.segments.push(ot),ot.prev=nr)}else{if(nr&&Xe){var or=nr.getIntersection(Xe);if(null!==or){if(!nr.isAnEndpoint(or))for(var wi=this._splitSafely(nr,or),Y=0,W=wi.length;Y<W;Y++)Rt.push(wi[Y]);if(!Xe.isAnEndpoint(or))for(var pt=this._splitSafely(Xe,or),bt=0,Ft=pt.length;bt<Ft;bt++)Rt.push(pt[bt])}}this.tree.remove(ot)}return Rt}},{key:"_splitSafely",value:function(nt,ot){this.tree.remove(nt);var Rt=nt.rightSE;this.queue.remove(Rt);var ce=nt.split(ot);return ce.push(Rt),void 0===nt.consumedBy&&this.tree.insert(nt),ce}}]),Kt}(),kr=typeof process<"u"&&process.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,Xr=typeof process<"u"&&process.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,qe=new(function(){function Kt(){he(this,Kt)}return dt(Kt,[{key:"run",value:function(nt,ot,Rt){qe.type=nt,at.reset();for(var ce=[new ze(ot,!0)],De=0,Qe=Rt.length;De<Qe;De++)ce.push(new ze(Rt[De],!1));if(qe.numMultiPolys=ce.length,"difference"===qe.type)for(var nr=ce[0],Xe=1;Xe<ce.length;)null!==$(ce[Xe].bbox,nr.bbox)?Xe++:ce.splice(Xe,1);if("intersection"===qe.type)for(var pn=0,Kr=ce.length;pn<Kr;pn++)for(var pr=ce[pn],un=pn+1,ei=ce.length;un<ei;un++)if(null===$(pr.bbox,ce[un].bbox))return[];for(var Kn=new qt(Pt.compare),Gn=0,Mn=ce.length;Gn<Mn;Gn++)for(var on=ce[Gn].getSweepEvents(),bi=0,To=on.length;bi<To;bi++)if(Kn.insert(on[bi]),Kn.size>kr)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var oa=new lr(Kn),gi=Kn.size,vo=Kn.pop();vo;){var On=vo.key;if(Kn.size===gi){var or=On.segment;throw new Error("Unable to pop() ".concat(On.isLeft?"left":"right"," SweepEvent ")+"[".concat(On.point.x,", ").concat(On.point.y,"] from segment #").concat(or.id," ")+"[".concat(or.leftSE.point.x,", ").concat(or.leftSE.point.y,"] -> ")+"[".concat(or.rightSE.point.x,", ").concat(or.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(Kn.size>kr)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(oa.segments.length>Xr)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var wi=oa.process(On),Y=0,W=wi.length;Y<W;Y++){var pt=wi[Y];void 0===pt.consumedBy&&Kn.insert(pt)}gi=Kn.size,vo=Kn.pop()}at.reset();var bt=ar.factory(oa.segments);return new Mr(bt).getGeom()}}]),Kt}());return{union:function(st){for(var nt=arguments.length,ot=new Array(nt>1?nt-1:0),Rt=1;Rt<nt;Rt++)ot[Rt-1]=arguments[Rt];return qe.run("union",st,ot)},intersection:function(st){for(var nt=arguments.length,ot=new Array(nt>1?nt-1:0),Rt=1;Rt<nt;Rt++)ot[Rt-1]=arguments[Rt];return qe.run("intersection",st,ot)},xor:function(st){for(var nt=arguments.length,ot=new Array(nt>1?nt-1:0),Rt=1;Rt<nt;Rt++)ot[Rt-1]=arguments[Rt];return qe.run("xor",st,ot)},difference:function(st){for(var nt=arguments.length,ot=new Array(nt>1?nt-1:0),Rt=1;Rt<nt;Rt++)ot[Rt-1]=arguments[Rt];return qe.run("difference",st,ot)}}}()},3544:(tr,he,St)=>{"use strict";tr.exports=Tt,tr.exports.default=Tt;var dt=St(6709);function Tt($,tt){if(!(this instanceof Tt))return new Tt($,tt);this._maxEntries=Math.max(4,$||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),tt&&this._initFormat(tt),this.clear()}function s($,tt,X){if(!X)return tt.indexOf($);for(var rt=0;rt<tt.length;rt++)if(X($,tt[rt]))return rt;return-1}function lt($,tt){ht($,0,$.children.length,tt,$)}function ht($,tt,X,rt,H){H||(H=Z(null)),H.minX=1/0,H.minY=1/0,H.maxX=-1/0,H.maxY=-1/0;for(var at,et=tt;et<X;et++)at=$.children[et],Lt(H,$.leaf?rt(at):at);return H}function Lt($,tt){return $.minX=Math.min($.minX,tt.minX),$.minY=Math.min($.minY,tt.minY),$.maxX=Math.max($.maxX,tt.maxX),$.maxY=Math.max($.maxY,tt.maxY),$}function Nt($,tt){return $.minX-tt.minX}function $t($,tt){return $.minY-tt.minY}function qt($){return($.maxX-$.minX)*($.maxY-$.minY)}function _e($){return $.maxX-$.minX+($.maxY-$.minY)}function yt($,tt){return(Math.max(tt.maxX,$.maxX)-Math.min(tt.minX,$.minX))*(Math.max(tt.maxY,$.maxY)-Math.min(tt.minY,$.minY))}function xt($,tt){var X=Math.max($.minX,tt.minX),rt=Math.max($.minY,tt.minY),H=Math.min($.maxX,tt.maxX),et=Math.min($.maxY,tt.maxY);return Math.max(0,H-X)*Math.max(0,et-rt)}function Yt($,tt){return $.minX<=tt.minX&&$.minY<=tt.minY&&tt.maxX<=$.maxX&&tt.maxY<=$.maxY}function ge($,tt){return tt.minX<=$.maxX&&tt.minY<=$.maxY&&tt.maxX>=$.minX&&tt.maxY>=$.minY}function Z($){return{children:$,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function it($,tt,X,rt,H){for(var at,et=[tt,X];et.length;)!((X=et.pop())-(tt=et.pop())<=rt)&&(at=tt+Math.ceil((X-tt)/rt/2)*rt,dt($,at,tt,X,H),et.push(tt,at,at,X))}Tt.prototype={all:function(){return this._all(this.data,[])},search:function($){var tt=this.data,X=[],rt=this.toBBox;if(!ge($,tt))return X;for(var et,at,j,Wt,H=[];tt;){for(et=0,at=tt.children.length;et<at;et++)j=tt.children[et],ge($,Wt=tt.leaf?rt(j):j)&&(tt.leaf?X.push(j):Yt($,Wt)?this._all(j,X):H.push(j));tt=H.pop()}return X},collides:function($){var tt=this.data,X=this.toBBox;if(!ge($,tt))return!1;for(var H,et,at,j,rt=[];tt;){for(H=0,et=tt.children.length;H<et;H++)if(at=tt.children[H],ge($,j=tt.leaf?X(at):at)){if(tt.leaf||Yt($,j))return!0;rt.push(at)}tt=rt.pop()}return!1},load:function($){if(!$||!$.length)return this;if($.length<this._minEntries){for(var tt=0,X=$.length;tt<X;tt++)this.insert($[tt]);return this}var rt=this._build($.slice(),0,$.length-1,0);if(this.data.children.length)if(this.data.height===rt.height)this._splitRoot(this.data,rt);else{if(this.data.height<rt.height){var H=this.data;this.data=rt,rt=H}this._insert(rt,this.data.height-rt.height-1,!0)}else this.data=rt;return this},insert:function($){return $&&this._insert($,this.data.height-1),this},clear:function(){return this.data=Z([]),this},remove:function($,tt){if(!$)return this;for(var at,j,Wt,Ct,X=this.data,rt=this.toBBox($),H=[],et=[];X||H.length;){if(X||(X=H.pop(),j=H[H.length-1],at=et.pop(),Ct=!0),X.leaf&&-1!==(Wt=s($,X.children,tt)))return X.children.splice(Wt,1),H.push(X),this._condense(H),this;Ct||X.leaf||!Yt(X,rt)?j?(at++,X=j.children[at],Ct=!1):X=null:(H.push(X),et.push(at),at=0,j=X,X=X.children[0])}return this},toBBox:function($){return $},compareMinX:Nt,compareMinY:$t,toJSON:function(){return this.data},fromJSON:function($){return this.data=$,this},_all:function($,tt){for(var X=[];$;)$.leaf?tt.push.apply(tt,$.children):X.push.apply(X,$.children),$=X.pop();return tt},_build:function($,tt,X,rt){var at,H=X-tt+1,et=this._maxEntries;if(H<=et)return lt(at=Z($.slice(tt,X+1)),this.toBBox),at;rt||(rt=Math.ceil(Math.log(H)/Math.log(et)),et=Math.ceil(H/Math.pow(et,rt-1))),(at=Z([])).leaf=!1,at.height=rt;var Ct,kt,gt,Fe,j=Math.ceil(H/et),Wt=j*Math.ceil(Math.sqrt(et));for(it($,tt,X,Wt,this.compareMinX),Ct=tt;Ct<=X;Ct+=Wt)for(it($,Ct,gt=Math.min(Ct+Wt-1,X),j,this.compareMinY),kt=Ct;kt<=gt;kt+=j)Fe=Math.min(kt+j-1,gt),at.children.push(this._build($,kt,Fe,rt-1));return lt(at,this.toBBox),at},_chooseSubtree:function($,tt,X,rt){for(var H,et,at,j,Wt,Ct,kt,gt;rt.push(tt),!tt.leaf&&rt.length-1!==X;){for(kt=gt=1/0,H=0,et=tt.children.length;H<et;H++)Wt=qt(at=tt.children[H]),(Ct=yt($,at)-Wt)<gt?(gt=Ct,kt=Wt<kt?Wt:kt,j=at):Ct===gt&&Wt<kt&&(kt=Wt,j=at);tt=j||tt.children[0]}return tt},_insert:function($,tt,X){var H=X?$:(0,this.toBBox)($),et=[],at=this._chooseSubtree(H,this.data,tt,et);for(at.children.push($),Lt(at,H);tt>=0&&et[tt].children.length>this._maxEntries;)this._split(et,tt),tt--;this._adjustParentBBoxes(H,et,tt)},_split:function($,tt){var X=$[tt],rt=X.children.length,H=this._minEntries;this._chooseSplitAxis(X,H,rt);var et=this._chooseSplitIndex(X,H,rt),at=Z(X.children.splice(et,X.children.length-et));at.height=X.height,at.leaf=X.leaf,lt(X,this.toBBox),lt(at,this.toBBox),tt?$[tt-1].children.push(at):this._splitRoot(X,at)},_splitRoot:function($,tt){this.data=Z([$,tt]),this.data.height=$.height+1,this.data.leaf=!1,lt(this.data,this.toBBox)},_chooseSplitIndex:function($,tt,X){var rt,H,et,at,j,Wt,Ct,kt;for(Wt=Ct=1/0,rt=tt;rt<=X-tt;rt++)at=xt(H=ht($,0,rt,this.toBBox),et=ht($,rt,X,this.toBBox)),j=qt(H)+qt(et),at<Wt?(Wt=at,kt=rt,Ct=j<Ct?j:Ct):at===Wt&&j<Ct&&(Ct=j,kt=rt);return kt},_chooseSplitAxis:function($,tt,X){var rt=$.leaf?this.compareMinX:Nt,H=$.leaf?this.compareMinY:$t;this._allDistMargin($,tt,X,rt)<this._allDistMargin($,tt,X,H)&&$.children.sort(rt)},_allDistMargin:function($,tt,X,rt){$.children.sort(rt);var Wt,Ct,H=this.toBBox,et=ht($,0,tt,H),at=ht($,X-tt,X,H),j=_e(et)+_e(at);for(Wt=tt;Wt<X-tt;Wt++)Ct=$.children[Wt],Lt(et,$.leaf?H(Ct):Ct),j+=_e(et);for(Wt=X-tt-1;Wt>=tt;Wt--)Ct=$.children[Wt],Lt(at,$.leaf?H(Ct):Ct),j+=_e(at);return j},_adjustParentBBoxes:function($,tt,X){for(var rt=X;rt>=0;rt--)Lt(tt[rt],$)},_condense:function($){for(var X,tt=$.length-1;tt>=0;tt--)0===$[tt].children.length?tt>0?(X=$[tt-1].children).splice(X.indexOf($[tt]),1):this.clear():lt($[tt],this.toBBox)},_initFormat:function($){var tt=["return a"," - b",";"];this.compareMinX=new Function("a","b",tt.join($[0])),this.compareMinY=new Function("a","b",tt.join($[1])),this.toBBox=new Function("a","return {minX: a"+$[0]+", minY: a"+$[1]+", maxX: a"+$[2]+", maxY: a"+$[3]+"};")}}},6709:function(tr){tr.exports=function(){"use strict";function St(s,lt,ht,Lt,Nt){for(;Lt>ht;){if(Lt-ht>600){var $t=Lt-ht+1,qt=lt-ht+1,_e=Math.log($t),yt=.5*Math.exp(2*_e/3),xt=.5*Math.sqrt(_e*yt*($t-yt)/$t)*(qt-$t/2<0?-1:1);St(s,lt,Math.max(ht,Math.floor(lt-qt*yt/$t+xt)),Math.min(Lt,Math.floor(lt+($t-qt)*yt/$t+xt)),Nt)}var Z=s[lt],it=ht,$=Lt;for(dt(s,ht,lt),Nt(s[Lt],Z)>0&&dt(s,ht,Lt);it<$;){for(dt(s,it,$),it++,$--;Nt(s[it],Z)<0;)it++;for(;Nt(s[$],Z)>0;)$--}0===Nt(s[ht],Z)?dt(s,ht,$):dt(s,++$,Lt),$<=lt&&(ht=$+1),lt<=$&&(Lt=$-1)}}function dt(s,lt,ht){var Lt=s[lt];s[lt]=s[ht],s[ht]=Lt}function Tt(s,lt){return s<lt?-1:s>lt?1:0}return function he(s,lt,ht,Lt,Nt){St(s,lt,ht||0,Lt||s.length-1,Nt||Tt)}}()},4468:(tr,he,St)=>{"use strict";var dt=St(9582).functionsHaveConfigurableNames(),Tt=Object,s=TypeError;tr.exports=function(){if(null!=this&&this!==Tt(this))throw new s("RegExp.prototype.flags getter called on non-object");var ht="";return this.hasIndices&&(ht+="d"),this.global&&(ht+="g"),this.ignoreCase&&(ht+="i"),this.multiline&&(ht+="m"),this.dotAll&&(ht+="s"),this.unicode&&(ht+="u"),this.sticky&&(ht+="y"),ht},dt&&Object.defineProperty&&Object.defineProperty(tr.exports,"name",{value:"get flags"})},9235:(tr,he,St)=>{"use strict";var dt=St(2358),Tt=St(5685),s=St(4468),lt=St(6343),ht=St(1956),Lt=Tt(lt());dt(Lt,{getPolyfill:lt,implementation:s,shim:ht}),tr.exports=Lt},6343:(tr,he,St)=>{"use strict";var dt=St(4468),Tt=St(2358).supportsDescriptors,s=Object.getOwnPropertyDescriptor;tr.exports=function(){if(Tt&&"gim"===/a/gim.flags){var ht=s(RegExp.prototype,"flags");if(ht&&"function"==typeof ht.get&&"boolean"==typeof RegExp.prototype.dotAll&&"boolean"==typeof RegExp.prototype.hasIndices){var Lt="",Nt={};if(Object.defineProperty(Nt,"hasIndices",{get:function(){Lt+="d"}}),Object.defineProperty(Nt,"sticky",{get:function(){Lt+="y"}}),"dy"===Lt)return ht.get}}return dt}},1956:(tr,he,St)=>{"use strict";var dt=St(2358).supportsDescriptors,Tt=St(6343),s=Object.getOwnPropertyDescriptor,lt=Object.defineProperty,ht=TypeError,Lt=Object.getPrototypeOf,Nt=/a/;tr.exports=function(){if(!dt||!Lt)throw new ht("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var qt=Tt(),_e=Lt(Nt),yt=s(_e,"flags");return(!yt||yt.get!==qt)&&lt(_e,"flags",{configurable:!0,enumerable:!1,get:qt}),qt}},7563:function(tr,he){!function(St){"use strict";function s(Yt,ge,Z,it,$){let tt,X,rt,H,et=ge[0],at=it[0],j=0,Wt=0;at>et==at>-et?(tt=et,et=ge[++j]):(tt=at,at=it[++Wt]);let Ct=0;if(j<Yt&&Wt<Z)for(at>et==at>-et?(rt=tt-((X=et+tt)-et),et=ge[++j]):(rt=tt-((X=at+tt)-at),at=it[++Wt]),tt=X,0!==rt&&($[Ct++]=rt);j<Yt&&Wt<Z;)at>et==at>-et?(rt=tt-((X=tt+et)-(H=X-tt))+(et-H),et=ge[++j]):(rt=tt-((X=tt+at)-(H=X-tt))+(at-H),at=it[++Wt]),tt=X,0!==rt&&($[Ct++]=rt);for(;j<Yt;)rt=tt-((X=tt+et)-(H=X-tt))+(et-H),et=ge[++j],tt=X,0!==rt&&($[Ct++]=rt);for(;Wt<Z;)rt=tt-((X=tt+at)-(H=X-tt))+(at-H),at=it[++Wt],tt=X,0!==rt&&($[Ct++]=rt);return 0===tt&&0!==Ct||($[Ct++]=tt),Ct}function lt(Yt){return new Float64Array(Yt)}const $t=lt(4),qt=lt(8),_e=lt(12),yt=lt(16),xt=lt(4);St.orient2d=function(Yt,ge,Z,it,$,tt){const X=(ge-tt)*(Z-$),rt=(Yt-$)*(it-tt),H=X-rt;if(0===X||0===rt||X>0!=rt>0)return H;const et=Math.abs(X+rt);return Math.abs(H)>=33306690738754716e-32*et?H:-function(at,j,Wt,Ct,kt,gt,Fe){let Ie,It,pe,Pt,te,le,Ot,Ue,ze,ar,Me,Mr,lr,kr,Xr,Sr,qe,ti;const vn=at-kt,Un=Wt-kt,ae=j-gt,Ve=Ct-gt;te=(Xr=(Ue=vn-(Ot=(le=134217729*vn)-(le-vn)))*(ar=Ve-(ze=(le=134217729*Ve)-(le-Ve)))-((kr=vn*Ve)-Ot*ze-Ue*ze-Ot*ar))-(Me=Xr-(qe=(Ue=ae-(Ot=(le=134217729*ae)-(le-ae)))*(ar=Un-(ze=(le=134217729*Un)-(le-Un)))-((Sr=ae*Un)-Ot*ze-Ue*ze-Ot*ar))),$t[0]=Xr-(Me+te)+(te-qe),te=(lr=kr-((Mr=kr+Me)-(te=Mr-kr))+(Me-te))-(Me=lr-Sr),$t[1]=lr-(Me+te)+(te-Sr),te=(ti=Mr+Me)-Mr,$t[2]=Mr-(ti-te)+(Me-te),$t[3]=ti;let Kt=function(ce,De){let Qe=De[0];for(let nr=1;nr<4;nr++)Qe+=De[nr];return Qe}(0,$t),st=22204460492503146e-32*Fe;if(Kt>=st||-Kt>=st||(Ie=at-(vn+(te=at-vn))+(te-kt),pe=Wt-(Un+(te=Wt-Un))+(te-kt),It=j-(ae+(te=j-ae))+(te-gt),Pt=Ct-(Ve+(te=Ct-Ve))+(te-gt),0===Ie&&0===It&&0===pe&&0===Pt)||(st=11093356479670487e-47*Fe+33306690738754706e-32*Math.abs(Kt),(Kt+=vn*Pt+Ve*Ie-(ae*pe+Un*It))>=st||-Kt>=st))return Kt;te=(Xr=(Ue=Ie-(Ot=(le=134217729*Ie)-(le-Ie)))*(ar=Ve-(ze=(le=134217729*Ve)-(le-Ve)))-((kr=Ie*Ve)-Ot*ze-Ue*ze-Ot*ar))-(Me=Xr-(qe=(Ue=It-(Ot=(le=134217729*It)-(le-It)))*(ar=Un-(ze=(le=134217729*Un)-(le-Un)))-((Sr=It*Un)-Ot*ze-Ue*ze-Ot*ar))),xt[0]=Xr-(Me+te)+(te-qe),te=(lr=kr-((Mr=kr+Me)-(te=Mr-kr))+(Me-te))-(Me=lr-Sr),xt[1]=lr-(Me+te)+(te-Sr),te=(ti=Mr+Me)-Mr,xt[2]=Mr-(ti-te)+(Me-te),xt[3]=ti;const nt=s(4,$t,4,xt,qt);te=(Xr=(Ue=vn-(Ot=(le=134217729*vn)-(le-vn)))*(ar=Pt-(ze=(le=134217729*Pt)-(le-Pt)))-((kr=vn*Pt)-Ot*ze-Ue*ze-Ot*ar))-(Me=Xr-(qe=(Ue=ae-(Ot=(le=134217729*ae)-(le-ae)))*(ar=pe-(ze=(le=134217729*pe)-(le-pe)))-((Sr=ae*pe)-Ot*ze-Ue*ze-Ot*ar))),xt[0]=Xr-(Me+te)+(te-qe),te=(lr=kr-((Mr=kr+Me)-(te=Mr-kr))+(Me-te))-(Me=lr-Sr),xt[1]=lr-(Me+te)+(te-Sr),te=(ti=Mr+Me)-Mr,xt[2]=Mr-(ti-te)+(Me-te),xt[3]=ti;const ot=s(nt,qt,4,xt,_e);te=(Xr=(Ue=Ie-(Ot=(le=134217729*Ie)-(le-Ie)))*(ar=Pt-(ze=(le=134217729*Pt)-(le-Pt)))-((kr=Ie*Pt)-Ot*ze-Ue*ze-Ot*ar))-(Me=Xr-(qe=(Ue=It-(Ot=(le=134217729*It)-(le-It)))*(ar=pe-(ze=(le=134217729*pe)-(le-pe)))-((Sr=It*pe)-Ot*ze-Ue*ze-Ot*ar))),xt[0]=Xr-(Me+te)+(te-qe),te=(lr=kr-((Mr=kr+Me)-(te=Mr-kr))+(Me-te))-(Me=lr-Sr),xt[1]=lr-(Me+te)+(te-Sr),te=(ti=Mr+Me)-Mr,xt[2]=Mr-(ti-te)+(Me-te),xt[3]=ti;const Rt=s(ot,_e,4,xt,yt);return yt[Rt-1]}(Yt,ge,Z,it,$,tt,et)},St.orient2dfast=function(Yt,ge,Z,it,$,tt){return(ge-tt)*(Z-$)-(Yt-$)*(it-tt)},Object.defineProperty(St,"__esModule",{value:!0})}(he)},9231:tr=>{"use strict";tr.exports={eudist:function(St,dt,Tt){for(var s=St.length,lt=0,ht=0;ht<s;ht++){var Lt=(St[ht]||0)-(dt[ht]||0);lt+=Lt*Lt}return Tt?Math.sqrt(lt):lt},mandist:function(St,dt,Tt){for(var s=St.length,lt=0,ht=0;ht<s;ht++)lt+=Math.abs((St[ht]||0)-(dt[ht]||0));return Tt?Math.sqrt(lt):lt},dist:function(St,dt,Tt){var s=Math.abs(St-dt);return Tt?s:s*s}}},5561:(tr,he,St)=>{"use strict";var dt=St(9231),Tt=dt.eudist,s=dt.dist;tr.exports={kmrand:function(ht,Lt){for(var Nt={},$t=[],qt=Lt<<2,_e=ht.length,yt=ht[0].length>0;$t.length<Lt&&qt-- >0;){var xt=ht[Math.floor(Math.random()*_e)],Yt=yt?xt.join("_"):""+xt;Nt[Yt]||(Nt[Yt]=!0,$t.push(xt))}if($t.length<Lt)throw new Error("Error initializating clusters");return $t},kmpp:function(ht,Lt){var Nt=ht[0].length?Tt:s,$t=[],qt=ht.length,_e=ht[0].length>0,xt=ht[Math.floor(Math.random()*qt)];for(_e&&xt.join("_"),$t.push(xt);$t.length<Lt;){for(var ge=[],Z=$t.length,it=0,$=[],tt=0;tt<qt;tt++){for(var X=1/0,rt=0;rt<Z;rt++){var H=Nt(ht[tt],$t[rt]);H<=X&&(X=H)}ge[tt]=X}for(var et=0;et<qt;et++)it+=ge[et];for(var at=0;at<qt;at++)$[at]={i:at,v:ht[at],pr:ge[at]/it,cs:0};$.sort(function(kt,gt){return kt.pr-gt.pr}),$[0].cs=$[0].pr;for(var j=1;j<qt;j++)$[j].cs=$[j-1].cs+$[j].pr;for(var Wt=Math.random(),Ct=0;Ct<qt-1&&$[Ct++].cs<Wt;);$t.push($[Ct-1].v)}return $t}}},9475:(tr,he,St)=>{"use strict";var dt=St(9231),Tt=St(5561),s=dt.eudist,Lt=Tt.kmrand,Nt=Tt.kmpp;function qt(yt,xt,Yt){Yt=Yt||[];for(var ge=0;ge<yt;ge++)Yt[ge]=xt;return Yt}tr.exports=function _e(yt,xt,Yt,ge){var Z=[],it=[],$=[],tt=[],X=!1,rt=ge||1e4,H=yt.length,et=yt[0].length,at=et>0,j=[];if(Yt)Z="kmrand"==Yt?Lt(yt,xt):"kmpp"==Yt?Nt(yt,xt):Yt;else for(var Wt={};Z.length<xt;){var Ct=Math.floor(Math.random()*H);Wt[Ct]||(Wt[Ct]=!0,Z.push(yt[Ct]))}do{qt(xt,0,j);for(var kt=0;kt<H;kt++){for(var gt=1/0,Fe=0,Ie=0;Ie<xt;Ie++)(tt=at?s(yt[kt],Z[Ie]):Math.abs(yt[kt]-Z[Ie]))<=gt&&(gt=tt,Fe=Ie);$[kt]=Fe,j[Fe]++}for(var It=[],Pt=(it=[],0);Pt<xt;Pt++)It[Pt]=at?qt(et,0,It[Pt]):0,it[Pt]=Z[Pt];if(at){for(var te=0;te<xt;te++)Z[te]=[];for(var le=0;le<H;le++)for(var Ue=It[$[le]],ze=yt[le],ar=0;ar<et;ar++)Ue[ar]+=ze[ar];X=!0;for(var Me=0;Me<xt;Me++){for(var Mr=Z[Me],lr=It[Me],kr=it[Me],Xr=j[Me],Sr=0;Sr<et;Sr++)Mr[Sr]=lr[Sr]/Xr||0;if(X)for(var qe=0;qe<et;qe++)if(kr[qe]!=Mr[qe]){X=!1;break}}}else{for(var ti=0;ti<H;ti++)It[$[ti]]+=yt[ti];for(var Un=0;Un<xt;Un++)Z[Un]=It[Un]/j[Un]||0;X=!0;for(var ae=0;ae<xt;ae++)if(it[ae]!=Z[ae]){X=!1;break}}X=X||--rt<=0}while(!X);return{it:1e4-rt,k:xt,idxs:$,centroids:Z}}},7253:(tr,he,St)=>{"use strict";St.r(he),St.d(he,{default:()=>dt});class dt{constructor(lt=[],ht=Tt){if(this.data=lt,this.length=this.data.length,this.compare=ht,this.length>0)for(let Lt=(this.length>>1)-1;Lt>=0;Lt--)this._down(Lt)}push(lt){this.data.push(lt),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const lt=this.data[0],ht=this.data.pop();return this.length--,this.length>0&&(this.data[0]=ht,this._down(0)),lt}peek(){return this.data[0]}_up(lt){const{data:ht,compare:Lt}=this,Nt=ht[lt];for(;lt>0;){const $t=lt-1>>1,qt=ht[$t];if(Lt(Nt,qt)>=0)break;ht[lt]=qt,lt=$t}ht[lt]=Nt}_down(lt){const{data:ht,compare:Lt}=this,Nt=this.length>>1,$t=ht[lt];for(;lt<Nt;){let qt=1+(lt<<1),_e=ht[qt];const yt=qt+1;if(yt<this.length&&Lt(ht[yt],_e)<0&&(qt=yt,_e=ht[yt]),Lt(_e,$t)>=0)break;ht[lt]=_e,lt=qt}ht[lt]=$t}}function Tt(s,lt){return s<lt?-1:s>lt?1:0}},770:function(tr,he){!function(St){"use strict";function dt(){}function Tt(e){this.message=e||""}function s(e){this.message=e||""}function lt(e){this.message=e||""}function ht(){}function Lt(e){return null===e?Ht:e.color}function Nt(e){return null===e?null:e.parent}function $t(e,i){null!==e&&(e.color=i)}function qt(e){return null===e?null:e.left}function _e(e){return null===e?null:e.right}function yt(){this.root_=null,this.size_=0}function xt(){}function Yt(){this.array_=[],arguments[0]instanceof gi&&this.addAll(arguments[0])}function ge(){}function Z(e){this.message=e||""}function it(){this.array_=[]}"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(e){if(null==this)throw new TypeError(this+" is not an object");var i=Object(this),h=Math.max(Math.min(i.length,9007199254740991),0)||0,d=1 in arguments&&parseInt(Number(arguments[1]),10)||0;d=d<0?Math.max(h+d,0):Math.min(d,h);var x=2 in arguments&&void 0!==arguments[2]?parseInt(Number(arguments[2]),10)||0:h;for(x=x<0?Math.max(h+arguments[2],0):Math.min(x,h);d<x;)i[d]=e,++d;return i},writable:!0}),Number.isFinite=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)},Number.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(e){return e!=e},Math.trunc=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};var $=function(){};$.prototype.interfaces_=function(){return[]},$.prototype.getClass=function(){return $},$.prototype.equalsWithTolerance=function(e,i,h){return Math.abs(e-i)<=h};var tt=function(e){function i(h){e.call(this,h),this.name="IllegalArgumentException",this.message=h,this.stack=(new e).stack}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i}(Error),X=function(){},rt={MAX_VALUE:{configurable:!0}};X.isNaN=function(e){return Number.isNaN(e)},X.doubleToLongBits=function(e){return e},X.longBitsToDouble=function(e){return e},X.isInfinite=function(e){return!Number.isFinite(e)},rt.MAX_VALUE.get=function(){return Number.MAX_VALUE},Object.defineProperties(X,rt);var H=function(){},et=function(){},at=function(){},j=function e(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)this.x=0,this.y=0,this.z=e.NULL_ORDINATE;else if(1===arguments.length){var i=arguments[0];this.x=i.x,this.y=i.y,this.z=i.z}else 2===arguments.length?(this.x=arguments[0],this.y=arguments[1],this.z=e.NULL_ORDINATE):3===arguments.length&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},Wt={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};j.prototype.setOrdinate=function(e,i){switch(e){case j.X:this.x=i;break;case j.Y:this.y=i;break;case j.Z:this.z=i;break;default:throw new tt("Invalid ordinate index: "+e)}},j.prototype.equals2D=function(){if(1===arguments.length){var e=arguments[0];return this.x===e.x&&this.y===e.y}if(2===arguments.length){var i=arguments[0],h=arguments[1];return!!$.equalsWithTolerance(this.x,i.x,h)&&!!$.equalsWithTolerance(this.y,i.y,h)}},j.prototype.getOrdinate=function(e){switch(e){case j.X:return this.x;case j.Y:return this.y;case j.Z:return this.z}throw new tt("Invalid ordinate index: "+e)},j.prototype.equals3D=function(e){return this.x===e.x&&this.y===e.y&&(this.z===e.z||X.isNaN(this.z))&&X.isNaN(e.z)},j.prototype.equals=function(e){return e instanceof j&&this.equals2D(e)},j.prototype.equalInZ=function(e,i){return $.equalsWithTolerance(this.z,e.z,i)},j.prototype.compareTo=function(e){return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0},j.prototype.clone=function(){},j.prototype.copy=function(){return new j(this)},j.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},j.prototype.distance3D=function(e){var i=this.x-e.x,h=this.y-e.y,d=this.z-e.z;return Math.sqrt(i*i+h*h+d*d)},j.prototype.distance=function(e){var i=this.x-e.x,h=this.y-e.y;return Math.sqrt(i*i+h*h)},j.prototype.hashCode=function(){var e=17;return 37*(e=37*e+j.hashCode(this.x))+j.hashCode(this.y)},j.prototype.setCoordinate=function(e){this.x=e.x,this.y=e.y,this.z=e.z},j.prototype.interfaces_=function(){return[H,et,dt]},j.prototype.getClass=function(){return j},j.hashCode=function(){if(1===arguments.length){var i=X.doubleToLongBits(arguments[0]);return Math.trunc((i^i)>>>32)}},Wt.DimensionalComparator.get=function(){return Ct},Wt.serialVersionUID.get=function(){return 0x5cbf2c235c7e5800},Wt.NULL_ORDINATE.get=function(){return X.NaN},Wt.X.get=function(){return 0},Wt.Y.get=function(){return 1},Wt.Z.get=function(){return 2},Object.defineProperties(j,Wt);var Ct=function(e){if(this._dimensionsToTest=2,0!==arguments.length&&1===arguments.length){var i=arguments[0];if(2!==i&&3!==i)throw new tt("only 2 or 3 dimensions may be specified");this._dimensionsToTest=i}};Ct.prototype.compare=function(e,i){var h=e,d=i,x=Ct.compare(h.x,d.x);if(0!==x)return x;var L=Ct.compare(h.y,d.y);return 0!==L?L:this._dimensionsToTest<=2?0:Ct.compare(h.z,d.z)},Ct.prototype.interfaces_=function(){return[at]},Ct.prototype.getClass=function(){return Ct},Ct.compare=function(e,i){return e<i?-1:e>i?1:X.isNaN(e)?X.isNaN(i)?0:-1:X.isNaN(i)?1:0};var kt=function(){};kt.prototype.create=function(){},kt.prototype.interfaces_=function(){return[]},kt.prototype.getClass=function(){return kt};var gt=function(){},Fe={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};gt.prototype.interfaces_=function(){return[]},gt.prototype.getClass=function(){return gt},gt.toLocationSymbol=function(e){switch(e){case gt.EXTERIOR:return"e";case gt.BOUNDARY:return"b";case gt.INTERIOR:return"i";case gt.NONE:return"-"}throw new tt("Unknown location value: "+e)},Fe.INTERIOR.get=function(){return 0},Fe.BOUNDARY.get=function(){return 1},Fe.EXTERIOR.get=function(){return 2},Fe.NONE.get=function(){return-1},Object.defineProperties(gt,Fe);var Ie=function(e,i){return e.interfaces_&&e.interfaces_().indexOf(i)>-1},It=function(){},pe={LOG_10:{configurable:!0}};It.prototype.interfaces_=function(){return[]},It.prototype.getClass=function(){return It},It.log10=function(e){var i=Math.log(e);return X.isInfinite(i)||X.isNaN(i)?i:i/It.LOG_10},It.min=function(e,i,h,d){var x=e;return i<x&&(x=i),h<x&&(x=h),d<x&&(x=d),x},It.clamp=function(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var e=arguments[0],i=arguments[1],h=arguments[2];return e<i?i:e>h?h:e}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var d=arguments[0],x=arguments[1],L=arguments[2];return d<x?x:d>L?L:d}},It.wrap=function(e,i){return e<0?i- -e%i:e%i},It.max=function(){if(3===arguments.length){var i=arguments[1],h=arguments[2],d=arguments[0];return i>d&&(d=i),h>d&&(d=h),d}if(4===arguments.length){var L=arguments[1],F=arguments[2],K=arguments[3],Mt=arguments[0];return L>Mt&&(Mt=L),F>Mt&&(Mt=F),K>Mt&&(Mt=K),Mt}},It.average=function(e,i){return(e+i)/2},pe.LOG_10.get=function(){return Math.log(10)},Object.defineProperties(It,pe);var Pt=function(e){this.str=e};Pt.prototype.append=function(e){this.str+=e},Pt.prototype.setCharAt=function(e,i){this.str=this.str.substr(0,e)+i+this.str.substr(e+1)},Pt.prototype.toString=function(e){return this.str};var te=function(e){this.value=e};te.prototype.intValue=function(){return this.value},te.prototype.compareTo=function(e){return this.value<e?-1:this.value>e?1:0},te.isNaN=function(e){return Number.isNaN(e)};var le=function(){};le.isWhitespace=function(e){return e<=32&&e>=0||127===e},le.toUpperCase=function(e){return e.toUpperCase()};var Ot=function e(){this._hi=0,this._lo=0,0===arguments.length?this.init(0):1===arguments.length?"number"==typeof arguments[0]||arguments[0]instanceof e?this.init(arguments[0]):"string"==typeof arguments[0]&&e.call(this,e.parse(arguments[0])):2===arguments.length&&this.init(arguments[0],arguments[1])},Ue={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};Ot.prototype.le=function(e){return(this._hi<e._hi||this._hi===e._hi)&&this._lo<=e._lo},Ot.prototype.extractSignificantDigits=function(e,i){var h=this.abs(),d=Ot.magnitude(h._hi),x=Ot.TEN.pow(d);(h=h.divide(x)).gt(Ot.TEN)?(h=h.divide(Ot.TEN),d+=1):h.lt(Ot.ONE)&&(h=h.multiply(Ot.TEN),d-=1);for(var L=d+1,F=new Pt,K=Ot.MAX_PRINT_DIGITS-1,Mt=0;Mt<=K;Mt++){e&&Mt===L&&F.append(".");var Qt=Math.trunc(h._hi);if(Qt<0)break;var ke=!1,Ge=0;Qt>9?(ke=!0,Ge="9"):Ge="0"+Qt,F.append(Ge),h=h.subtract(Ot.valueOf(Qt)).multiply(Ot.TEN),ke&&h.selfAdd(Ot.TEN);var gr=!0,Ir=Ot.magnitude(h._hi);if(Ir<0&&Math.abs(Ir)>=K-Mt&&(gr=!1),!gr)break}return i[0]=d,F.toString()},Ot.prototype.sqr=function(){return this.multiply(this)},Ot.prototype.doubleValue=function(){return this._hi+this._lo},Ot.prototype.subtract=function(){return arguments[0]instanceof Ot?this.add(arguments[0].negate()):"number"==typeof arguments[0]?this.add(-arguments[0]):void 0},Ot.prototype.equals=function(){if(1===arguments.length){var e=arguments[0];return this._hi===e._hi&&this._lo===e._lo}},Ot.prototype.isZero=function(){return 0===this._hi&&0===this._lo},Ot.prototype.selfSubtract=function(){if(arguments[0]instanceof Ot){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e._hi,-e._lo)}if("number"==typeof arguments[0]){var i=arguments[0];return this.isNaN()?this:this.selfAdd(-i,0)}},Ot.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},Ot.prototype.min=function(e){return this.le(e)?this:e},Ot.prototype.selfDivide=function(){if(1===arguments.length){if(arguments[0]instanceof Ot){var e=arguments[0];return this.selfDivide(e._hi,e._lo)}if("number"==typeof arguments[0])return this.selfDivide(arguments[0],0)}else if(2===arguments.length){var h=arguments[0],x=null,L=null,F=null,K=null,Mt=null,Qt=null,ke=null,Ge=null;return this._hi=Ge=(Mt=this._hi/h)+(Qt=(this._hi-(ke=Mt*h)-(Ge=(x=(Qt=Ot.SPLIT*Mt)-(x=Qt-Mt))*(F=(Ge=Ot.SPLIT*h)-(F=Ge-h))-ke+x*(K=h-F)+(L=Mt-x)*F+L*K)+this._lo-Mt*arguments[1])/h),this._lo=Mt-Ge+Qt,this}},Ot.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"},Ot.prototype.divide=function(){if(arguments[0]instanceof Ot){var e=arguments[0],i=null,h=null,d=null,x=null,L=null,F=null,K=null,Mt=null;return h=(L=this._hi/e._hi)-(i=(F=Ot.SPLIT*L)-(i=F-L)),Mt=i*(d=(Mt=Ot.SPLIT*e._hi)-(d=Mt-e._hi))-(K=L*e._hi)+i*(x=e._hi-d)+h*d+h*x,new Ot(Mt=L+(F=(this._hi-K-Mt+this._lo-L*e._lo)/e._hi),L-Mt+F)}if("number"==typeof arguments[0]){var Qt=arguments[0];return X.isNaN(Qt)?Ot.createNaN():Ot.copy(this).selfDivide(Qt,0)}},Ot.prototype.ge=function(e){return(this._hi>e._hi||this._hi===e._hi)&&this._lo>=e._lo},Ot.prototype.pow=function(e){if(0===e)return Ot.valueOf(1);var i=new Ot(this),h=Ot.valueOf(1),d=Math.abs(e);if(d>1)for(;d>0;)d%2==1&&h.selfMultiply(i),(d/=2)>0&&(i=i.sqr());else h=i;return e<0?h.reciprocal():h},Ot.prototype.ceil=function(){if(this.isNaN())return Ot.NaN;var e=Math.ceil(this._hi),i=0;return e===this._hi&&(i=Math.ceil(this._lo)),new Ot(e,i)},Ot.prototype.compareTo=function(e){return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0},Ot.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()},Ot.prototype.setValue=function(){return arguments[0]instanceof Ot||"number"==typeof arguments[0]?(this.init(arguments[0]),this):void 0},Ot.prototype.max=function(e){return this.ge(e)?this:e},Ot.prototype.sqrt=function(){if(this.isZero())return Ot.valueOf(0);if(this.isNegative())return Ot.NaN;var e=1/Math.sqrt(this._hi),h=Ot.valueOf(this._hi*e),d=this.subtract(h.sqr())._hi*(.5*e);return h.add(d)},Ot.prototype.selfAdd=function(){if(1===arguments.length){if(arguments[0]instanceof Ot){var e=arguments[0];return this.selfAdd(e._hi,e._lo)}if("number"==typeof arguments[0]){var i=arguments[0],h=null,d=null,x=null,F=null,K=null;return this._hi=(h=(x=this._hi+i)+(K=i-(F=x-this._hi)+(this._hi-(x-F))+this._lo))+(d=K+(x-h)),this._lo=d+(h-this._hi),this}}else if(2===arguments.length){var Mt=arguments[0],Qt=arguments[1],ke=null,Ge=null,gr=null,Ir=null,jr=null,ln=null,Mi=null;jr=(Ir=this._hi+Mt)-(ln=Ir-this._hi),gr=(Ge=this._lo+Qt)-(Mi=Ge-this._lo);var l=(ke=Ir+(ln=(jr=Mt-ln+(this._hi-jr))+Ge))+(ln=(gr=Qt-Mi+(this._lo-gr))+(ln+(Ir-ke))),f=ln+(ke-l);return this._hi=l,this._lo=f,this}},Ot.prototype.selfMultiply=function(){if(1===arguments.length){if(arguments[0]instanceof Ot){var e=arguments[0];return this.selfMultiply(e._hi,e._lo)}if("number"==typeof arguments[0])return this.selfMultiply(arguments[0],0)}else if(2===arguments.length){var h=arguments[0],x=null,L=null,F=null,K=null,Mt=null,Qt=null;x=(Mt=Ot.SPLIT*this._hi)-this._hi,x=Mt-x;var ke=(Mt=this._hi*h)+(Qt=x*(F=(Qt=Ot.SPLIT*h)-(F=Qt-h))-Mt+x*(K=h-F)+(L=this._hi-x)*F+L*K+(this._hi*arguments[1]+this._lo*h)),Ge=Qt+(x=Mt-ke);return this._hi=ke,this._lo=Ge,this}},Ot.prototype.selfSqr=function(){return this.selfMultiply(this)},Ot.prototype.floor=function(){if(this.isNaN())return Ot.NaN;var e=Math.floor(this._hi),i=0;return e===this._hi&&(i=Math.floor(this._lo)),new Ot(e,i)},Ot.prototype.negate=function(){return this.isNaN()?this:new Ot(-this._hi,-this._lo)},Ot.prototype.clone=function(){},Ot.prototype.multiply=function(){if(arguments[0]instanceof Ot){var e=arguments[0];return e.isNaN()?Ot.createNaN():Ot.copy(this).selfMultiply(e)}if("number"==typeof arguments[0]){var i=arguments[0];return X.isNaN(i)?Ot.createNaN():Ot.copy(this).selfMultiply(i,0)}},Ot.prototype.isNaN=function(){return X.isNaN(this._hi)},Ot.prototype.intValue=function(){return Math.trunc(this._hi)},Ot.prototype.toString=function(){var e=Ot.magnitude(this._hi);return e>=-3&&e<=20?this.toStandardNotation():this.toSciNotation()},Ot.prototype.toStandardNotation=function(){var e=this.getSpecialNumberString();if(null!==e)return e;var i=new Array(1).fill(null),h=this.extractSignificantDigits(!0,i),d=i[0]+1,x=h;return"."===h.charAt(0)?x="0"+h:d<0?x="0."+Ot.stringOfChar("0",-d)+h:-1===h.indexOf(".")&&(x=h+Ot.stringOfChar("0",d-h.length)+".0"),this.isNegative()?"-"+x:x},Ot.prototype.reciprocal=function(){var i,d,x,F,e=null,h=null,L=null,K=null;i=(x=1/this._hi)-(e=(L=Ot.SPLIT*x)-(e=L-x)),h=(K=Ot.SPLIT*this._hi)-this._hi;var Mt=x+(L=(1-(F=x*this._hi)-(K=e*(h=K-h)-F+e*(d=this._hi-h)+i*h+i*d)-x*this._lo)/this._hi);return new Ot(Mt,x-Mt+L)},Ot.prototype.toSciNotation=function(){if(this.isZero())return Ot.SCI_NOT_ZERO;var e=this.getSpecialNumberString();if(null!==e)return e;var i=new Array(1).fill(null),h=this.extractSignificantDigits(!1,i),d=Ot.SCI_NOT_EXPONENT_CHAR+i[0];if("0"===h.charAt(0))throw new Error("Found leading zero: "+h);var x="";h.length>1&&(x=h.substring(1));var L=h.charAt(0)+"."+x;return this.isNegative()?"-"+L+d:L+d},Ot.prototype.abs=function(){return this.isNaN()?Ot.NaN:this.isNegative()?this.negate():new Ot(this)},Ot.prototype.isPositive=function(){return(this._hi>0||0===this._hi)&&this._lo>0},Ot.prototype.lt=function(e){return(this._hi<e._hi||this._hi===e._hi)&&this._lo<e._lo},Ot.prototype.add=function(){if(arguments[0]instanceof Ot){var e=arguments[0];return Ot.copy(this).selfAdd(e)}if("number"==typeof arguments[0]){var i=arguments[0];return Ot.copy(this).selfAdd(i)}},Ot.prototype.init=function(){if(1===arguments.length){if("number"==typeof arguments[0])this._hi=arguments[0],this._lo=0;else if(arguments[0]instanceof Ot){var i=arguments[0];this._hi=i._hi,this._lo=i._lo}}else if(2===arguments.length){var d=arguments[1];this._hi=arguments[0],this._lo=d}},Ot.prototype.gt=function(e){return(this._hi>e._hi||this._hi===e._hi)&&this._lo>e._lo},Ot.prototype.isNegative=function(){return(this._hi<0||0===this._hi)&&this._lo<0},Ot.prototype.trunc=function(){return this.isNaN()?Ot.NaN:this.isPositive()?this.floor():this.ceil()},Ot.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0},Ot.prototype.interfaces_=function(){return[dt,H,et]},Ot.prototype.getClass=function(){return Ot},Ot.sqr=function(e){return Ot.valueOf(e).selfMultiply(e)},Ot.valueOf=function(){return"string"==typeof arguments[0]?Ot.parse(arguments[0]):"number"==typeof arguments[0]?new Ot(arguments[0]):void 0},Ot.sqrt=function(e){return Ot.valueOf(e).sqrt()},Ot.parse=function(e){for(var i=0,h=e.length;le.isWhitespace(e.charAt(i));)i++;var d=!1;if(i<h){var x=e.charAt(i);"-"!==x&&"+"!==x||(i++,"-"===x&&(d=!0))}for(var L=new Ot,F=0,K=0,Mt=0;!(i>=h);){var Qt=e.charAt(i);if(i++,le.isDigit(Qt)){var ke=Qt-"0";L.selfMultiply(Ot.TEN),L.selfAdd(ke),F++}else{if("."!==Qt){if("e"===Qt||"E"===Qt){var Ge=e.substring(i);try{Mt=te.parseInt(Ge)}catch(Mi){throw Mi instanceof Error?new Error("Invalid exponent "+Ge+" in string "+e):Mi}break}throw new Error("Unexpected character '"+Qt+"' at position "+i+" in string "+e)}K=F}}var gr=L,Ir=F-K-Mt;if(0===Ir)gr=L;else if(Ir>0){var jr=Ot.TEN.pow(Ir);gr=L.divide(jr)}else if(Ir<0){var ln=Ot.TEN.pow(-Ir);gr=L.multiply(ln)}return d?gr.negate():gr},Ot.createNaN=function(){return new Ot(X.NaN,X.NaN)},Ot.copy=function(e){return new Ot(e)},Ot.magnitude=function(e){var i=Math.abs(e),h=Math.log(i)/Math.log(10),d=Math.trunc(Math.floor(h));return 10*Math.pow(10,d)<=i&&(d+=1),d},Ot.stringOfChar=function(e,i){for(var h=new Pt,d=0;d<i;d++)h.append(e);return h.toString()},Ue.PI.get=function(){return new Ot(3.141592653589793,12246467991473532e-32)},Ue.TWO_PI.get=function(){return new Ot(6.283185307179586,24492935982947064e-32)},Ue.PI_2.get=function(){return new Ot(1.5707963267948966,6123233995736766e-32)},Ue.E.get=function(){return new Ot(2.718281828459045,14456468917292502e-32)},Ue.NaN.get=function(){return new Ot(X.NaN,X.NaN)},Ue.EPS.get=function(){return 123259516440783e-46},Ue.SPLIT.get=function(){return 134217729},Ue.MAX_PRINT_DIGITS.get=function(){return 32},Ue.TEN.get=function(){return Ot.valueOf(10)},Ue.ONE.get=function(){return Ot.valueOf(1)},Ue.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"},Ue.SCI_NOT_ZERO.get=function(){return"0.0E0"},Object.defineProperties(Ot,Ue);var ze=function(){},ar={DP_SAFE_EPSILON:{configurable:!0}};ze.prototype.interfaces_=function(){return[]},ze.prototype.getClass=function(){return ze},ze.orientationIndex=function(e,i,h){var d=ze.orientationIndexFilter(e,i,h);if(d<=1)return d;var x=Ot.valueOf(i.x).selfAdd(-e.x),L=Ot.valueOf(i.y).selfAdd(-e.y),F=Ot.valueOf(h.x).selfAdd(-i.x),K=Ot.valueOf(h.y).selfAdd(-i.y);return x.selfMultiply(K).selfSubtract(L.selfMultiply(F)).signum()},ze.signOfDet2x2=function(e,i,h,d){return e.multiply(d).selfSubtract(i.multiply(h)).signum()},ze.intersection=function(e,i,h,d){var x=Ot.valueOf(d.y).selfSubtract(h.y).selfMultiply(Ot.valueOf(i.x).selfSubtract(e.x)),L=Ot.valueOf(d.x).selfSubtract(h.x).selfMultiply(Ot.valueOf(i.y).selfSubtract(e.y)),F=x.subtract(L),K=Ot.valueOf(d.x).selfSubtract(h.x).selfMultiply(Ot.valueOf(e.y).selfSubtract(h.y)),Mt=Ot.valueOf(d.y).selfSubtract(h.y).selfMultiply(Ot.valueOf(e.x).selfSubtract(h.x)),Qt=K.subtract(Mt).selfDivide(F).doubleValue(),ke=Ot.valueOf(e.x).selfAdd(Ot.valueOf(i.x).selfSubtract(e.x).selfMultiply(Qt)).doubleValue(),Ge=Ot.valueOf(i.x).selfSubtract(e.x).selfMultiply(Ot.valueOf(e.y).selfSubtract(h.y)),gr=Ot.valueOf(i.y).selfSubtract(e.y).selfMultiply(Ot.valueOf(e.x).selfSubtract(h.x)),Ir=Ge.subtract(gr).selfDivide(F).doubleValue(),jr=Ot.valueOf(h.y).selfAdd(Ot.valueOf(d.y).selfSubtract(h.y).selfMultiply(Ir)).doubleValue();return new j(ke,jr)},ze.orientationIndexFilter=function(e,i,h){var d=null,x=(e.x-h.x)*(i.y-h.y),L=(e.y-h.y)*(i.x-h.x),F=x-L;if(x>0){if(L<=0)return ze.signum(F);d=x+L}else{if(!(x<0)||L>=0)return ze.signum(F);d=-x-L}var K=ze.DP_SAFE_EPSILON*d;return F>=K||-F>=K?ze.signum(F):2},ze.signum=function(e){return e>0?1:e<0?-1:0},ar.DP_SAFE_EPSILON.get=function(){return 1e-15},Object.defineProperties(ze,ar);var Me=function(){},Mr={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};Mr.X.get=function(){return 0},Mr.Y.get=function(){return 1},Mr.Z.get=function(){return 2},Mr.M.get=function(){return 3},Me.prototype.setOrdinate=function(e,i,h){},Me.prototype.size=function(){},Me.prototype.getOrdinate=function(e,i){},Me.prototype.getCoordinate=function(){},Me.prototype.getCoordinateCopy=function(e){},Me.prototype.getDimension=function(){},Me.prototype.getX=function(e){},Me.prototype.clone=function(){},Me.prototype.expandEnvelope=function(e){},Me.prototype.copy=function(){},Me.prototype.getY=function(e){},Me.prototype.toCoordinateArray=function(){},Me.prototype.interfaces_=function(){return[et]},Me.prototype.getClass=function(){return Me},Object.defineProperties(Me,Mr);var lr=function(){},kr=function(e){function i(){e.call(this,"Projective point not representable on the Cartesian plane.")}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i}(lr),Xr=function(){};Xr.arraycopy=function(e,i,h,d,x){for(var L=0,F=i;F<i+x;F++)h[d+L]=e[F],L++},Xr.getProperty=function(e){return{"line.separator":"\n"}[e]};var Sr=function e(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){var i=arguments[0];this.x=i.x,this.y=i.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var d=arguments[1];this.x=arguments[0],this.y=d,this.w=1}else if(arguments[0]instanceof e&&arguments[1]instanceof e){var x=arguments[0],L=arguments[1];this.x=x.y*L.w-L.y*x.w,this.y=L.x*x.w-x.x*L.w,this.w=x.x*L.y-L.x*x.y}else if(arguments[0]instanceof j&&arguments[1]instanceof j){var F=arguments[0],K=arguments[1];this.x=F.y-K.y,this.y=K.x-F.x,this.w=F.x*K.y-K.x*F.y}}else if(3===arguments.length){var Qt=arguments[1],ke=arguments[2];this.x=arguments[0],this.y=Qt,this.w=ke}else if(4===arguments.length){var Ge=arguments[0],gr=arguments[1],Ir=arguments[2],jr=arguments[3],ln=Ge.y-gr.y,Mi=gr.x-Ge.x,l=Ge.x*gr.y-gr.x*Ge.y,f=Ir.y-jr.y,c=jr.x-Ir.x,m=Ir.x*jr.y-jr.x*Ir.y;this.x=Mi*m-c*l,this.y=f*l-ln*m,this.w=ln*c-f*Mi}};Sr.prototype.getY=function(){var e=this.y/this.w;if(X.isNaN(e)||X.isInfinite(e))throw new kr;return e},Sr.prototype.getX=function(){var e=this.x/this.w;if(X.isNaN(e)||X.isInfinite(e))throw new kr;return e},Sr.prototype.getCoordinate=function(){var e=new j;return e.x=this.getX(),e.y=this.getY(),e},Sr.prototype.interfaces_=function(){return[]},Sr.prototype.getClass=function(){return Sr},Sr.intersection=function(e,i,h,d){var x=e.y-i.y,L=i.x-e.x,F=e.x*i.y-i.x*e.y,K=h.y-d.y,Mt=d.x-h.x,Qt=h.x*d.y-d.x*h.y,ke=x*Mt-K*L,Ge=(L*Qt-Mt*F)/ke,gr=(K*F-x*Qt)/ke;if(X.isNaN(Ge)||X.isInfinite(Ge)||X.isNaN(gr)||X.isInfinite(gr))throw new kr;return new j(Ge,gr)};var qe=function e(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length)if(arguments[0]instanceof j){var i=arguments[0];this.init(i.x,i.x,i.y,i.y)}else arguments[0]instanceof e&&this.init(arguments[0]);else if(2===arguments.length){var d=arguments[0],x=arguments[1];this.init(d.x,x.x,d.y,x.y)}else 4===arguments.length&&this.init(arguments[0],arguments[1],arguments[2],arguments[3])},ti={serialVersionUID:{configurable:!0}};qe.prototype.getArea=function(){return this.getWidth()*this.getHeight()},qe.prototype.equals=function(e){if(!(e instanceof qe))return!1;var i=e;return this.isNull()?i.isNull():this._maxx===i.getMaxX()&&this._maxy===i.getMaxY()&&this._minx===i.getMinX()&&this._miny===i.getMinY()},qe.prototype.intersection=function(e){return this.isNull()||e.isNull()||!this.intersects(e)?new qe:new qe(this._minx>e._minx?this._minx:e._minx,this._maxx<e._maxx?this._maxx:e._maxx,this._miny>e._miny?this._miny:e._miny,this._maxy<e._maxy?this._maxy:e._maxy)},qe.prototype.isNull=function(){return this._maxx<this._minx},qe.prototype.getMaxX=function(){return this._maxx},qe.prototype.covers=function(){if(1===arguments.length){if(arguments[0]instanceof j){var e=arguments[0];return this.covers(e.x,e.y)}if(arguments[0]instanceof qe){var i=arguments[0];return!this.isNull()&&!i.isNull()&&i.getMinX()>=this._minx&&i.getMaxX()<=this._maxx&&i.getMinY()>=this._miny&&i.getMaxY()<=this._maxy}}else if(2===arguments.length){var h=arguments[0],d=arguments[1];return!this.isNull()&&h>=this._minx&&h<=this._maxx&&d>=this._miny&&d<=this._maxy}},qe.prototype.intersects=function(){if(1===arguments.length){if(arguments[0]instanceof qe){var e=arguments[0];return!this.isNull()&&!e.isNull()&&!(e._minx>this._maxx||e._maxx<this._minx||e._miny>this._maxy||e._maxy<this._miny)}if(arguments[0]instanceof j){var i=arguments[0];return this.intersects(i.x,i.y)}}else if(2===arguments.length){var h=arguments[0],d=arguments[1];return!this.isNull()&&!(h>this._maxx||h<this._minx||d>this._maxy||d<this._miny)}},qe.prototype.getMinY=function(){return this._miny},qe.prototype.getMinX=function(){return this._minx},qe.prototype.expandToInclude=function(){if(1===arguments.length){if(arguments[0]instanceof j){var e=arguments[0];this.expandToInclude(e.x,e.y)}else if(arguments[0]instanceof qe){var i=arguments[0];if(i.isNull())return null;this.isNull()?(this._minx=i.getMinX(),this._maxx=i.getMaxX(),this._miny=i.getMinY(),this._maxy=i.getMaxY()):(i._minx<this._minx&&(this._minx=i._minx),i._maxx>this._maxx&&(this._maxx=i._maxx),i._miny<this._miny&&(this._miny=i._miny),i._maxy>this._maxy&&(this._maxy=i._maxy))}}else if(2===arguments.length){var h=arguments[0],d=arguments[1];this.isNull()?(this._minx=h,this._maxx=h,this._miny=d,this._maxy=d):(h<this._minx&&(this._minx=h),h>this._maxx&&(this._maxx=h),d<this._miny&&(this._miny=d),d>this._maxy&&(this._maxy=d))}},qe.prototype.minExtent=function(){if(this.isNull())return 0;var e=this.getWidth(),i=this.getHeight();return e<i?e:i},qe.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx},qe.prototype.compareTo=function(e){var i=e;return this.isNull()?i.isNull()?0:-1:i.isNull()?1:this._minx<i._minx?-1:this._minx>i._minx?1:this._miny<i._miny?-1:this._miny>i._miny?1:this._maxx<i._maxx?-1:this._maxx>i._maxx?1:this._maxy<i._maxy?-1:this._maxy>i._maxy?1:0},qe.prototype.translate=function(e,i){if(this.isNull())return null;this.init(this.getMinX()+e,this.getMaxX()+e,this.getMinY()+i,this.getMaxY()+i)},qe.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"},qe.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1},qe.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny},qe.prototype.maxExtent=function(){if(this.isNull())return 0;var e=this.getWidth(),i=this.getHeight();return e>i?e:i},qe.prototype.expandBy=function(){if(1===arguments.length){var e=arguments[0];this.expandBy(e,e)}else if(2===arguments.length){var i=arguments[0],h=arguments[1];if(this.isNull())return null;this._minx-=i,this._maxx+=i,this._miny-=h,this._maxy+=h,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}},qe.prototype.contains=function(){if(1===arguments.length){if(arguments[0]instanceof qe)return this.covers(arguments[0]);if(arguments[0]instanceof j)return this.covers(arguments[0])}else if(2===arguments.length)return this.covers(arguments[0],arguments[1])},qe.prototype.centre=function(){return this.isNull()?null:new j((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},qe.prototype.init=function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof j){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof qe){var i=arguments[0];this._minx=i._minx,this._maxx=i._maxx,this._miny=i._miny,this._maxy=i._maxy}}else if(2===arguments.length){var h=arguments[0],d=arguments[1];this.init(h.x,d.x,h.y,d.y)}else if(4===arguments.length){var x=arguments[0],L=arguments[1],F=arguments[2],K=arguments[3];x<L?(this._minx=x,this._maxx=L):(this._minx=L,this._maxx=x),F<K?(this._miny=F,this._maxy=K):(this._miny=K,this._maxy=F)}},qe.prototype.getMaxY=function(){return this._maxy},qe.prototype.distance=function(e){if(this.intersects(e))return 0;var i=0;this._maxx<e._minx?i=e._minx-this._maxx:this._minx>e._maxx&&(i=this._minx-e._maxx);var h=0;return this._maxy<e._miny?h=e._miny-this._maxy:this._miny>e._maxy&&(h=this._miny-e._maxy),0===i?h:0===h?i:Math.sqrt(i*i+h*h)},qe.prototype.hashCode=function(){var e=17;return 37*(e=37*(e=37*(e=37*e+j.hashCode(this._minx))+j.hashCode(this._maxx))+j.hashCode(this._miny))+j.hashCode(this._maxy)},qe.prototype.interfaces_=function(){return[H,dt]},qe.prototype.getClass=function(){return qe},qe.intersects=function(){if(3===arguments.length){var e=arguments[0],i=arguments[1],h=arguments[2];return h.x>=(e.x<i.x?e.x:i.x)&&h.x<=(e.x>i.x?e.x:i.x)&&h.y>=(e.y<i.y?e.y:i.y)&&h.y<=(e.y>i.y?e.y:i.y)}if(4===arguments.length){var d=arguments[0],x=arguments[1],L=arguments[2],F=arguments[3],K=Math.min(L.x,F.x),Mt=Math.max(L.x,F.x),Qt=Math.min(d.x,x.x),ke=Math.max(d.x,x.x);return!(Qt>Mt||ke<K||(K=Math.min(L.y,F.y),Mt=Math.max(L.y,F.y),Qt=Math.min(d.y,x.y),ke=Math.max(d.y,x.y),Qt>Mt||ke<K))}},ti.serialVersionUID.get=function(){return 0x51845cd552189800},Object.defineProperties(qe,ti);var vn={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},Un=function(e){this.geometryFactory=e||new xn};Un.prototype.read=function(e){var i,h;e=e.replace(/[\n\r]/g," ");var x=vn.typeStr.exec(e);if(-1!==e.search("EMPTY")&&((x=vn.emptyTypeStr.exec(e))[2]=void 0),x&&(h=x[1].toLowerCase(),Ve[h]&&(i=Ve[h].apply(this,[x[2]]))),void 0===i)throw new Error("Could not parse WKT "+e);return i},Un.prototype.write=function(e){return this.extractGeometry(e)},Un.prototype.extractGeometry=function(e){var i=e.getGeometryType().toLowerCase();if(!ae[i])return null;var h=i.toUpperCase();return e.isEmpty()?h+" EMPTY":h+"("+ae[i].apply(this,[e])+")"};var ae={coordinate:function(e){return e.x+" "+e.y},point:function(e){return ae.coordinate.call(this,e._coordinates._coordinates[0])},multipoint:function(e){for(var i=[],h=0,d=e._geometries.length;h<d;++h)i.push("("+ae.point.apply(this,[e._geometries[h]])+")");return i.join(",")},linestring:function(e){for(var i=[],h=0,d=e._points._coordinates.length;h<d;++h)i.push(ae.coordinate.apply(this,[e._points._coordinates[h]]));return i.join(",")},linearring:function(e){for(var i=[],h=0,d=e._points._coordinates.length;h<d;++h)i.push(ae.coordinate.apply(this,[e._points._coordinates[h]]));return i.join(",")},multilinestring:function(e){for(var i=[],h=0,d=e._geometries.length;h<d;++h)i.push("("+ae.linestring.apply(this,[e._geometries[h]])+")");return i.join(",")},polygon:function(e){var i=[];i.push("("+ae.linestring.apply(this,[e._shell])+")");for(var h=0,d=e._holes.length;h<d;++h)i.push("("+ae.linestring.apply(this,[e._holes[h]])+")");return i.join(",")},multipolygon:function(e){for(var i=[],h=0,d=e._geometries.length;h<d;++h)i.push("("+ae.polygon.apply(this,[e._geometries[h]])+")");return i.join(",")},geometrycollection:function(e){for(var i=[],h=0,d=e._geometries.length;h<d;++h)i.push(this.extractGeometry(e._geometries[h]));return i.join(",")}},Ve={point:function(e){if(void 0===e)return this.geometryFactory.createPoint();var i=e.trim().split(vn.spaces);return this.geometryFactory.createPoint(new j(Number.parseFloat(i[0]),Number.parseFloat(i[1])))},multipoint:function(e){if(void 0===e)return this.geometryFactory.createMultiPoint();for(var i,h=e.trim().split(","),d=[],x=0,L=h.length;x<L;++x)i=h[x].replace(vn.trimParens,"$1"),d.push(Ve.point.apply(this,[i]));return this.geometryFactory.createMultiPoint(d)},linestring:function(e){if(void 0===e)return this.geometryFactory.createLineString();for(var i,h=e.trim().split(","),d=[],x=0,L=h.length;x<L;++x)i=h[x].trim().split(vn.spaces),d.push(new j(Number.parseFloat(i[0]),Number.parseFloat(i[1])));return this.geometryFactory.createLineString(d)},linearring:function(e){if(void 0===e)return this.geometryFactory.createLinearRing();for(var i,h=e.trim().split(","),d=[],x=0,L=h.length;x<L;++x)i=h[x].trim().split(vn.spaces),d.push(new j(Number.parseFloat(i[0]),Number.parseFloat(i[1])));return this.geometryFactory.createLinearRing(d)},multilinestring:function(e){if(void 0===e)return this.geometryFactory.createMultiLineString();for(var i,h=e.trim().split(vn.parenComma),d=[],x=0,L=h.length;x<L;++x)i=h[x].replace(vn.trimParens,"$1"),d.push(Ve.linestring.apply(this,[i]));return this.geometryFactory.createMultiLineString(d)},polygon:function(e){if(void 0===e)return this.geometryFactory.createPolygon();for(var i,h,d,x,L=e.trim().split(vn.parenComma),F=[],K=0,Mt=L.length;K<Mt;++K)i=L[K].replace(vn.trimParens,"$1"),h=Ve.linestring.apply(this,[i]),d=this.geometryFactory.createLinearRing(h._points),0===K?x=d:F.push(d);return this.geometryFactory.createPolygon(x,F)},multipolygon:function(e){if(void 0===e)return this.geometryFactory.createMultiPolygon();for(var i,h=e.trim().split(vn.doubleParenComma),d=[],x=0,L=h.length;x<L;++x)i=h[x].replace(vn.trimParens,"$1"),d.push(Ve.polygon.apply(this,[i]));return this.geometryFactory.createMultiPolygon(d)},geometrycollection:function(e){if(void 0===e)return this.geometryFactory.createGeometryCollection();for(var i=(e=e.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),h=[],d=0,x=i.length;d<x;++d)h.push(this.read(i[d]));return this.geometryFactory.createGeometryCollection(h)}},Kt=function(e){this.parser=new Un(e)};Kt.prototype.write=function(e){return this.parser.write(e)},Kt.toLineString=function(e,i){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+e.x+" "+e.y+", "+i.x+" "+i.y+" )"};var st=function(e){function i(h){e.call(this,h),this.name="RuntimeException",this.message=h,this.stack=(new e).stack}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i}(Error),nt=function(e){function i(){e.call(this),0===arguments.length?e.call(this):1===arguments.length&&e.call(this,arguments[0])}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i}(st),ot=function(){};ot.prototype.interfaces_=function(){return[]},ot.prototype.getClass=function(){return ot},ot.shouldNeverReachHere=function(){if(0===arguments.length)ot.shouldNeverReachHere(null);else if(1===arguments.length){var e=arguments[0];throw new nt("Should never reach here"+(null!==e?": "+e:""))}},ot.isTrue=function(){var i;if(1===arguments.length)ot.isTrue(arguments[0],null);else if(2===arguments.length&&(i=arguments[1],!arguments[0]))throw null===i?new nt:new nt(i)},ot.equals=function(){var e,i,h;if(2===arguments.length)ot.equals(e=arguments[0],i=arguments[1],null);else if(3===arguments.length&&(h=arguments[2],!(i=arguments[1]).equals(e=arguments[0])))throw new nt("Expected "+e+" but encountered "+i+(null!==h?": "+h:""))};var Rt=function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new j,this._intPt[1]=new j,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},ce={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};Rt.prototype.getIndexAlongSegment=function(e,i){return this.computeIntLineIndex(),this._intLineIndex[e][i]},Rt.prototype.getTopologySummary=function(){var e=new Pt;return this.isEndPoint()&&e.append(" endpoint"),this._isProper&&e.append(" proper"),this.isCollinear()&&e.append(" collinear"),e.toString()},Rt.prototype.computeIntersection=function(e,i,h,d){this._inputLines[0][0]=e,this._inputLines[0][1]=i,this._inputLines[1][0]=h,this._inputLines[1][1]=d,this._result=this.computeIntersect(e,i,h,d)},Rt.prototype.getIntersectionNum=function(){return this._result},Rt.prototype.computeIntLineIndex=function(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var e=arguments[0];this.getEdgeDistance(e,0)>this.getEdgeDistance(e,1)?(this._intLineIndex[e][0]=0,this._intLineIndex[e][1]=1):(this._intLineIndex[e][0]=1,this._intLineIndex[e][1]=0)}},Rt.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},Rt.prototype.setPrecisionModel=function(e){this._precisionModel=e},Rt.prototype.isInteriorIntersection=function(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var e=arguments[0],i=0;i<this._result;i++)if(!this._intPt[i].equals2D(this._inputLines[e][0])&&!this._intPt[i].equals2D(this._inputLines[e][1]))return!0;return!1}},Rt.prototype.getIntersection=function(e){return this._intPt[e]},Rt.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},Rt.prototype.hasIntersection=function(){return this._result!==Rt.NO_INTERSECTION},Rt.prototype.getEdgeDistance=function(e,i){return Rt.computeEdgeDistance(this._intPt[i],this._inputLines[e][0],this._inputLines[e][1])},Rt.prototype.isCollinear=function(){return this._result===Rt.COLLINEAR_INTERSECTION},Rt.prototype.toString=function(){return Kt.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+Kt.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()},Rt.prototype.getEndpoint=function(e,i){return this._inputLines[e][i]},Rt.prototype.isIntersection=function(e){for(var i=0;i<this._result;i++)if(this._intPt[i].equals2D(e))return!0;return!1},Rt.prototype.getIntersectionAlongSegment=function(e,i){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[e][i]]},Rt.prototype.interfaces_=function(){return[]},Rt.prototype.getClass=function(){return Rt},Rt.computeEdgeDistance=function(e,i,h){var d=Math.abs(h.x-i.x),x=Math.abs(h.y-i.y),L=-1;if(e.equals(i))L=0;else if(e.equals(h))L=d>x?d:x;else{var F=Math.abs(e.x-i.x),K=Math.abs(e.y-i.y);0!==(L=d>x?F:K)||e.equals(i)||(L=Math.max(F,K))}return ot.isTrue(!(0===L&&!e.equals(i)),"Bad distance calculation"),L},Rt.nonRobustComputeEdgeDistance=function(e,i,h){var d=e.x-i.x,x=e.y-i.y,L=Math.sqrt(d*d+x*x);return ot.isTrue(!(0===L&&!e.equals(i)),"Invalid distance calculation"),L},ce.DONT_INTERSECT.get=function(){return 0},ce.DO_INTERSECT.get=function(){return 1},ce.COLLINEAR.get=function(){return 2},ce.NO_INTERSECTION.get=function(){return 0},ce.POINT_INTERSECTION.get=function(){return 1},ce.COLLINEAR_INTERSECTION.get=function(){return 2},Object.defineProperties(Rt,ce);var De=function(e){function i(){e.apply(this,arguments)}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.isInSegmentEnvelopes=function(h){var d=new qe(this._inputLines[0][0],this._inputLines[0][1]),x=new qe(this._inputLines[1][0],this._inputLines[1][1]);return d.contains(h)&&x.contains(h)},i.prototype.computeIntersection=function(){if(3!==arguments.length)return e.prototype.computeIntersection.apply(this,arguments);var h=arguments[0],d=arguments[1],x=arguments[2];if(this._isProper=!1,qe.intersects(d,x,h)&&0===Xe.orientationIndex(d,x,h)&&0===Xe.orientationIndex(x,d,h))return this._isProper=!0,(h.equals(d)||h.equals(x))&&(this._isProper=!1),this._result=e.POINT_INTERSECTION,null;this._result=e.NO_INTERSECTION},i.prototype.normalizeToMinimum=function(h,d,x,L,F){F.x=this.smallestInAbsValue(h.x,d.x,x.x,L.x),F.y=this.smallestInAbsValue(h.y,d.y,x.y,L.y),h.x-=F.x,h.y-=F.y,d.x-=F.x,d.y-=F.y,x.x-=F.x,x.y-=F.y,L.x-=F.x,L.y-=F.y},i.prototype.safeHCoordinateIntersection=function(h,d,x,L){var F=null;try{F=Sr.intersection(h,d,x,L)}catch(K){if(!(K instanceof kr))throw K;F=i.nearestEndpoint(h,d,x,L)}return F},i.prototype.intersection=function(h,d,x,L){var F=this.intersectionWithNormalization(h,d,x,L);return this.isInSegmentEnvelopes(F)||(F=new j(i.nearestEndpoint(h,d,x,L))),null!==this._precisionModel&&this._precisionModel.makePrecise(F),F},i.prototype.smallestInAbsValue=function(h,d,x,L){var F=h,K=Math.abs(F);return Math.abs(d)<K&&(F=d,K=Math.abs(d)),Math.abs(x)<K&&(F=x,K=Math.abs(x)),Math.abs(L)<K&&(F=L),F},i.prototype.checkDD=function(h,d,x,L,F){var K=ze.intersection(h,d,x,L),Mt=this.isInSegmentEnvelopes(K);Xr.out.println("DD in env = "+Mt+"  --------------------- "+K),F.distance(K)>1e-4&&Xr.out.println("Distance = "+F.distance(K))},i.prototype.intersectionWithNormalization=function(h,d,x,L){var F=new j(h),K=new j(d),Mt=new j(x),Qt=new j(L),ke=new j;this.normalizeToEnvCentre(F,K,Mt,Qt,ke);var Ge=this.safeHCoordinateIntersection(F,K,Mt,Qt);return Ge.x+=ke.x,Ge.y+=ke.y,Ge},i.prototype.computeCollinearIntersection=function(h,d,x,L){var F=qe.intersects(h,d,x),K=qe.intersects(h,d,L),Mt=qe.intersects(x,L,h),Qt=qe.intersects(x,L,d);return F&&K?(this._intPt[0]=x,this._intPt[1]=L,e.COLLINEAR_INTERSECTION):Mt&&Qt?(this._intPt[0]=h,this._intPt[1]=d,e.COLLINEAR_INTERSECTION):F&&Mt?(this._intPt[0]=x,this._intPt[1]=h,!x.equals(h)||K||Qt?e.COLLINEAR_INTERSECTION:e.POINT_INTERSECTION):F&&Qt?(this._intPt[0]=x,this._intPt[1]=d,!x.equals(d)||K||Mt?e.COLLINEAR_INTERSECTION:e.POINT_INTERSECTION):K&&Mt?(this._intPt[0]=L,this._intPt[1]=h,!L.equals(h)||F||Qt?e.COLLINEAR_INTERSECTION:e.POINT_INTERSECTION):K&&Qt?(this._intPt[0]=L,this._intPt[1]=d,!L.equals(d)||F||Mt?e.COLLINEAR_INTERSECTION:e.POINT_INTERSECTION):e.NO_INTERSECTION},i.prototype.normalizeToEnvCentre=function(h,d,x,L,F){var K=h.x<d.x?h.x:d.x,Mt=h.y<d.y?h.y:d.y,Qt=h.x>d.x?h.x:d.x,ke=h.y>d.y?h.y:d.y,Ge=x.x<L.x?x.x:L.x,gr=x.y<L.y?x.y:L.y,Ir=x.x>L.x?x.x:L.x,jr=x.y>L.y?x.y:L.y,Mi=((Mt>gr?Mt:gr)+(ke<jr?ke:jr))/2;F.x=((K>Ge?K:Ge)+(Qt<Ir?Qt:Ir))/2,F.y=Mi,h.x-=F.x,h.y-=F.y,d.x-=F.x,d.y-=F.y,x.x-=F.x,x.y-=F.y,L.x-=F.x,L.y-=F.y},i.prototype.computeIntersect=function(h,d,x,L){if(this._isProper=!1,!qe.intersects(h,d,x,L))return e.NO_INTERSECTION;var F=Xe.orientationIndex(h,d,x),K=Xe.orientationIndex(h,d,L);if(F>0&&K>0||F<0&&K<0)return e.NO_INTERSECTION;var Mt=Xe.orientationIndex(x,L,h),Qt=Xe.orientationIndex(x,L,d);return Mt>0&&Qt>0||Mt<0&&Qt<0?e.NO_INTERSECTION:0===F&&0===K&&0===Mt&&0===Qt?this.computeCollinearIntersection(h,d,x,L):(0===F||0===K||0===Mt||0===Qt?(this._isProper=!1,h.equals2D(x)||h.equals2D(L)?this._intPt[0]=h:d.equals2D(x)||d.equals2D(L)?this._intPt[0]=d:0===F?this._intPt[0]=new j(x):0===K?this._intPt[0]=new j(L):0===Mt?this._intPt[0]=new j(h):0===Qt&&(this._intPt[0]=new j(d))):(this._isProper=!0,this._intPt[0]=this.intersection(h,d,x,L)),e.POINT_INTERSECTION)},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i.nearestEndpoint=function(h,d,x,L){var F=h,K=Xe.distancePointLine(h,x,L),Mt=Xe.distancePointLine(d,x,L);return Mt<K&&(K=Mt,F=d),(Mt=Xe.distancePointLine(x,h,d))<K&&(K=Mt,F=x),(Mt=Xe.distancePointLine(L,h,d))<K&&(K=Mt,F=L),F},i}(Rt),Qe=function(){};Qe.prototype.interfaces_=function(){return[]},Qe.prototype.getClass=function(){return Qe},Qe.orientationIndex=function(e,i,h){return Qe.signOfDet2x2(i.x-e.x,i.y-e.y,h.x-i.x,h.y-i.y)},Qe.signOfDet2x2=function(e,i,h,d){var x=null,L=null,F=null;if(x=1,0===e||0===d)return 0===i||0===h?0:i>0?h>0?-x:x:h>0?x:-x;if(0===i||0===h)return d>0?e>0?x:-x:e>0?-x:x;if(i>0?d>0?i<=d||(x=-x,L=e,e=h,h=L,L=i,i=d,d=L):i<=-d?(x=-x,h=-h,d=-d):(L=e,e=-h,h=L,L=i,i=-d,d=L):d>0?-i<=d?(x=-x,e=-e,i=-i):(L=-e,e=h,h=L,L=-i,i=d,d=L):i>=d?(e=-e,i=-i,h=-h,d=-d):(x=-x,L=-e,e=-h,h=L,L=-i,i=-d,d=L),e>0){if(!(h>0&&e<=h))return x}else{if(h>0||!(e>=h))return-x;x=-x,e=-e,h=-h}for(;;){if((d-=(F=Math.floor(h/e))*i)<0)return-x;if(d>i)return x;if(e>(h-=F*e)+h){if(i<d+d)return x}else{if(i>d+d)return-x;h=e-h,d=i-d,x=-x}if(0===d)return 0===h?0:-x;if(0===h||(e-=(F=Math.floor(e/h))*h,(i-=F*d)<0))return x;if(i>d)return-x;if(h>e+e){if(d<i+i)return-x}else{if(d>i+i)return x;e=h-e,i=d-i,x=-x}if(0===i)return 0===e?0:x;if(0===e)return-x}};var nr=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1,this._p=arguments[0]};nr.prototype.countSegment=function(e,i){if(e.x<this._p.x&&i.x<this._p.x)return null;if(this._p.x===i.x&&this._p.y===i.y)return this._isPointOnSegment=!0,null;if(e.y===this._p.y&&i.y===this._p.y){var h=e.x,d=i.x;return h>d&&(h=i.x,d=e.x),this._p.x>=h&&this._p.x<=d&&(this._isPointOnSegment=!0),null}if(e.y>this._p.y&&i.y<=this._p.y||i.y>this._p.y&&e.y<=this._p.y){var L=e.y-this._p.y,K=i.y-this._p.y,Mt=Qe.signOfDet2x2(e.x-this._p.x,L,i.x-this._p.x,K);if(0===Mt)return this._isPointOnSegment=!0,null;K<L&&(Mt=-Mt),Mt>0&&this._crossingCount++}},nr.prototype.isPointInPolygon=function(){return this.getLocation()!==gt.EXTERIOR},nr.prototype.getLocation=function(){return this._isPointOnSegment?gt.BOUNDARY:this._crossingCount%2==1?gt.INTERIOR:gt.EXTERIOR},nr.prototype.isOnSegment=function(){return this._isPointOnSegment},nr.prototype.interfaces_=function(){return[]},nr.prototype.getClass=function(){return nr},nr.locatePointInRing=function(){if(arguments[0]instanceof j&&Ie(arguments[1],Me)){for(var i=arguments[1],h=new nr(arguments[0]),d=new j,x=new j,L=1;L<i.size();L++)if(i.getCoordinate(L,d),i.getCoordinate(L-1,x),h.countSegment(d,x),h.isOnSegment())return h.getLocation();return h.getLocation()}if(arguments[0]instanceof j&&arguments[1]instanceof Array){for(var K=arguments[1],Mt=new nr(arguments[0]),Qt=1;Qt<K.length;Qt++)if(Mt.countSegment(K[Qt],K[Qt-1]),Mt.isOnSegment())return Mt.getLocation();return Mt.getLocation()}};var Xe=function(){},pn={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};Xe.prototype.interfaces_=function(){return[]},Xe.prototype.getClass=function(){return Xe},Xe.orientationIndex=function(e,i,h){return ze.orientationIndex(e,i,h)},Xe.signedArea=function(){if(arguments[0]instanceof Array){var e=arguments[0];if(e.length<3)return 0;for(var i=0,h=e[0].x,d=1;d<e.length-1;d++)i+=(e[d].x-h)*(e[d-1].y-e[d+1].y);return i/2}if(Ie(arguments[0],Me)){var F=arguments[0],K=F.size();if(K<3)return 0;var Mt=new j,Qt=new j,ke=new j;F.getCoordinate(0,Qt),F.getCoordinate(1,ke);var Ge=Qt.x;ke.x-=Ge;for(var gr=0,Ir=1;Ir<K-1;Ir++)Mt.y=Qt.y,Qt.x=ke.x,Qt.y=ke.y,F.getCoordinate(Ir+1,ke),ke.x-=Ge,gr+=Qt.x*(Mt.y-ke.y);return gr/2}},Xe.distanceLineLine=function(e,i,h,d){if(e.equals(i))return Xe.distancePointLine(e,h,d);if(h.equals(d))return Xe.distancePointLine(d,e,i);var x=!1;if(qe.intersects(e,i,h,d)){var L=(i.x-e.x)*(d.y-h.y)-(i.y-e.y)*(d.x-h.x);if(0===L)x=!0;else{var K=((e.y-h.y)*(i.x-e.x)-(e.x-h.x)*(i.y-e.y))/L,Mt=((e.y-h.y)*(d.x-h.x)-(e.x-h.x)*(d.y-h.y))/L;(Mt<0||Mt>1||K<0||K>1)&&(x=!0)}}else x=!0;return x?It.min(Xe.distancePointLine(e,h,d),Xe.distancePointLine(i,h,d),Xe.distancePointLine(h,e,i),Xe.distancePointLine(d,e,i)):0},Xe.isPointInRing=function(e,i){return Xe.locatePointInRing(e,i)!==gt.EXTERIOR},Xe.computeLength=function(e){var i=e.size();if(i<=1)return 0;var h=0,d=new j;e.getCoordinate(0,d);for(var x=d.x,L=d.y,F=1;F<i;F++){e.getCoordinate(F,d);var K=d.x,Mt=d.y,Qt=K-x,ke=Mt-L;h+=Math.sqrt(Qt*Qt+ke*ke),x=K,L=Mt}return h},Xe.isCCW=function(e){var i=e.length-1;if(i<3)throw new tt("Ring has fewer than 4 points, so orientation cannot be determined");for(var h=e[0],d=0,x=1;x<=i;x++){var L=e[x];L.y>h.y&&(h=L,d=x)}var F=d;do{(F-=1)<0&&(F=i)}while(e[F].equals2D(h)&&F!==d);var K=d;do{K=(K+1)%i}while(e[K].equals2D(h)&&K!==d);var Mt=e[F],Qt=e[K];if(Mt.equals2D(h)||Qt.equals2D(h)||Mt.equals2D(Qt))return!1;var ke=Xe.computeOrientation(Mt,h,Qt);return 0===ke?Mt.x>Qt.x:ke>0},Xe.locatePointInRing=function(e,i){return nr.locatePointInRing(e,i)},Xe.distancePointLinePerpendicular=function(e,i,h){var d=(h.x-i.x)*(h.x-i.x)+(h.y-i.y)*(h.y-i.y);return Math.abs(((i.y-e.y)*(h.x-i.x)-(i.x-e.x)*(h.y-i.y))/d)*Math.sqrt(d)},Xe.computeOrientation=function(e,i,h){return Xe.orientationIndex(e,i,h)},Xe.distancePointLine=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1];if(0===i.length)throw new tt("Line array must contain at least one vertex");for(var h=e.distance(i[0]),d=0;d<i.length-1;d++){var x=Xe.distancePointLine(e,i[d],i[d+1]);x<h&&(h=x)}return h}if(3===arguments.length){var L=arguments[0],F=arguments[1],K=arguments[2];if(F.x===K.x&&F.y===K.y)return L.distance(F);var Mt=(K.x-F.x)*(K.x-F.x)+(K.y-F.y)*(K.y-F.y),Qt=((L.x-F.x)*(K.x-F.x)+(L.y-F.y)*(K.y-F.y))/Mt;return Qt<=0?L.distance(F):Qt>=1?L.distance(K):Math.abs(((F.y-L.y)*(K.x-F.x)-(F.x-L.x)*(K.y-F.y))/Mt)*Math.sqrt(Mt)}},Xe.isOnLine=function(e,i){for(var h=new De,d=1;d<i.length;d++)if(h.computeIntersection(e,i[d-1],i[d]),h.hasIntersection())return!0;return!1},pn.CLOCKWISE.get=function(){return-1},pn.RIGHT.get=function(){return Xe.CLOCKWISE},pn.COUNTERCLOCKWISE.get=function(){return 1},pn.LEFT.get=function(){return Xe.COUNTERCLOCKWISE},pn.COLLINEAR.get=function(){return 0},pn.STRAIGHT.get=function(){return Xe.COLLINEAR},Object.defineProperties(Xe,pn);var Kr=function(){};Kr.prototype.filter=function(e){},Kr.prototype.interfaces_=function(){return[]},Kr.prototype.getClass=function(){return Kr};var pr=function(){var e=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=e,this._SRID=e.getSRID()},un={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};pr.prototype.isGeometryCollection=function(){return this.getSortIndex()===pr.SORTINDEX_GEOMETRYCOLLECTION},pr.prototype.getFactory=function(){return this._factory},pr.prototype.getGeometryN=function(e){return this},pr.prototype.getArea=function(){return 0},pr.prototype.isRectangle=function(){return!1},pr.prototype.equals=function(){if(arguments[0]instanceof pr){var e=arguments[0];return null!==e&&this.equalsTopo(e)}if(arguments[0]instanceof Object){var i=arguments[0];return i instanceof pr&&this.equalsExact(i)}},pr.prototype.equalsExact=function(e){return this===e||this.equalsExact(e,0)},pr.prototype.geometryChanged=function(){this.apply(pr.geometryChangedFilter)},pr.prototype.geometryChangedAction=function(){this._envelope=null},pr.prototype.equalsNorm=function(e){return null!==e&&this.norm().equalsExact(e.norm())},pr.prototype.getLength=function(){return 0},pr.prototype.getNumGeometries=function(){return 1},pr.prototype.compareTo=function(){if(1===arguments.length){var e=arguments[0],i=e;return this.getSortIndex()!==i.getSortIndex()?this.getSortIndex()-i.getSortIndex():this.isEmpty()&&i.isEmpty()?0:this.isEmpty()?-1:i.isEmpty()?1:this.compareToSameClass(e)}if(2===arguments.length){var h=arguments[0],d=arguments[1];return this.getSortIndex()!==h.getSortIndex()?this.getSortIndex()-h.getSortIndex():this.isEmpty()&&h.isEmpty()?0:this.isEmpty()?-1:h.isEmpty()?1:this.compareToSameClass(h,d)}},pr.prototype.getUserData=function(){return this._userData},pr.prototype.getSRID=function(){return this._SRID},pr.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},pr.prototype.checkNotGeometryCollection=function(e){if(e.getSortIndex()===pr.SORTINDEX_GEOMETRYCOLLECTION)throw new tt("This method does not support GeometryCollection arguments")},pr.prototype.equal=function(e,i,h){return 0===h?e.equals(i):e.distance(i)<=h},pr.prototype.norm=function(){var e=this.copy();return e.normalize(),e},pr.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()},pr.prototype.getEnvelopeInternal=function(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new qe(this._envelope)},pr.prototype.setSRID=function(e){this._SRID=e},pr.prototype.setUserData=function(e){this._userData=e},pr.prototype.compare=function(e,i){for(var h=e.iterator(),d=i.iterator();h.hasNext()&&d.hasNext();){var x=h.next(),L=d.next(),F=x.compareTo(L);if(0!==F)return F}return h.hasNext()?1:d.hasNext()?-1:0},pr.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()},pr.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===pr.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===pr.SORTINDEX_MULTIPOINT||this.getSortIndex()===pr.SORTINDEX_MULTILINESTRING||this.getSortIndex()===pr.SORTINDEX_MULTIPOLYGON},pr.prototype.interfaces_=function(){return[et,H,dt]},pr.prototype.getClass=function(){return pr},pr.hasNonEmptyElements=function(e){for(var i=0;i<e.length;i++)if(!e[i].isEmpty())return!0;return!1},pr.hasNullElements=function(e){for(var i=0;i<e.length;i++)if(null===e[i])return!0;return!1},un.serialVersionUID.get=function(){return 0x799ea46522854c00},un.SORTINDEX_POINT.get=function(){return 0},un.SORTINDEX_MULTIPOINT.get=function(){return 1},un.SORTINDEX_LINESTRING.get=function(){return 2},un.SORTINDEX_LINEARRING.get=function(){return 3},un.SORTINDEX_MULTILINESTRING.get=function(){return 4},un.SORTINDEX_POLYGON.get=function(){return 5},un.SORTINDEX_MULTIPOLYGON.get=function(){return 6},un.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7},un.geometryChangedFilter.get=function(){return ei},Object.defineProperties(pr,un);var ei=function(){};ei.interfaces_=function(){return[Kr]},ei.filter=function(e){e.geometryChangedAction()};var Kn=function(){};Kn.prototype.filter=function(e){},Kn.prototype.interfaces_=function(){return[]},Kn.prototype.getClass=function(){return Kn};var Gn=function(){},Mn={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};Gn.prototype.isInBoundary=function(e){},Gn.prototype.interfaces_=function(){return[]},Gn.prototype.getClass=function(){return Gn},Mn.Mod2BoundaryNodeRule.get=function(){return on},Mn.EndPointBoundaryNodeRule.get=function(){return bi},Mn.MultiValentEndPointBoundaryNodeRule.get=function(){return To},Mn.MonoValentEndPointBoundaryNodeRule.get=function(){return oa},Mn.MOD2_BOUNDARY_RULE.get=function(){return new on},Mn.ENDPOINT_BOUNDARY_RULE.get=function(){return new bi},Mn.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new To},Mn.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new oa},Mn.OGC_SFS_BOUNDARY_RULE.get=function(){return Gn.MOD2_BOUNDARY_RULE},Object.defineProperties(Gn,Mn);var on=function(){};on.prototype.isInBoundary=function(e){return e%2==1},on.prototype.interfaces_=function(){return[Gn]},on.prototype.getClass=function(){return on};var bi=function(){};bi.prototype.isInBoundary=function(e){return e>0},bi.prototype.interfaces_=function(){return[Gn]},bi.prototype.getClass=function(){return bi};var To=function(){};To.prototype.isInBoundary=function(e){return e>1},To.prototype.interfaces_=function(){return[Gn]},To.prototype.getClass=function(){return To};var oa=function(){};oa.prototype.isInBoundary=function(e){return 1===e},oa.prototype.interfaces_=function(){return[Gn]},oa.prototype.getClass=function(){return oa};var gi=function(){};gi.prototype.add=function(){},gi.prototype.addAll=function(){},gi.prototype.isEmpty=function(){},gi.prototype.iterator=function(){},gi.prototype.size=function(){},gi.prototype.toArray=function(){},gi.prototype.remove=function(){},(Tt.prototype=new Error).name="IndexOutOfBoundsException";var vo=function(){};vo.prototype.hasNext=function(){},vo.prototype.next=function(){},vo.prototype.remove=function(){};var On=function(e){function i(){e.apply(this,arguments)}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.get=function(){},i.prototype.set=function(){},i.prototype.isEmpty=function(){},i}(gi);(s.prototype=new Error).name="NoSuchElementException";var or=function(e){function i(){e.call(this),this.array_=[],arguments[0]instanceof gi&&this.addAll(arguments[0])}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.ensureCapacity=function(){},i.prototype.interfaces_=function(){return[e,gi]},i.prototype.add=function(h){return 1===arguments.length?this.array_.push(h):this.array_.splice(arguments[0],arguments[1]),!0},i.prototype.clear=function(){this.array_=[]},i.prototype.addAll=function(h){for(var d=h.iterator();d.hasNext();)this.add(d.next());return!0},i.prototype.set=function(h,d){var x=this.array_[h];return this.array_[h]=d,x},i.prototype.iterator=function(){return new wi(this)},i.prototype.get=function(h){if(h<0||h>=this.size())throw new Tt;return this.array_[h]},i.prototype.isEmpty=function(){return 0===this.array_.length},i.prototype.size=function(){return this.array_.length},i.prototype.toArray=function(){for(var h=[],d=0,x=this.array_.length;d<x;d++)h.push(this.array_[d]);return h},i.prototype.remove=function(h){for(var d=!1,x=0,L=this.array_.length;x<L;x++)if(this.array_[x]===h){this.array_.splice(x,1),d=!0;break}return d},i}(On),wi=function(e){function i(h){e.call(this),this.arrayList_=h,this.position_=0}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new s;return this.arrayList_.get(this.position_++)},i.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},i.prototype.set=function(h){return this.arrayList_.set(this.position_-1,h)},i.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},i}(vo),Y=function(e){function i(){if(e.call(this),0!==arguments.length)if(1===arguments.length){var d=arguments[0];this.ensureCapacity(d.length),this.add(d,!0)}else if(2===arguments.length){var x=arguments[0],L=arguments[1];this.ensureCapacity(x.length),this.add(x,L)}}e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i;var h={coordArrayType:{configurable:!0}};return h.coordArrayType.get=function(){return new Array(0).fill(null)},i.prototype.getCoordinate=function(d){return this.get(d)},i.prototype.addAll=function(){if(2===arguments.length){for(var x=arguments[1],L=!1,F=arguments[0].iterator();F.hasNext();)this.add(F.next(),x),L=!0;return L}return e.prototype.addAll.apply(this,arguments)},i.prototype.clone=function(){for(var d=e.prototype.clone.call(this),x=0;x<this.size();x++)d.add(x,this.get(x).copy());return d},i.prototype.toCoordinateArray=function(){return this.toArray(i.coordArrayType)},i.prototype.add=function(){if(1===arguments.length)e.prototype.add.call(this,arguments[0]);else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1])return this.add(arguments[0],arguments[1],!0),!0;if(arguments[0]instanceof j&&"boolean"==typeof arguments[1]){var F=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(F))return null;e.prototype.add.call(this,F)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1])return this.add(arguments[0],arguments[1]),!0}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var Qt=arguments[0],ke=arguments[1];if(arguments[2])for(var Ge=0;Ge<Qt.length;Ge++)this.add(Qt[Ge],ke);else for(var gr=Qt.length-1;gr>=0;gr--)this.add(Qt[gr],ke);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof j){var Ir=arguments[0],jr=arguments[1];if(!arguments[2]){var ln=this.size();if(ln>0&&(Ir>0&&this.get(Ir-1).equals2D(jr)||Ir<ln&&this.get(Ir).equals2D(jr)))return null}e.prototype.add.call(this,Ir,jr)}}else if(4===arguments.length){var Mi=arguments[0],l=arguments[1],f=arguments[2],c=arguments[3],m=1;f>c&&(m=-1);for(var E=f;E!==c;E+=m)this.add(Mi[E],l);return!0}},i.prototype.closeRing=function(){this.size()>0&&this.add(new j(this.get(0)),!1)},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},Object.defineProperties(i,h),i}(or),W=function(){},pt={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};pt.ForwardComparator.get=function(){return bt},pt.BidirectionalComparator.get=function(){return Ft},pt.coordArrayType.get=function(){return new Array(0).fill(null)},W.prototype.interfaces_=function(){return[]},W.prototype.getClass=function(){return W},W.isRing=function(e){return!(e.length<4||!e[0].equals2D(e[e.length-1]))},W.ptNotInList=function(e,i){for(var h=0;h<e.length;h++){var d=e[h];if(W.indexOf(d,i)<0)return d}return null},W.scroll=function(e,i){var h=W.indexOf(i,e);if(h<0)return null;var d=new Array(e.length).fill(null);Xr.arraycopy(e,h,d,0,e.length-h),Xr.arraycopy(e,0,d,e.length-h,h),Xr.arraycopy(d,0,e,0,e.length)},W.equals=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1];if(e===i)return!0;if(null===e||null===i||e.length!==i.length)return!1;for(var h=0;h<e.length;h++)if(!e[h].equals(i[h]))return!1;return!0}if(3===arguments.length){var d=arguments[0],x=arguments[1],L=arguments[2];if(d===x)return!0;if(null===d||null===x||d.length!==x.length)return!1;for(var F=0;F<d.length;F++)if(0!==L.compare(d[F],x[F]))return!1;return!0}},W.intersection=function(e,i){for(var h=new Y,d=0;d<e.length;d++)i.intersects(e[d])&&h.add(e[d],!0);return h.toCoordinateArray()},W.hasRepeatedPoints=function(e){for(var i=1;i<e.length;i++)if(e[i-1].equals(e[i]))return!0;return!1},W.removeRepeatedPoints=function(e){return W.hasRepeatedPoints(e)?new Y(e,!1).toCoordinateArray():e},W.reverse=function(e){for(var i=e.length-1,h=Math.trunc(i/2),d=0;d<=h;d++){var x=e[d];e[d]=e[i-d],e[i-d]=x}},W.removeNull=function(e){for(var i=0,h=0;h<e.length;h++)null!==e[h]&&i++;var d=new Array(i).fill(null);if(0===i)return d;for(var x=0,L=0;L<e.length;L++)null!==e[L]&&(d[x++]=e[L]);return d},W.copyDeep=function(){if(1===arguments.length){for(var e=arguments[0],i=new Array(e.length).fill(null),h=0;h<e.length;h++)i[h]=new j(e[h]);return i}if(5===arguments.length)for(var d=arguments[0],x=arguments[1],L=arguments[2],F=arguments[3],K=arguments[4],Mt=0;Mt<K;Mt++)L[F+Mt]=new j(d[x+Mt])},W.isEqualReversed=function(e,i){for(var h=0;h<e.length;h++)if(0!==e[h].compareTo(i[e.length-h-1]))return!1;return!0},W.envelope=function(e){for(var i=new qe,h=0;h<e.length;h++)i.expandToInclude(e[h]);return i},W.toCoordinateArray=function(e){return e.toArray(W.coordArrayType)},W.atLeastNCoordinatesOrNothing=function(e,i){return i.length>=e?i:[]},W.indexOf=function(e,i){for(var h=0;h<i.length;h++)if(e.equals(i[h]))return h;return-1},W.increasingDirection=function(e){for(var i=0;i<Math.trunc(e.length/2);i++){var d=e[i].compareTo(e[e.length-1-i]);if(0!==d)return d}return 1},W.compare=function(e,i){for(var h=0;h<e.length&&h<i.length;){var d=e[h].compareTo(i[h]);if(0!==d)return d;h++}return h<i.length?-1:h<e.length?1:0},W.minCoordinate=function(e){for(var i=null,h=0;h<e.length;h++)(null===i||i.compareTo(e[h])>0)&&(i=e[h]);return i},W.extract=function(e,i,h){i=It.clamp(i,0,e.length);var d=(h=It.clamp(h,-1,e.length))-i+1;h<0&&(d=0),i>=e.length&&(d=0),h<i&&(d=0);var x=new Array(d).fill(null);if(0===d)return x;for(var L=0,F=i;F<=h;F++)x[L++]=e[F];return x},Object.defineProperties(W,pt);var bt=function(){};bt.prototype.compare=function(e,i){return W.compare(e,i)},bt.prototype.interfaces_=function(){return[at]},bt.prototype.getClass=function(){return bt};var Ft=function(){};Ft.prototype.compare=function(e,i){var h=e,d=i;if(h.length<d.length)return-1;if(h.length>d.length)return 1;if(0===h.length)return 0;var x=W.compare(h,d);return W.isEqualReversed(h,d)?0:x},Ft.prototype.OLDcompare=function(e,i){var h=e,d=i;if(h.length<d.length)return-1;if(h.length>d.length)return 1;if(0===h.length)return 0;for(var x=W.increasingDirection(h),L=W.increasingDirection(d),F=x>0?0:h.length-1,K=L>0?0:h.length-1,Mt=0;Mt<h.length;Mt++){var Qt=h[F].compareTo(d[K]);if(0!==Qt)return Qt;F+=x,K+=L}return 0},Ft.prototype.interfaces_=function(){return[at]},Ft.prototype.getClass=function(){return Ft};var se=function(){};se.prototype.get=function(){},se.prototype.put=function(){},se.prototype.size=function(){},se.prototype.values=function(){},se.prototype.entrySet=function(){};var me=function(e){function i(){e.apply(this,arguments)}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i}(se);(lt.prototype=new Error).name="OperationNotSupported",(ht.prototype=new gi).contains=function(){};var ue=function(e){function i(){e.call(this),this.array_=[],arguments[0]instanceof gi&&this.addAll(arguments[0])}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.contains=function(h){for(var d=0,x=this.array_.length;d<x;d++)if(this.array_[d]===h)return!0;return!1},i.prototype.add=function(h){return!this.contains(h)&&(this.array_.push(h),!0)},i.prototype.addAll=function(h){for(var d=h.iterator();d.hasNext();)this.add(d.next());return!0},i.prototype.remove=function(h){throw new Error},i.prototype.size=function(){return this.array_.length},i.prototype.isEmpty=function(){return 0===this.array_.length},i.prototype.toArray=function(){for(var h=[],d=0,x=this.array_.length;d<x;d++)h.push(this.array_[d]);return h},i.prototype.iterator=function(){return new Dt(this)},i}(ht),Dt=function(e){function i(h){e.call(this),this.hashSet_=h,this.position_=0}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new s;return this.hashSet_.array_[this.position_++]},i.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},i.prototype.remove=function(){throw new lt},i}(vo),Ht=0;(yt.prototype=new me).get=function(e){for(var i=this.root_;null!==i;){var h=e.compareTo(i.key);if(h<0)i=i.left;else{if(!(h>0))return i.value;i=i.right}}return null},yt.prototype.put=function(e,i){if(null===this.root_)return this.root_={key:e,value:i,left:null,right:null,parent:null,color:Ht,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var h,d,x=this.root_;do{if(h=x,(d=e.compareTo(x.key))<0)x=x.left;else{if(!(d>0)){var L=x.value;return x.value=i,L}x=x.right}}while(null!==x);var F={key:e,left:null,right:null,value:i,parent:h,color:Ht,getValue:function(){return this.value},getKey:function(){return this.key}};return d<0?h.left=F:h.right=F,this.fixAfterInsertion(F),this.size_++,null},yt.prototype.fixAfterInsertion=function(e){for(e.color=1;null!=e&&e!==this.root_&&1===e.parent.color;)if(Nt(e)===qt(Nt(Nt(e)))){var i=_e(Nt(Nt(e)));1===Lt(i)?($t(Nt(e),Ht),$t(i,Ht),$t(Nt(Nt(e)),1),e=Nt(Nt(e))):(e===_e(Nt(e))&&(e=Nt(e),this.rotateLeft(e)),$t(Nt(e),Ht),$t(Nt(Nt(e)),1),this.rotateRight(Nt(Nt(e))))}else{var h=qt(Nt(Nt(e)));1===Lt(h)?($t(Nt(e),Ht),$t(h,Ht),$t(Nt(Nt(e)),1),e=Nt(Nt(e))):(e===qt(Nt(e))&&(e=Nt(e),this.rotateRight(e)),$t(Nt(e),Ht),$t(Nt(Nt(e)),1),this.rotateLeft(Nt(Nt(e))))}this.root_.color=Ht},yt.prototype.values=function(){var e=new or,i=this.getFirstEntry();if(null!==i)for(e.add(i.value);null!==(i=yt.successor(i));)e.add(i.value);return e},yt.prototype.entrySet=function(){var e=new ue,i=this.getFirstEntry();if(null!==i)for(e.add(i);null!==(i=yt.successor(i));)e.add(i);return e},yt.prototype.rotateLeft=function(e){if(null!=e){var i=e.right;e.right=i.left,null!=i.left&&(i.left.parent=e),i.parent=e.parent,null===e.parent?this.root_=i:e.parent.left===e?e.parent.left=i:e.parent.right=i,i.left=e,e.parent=i}},yt.prototype.rotateRight=function(e){if(null!=e){var i=e.left;e.left=i.right,null!=i.right&&(i.right.parent=e),i.parent=e.parent,null===e.parent?this.root_=i:e.parent.right===e?e.parent.right=i:e.parent.left=i,i.right=e,e.parent=i}},yt.prototype.getFirstEntry=function(){var e=this.root_;if(null!=e)for(;null!=e.left;)e=e.left;return e},yt.successor=function(e){if(null===e)return null;if(null!==e.right){for(var i=e.right;null!==i.left;)i=i.left;return i}for(var h=e.parent,d=e;null!==h&&d===h.right;)d=h,h=h.parent;return h},yt.prototype.size=function(){return this.size_};var ir=function(){};ir.prototype.interfaces_=function(){return[]},ir.prototype.getClass=function(){return ir},xt.prototype=new ht,(Yt.prototype=new xt).contains=function(e){for(var i=0,h=this.array_.length;i<h;i++)if(0===this.array_[i].compareTo(e))return!0;return!1},Yt.prototype.add=function(e){if(this.contains(e))return!1;for(var i=0,h=this.array_.length;i<h;i++)if(1===this.array_[i].compareTo(e))return this.array_.splice(i,0,e),!0;return this.array_.push(e),!0},Yt.prototype.addAll=function(e){for(var i=e.iterator();i.hasNext();)this.add(i.next());return!0},Yt.prototype.remove=function(e){throw new lt},Yt.prototype.size=function(){return this.array_.length},Yt.prototype.isEmpty=function(){return 0===this.array_.length},Yt.prototype.toArray=function(){for(var e=[],i=0,h=this.array_.length;i<h;i++)e.push(this.array_[i]);return e},Yt.prototype.iterator=function(){return new mr(this)};var mr=function(e){this.treeSet_=e,this.position_=0};mr.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new s;return this.treeSet_.array_[this.position_++]},mr.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},mr.prototype.remove=function(){throw new lt};var Te=function(){};Te.sort=function(){var e,i,h,x=arguments[0];if(1===arguments.length)x.sort(function(F,K){return F.compareTo(K)});else if(2===arguments.length)h=arguments[1],x.sort(function(F,K){return h.compare(F,K)});else if(3===arguments.length){(i=x.slice(arguments[1],arguments[2])).sort();var L=x.slice(0,arguments[1]).concat(i,x.slice(arguments[2],x.length));for(x.splice(0,x.length),e=0;e<L.length;e++)x.push(L[e])}else if(4===arguments.length)for(i=x.slice(arguments[1],arguments[2]),h=arguments[3],i.sort(function(F,K){return h.compare(F,K)}),L=x.slice(0,arguments[1]).concat(i,x.slice(arguments[2],x.length)),x.splice(0,x.length),e=0;e<L.length;e++)x.push(L[e])},Te.asList=function(e){for(var i=new or,h=0,d=e.length;h<d;h++)i.add(e[h]);return i};var Ye=function(){},vr={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};vr.P.get=function(){return 0},vr.L.get=function(){return 1},vr.A.get=function(){return 2},vr.FALSE.get=function(){return-1},vr.TRUE.get=function(){return-2},vr.DONTCARE.get=function(){return-3},vr.SYM_FALSE.get=function(){return"F"},vr.SYM_TRUE.get=function(){return"T"},vr.SYM_DONTCARE.get=function(){return"*"},vr.SYM_P.get=function(){return"0"},vr.SYM_L.get=function(){return"1"},vr.SYM_A.get=function(){return"2"},Ye.prototype.interfaces_=function(){return[]},Ye.prototype.getClass=function(){return Ye},Ye.toDimensionSymbol=function(e){switch(e){case Ye.FALSE:return Ye.SYM_FALSE;case Ye.TRUE:return Ye.SYM_TRUE;case Ye.DONTCARE:return Ye.SYM_DONTCARE;case Ye.P:return Ye.SYM_P;case Ye.L:return Ye.SYM_L;case Ye.A:return Ye.SYM_A}throw new tt("Unknown dimension value: "+e)},Ye.toDimensionValue=function(e){switch(le.toUpperCase(e)){case Ye.SYM_FALSE:return Ye.FALSE;case Ye.SYM_TRUE:return Ye.TRUE;case Ye.SYM_DONTCARE:return Ye.DONTCARE;case Ye.SYM_P:return Ye.P;case Ye.SYM_L:return Ye.L;case Ye.SYM_A:return Ye.A}throw new tt("Unknown dimension symbol: "+e)},Object.defineProperties(Ye,vr);var _r=function(){};_r.prototype.filter=function(e){},_r.prototype.interfaces_=function(){return[]},_r.prototype.getClass=function(){return _r};var Pr=function(){};Pr.prototype.filter=function(e,i){},Pr.prototype.isDone=function(){},Pr.prototype.isGeometryChanged=function(){},Pr.prototype.interfaces_=function(){return[]},Pr.prototype.getClass=function(){return Pr};var He=function(e){function i(d,x){if(e.call(this,x),this._geometries=d||[],e.hasNullElements(this._geometries))throw new tt("geometries must not contain null elements")}e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i;var h={serialVersionUID:{configurable:!0}};return i.prototype.computeEnvelopeInternal=function(){for(var d=new qe,x=0;x<this._geometries.length;x++)d.expandToInclude(this._geometries[x].getEnvelopeInternal());return d},i.prototype.getGeometryN=function(d){return this._geometries[d]},i.prototype.getSortIndex=function(){return e.SORTINDEX_GEOMETRYCOLLECTION},i.prototype.getCoordinates=function(){for(var d=new Array(this.getNumPoints()).fill(null),x=-1,L=0;L<this._geometries.length;L++)for(var F=this._geometries[L].getCoordinates(),K=0;K<F.length;K++)d[++x]=F[K];return d},i.prototype.getArea=function(){for(var d=0,x=0;x<this._geometries.length;x++)d+=this._geometries[x].getArea();return d},i.prototype.equalsExact=function(){if(2===arguments.length){var d=arguments[0],x=arguments[1];if(!this.isEquivalentClass(d))return!1;var L=d;if(this._geometries.length!==L._geometries.length)return!1;for(var F=0;F<this._geometries.length;F++)if(!this._geometries[F].equalsExact(L._geometries[F],x))return!1;return!0}return e.prototype.equalsExact.apply(this,arguments)},i.prototype.normalize=function(){for(var d=0;d<this._geometries.length;d++)this._geometries[d].normalize();Te.sort(this._geometries)},i.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},i.prototype.getBoundaryDimension=function(){for(var d=Ye.FALSE,x=0;x<this._geometries.length;x++)d=Math.max(d,this._geometries[x].getBoundaryDimension());return d},i.prototype.getDimension=function(){for(var d=Ye.FALSE,x=0;x<this._geometries.length;x++)d=Math.max(d,this._geometries[x].getDimension());return d},i.prototype.getLength=function(){for(var d=0,x=0;x<this._geometries.length;x++)d+=this._geometries[x].getLength();return d},i.prototype.getNumPoints=function(){for(var d=0,x=0;x<this._geometries.length;x++)d+=this._geometries[x].getNumPoints();return d},i.prototype.getNumGeometries=function(){return this._geometries.length},i.prototype.reverse=function(){for(var x=new Array(this._geometries.length).fill(null),L=0;L<this._geometries.length;L++)x[L]=this._geometries[L].reverse();return this.getFactory().createGeometryCollection(x)},i.prototype.compareToSameClass=function(){if(1===arguments.length){var d=arguments[0],x=new Yt(Te.asList(this._geometries)),L=new Yt(Te.asList(d._geometries));return this.compare(x,L)}if(2===arguments.length){for(var K=arguments[1],Mt=arguments[0],Qt=this.getNumGeometries(),ke=Mt.getNumGeometries(),Ge=0;Ge<Qt&&Ge<ke;){var gr=this.getGeometryN(Ge),Ir=Mt.getGeometryN(Ge),jr=gr.compareToSameClass(Ir,K);if(0!==jr)return jr;Ge++}return Ge<Qt?1:Ge<ke?-1:0}},i.prototype.apply=function(){if(Ie(arguments[0],Kn))for(var d=arguments[0],x=0;x<this._geometries.length;x++)this._geometries[x].apply(d);else if(Ie(arguments[0],Pr)){var L=arguments[0];if(0===this._geometries.length)return null;for(var F=0;F<this._geometries.length&&(this._geometries[F].apply(L),!L.isDone());F++);L.isGeometryChanged()&&this.geometryChanged()}else if(Ie(arguments[0],_r)){var K=arguments[0];K.filter(this);for(var Mt=0;Mt<this._geometries.length;Mt++)this._geometries[Mt].apply(K)}else if(Ie(arguments[0],Kr)){var Qt=arguments[0];Qt.filter(this);for(var ke=0;ke<this._geometries.length;ke++)this._geometries[ke].apply(Qt)}},i.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),ot.shouldNeverReachHere(),null},i.prototype.clone=function(){var d=e.prototype.clone.call(this);d._geometries=new Array(this._geometries.length).fill(null);for(var x=0;x<this._geometries.length;x++)d._geometries[x]=this._geometries[x].clone();return d},i.prototype.getGeometryType=function(){return"GeometryCollection"},i.prototype.copy=function(){for(var d=new Array(this._geometries.length).fill(null),x=0;x<d.length;x++)d[x]=this._geometries[x].copy();return new i(d,this._factory)},i.prototype.isEmpty=function(){for(var d=0;d<this._geometries.length;d++)if(!this._geometries[d].isEmpty())return!1;return!0},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},h.serialVersionUID.get=function(){return-0x4f07bcb1f857d800},Object.defineProperties(i,h),i}(pr),yr=function(e){function i(){e.apply(this,arguments)}e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i;var h={serialVersionUID:{configurable:!0}};return i.prototype.getSortIndex=function(){return pr.SORTINDEX_MULTILINESTRING},i.prototype.equalsExact=function(){if(2===arguments.length){var d=arguments[0],x=arguments[1];return!!this.isEquivalentClass(d)&&e.prototype.equalsExact.call(this,d,x)}return e.prototype.equalsExact.apply(this,arguments)},i.prototype.getBoundaryDimension=function(){return this.isClosed()?Ye.FALSE:0},i.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var d=0;d<this._geometries.length;d++)if(!this._geometries[d].isClosed())return!1;return!0},i.prototype.getDimension=function(){return 1},i.prototype.reverse=function(){for(var d=this._geometries.length,x=new Array(d).fill(null),L=0;L<this._geometries.length;L++)x[d-1-L]=this._geometries[L].reverse();return this.getFactory().createMultiLineString(x)},i.prototype.getBoundary=function(){return new Ke(this).getBoundary()},i.prototype.getGeometryType=function(){return"MultiLineString"},i.prototype.copy=function(){for(var d=new Array(this._geometries.length).fill(null),x=0;x<d.length;x++)d[x]=this._geometries[x].copy();return new i(d,this._factory)},i.prototype.interfaces_=function(){return[ir]},i.prototype.getClass=function(){return i},h.serialVersionUID.get=function(){return 0x7155d2ab4afa8000},Object.defineProperties(i,h),i}(He),Ke=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length){var e=arguments[0],i=Gn.MOD2_BOUNDARY_RULE;this._geom=e,this._geomFact=e.getFactory(),this._bnRule=i}else if(2===arguments.length){var h=arguments[0],d=arguments[1];this._geom=h,this._geomFact=h.getFactory(),this._bnRule=d}};Ke.prototype.boundaryMultiLineString=function(e){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var i=this.computeBoundaryCoordinates(e);return 1===i.length?this._geomFact.createPoint(i[0]):this._geomFact.createMultiPointFromCoords(i)},Ke.prototype.getBoundary=function(){return this._geom instanceof Nr?this.boundaryLineString(this._geom):this._geom instanceof yr?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()},Ke.prototype.boundaryLineString=function(e){return this._geom.isEmpty()?this.getEmptyMultiPoint():e.isClosed()?this._bnRule.isInBoundary(2)?e.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([e.getStartPoint(),e.getEndPoint()])},Ke.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()},Ke.prototype.computeBoundaryCoordinates=function(e){var i=new or;this._endpointMap=new yt;for(var h=0;h<e.getNumGeometries();h++){var d=e.getGeometryN(h);0!==d.getNumPoints()&&(this.addEndpoint(d.getCoordinateN(0)),this.addEndpoint(d.getCoordinateN(d.getNumPoints()-1)))}for(var x=this._endpointMap.entrySet().iterator();x.hasNext();){var L=x.next(),F=L.getValue().count;this._bnRule.isInBoundary(F)&&i.add(L.getKey())}return W.toCoordinateArray(i)},Ke.prototype.addEndpoint=function(e){var i=this._endpointMap.get(e);null===i&&(i=new wn,this._endpointMap.put(e,i)),i.count++},Ke.prototype.interfaces_=function(){return[]},Ke.prototype.getClass=function(){return Ke},Ke.getBoundary=function(){return 1===arguments.length?new Ke(arguments[0]).getBoundary():2===arguments.length?new Ke(arguments[0],arguments[1]).getBoundary():void 0};var wn=function(){this.count=null};wn.prototype.interfaces_=function(){return[]},wn.prototype.getClass=function(){return wn};var an=function(){},Lr={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};an.prototype.interfaces_=function(){return[]},an.prototype.getClass=function(){return an},an.chars=function(e,i){for(var h=new Array(i).fill(null),d=0;d<i;d++)h[d]=e;return String(h)},an.getStackTrace=function(){if(1===arguments.length){var e=arguments[0],i=new function(){},h=new function(){}(i);return e.printStackTrace(h),i.toString()}if(2===arguments.length){for(var x=arguments[1],L="",F=new function(){}(new function(){}(an.getStackTrace(arguments[0]))),K=0;K<x;K++)try{L+=F.readLine()+an.NEWLINE}catch(Mt){if(!(Mt instanceof ge))throw Mt;ot.shouldNeverReachHere()}return L}},an.split=function(e,i){for(var h=i.length,d=new or,x=""+e,L=x.indexOf(i);L>=0;){var F=x.substring(0,L);d.add(F),L=(x=x.substring(L+h)).indexOf(i)}x.length>0&&d.add(x);for(var K=new Array(d.size()).fill(null),Mt=0;Mt<K.length;Mt++)K[Mt]=d.get(Mt);return K},an.toString=function(){if(1===arguments.length)return an.SIMPLE_ORDINATE_FORMAT.format(arguments[0])},an.spaces=function(e){return an.chars(" ",e)},Lr.NEWLINE.get=function(){return Xr.getProperty("line.separator")},Lr.SIMPLE_ORDINATE_FORMAT.get=function(){return new function(){}("0.#")},Object.defineProperties(an,Lr);var _n=function(){};_n.prototype.interfaces_=function(){return[]},_n.prototype.getClass=function(){return _n},_n.copyCoord=function(e,i,h,d){for(var x=Math.min(e.getDimension(),h.getDimension()),L=0;L<x;L++)h.setOrdinate(d,L,e.getOrdinate(i,L))},_n.isRing=function(e){var i=e.size();return 0===i||!(i<=3)&&e.getOrdinate(0,Me.X)===e.getOrdinate(i-1,Me.X)&&e.getOrdinate(0,Me.Y)===e.getOrdinate(i-1,Me.Y)},_n.isEqual=function(e,i){var h=e.size();if(h!==i.size())return!1;for(var d=Math.min(e.getDimension(),i.getDimension()),x=0;x<h;x++)for(var L=0;L<d;L++){var F=e.getOrdinate(x,L),K=i.getOrdinate(x,L);if(!(e.getOrdinate(x,L)===i.getOrdinate(x,L)||X.isNaN(F)&&X.isNaN(K)))return!1}return!0},_n.extend=function(e,i,h){var d=e.create(h,i.getDimension()),x=i.size();if(_n.copy(i,0,d,0,x),x>0)for(var L=x;L<h;L++)_n.copy(i,x-1,d,L,1);return d},_n.reverse=function(e){for(var i=e.size()-1,h=Math.trunc(i/2),d=0;d<=h;d++)_n.swap(e,d,i-d)},_n.swap=function(e,i,h){if(i===h)return null;for(var d=0;d<e.getDimension();d++){var x=e.getOrdinate(i,d);e.setOrdinate(i,d,e.getOrdinate(h,d)),e.setOrdinate(h,d,x)}},_n.copy=function(e,i,h,d,x){for(var L=0;L<x;L++)_n.copyCoord(e,i+L,h,d+L)},_n.toString=function(){if(1===arguments.length){var e=arguments[0],i=e.size();if(0===i)return"()";var h=e.getDimension(),d=new Pt;d.append("(");for(var x=0;x<i;x++){x>0&&d.append(" ");for(var L=0;L<h;L++)L>0&&d.append(","),d.append(an.toString(e.getOrdinate(x,L)))}return d.append(")"),d.toString()}},_n.ensureValidRing=function(e,i){var h=i.size();return 0===h?i:h<=3?_n.createClosedRing(e,i,4):i.getOrdinate(0,Me.X)===i.getOrdinate(h-1,Me.X)&&i.getOrdinate(0,Me.Y)===i.getOrdinate(h-1,Me.Y)?i:_n.createClosedRing(e,i,h+1)},_n.createClosedRing=function(e,i,h){var d=e.create(h,i.getDimension()),x=i.size();_n.copy(i,0,d,0,x);for(var L=x;L<h;L++)_n.copy(i,0,d,L,1);return d};var Nr=function(e){function i(d,x){e.call(this,x),this._points=null,this.init(d)}e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i;var h={serialVersionUID:{configurable:!0}};return i.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new qe:this._points.expandEnvelope(new qe)},i.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},i.prototype.getSortIndex=function(){return e.SORTINDEX_LINESTRING},i.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},i.prototype.equalsExact=function(){if(2===arguments.length){var d=arguments[0],x=arguments[1];if(!this.isEquivalentClass(d))return!1;var L=d;if(this._points.size()!==L._points.size())return!1;for(var F=0;F<this._points.size();F++)if(!this.equal(this._points.getCoordinate(F),L._points.getCoordinate(F),x))return!1;return!0}return e.prototype.equalsExact.apply(this,arguments)},i.prototype.normalize=function(){for(var d=0;d<Math.trunc(this._points.size()/2);d++){var x=this._points.size()-1-d;if(!this._points.getCoordinate(d).equals(this._points.getCoordinate(x)))return this._points.getCoordinate(d).compareTo(this._points.getCoordinate(x))>0&&_n.reverse(this._points),null}},i.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},i.prototype.getBoundaryDimension=function(){return this.isClosed()?Ye.FALSE:0},i.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},i.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},i.prototype.getDimension=function(){return 1},i.prototype.getLength=function(){return Xe.computeLength(this._points)},i.prototype.getNumPoints=function(){return this._points.size()},i.prototype.reverse=function(){var d=this._points.copy();return _n.reverse(d),this.getFactory().createLineString(d)},i.prototype.compareToSameClass=function(){if(1===arguments.length){for(var d=arguments[0],x=0,L=0;x<this._points.size()&&L<d._points.size();){var F=this._points.getCoordinate(x).compareTo(d._points.getCoordinate(L));if(0!==F)return F;x++,L++}return x<this._points.size()?1:L<d._points.size()?-1:0}if(2===arguments.length)return arguments[1].compare(this._points,arguments[0]._points)},i.prototype.apply=function(){if(Ie(arguments[0],Kn))for(var d=arguments[0],x=0;x<this._points.size();x++)d.filter(this._points.getCoordinate(x));else if(Ie(arguments[0],Pr)){var L=arguments[0];if(0===this._points.size())return null;for(var F=0;F<this._points.size()&&(L.filter(this._points,F),!L.isDone());F++);L.isGeometryChanged()&&this.geometryChanged()}else(Ie(arguments[0],_r)||Ie(arguments[0],Kr))&&arguments[0].filter(this)},i.prototype.getBoundary=function(){return new Ke(this).getBoundary()},i.prototype.isEquivalentClass=function(d){return d instanceof i},i.prototype.clone=function(){var d=e.prototype.clone.call(this);return d._points=this._points.clone(),d},i.prototype.getCoordinateN=function(d){return this._points.getCoordinate(d)},i.prototype.getGeometryType=function(){return"LineString"},i.prototype.copy=function(){return new i(this._points.copy(),this._factory)},i.prototype.getCoordinateSequence=function(){return this._points},i.prototype.isEmpty=function(){return 0===this._points.size()},i.prototype.init=function(d){if(null===d&&(d=this.getFactory().getCoordinateSequenceFactory().create([])),1===d.size())throw new tt("Invalid number of points in LineString (found "+d.size()+" - must be 0 or >= 2)");this._points=d},i.prototype.isCoordinate=function(d){for(var x=0;x<this._points.size();x++)if(this._points.getCoordinate(x).equals(d))return!0;return!1},i.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},i.prototype.getPointN=function(d){return this.getFactory().createPoint(this._points.getCoordinate(d))},i.prototype.interfaces_=function(){return[ir]},i.prototype.getClass=function(){return i},h.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(i,h),i}(pr),Gi=function(){};Gi.prototype.interfaces_=function(){return[]},Gi.prototype.getClass=function(){return Gi};var ri=function(e){function i(d,x){e.call(this,x),this._coordinates=d||null,this.init(this._coordinates)}e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i;var h={serialVersionUID:{configurable:!0}};return i.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new qe;var d=new qe;return d.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),d},i.prototype.getSortIndex=function(){return e.SORTINDEX_POINT},i.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},i.prototype.equalsExact=function(){if(2===arguments.length){var d=arguments[0],x=arguments[1];return!!this.isEquivalentClass(d)&&(!(!this.isEmpty()||!d.isEmpty())||this.isEmpty()===d.isEmpty()&&this.equal(d.getCoordinate(),this.getCoordinate(),x))}return e.prototype.equalsExact.apply(this,arguments)},i.prototype.normalize=function(){},i.prototype.getCoordinate=function(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null},i.prototype.getBoundaryDimension=function(){return Ye.FALSE},i.prototype.getDimension=function(){return 0},i.prototype.getNumPoints=function(){return this.isEmpty()?0:1},i.prototype.reverse=function(){return this.copy()},i.prototype.getX=function(){if(null===this.getCoordinate())throw new Error("getX called on empty Point");return this.getCoordinate().x},i.prototype.compareToSameClass=function(){if(1===arguments.length){var d=arguments[0];return this.getCoordinate().compareTo(d.getCoordinate())}if(2===arguments.length)return arguments[1].compare(this._coordinates,arguments[0]._coordinates)},i.prototype.apply=function(){if(Ie(arguments[0],Kn)){var d=arguments[0];if(this.isEmpty())return null;d.filter(this.getCoordinate())}else if(Ie(arguments[0],Pr)){var x=arguments[0];if(this.isEmpty())return null;x.filter(this._coordinates,0),x.isGeometryChanged()&&this.geometryChanged()}else(Ie(arguments[0],_r)||Ie(arguments[0],Kr))&&arguments[0].filter(this)},i.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},i.prototype.clone=function(){var d=e.prototype.clone.call(this);return d._coordinates=this._coordinates.clone(),d},i.prototype.getGeometryType=function(){return"Point"},i.prototype.copy=function(){return new i(this._coordinates.copy(),this._factory)},i.prototype.getCoordinateSequence=function(){return this._coordinates},i.prototype.getY=function(){if(null===this.getCoordinate())throw new Error("getY called on empty Point");return this.getCoordinate().y},i.prototype.isEmpty=function(){return 0===this._coordinates.size()},i.prototype.init=function(d){null===d&&(d=this.getFactory().getCoordinateSequenceFactory().create([])),ot.isTrue(d.size()<=1),this._coordinates=d},i.prototype.isSimple=function(){return!0},i.prototype.interfaces_=function(){return[Gi]},i.prototype.getClass=function(){return i},h.serialVersionUID.get=function(){return 0x44077bad161cbc00},Object.defineProperties(i,h),i}(pr),qn=function(){};qn.prototype.interfaces_=function(){return[]},qn.prototype.getClass=function(){return qn};var En=function(e){function i(d,x,L){if(e.call(this,L),this._shell=null,this._holes=null,null===d&&(d=this.getFactory().createLinearRing()),null===x&&(x=[]),e.hasNullElements(x))throw new tt("holes must not contain null elements");if(d.isEmpty()&&e.hasNonEmptyElements(x))throw new tt("shell is empty but holes are not");this._shell=d,this._holes=x}e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i;var h={serialVersionUID:{configurable:!0}};return i.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},i.prototype.getSortIndex=function(){return e.SORTINDEX_POLYGON},i.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var d=new Array(this.getNumPoints()).fill(null),x=-1,L=this._shell.getCoordinates(),F=0;F<L.length;F++)d[++x]=L[F];for(var K=0;K<this._holes.length;K++)for(var Mt=this._holes[K].getCoordinates(),Qt=0;Qt<Mt.length;Qt++)d[++x]=Mt[Qt];return d},i.prototype.getArea=function(){var d=0;d+=Math.abs(Xe.signedArea(this._shell.getCoordinateSequence()));for(var x=0;x<this._holes.length;x++)d-=Math.abs(Xe.signedArea(this._holes[x].getCoordinateSequence()));return d},i.prototype.isRectangle=function(){if(0!==this.getNumInteriorRing()||null===this._shell||5!==this._shell.getNumPoints())return!1;for(var d=this._shell.getCoordinateSequence(),x=this.getEnvelopeInternal(),L=0;L<5;L++){var F=d.getX(L);if(F!==x.getMinX()&&F!==x.getMaxX())return!1;var K=d.getY(L);if(K!==x.getMinY()&&K!==x.getMaxY())return!1}for(var Mt=d.getX(0),Qt=d.getY(0),ke=1;ke<=4;ke++){var Ge=d.getX(ke),gr=d.getY(ke);if(Ge!==Mt==(gr!==Qt))return!1;Mt=Ge,Qt=gr}return!0},i.prototype.equalsExact=function(){if(2===arguments.length){var d=arguments[0],x=arguments[1];if(!this.isEquivalentClass(d))return!1;var L=d;if(!this._shell.equalsExact(L._shell,x)||this._holes.length!==L._holes.length)return!1;for(var Mt=0;Mt<this._holes.length;Mt++)if(!this._holes[Mt].equalsExact(L._holes[Mt],x))return!1;return!0}return e.prototype.equalsExact.apply(this,arguments)},i.prototype.normalize=function(){if(0===arguments.length){this.normalize(this._shell,!0);for(var d=0;d<this._holes.length;d++)this.normalize(this._holes[d],!1);Te.sort(this._holes)}else if(2===arguments.length){var x=arguments[0],L=arguments[1];if(x.isEmpty())return null;var F=new Array(x.getCoordinates().length-1).fill(null);Xr.arraycopy(x.getCoordinates(),0,F,0,F.length);var K=W.minCoordinate(x.getCoordinates());W.scroll(F,K),Xr.arraycopy(F,0,x.getCoordinates(),0,F.length),x.getCoordinates()[F.length]=F[0],Xe.isCCW(x.getCoordinates())===L&&W.reverse(x.getCoordinates())}},i.prototype.getCoordinate=function(){return this._shell.getCoordinate()},i.prototype.getNumInteriorRing=function(){return this._holes.length},i.prototype.getBoundaryDimension=function(){return 1},i.prototype.getDimension=function(){return 2},i.prototype.getLength=function(){var d=0;d+=this._shell.getLength();for(var x=0;x<this._holes.length;x++)d+=this._holes[x].getLength();return d},i.prototype.getNumPoints=function(){for(var d=this._shell.getNumPoints(),x=0;x<this._holes.length;x++)d+=this._holes[x].getNumPoints();return d},i.prototype.reverse=function(){var d=this.copy();d._shell=this._shell.copy().reverse(),d._holes=new Array(this._holes.length).fill(null);for(var x=0;x<this._holes.length;x++)d._holes[x]=this._holes[x].copy().reverse();return d},i.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},i.prototype.compareToSameClass=function(){if(1===arguments.length)return this._shell.compareToSameClass(arguments[0]._shell);if(2===arguments.length){var K=arguments[1],Mt=arguments[0],Ge=this._shell.compareToSameClass(Mt._shell,K);if(0!==Ge)return Ge;for(var gr=this.getNumInteriorRing(),Ir=Mt.getNumInteriorRing(),jr=0;jr<gr&&jr<Ir;){var ln=this.getInteriorRingN(jr),Mi=Mt.getInteriorRingN(jr),l=ln.compareToSameClass(Mi,K);if(0!==l)return l;jr++}return jr<gr?1:jr<Ir?-1:0}},i.prototype.apply=function(d){if(Ie(d,Kn)){this._shell.apply(d);for(var x=0;x<this._holes.length;x++)this._holes[x].apply(d)}else if(Ie(d,Pr)){if(this._shell.apply(d),!d.isDone())for(var L=0;L<this._holes.length&&(this._holes[L].apply(d),!d.isDone());L++);d.isGeometryChanged()&&this.geometryChanged()}else if(Ie(d,_r))d.filter(this);else if(Ie(d,Kr)){d.filter(this),this._shell.apply(d);for(var F=0;F<this._holes.length;F++)this._holes[F].apply(d)}},i.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var d=new Array(this._holes.length+1).fill(null);d[0]=this._shell;for(var x=0;x<this._holes.length;x++)d[x+1]=this._holes[x];return d.length<=1?this.getFactory().createLinearRing(d[0].getCoordinateSequence()):this.getFactory().createMultiLineString(d)},i.prototype.clone=function(){var d=e.prototype.clone.call(this);d._shell=this._shell.clone(),d._holes=new Array(this._holes.length).fill(null);for(var x=0;x<this._holes.length;x++)d._holes[x]=this._holes[x].clone();return d},i.prototype.getGeometryType=function(){return"Polygon"},i.prototype.copy=function(){for(var d=this._shell.copy(),x=new Array(this._holes.length).fill(null),L=0;L<x.length;L++)x[L]=this._holes[L].copy();return new i(d,x,this._factory)},i.prototype.getExteriorRing=function(){return this._shell},i.prototype.isEmpty=function(){return this._shell.isEmpty()},i.prototype.getInteriorRingN=function(d){return this._holes[d]},i.prototype.interfaces_=function(){return[qn]},i.prototype.getClass=function(){return i},h.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(i,h),i}(pr),ho=function(e){function i(){e.apply(this,arguments)}e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i;var h={serialVersionUID:{configurable:!0}};return i.prototype.getSortIndex=function(){return pr.SORTINDEX_MULTIPOINT},i.prototype.isValid=function(){return!0},i.prototype.equalsExact=function(){if(2===arguments.length){var d=arguments[0],x=arguments[1];return!!this.isEquivalentClass(d)&&e.prototype.equalsExact.call(this,d,x)}return e.prototype.equalsExact.apply(this,arguments)},i.prototype.getCoordinate=function(){return 1===arguments.length?this._geometries[arguments[0]].getCoordinate():e.prototype.getCoordinate.apply(this,arguments)},i.prototype.getBoundaryDimension=function(){return Ye.FALSE},i.prototype.getDimension=function(){return 0},i.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},i.prototype.getGeometryType=function(){return"MultiPoint"},i.prototype.copy=function(){for(var d=new Array(this._geometries.length).fill(null),x=0;x<d.length;x++)d[x]=this._geometries[x].copy();return new i(d,this._factory)},i.prototype.interfaces_=function(){return[Gi]},i.prototype.getClass=function(){return i},h.serialVersionUID.get=function(){return-0x6fb1ed4162e0fc00},Object.defineProperties(i,h),i}(He),li=function(e){function i(d,x){d instanceof j&&x instanceof xn&&(d=x.getCoordinateSequenceFactory().create(d)),e.call(this,d,x),this.validateConstruction()}e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i;var h={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return i.prototype.getSortIndex=function(){return pr.SORTINDEX_LINEARRING},i.prototype.getBoundaryDimension=function(){return Ye.FALSE},i.prototype.isClosed=function(){return!!this.isEmpty()||e.prototype.isClosed.call(this)},i.prototype.reverse=function(){var d=this._points.copy();return _n.reverse(d),this.getFactory().createLinearRing(d)},i.prototype.validateConstruction=function(){if(!this.isEmpty()&&!e.prototype.isClosed.call(this))throw new tt("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<i.MINIMUM_VALID_SIZE)throw new tt("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},i.prototype.getGeometryType=function(){return"LinearRing"},i.prototype.copy=function(){return new i(this._points.copy(),this._factory)},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},h.MINIMUM_VALID_SIZE.get=function(){return 4},h.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(i,h),i}(Nr),Gr=function(e){function i(){e.apply(this,arguments)}e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i;var h={serialVersionUID:{configurable:!0}};return i.prototype.getSortIndex=function(){return pr.SORTINDEX_MULTIPOLYGON},i.prototype.equalsExact=function(){if(2===arguments.length){var d=arguments[0],x=arguments[1];return!!this.isEquivalentClass(d)&&e.prototype.equalsExact.call(this,d,x)}return e.prototype.equalsExact.apply(this,arguments)},i.prototype.getBoundaryDimension=function(){return 1},i.prototype.getDimension=function(){return 2},i.prototype.reverse=function(){for(var x=new Array(this._geometries.length).fill(null),L=0;L<this._geometries.length;L++)x[L]=this._geometries[L].reverse();return this.getFactory().createMultiPolygon(x)},i.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var d=new or,x=0;x<this._geometries.length;x++)for(var L=this._geometries[x].getBoundary(),F=0;F<L.getNumGeometries();F++)d.add(L.getGeometryN(F));var K=new Array(d.size()).fill(null);return this.getFactory().createMultiLineString(d.toArray(K))},i.prototype.getGeometryType=function(){return"MultiPolygon"},i.prototype.copy=function(){for(var d=new Array(this._geometries.length).fill(null),x=0;x<d.length;x++)d[x]=this._geometries[x].copy();return new i(d,this._factory)},i.prototype.interfaces_=function(){return[qn]},i.prototype.getClass=function(){return i},h.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(i,h),i}(He),fa=function(e){this._factory=e||null,this._isUserDataCopied=!1},Jn={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};fa.prototype.setCopyUserData=function(e){this._isUserDataCopied=e},fa.prototype.edit=function(e,i){if(null===e)return null;var h=this.editInternal(e,i);return this._isUserDataCopied&&h.setUserData(e.getUserData()),h},fa.prototype.editInternal=function(e,i){return null===this._factory&&(this._factory=e.getFactory()),e instanceof He?this.editGeometryCollection(e,i):e instanceof En?this.editPolygon(e,i):e instanceof ri||e instanceof Nr?i.edit(e,this._factory):(ot.shouldNeverReachHere("Unsupported Geometry class: "+e.getClass().getName()),null)},fa.prototype.editGeometryCollection=function(e,i){for(var h=i.edit(e,this._factory),d=new or,x=0;x<h.getNumGeometries();x++){var L=this.edit(h.getGeometryN(x),i);null===L||L.isEmpty()||d.add(L)}return h.getClass()===ho?this._factory.createMultiPoint(d.toArray([])):h.getClass()===yr?this._factory.createMultiLineString(d.toArray([])):h.getClass()===Gr?this._factory.createMultiPolygon(d.toArray([])):this._factory.createGeometryCollection(d.toArray([]))},fa.prototype.editPolygon=function(e,i){var h=i.edit(e,this._factory);if(null===h&&(h=this._factory.createPolygon(null)),h.isEmpty())return h;var d=this.edit(h.getExteriorRing(),i);if(null===d||d.isEmpty())return this._factory.createPolygon();for(var x=new or,L=0;L<h.getNumInteriorRing();L++){var F=this.edit(h.getInteriorRingN(L),i);null===F||F.isEmpty()||x.add(F)}return this._factory.createPolygon(d,x.toArray([]))},fa.prototype.interfaces_=function(){return[]},fa.prototype.getClass=function(){return fa},fa.GeometryEditorOperation=function(){},Jn.NoOpGeometryOperation.get=function(){return Ra},Jn.CoordinateOperation.get=function(){return Ka},Jn.CoordinateSequenceOperation.get=function(){return Ro},Object.defineProperties(fa,Jn);var Ra=function(){};Ra.prototype.edit=function(e,i){return e},Ra.prototype.interfaces_=function(){return[fa.GeometryEditorOperation]},Ra.prototype.getClass=function(){return Ra};var Ka=function(){};Ka.prototype.edit=function(e,i){var h=this.editCoordinates(e.getCoordinates(),e);return null===h?e:e instanceof li?i.createLinearRing(h):e instanceof Nr?i.createLineString(h):e instanceof ri?h.length>0?i.createPoint(h[0]):i.createPoint():e},Ka.prototype.interfaces_=function(){return[fa.GeometryEditorOperation]},Ka.prototype.getClass=function(){return Ka};var Ro=function(){};Ro.prototype.edit=function(e,i){return e instanceof li?i.createLinearRing(this.edit(e.getCoordinateSequence(),e)):e instanceof Nr?i.createLineString(this.edit(e.getCoordinateSequence(),e)):e instanceof ri?i.createPoint(this.edit(e.getCoordinateSequence(),e)):e},Ro.prototype.interfaces_=function(){return[fa.GeometryEditorOperation]},Ro.prototype.getClass=function(){return Ro};var Hn=function(){if(this._dimension=3,this._coordinates=null,1===arguments.length){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var e=arguments[0];this._coordinates=new Array(e).fill(null);for(var i=0;i<e;i++)this._coordinates[i]=new j}else if(Ie(arguments[0],Me)){var h=arguments[0];if(null===h)return this._coordinates=new Array(0).fill(null),null;this._dimension=h.getDimension(),this._coordinates=new Array(h.size()).fill(null);for(var d=0;d<this._coordinates.length;d++)this._coordinates[d]=h.getCoordinateCopy(d)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var x=arguments[0],L=arguments[1];this._coordinates=x,this._dimension=L,null===x&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var F=arguments[0],K=arguments[1];this._coordinates=new Array(F).fill(null),this._dimension=K;for(var Mt=0;Mt<F;Mt++)this._coordinates[Mt]=new j}},mu={serialVersionUID:{configurable:!0}};Hn.prototype.setOrdinate=function(e,i,h){switch(i){case Me.X:this._coordinates[e].x=h;break;case Me.Y:this._coordinates[e].y=h;break;case Me.Z:this._coordinates[e].z=h;break;default:throw new tt("invalid ordinateIndex")}},Hn.prototype.size=function(){return this._coordinates.length},Hn.prototype.getOrdinate=function(e,i){switch(i){case Me.X:return this._coordinates[e].x;case Me.Y:return this._coordinates[e].y;case Me.Z:return this._coordinates[e].z}return X.NaN},Hn.prototype.getCoordinate=function(){if(1===arguments.length)return this._coordinates[arguments[0]];if(2===arguments.length){var i=arguments[0],h=arguments[1];h.x=this._coordinates[i].x,h.y=this._coordinates[i].y,h.z=this._coordinates[i].z}},Hn.prototype.getCoordinateCopy=function(e){return new j(this._coordinates[e])},Hn.prototype.getDimension=function(){return this._dimension},Hn.prototype.getX=function(e){return this._coordinates[e].x},Hn.prototype.clone=function(){for(var e=new Array(this.size()).fill(null),i=0;i<this._coordinates.length;i++)e[i]=this._coordinates[i].clone();return new Hn(e,this._dimension)},Hn.prototype.expandEnvelope=function(e){for(var i=0;i<this._coordinates.length;i++)e.expandToInclude(this._coordinates[i]);return e},Hn.prototype.copy=function(){for(var e=new Array(this.size()).fill(null),i=0;i<this._coordinates.length;i++)e[i]=this._coordinates[i].copy();return new Hn(e,this._dimension)},Hn.prototype.toString=function(){if(this._coordinates.length>0){var e=new Pt(17*this._coordinates.length);e.append("("),e.append(this._coordinates[0]);for(var i=1;i<this._coordinates.length;i++)e.append(", "),e.append(this._coordinates[i]);return e.append(")"),e.toString()}return"()"},Hn.prototype.getY=function(e){return this._coordinates[e].y},Hn.prototype.toCoordinateArray=function(){return this._coordinates},Hn.prototype.interfaces_=function(){return[Me,dt]},Hn.prototype.getClass=function(){return Hn},mu.serialVersionUID.get=function(){return-0xcb44a778db18e00},Object.defineProperties(Hn,mu);var xa=function(){},$o={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};xa.prototype.readResolve=function(){return xa.instance()},xa.prototype.create=function(){if(1===arguments.length){if(arguments[0]instanceof Array)return new Hn(arguments[0]);if(Ie(arguments[0],Me))return new Hn(arguments[0])}else if(2===arguments.length){var h=arguments[0],d=arguments[1];return d>3&&(d=3),d<2?new Hn(h):new Hn(h,d)}},xa.prototype.interfaces_=function(){return[kt,dt]},xa.prototype.getClass=function(){return xa},xa.instance=function(){return xa.instanceObject},$o.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00},$o.instanceObject.get=function(){return new xa},Object.defineProperties(xa,$o);var su=function(e){function i(){e.call(this),this.map_=new Map}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.get=function(h){return this.map_.get(h)||null},i.prototype.put=function(h,d){return this.map_.set(h,d),d},i.prototype.values=function(){for(var h=new or,d=this.map_.values(),x=d.next();!x.done;)h.add(x.value),x=d.next();return h},i.prototype.entrySet=function(){var h=new ue;return this.map_.entries().forEach(function(d){return h.add(d)}),h},i.prototype.size=function(){return this.map_.size()},i}(se),Pn=function e(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=e.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof Fo){var i=arguments[0];this._modelType=i,i===e.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){var h=arguments[0];this._modelType=e.FIXED,this.setScale(h)}else if(arguments[0]instanceof e){var d=arguments[0];this._modelType=d._modelType,this._scale=d._scale}},_o={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};Pn.prototype.equals=function(e){return e instanceof Pn&&this._modelType===e._modelType&&this._scale===e._scale},Pn.prototype.compareTo=function(e){var i=e,h=this.getMaximumSignificantDigits(),d=i.getMaximumSignificantDigits();return new te(h).compareTo(new te(d))},Pn.prototype.getScale=function(){return this._scale},Pn.prototype.isFloating=function(){return this._modelType===Pn.FLOATING||this._modelType===Pn.FLOATING_SINGLE},Pn.prototype.getType=function(){return this._modelType},Pn.prototype.toString=function(){var e="UNKNOWN";return this._modelType===Pn.FLOATING?e="Floating":this._modelType===Pn.FLOATING_SINGLE?e="Floating-Single":this._modelType===Pn.FIXED&&(e="Fixed (Scale="+this.getScale()+")"),e},Pn.prototype.makePrecise=function(){if("number"==typeof arguments[0]){var e=arguments[0];return X.isNaN(e)||this._modelType===Pn.FLOATING_SINGLE?e:this._modelType===Pn.FIXED?Math.round(e*this._scale)/this._scale:e}if(arguments[0]instanceof j){var i=arguments[0];if(this._modelType===Pn.FLOATING)return null;i.x=this.makePrecise(i.x),i.y=this.makePrecise(i.y)}},Pn.prototype.getMaximumSignificantDigits=function(){var e=16;return this._modelType===Pn.FLOATING?e=16:this._modelType===Pn.FLOATING_SINGLE?e=6:this._modelType===Pn.FIXED&&(e=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),e},Pn.prototype.setScale=function(e){this._scale=Math.abs(e)},Pn.prototype.interfaces_=function(){return[dt,H]},Pn.prototype.getClass=function(){return Pn},Pn.mostPrecise=function(e,i){return e.compareTo(i)>=0?e:i},_o.serialVersionUID.get=function(){return 0x6bee6404e9a25c00},_o.maximumPreciseValue.get=function(){return 9007199254740992},Object.defineProperties(Pn,_o);var Fo=function e(i){this._name=i||null,e.nameToTypeMap.put(i,this)},Fa={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};Fo.prototype.readResolve=function(){return Fo.nameToTypeMap.get(this._name)},Fo.prototype.toString=function(){return this._name},Fo.prototype.interfaces_=function(){return[dt]},Fo.prototype.getClass=function(){return Fo},Fa.serialVersionUID.get=function(){return-552860263173159e4},Fa.nameToTypeMap.get=function(){return new su},Object.defineProperties(Fo,Fa),Pn.Type=Fo,Pn.FIXED=new Fo("FIXED"),Pn.FLOATING=new Fo("FLOATING"),Pn.FLOATING_SINGLE=new Fo("FLOATING SINGLE");var xn=function e(){this._precisionModel=new Pn,this._SRID=0,this._coordinateSequenceFactory=e.getDefaultCoordinateSequenceFactory(),0===arguments.length||(1===arguments.length?Ie(arguments[0],kt)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof Pn&&(this._precisionModel=arguments[0]):2===arguments.length?(this._precisionModel=arguments[0],this._SRID=arguments[1]):3===arguments.length&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},Iu={serialVersionUID:{configurable:!0}};xn.prototype.toGeometry=function(e){return e.isNull()?this.createPoint(null):e.getMinX()===e.getMaxX()&&e.getMinY()===e.getMaxY()?this.createPoint(new j(e.getMinX(),e.getMinY())):e.getMinX()===e.getMaxX()||e.getMinY()===e.getMaxY()?this.createLineString([new j(e.getMinX(),e.getMinY()),new j(e.getMaxX(),e.getMaxY())]):this.createPolygon(this.createLinearRing([new j(e.getMinX(),e.getMinY()),new j(e.getMinX(),e.getMaxY()),new j(e.getMaxX(),e.getMaxY()),new j(e.getMaxX(),e.getMinY()),new j(e.getMinX(),e.getMinY())]),null)},xn.prototype.createLineString=function(e){return e?e instanceof Array?new Nr(this.getCoordinateSequenceFactory().create(e),this):Ie(e,Me)?new Nr(e,this):void 0:new Nr(this.getCoordinateSequenceFactory().create([]),this)},xn.prototype.createMultiLineString=function(){return 0===arguments.length?new yr(null,this):1===arguments.length?new yr(arguments[0],this):void 0},xn.prototype.buildGeometry=function(e){for(var i=null,h=!1,d=!1,x=e.iterator();x.hasNext();){var L=x.next(),F=L.getClass();null===i&&(i=F),F!==i&&(h=!0),L.isGeometryCollectionOrDerived()&&(d=!0)}if(null===i)return this.createGeometryCollection();if(h||d)return this.createGeometryCollection(xn.toGeometryArray(e));var K=e.iterator().next();if(e.size()>1){if(K instanceof En)return this.createMultiPolygon(xn.toPolygonArray(e));if(K instanceof Nr)return this.createMultiLineString(xn.toLineStringArray(e));if(K instanceof ri)return this.createMultiPoint(xn.toPointArray(e));ot.shouldNeverReachHere("Unhandled class: "+K.getClass().getName())}return K},xn.prototype.createMultiPointFromCoords=function(e){return this.createMultiPoint(null!==e?this.getCoordinateSequenceFactory().create(e):null)},xn.prototype.createPoint=function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof j){var e=arguments[0];return this.createPoint(null!==e?this.getCoordinateSequenceFactory().create([e]):null)}if(Ie(arguments[0],Me))return new ri(arguments[0],this)}},xn.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory},xn.prototype.createPolygon=function(){if(0===arguments.length)return new En(null,null,this);if(1===arguments.length){if(Ie(arguments[0],Me))return this.createPolygon(this.createLinearRing(arguments[0]));if(arguments[0]instanceof Array)return this.createPolygon(this.createLinearRing(arguments[0]));if(arguments[0]instanceof li)return this.createPolygon(arguments[0],null)}else if(2===arguments.length)return new En(arguments[0],arguments[1],this)},xn.prototype.getSRID=function(){return this._SRID},xn.prototype.createGeometryCollection=function(){return 0===arguments.length?new He(null,this):1===arguments.length?new He(arguments[0],this):void 0},xn.prototype.createGeometry=function(e){return new fa(this).edit(e,{edit:function(){if(2===arguments.length)return this._coordinateSequenceFactory.create(arguments[0])}})},xn.prototype.getPrecisionModel=function(){return this._precisionModel},xn.prototype.createLinearRing=function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var e=arguments[0];return this.createLinearRing(null!==e?this.getCoordinateSequenceFactory().create(e):null)}if(Ie(arguments[0],Me))return new li(arguments[0],this)}},xn.prototype.createMultiPolygon=function(){return 0===arguments.length?new Gr(null,this):1===arguments.length?new Gr(arguments[0],this):void 0},xn.prototype.createMultiPoint=function(){if(0===arguments.length)return new ho(null,this);if(1===arguments.length){if(arguments[0]instanceof Array)return new ho(arguments[0],this);if(arguments[0]instanceof Array){var i=arguments[0];return this.createMultiPoint(null!==i?this.getCoordinateSequenceFactory().create(i):null)}if(Ie(arguments[0],Me)){var h=arguments[0];if(null===h)return this.createMultiPoint(new Array(0).fill(null));for(var d=new Array(h.size()).fill(null),x=0;x<h.size();x++){var L=this.getCoordinateSequenceFactory().create(1,h.getDimension());_n.copy(h,x,L,0,1),d[x]=this.createPoint(L)}return this.createMultiPoint(d)}}},xn.prototype.interfaces_=function(){return[dt]},xn.prototype.getClass=function(){return xn},xn.toMultiPolygonArray=function(e){var i=new Array(e.size()).fill(null);return e.toArray(i)},xn.toGeometryArray=function(e){if(null===e)return null;var i=new Array(e.size()).fill(null);return e.toArray(i)},xn.getDefaultCoordinateSequenceFactory=function(){return xa.instance()},xn.toMultiLineStringArray=function(e){var i=new Array(e.size()).fill(null);return e.toArray(i)},xn.toLineStringArray=function(e){var i=new Array(e.size()).fill(null);return e.toArray(i)},xn.toMultiPointArray=function(e){var i=new Array(e.size()).fill(null);return e.toArray(i)},xn.toLinearRingArray=function(e){var i=new Array(e.size()).fill(null);return e.toArray(i)},xn.toPointArray=function(e){var i=new Array(e.size()).fill(null);return e.toArray(i)},xn.toPolygonArray=function(e){var i=new Array(e.size()).fill(null);return e.toArray(i)},xn.createPointFromInternalCoord=function(e,i){return i.getPrecisionModel().makePrecise(e),i.getFactory().createPoint(e)},Iu.serialVersionUID.get=function(){return-0x5ea75f2051eeb400},Object.defineProperties(xn,Iu);var oc=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],A=function(e){this.geometryFactory=e||new xn};A.prototype.read=function(e){var i,h=(i="string"==typeof e?JSON.parse(e):e).type;if(!U[h])throw new Error("Unknown GeoJSON type: "+i.type);return-1!==oc.indexOf(h)?U[h].apply(this,[i.coordinates]):U[h].apply(this,"GeometryCollection"===h?[i.geometries]:[i])},A.prototype.write=function(e){var i=e.getGeometryType();if(!ct[i])throw new Error("Geometry is not supported");return ct[i].apply(this,[e])};var U={Feature:function(e){var i={};for(var h in e)i[h]=e[h];if(e.geometry){if(!U[e.geometry.type])throw new Error("Unknown GeoJSON type: "+e.type);i.geometry=this.read(e.geometry)}return e.bbox&&(i.bbox=U.bbox.apply(this,[e.bbox])),i},FeatureCollection:function(e){var i={};if(e.features){i.features=[];for(var h=0;h<e.features.length;++h)i.features.push(this.read(e.features[h]))}return e.bbox&&(i.bbox=this.parse.bbox.apply(this,[e.bbox])),i},coordinates:function(e){for(var i=[],h=0;h<e.length;++h){var d=e[h];i.push(new j(d[0],d[1]))}return i},bbox:function(e){return this.geometryFactory.createLinearRing([new j(e[0],e[1]),new j(e[2],e[1]),new j(e[2],e[3]),new j(e[0],e[3]),new j(e[0],e[1])])},Point:function(e){var i=new j(e[0],e[1]);return this.geometryFactory.createPoint(i)},MultiPoint:function(e){for(var i=[],h=0;h<e.length;++h)i.push(U.Point.apply(this,[e[h]]));return this.geometryFactory.createMultiPoint(i)},LineString:function(e){var i=U.coordinates.apply(this,[e]);return this.geometryFactory.createLineString(i)},MultiLineString:function(e){for(var i=[],h=0;h<e.length;++h)i.push(U.LineString.apply(this,[e[h]]));return this.geometryFactory.createMultiLineString(i)},Polygon:function(e){for(var i=U.coordinates.apply(this,[e[0]]),h=this.geometryFactory.createLinearRing(i),d=[],x=1;x<e.length;++x){var F=U.coordinates.apply(this,[e[x]]),K=this.geometryFactory.createLinearRing(F);d.push(K)}return this.geometryFactory.createPolygon(h,d)},MultiPolygon:function(e){for(var i=[],h=0;h<e.length;++h)i.push(U.Polygon.apply(this,[e[h]]));return this.geometryFactory.createMultiPolygon(i)},GeometryCollection:function(e){for(var i=[],h=0;h<e.length;++h)i.push(this.read(e[h]));return this.geometryFactory.createGeometryCollection(i)}},ct={coordinate:function(e){return[e.x,e.y]},Point:function(e){return{type:"Point",coordinates:ct.coordinate.apply(this,[e.getCoordinate()])}},MultiPoint:function(e){for(var i=[],h=0;h<e._geometries.length;++h){var x=ct.Point.apply(this,[e._geometries[h]]);i.push(x.coordinates)}return{type:"MultiPoint",coordinates:i}},LineString:function(e){for(var i=[],h=e.getCoordinates(),d=0;d<h.length;++d)i.push(ct.coordinate.apply(this,[h[d]]));return{type:"LineString",coordinates:i}},MultiLineString:function(e){for(var i=[],h=0;h<e._geometries.length;++h){var x=ct.LineString.apply(this,[e._geometries[h]]);i.push(x.coordinates)}return{type:"MultiLineString",coordinates:i}},Polygon:function(e){var i=[],h=ct.LineString.apply(this,[e._shell]);i.push(h.coordinates);for(var d=0;d<e._holes.length;++d){var L=ct.LineString.apply(this,[e._holes[d]]);i.push(L.coordinates)}return{type:"Polygon",coordinates:i}},MultiPolygon:function(e){for(var i=[],h=0;h<e._geometries.length;++h){var x=ct.Polygon.apply(this,[e._geometries[h]]);i.push(x.coordinates)}return{type:"MultiPolygon",coordinates:i}},GeometryCollection:function(e){for(var i=[],h=0;h<e._geometries.length;++h){var d=e._geometries[h],x=d.getGeometryType();i.push(ct[x].apply(this,[d]))}return{type:"GeometryCollection",geometries:i}}},oe=function(e){this.geometryFactory=e||new xn,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new A(this.geometryFactory)};oe.prototype.read=function(e){var i=this.parser.read(e);return this.precisionModel.getType()===Pn.FIXED&&this.reducePrecision(i),i},oe.prototype.reducePrecision=function(e){var i,h;if(e.coordinate)this.precisionModel.makePrecise(e.coordinate);else if(e.points)for(i=0,h=e.points.length;i<h;i++)this.precisionModel.makePrecise(e.points[i]);else if(e.geometries)for(i=0,h=e.geometries.length;i<h;i++)this.reducePrecision(e.geometries[i])};var Se=function(){this.parser=new A(this.geometryFactory)};Se.prototype.write=function(e){return this.parser.write(e)};var Bt=function(){},Pe={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};Bt.prototype.interfaces_=function(){return[]},Bt.prototype.getClass=function(){return Bt},Bt.opposite=function(e){return e===Bt.LEFT?Bt.RIGHT:e===Bt.RIGHT?Bt.LEFT:e},Pe.ON.get=function(){return 0},Pe.LEFT.get=function(){return 1},Pe.RIGHT.get=function(){return 2},Object.defineProperties(Bt,Pe),(Z.prototype=new Error).name="EmptyStackException",(it.prototype=new On).add=function(e){return this.array_.push(e),!0},it.prototype.get=function(e){if(e<0||e>=this.size())throw new Error;return this.array_[e]},it.prototype.push=function(e){return this.array_.push(e),e},it.prototype.pop=function(e){if(0===this.array_.length)throw new Z;return this.array_.pop()},it.prototype.peek=function(){if(0===this.array_.length)throw new Z;return this.array_[this.array_.length-1]},it.prototype.empty=function(){return 0===this.array_.length},it.prototype.isEmpty=function(){return this.empty()},it.prototype.search=function(e){return this.array_.indexOf(e)},it.prototype.size=function(){return this.array_.length},it.prototype.toArray=function(){for(var e=[],i=0,h=this.array_.length;i<h;i++)e.push(this.array_[i]);return e};var cr=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};cr.prototype.getCoordinate=function(){return this._minCoord},cr.prototype.getRightmostSide=function(e,i){var h=this.getRightmostSideOfSegment(e,i);return h<0&&(h=this.getRightmostSideOfSegment(e,i-1)),h<0&&(this._minCoord=null,this.checkForRightmostCoordinate(e)),h},cr.prototype.findRightmostEdgeAtVertex=function(){var e=this._minDe.getEdge().getCoordinates();ot.isTrue(this._minIndex>0&&this._minIndex<e.length,"rightmost point expected to be interior vertex of edge");var i=e[this._minIndex-1],h=e[this._minIndex+1],d=Xe.computeOrientation(this._minCoord,h,i),x=!1;(i.y<this._minCoord.y&&h.y<this._minCoord.y&&d===Xe.COUNTERCLOCKWISE||i.y>this._minCoord.y&&h.y>this._minCoord.y&&d===Xe.CLOCKWISE)&&(x=!0),x&&(this._minIndex=this._minIndex-1)},cr.prototype.getRightmostSideOfSegment=function(e,i){var h=e.getEdge().getCoordinates();if(i<0||i+1>=h.length||h[i].y===h[i+1].y)return-1;var d=Bt.LEFT;return h[i].y<h[i+1].y&&(d=Bt.RIGHT),d},cr.prototype.getEdge=function(){return this._orientedDe},cr.prototype.checkForRightmostCoordinate=function(e){for(var i=e.getEdge().getCoordinates(),h=0;h<i.length-1;h++)(null===this._minCoord||i[h].x>this._minCoord.x)&&(this._minDe=e,this._minIndex=h,this._minCoord=i[h])},cr.prototype.findRightmostEdgeAtNode=function(){var e=this._minDe.getNode().getEdges();this._minDe=e.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)},cr.prototype.findEdge=function(e){for(var i=e.iterator();i.hasNext();){var h=i.next();h.isForward()&&this.checkForRightmostCoordinate(h)}ot.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===Bt.LEFT&&(this._orientedDe=this._minDe.getSym())},cr.prototype.interfaces_=function(){return[]},cr.prototype.getClass=function(){return cr};var ur=function(e){function i(h,d){e.call(this,i.msgWithCoord(h,d)),this.pt=d?new j(d):null,this.name="TopologyException"}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.getCoordinate=function(){return this.pt},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i.msgWithCoord=function(h,d){return d?h:h+" [ "+d+" ]"},i}(st),Rr=function(){this.array_=[]};Rr.prototype.addLast=function(e){this.array_.push(e)},Rr.prototype.removeFirst=function(){return this.array_.shift()},Rr.prototype.isEmpty=function(){return 0===this.array_.length};var Ae=function(){this._finder=null,this._dirEdgeList=new or,this._nodes=new or,this._rightMostCoord=null,this._env=null,this._finder=new cr};Ae.prototype.clearVisitedEdges=function(){for(var e=this._dirEdgeList.iterator();e.hasNext();)e.next().setVisited(!1)},Ae.prototype.getRightmostCoordinate=function(){return this._rightMostCoord},Ae.prototype.computeNodeDepth=function(e){for(var i=null,h=e.getEdges().iterator();h.hasNext();){var d=h.next();if(d.isVisited()||d.getSym().isVisited()){i=d;break}}if(null===i)throw new ur("unable to find edge to compute depths at "+e.getCoordinate());e.getEdges().computeDepths(i);for(var x=e.getEdges().iterator();x.hasNext();){var L=x.next();L.setVisited(!0),this.copySymDepths(L)}},Ae.prototype.computeDepth=function(e){this.clearVisitedEdges();var i=this._finder.getEdge();i.setEdgeDepths(Bt.RIGHT,e),this.copySymDepths(i),this.computeDepths(i)},Ae.prototype.create=function(e){this.addReachable(e),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()},Ae.prototype.findResultEdges=function(){for(var e=this._dirEdgeList.iterator();e.hasNext();){var i=e.next();i.getDepth(Bt.RIGHT)>=1&&i.getDepth(Bt.LEFT)<=0&&!i.isInteriorAreaEdge()&&i.setInResult(!0)}},Ae.prototype.computeDepths=function(e){var i=new ue,h=new Rr,d=e.getNode();for(h.addLast(d),i.add(d),e.setVisited(!0);!h.isEmpty();){var x=h.removeFirst();i.add(x),this.computeNodeDepth(x);for(var L=x.getEdges().iterator();L.hasNext();){var F=L.next().getSym();if(!F.isVisited()){var K=F.getNode();i.contains(K)||(h.addLast(K),i.add(K))}}}},Ae.prototype.compareTo=function(e){return this._rightMostCoord.x<e._rightMostCoord.x?-1:this._rightMostCoord.x>e._rightMostCoord.x?1:0},Ae.prototype.getEnvelope=function(){if(null===this._env){for(var e=new qe,i=this._dirEdgeList.iterator();i.hasNext();)for(var h=i.next().getEdge().getCoordinates(),d=0;d<h.length-1;d++)e.expandToInclude(h[d]);this._env=e}return this._env},Ae.prototype.addReachable=function(e){var i=new it;for(i.add(e);!i.empty();){var h=i.pop();this.add(h,i)}},Ae.prototype.copySymDepths=function(e){var i=e.getSym();i.setDepth(Bt.LEFT,e.getDepth(Bt.RIGHT)),i.setDepth(Bt.RIGHT,e.getDepth(Bt.LEFT))},Ae.prototype.add=function(e,i){e.setVisited(!0),this._nodes.add(e);for(var h=e.getEdges().iterator();h.hasNext();){var d=h.next();this._dirEdgeList.add(d);var x=d.getSym().getNode();x.isVisited()||i.push(x)}},Ae.prototype.getNodes=function(){return this._nodes},Ae.prototype.getDirectedEdges=function(){return this._dirEdgeList},Ae.prototype.interfaces_=function(){return[H]},Ae.prototype.getClass=function(){return Ae};var sr=function e(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array)this.init(arguments[0].length);else if(Number.isInteger(arguments[0])){var h=arguments[0];this.init(1),this.location[Bt.ON]=h}else if(arguments[0]instanceof e){var d=arguments[0];if(this.init(d.location.length),null!==d)for(var x=0;x<this.location.length;x++)this.location[x]=d.location[x]}}else if(3===arguments.length){var L=arguments[0],F=arguments[1],K=arguments[2];this.init(3),this.location[Bt.ON]=L,this.location[Bt.LEFT]=F,this.location[Bt.RIGHT]=K}};sr.prototype.setAllLocations=function(e){for(var i=0;i<this.location.length;i++)this.location[i]=e},sr.prototype.isNull=function(){for(var e=0;e<this.location.length;e++)if(this.location[e]!==gt.NONE)return!1;return!0},sr.prototype.setAllLocationsIfNull=function(e){for(var i=0;i<this.location.length;i++)this.location[i]===gt.NONE&&(this.location[i]=e)},sr.prototype.isLine=function(){return 1===this.location.length},sr.prototype.merge=function(e){if(e.location.length>this.location.length){var i=new Array(3).fill(null);i[Bt.ON]=this.location[Bt.ON],i[Bt.LEFT]=gt.NONE,i[Bt.RIGHT]=gt.NONE,this.location=i}for(var h=0;h<this.location.length;h++)this.location[h]===gt.NONE&&h<e.location.length&&(this.location[h]=e.location[h])},sr.prototype.getLocations=function(){return this.location},sr.prototype.flip=function(){if(this.location.length<=1)return null;var e=this.location[Bt.LEFT];this.location[Bt.LEFT]=this.location[Bt.RIGHT],this.location[Bt.RIGHT]=e},sr.prototype.toString=function(){var e=new Pt;return this.location.length>1&&e.append(gt.toLocationSymbol(this.location[Bt.LEFT])),e.append(gt.toLocationSymbol(this.location[Bt.ON])),this.location.length>1&&e.append(gt.toLocationSymbol(this.location[Bt.RIGHT])),e.toString()},sr.prototype.setLocations=function(e,i,h){this.location[Bt.ON]=e,this.location[Bt.LEFT]=i,this.location[Bt.RIGHT]=h},sr.prototype.get=function(e){return e<this.location.length?this.location[e]:gt.NONE},sr.prototype.isArea=function(){return this.location.length>1},sr.prototype.isAnyNull=function(){for(var e=0;e<this.location.length;e++)if(this.location[e]===gt.NONE)return!0;return!1},sr.prototype.setLocation=function(){1===arguments.length?this.setLocation(Bt.ON,arguments[0]):2===arguments.length&&(this.location[arguments[0]]=arguments[1])},sr.prototype.init=function(e){this.location=new Array(e).fill(null),this.setAllLocations(gt.NONE)},sr.prototype.isEqualOnSide=function(e,i){return this.location[i]===e.location[i]},sr.prototype.allPositionsEqual=function(e){for(var i=0;i<this.location.length;i++)if(this.location[i]!==e)return!1;return!0},sr.prototype.interfaces_=function(){return[]},sr.prototype.getClass=function(){return sr};var hr=function e(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){var i=arguments[0];this.elt[0]=new sr(i),this.elt[1]=new sr(i)}else if(arguments[0]instanceof e){var h=arguments[0];this.elt[0]=new sr(h.elt[0]),this.elt[1]=new sr(h.elt[1])}}else if(2===arguments.length){var d=arguments[0],x=arguments[1];this.elt[0]=new sr(gt.NONE),this.elt[1]=new sr(gt.NONE),this.elt[d].setLocation(x)}else if(3===arguments.length){var L=arguments[0],F=arguments[1],K=arguments[2];this.elt[0]=new sr(L,F,K),this.elt[1]=new sr(L,F,K)}else if(4===arguments.length){var Mt=arguments[0],Qt=arguments[1],ke=arguments[2],Ge=arguments[3];this.elt[0]=new sr(gt.NONE,gt.NONE,gt.NONE),this.elt[1]=new sr(gt.NONE,gt.NONE,gt.NONE),this.elt[Mt].setLocations(Qt,ke,Ge)}};hr.prototype.getGeometryCount=function(){var e=0;return this.elt[0].isNull()||e++,this.elt[1].isNull()||e++,e},hr.prototype.setAllLocations=function(e,i){this.elt[e].setAllLocations(i)},hr.prototype.isNull=function(e){return this.elt[e].isNull()},hr.prototype.setAllLocationsIfNull=function(){if(1===arguments.length){var e=arguments[0];this.setAllLocationsIfNull(0,e),this.setAllLocationsIfNull(1,e)}else 2===arguments.length&&this.elt[arguments[0]].setAllLocationsIfNull(arguments[1])},hr.prototype.isLine=function(e){return this.elt[e].isLine()},hr.prototype.merge=function(e){for(var i=0;i<2;i++)null===this.elt[i]&&null!==e.elt[i]?this.elt[i]=new sr(e.elt[i]):this.elt[i].merge(e.elt[i])},hr.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},hr.prototype.getLocation=function(){return 1===arguments.length?this.elt[arguments[0]].get(Bt.ON):2===arguments.length?this.elt[arguments[0]].get(arguments[1]):void 0},hr.prototype.toString=function(){var e=new Pt;return null!==this.elt[0]&&(e.append("A:"),e.append(this.elt[0].toString())),null!==this.elt[1]&&(e.append(" B:"),e.append(this.elt[1].toString())),e.toString()},hr.prototype.isArea=function(){return 0===arguments.length?this.elt[0].isArea()||this.elt[1].isArea():1===arguments.length?this.elt[arguments[0]].isArea():void 0},hr.prototype.isAnyNull=function(e){return this.elt[e].isAnyNull()},hr.prototype.setLocation=function(){2===arguments.length?this.elt[arguments[0]].setLocation(Bt.ON,arguments[1]):3===arguments.length&&this.elt[arguments[0]].setLocation(arguments[1],arguments[2])},hr.prototype.isEqualOnSide=function(e,i){return this.elt[0].isEqualOnSide(e.elt[0],i)&&this.elt[1].isEqualOnSide(e.elt[1],i)},hr.prototype.allPositionsEqual=function(e,i){return this.elt[e].allPositionsEqual(i)},hr.prototype.toLine=function(e){this.elt[e].isArea()&&(this.elt[e]=new sr(this.elt[e].location[0]))},hr.prototype.interfaces_=function(){return[]},hr.prototype.getClass=function(){return hr},hr.toLineLabel=function(e){for(var i=new hr(gt.NONE),h=0;h<2;h++)i.setLocation(h,e.getLocation(h));return i};var Dr=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new or,this._pts=new or,this._label=new hr(gt.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new or,this._geometryFactory=null;var e=arguments[0];this._geometryFactory=arguments[1],this.computePoints(e),this.computeRing()};Dr.prototype.computeRing=function(){if(null!==this._ring)return null;for(var e=new Array(this._pts.size()).fill(null),i=0;i<this._pts.size();i++)e[i]=this._pts.get(i);this._ring=this._geometryFactory.createLinearRing(e),this._isHole=Xe.isCCW(this._ring.getCoordinates())},Dr.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},Dr.prototype.computePoints=function(e){this._startDe=e;var i=e,h=!0;do{if(null===i)throw new ur("Found null DirectedEdge");if(i.getEdgeRing()===this)throw new ur("Directed Edge visited twice during ring-building at "+i.getCoordinate());this._edges.add(i);var d=i.getLabel();ot.isTrue(d.isArea()),this.mergeLabel(d),this.addPoints(i.getEdge(),i.isForward(),h),h=!1,this.setEdgeRing(i,this),i=this.getNext(i)}while(i!==this._startDe)},Dr.prototype.getLinearRing=function(){return this._ring},Dr.prototype.getCoordinate=function(e){return this._pts.get(e)},Dr.prototype.computeMaxNodeDegree=function(){this._maxNodeDegree=0;var e=this._startDe;do{var i=e.getNode().getEdges().getOutgoingDegree(this);i>this._maxNodeDegree&&(this._maxNodeDegree=i),e=this.getNext(e)}while(e!==this._startDe);this._maxNodeDegree*=2},Dr.prototype.addPoints=function(e,i,h){var d=e.getCoordinates();if(i){var x=1;h&&(x=0);for(var L=x;L<d.length;L++)this._pts.add(d[L])}else{var F=d.length-2;h&&(F=d.length-1);for(var K=F;K>=0;K--)this._pts.add(d[K])}},Dr.prototype.isHole=function(){return this._isHole},Dr.prototype.setInResult=function(){var e=this._startDe;do{e.getEdge().setInResult(!0),e=e.getNext()}while(e!==this._startDe)},Dr.prototype.containsPoint=function(e){var i=this.getLinearRing();if(!i.getEnvelopeInternal().contains(e)||!Xe.isPointInRing(e,i.getCoordinates()))return!1;for(var h=this._holes.iterator();h.hasNext();)if(h.next().containsPoint(e))return!1;return!0},Dr.prototype.addHole=function(e){this._holes.add(e)},Dr.prototype.isShell=function(){return null===this._shell},Dr.prototype.getLabel=function(){return this._label},Dr.prototype.getEdges=function(){return this._edges},Dr.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree},Dr.prototype.getShell=function(){return this._shell},Dr.prototype.mergeLabel=function(){if(1===arguments.length){var e=arguments[0];this.mergeLabel(e,0),this.mergeLabel(e,1)}else if(2===arguments.length){var h=arguments[1],d=arguments[0].getLocation(h,Bt.RIGHT);if(d===gt.NONE)return null;if(this._label.getLocation(h)===gt.NONE)return this._label.setLocation(h,d),null}},Dr.prototype.setShell=function(e){this._shell=e,null!==e&&e.addHole(this)},Dr.prototype.toPolygon=function(e){for(var i=new Array(this._holes.size()).fill(null),h=0;h<this._holes.size();h++)i[h]=this._holes.get(h).getLinearRing();return e.createPolygon(this.getLinearRing(),i)},Dr.prototype.interfaces_=function(){return[]},Dr.prototype.getClass=function(){return Dr};var Tn=function(e){function i(){e.call(this,arguments[0],arguments[1])}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.setEdgeRing=function(h,d){h.setMinEdgeRing(d)},i.prototype.getNext=function(h){return h.getNextMin()},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i}(Dr),zo=function(e){function i(){e.call(this,arguments[0],arguments[1])}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.buildMinimalRings=function(){var h=new or,d=this._startDe;do{if(null===d.getMinEdgeRing()){var x=new Tn(d,this._geometryFactory);h.add(x)}d=d.getNext()}while(d!==this._startDe);return h},i.prototype.setEdgeRing=function(h,d){h.setEdgeRing(d)},i.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var h=this._startDe;do{h.getNode().getEdges().linkMinimalDirectedEdges(this),h=h.getNext()}while(h!==this._startDe)},i.prototype.getNext=function(h){return h.getNext()},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i}(Dr),$e=function(){this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0!==arguments.length&&1===arguments.length&&(this._label=arguments[0])};$e.prototype.setVisited=function(e){this._isVisited=e},$e.prototype.setInResult=function(e){this._isInResult=e},$e.prototype.isCovered=function(){return this._isCovered},$e.prototype.isCoveredSet=function(){return this._isCoveredSet},$e.prototype.setLabel=function(e){this._label=e},$e.prototype.getLabel=function(){return this._label},$e.prototype.setCovered=function(e){this._isCovered=e,this._isCoveredSet=!0},$e.prototype.updateIM=function(e){ot.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(e)},$e.prototype.isInResult=function(){return this._isInResult},$e.prototype.isVisited=function(){return this._isVisited},$e.prototype.interfaces_=function(){return[]},$e.prototype.getClass=function(){return $e};var Vr=function(e){function i(){e.call(this),this._coord=null,this._edges=null;var d=arguments[1];this._coord=arguments[0],this._edges=d,this._label=new hr(0,gt.NONE)}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.isIncidentEdgeInResult=function(){for(var h=this.getEdges().getEdges().iterator();h.hasNext();)if(h.next().getEdge().isInResult())return!0;return!1},i.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},i.prototype.getCoordinate=function(){return this._coord},i.prototype.print=function(h){h.println("node "+this._coord+" lbl: "+this._label)},i.prototype.computeIM=function(h){},i.prototype.computeMergedLocation=function(h,d){var x=gt.NONE;if(x=this._label.getLocation(d),!h.isNull(d)){var L=h.getLocation(d);x!==gt.BOUNDARY&&(x=L)}return x},i.prototype.setLabel=function(){if(2!==arguments.length)return e.prototype.setLabel.apply(this,arguments);var h=arguments[0],d=arguments[1];null===this._label?this._label=new hr(h,d):this._label.setLocation(h,d)},i.prototype.getEdges=function(){return this._edges},i.prototype.mergeLabel=function(){if(arguments[0]instanceof i)this.mergeLabel(arguments[0]._label);else if(arguments[0]instanceof hr)for(var d=arguments[0],x=0;x<2;x++){var L=this.computeMergedLocation(d,x);this._label.getLocation(x)===gt.NONE&&this._label.setLocation(x,L)}},i.prototype.add=function(h){this._edges.insert(h),h.setNode(this)},i.prototype.setLabelBoundary=function(h){if(null===this._label)return null;var d=gt.NONE;null!==this._label&&(d=this._label.getLocation(h)),this._label.setLocation(h,d===gt.BOUNDARY?gt.INTERIOR:gt.BOUNDARY)},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i}($e),Qn=function(){this.nodeMap=new yt,this.nodeFact=null,this.nodeFact=arguments[0]};Qn.prototype.find=function(e){return this.nodeMap.get(e)},Qn.prototype.addNode=function(){if(arguments[0]instanceof j){var e=arguments[0],i=this.nodeMap.get(e);return null===i&&(i=this.nodeFact.createNode(e),this.nodeMap.put(e,i)),i}if(arguments[0]instanceof Vr){var h=arguments[0],d=this.nodeMap.get(h.getCoordinate());return null===d?(this.nodeMap.put(h.getCoordinate(),h),h):(d.mergeLabel(h),d)}},Qn.prototype.print=function(e){for(var i=this.iterator();i.hasNext();)i.next().print(e)},Qn.prototype.iterator=function(){return this.nodeMap.values().iterator()},Qn.prototype.values=function(){return this.nodeMap.values()},Qn.prototype.getBoundaryNodes=function(e){for(var i=new or,h=this.iterator();h.hasNext();){var d=h.next();d.getLabel().getLocation(e)===gt.BOUNDARY&&i.add(d)}return i},Qn.prototype.add=function(e){var i=e.getCoordinate();this.addNode(i).add(e)},Qn.prototype.interfaces_=function(){return[]},Qn.prototype.getClass=function(){return Qn};var en=function(){},ci={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};en.prototype.interfaces_=function(){return[]},en.prototype.getClass=function(){return en},en.isNorthern=function(e){return e===en.NE||e===en.NW},en.isOpposite=function(e,i){return e!==i&&(e-i+4)%4==2},en.commonHalfPlane=function(e,i){if(e===i)return e;if((e-i+4)%4==2)return-1;var h=e<i?e:i;return 0===h&&3===(e>i?e:i)?3:h},en.isInHalfPlane=function(e,i){return i===en.SE?e===en.SE||e===en.SW:e===i||e===i+1},en.quadrant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var e=arguments[0],i=arguments[1];if(0===e&&0===i)throw new tt("Cannot compute the quadrant for point ( "+e+", "+i+" )");return e>=0?i>=0?en.NE:en.SE:i>=0?en.NW:en.SW}if(arguments[0]instanceof j&&arguments[1]instanceof j){var h=arguments[0],d=arguments[1];if(d.x===h.x&&d.y===h.y)throw new tt("Cannot compute the quadrant for two identical points "+h);return d.x>=h.x?d.y>=h.y?en.NE:en.SE:d.y>=h.y?en.NW:en.SW}},ci.NE.get=function(){return 0},ci.NW.get=function(){return 1},ci.SW.get=function(){return 2},ci.SE.get=function(){return 3},Object.defineProperties(en,ci);var zr=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length)this._edge=arguments[0];else if(3===arguments.length){var h=arguments[1],d=arguments[2];this._edge=arguments[0],this.init(h,d),this._label=null}else if(4===arguments.length){var L=arguments[1],F=arguments[2],K=arguments[3];this._edge=arguments[0],this.init(L,F),this._label=K}};zr.prototype.compareDirection=function(e){return this._dx===e._dx&&this._dy===e._dy?0:this._quadrant>e._quadrant?1:this._quadrant<e._quadrant?-1:Xe.computeOrientation(e._p0,e._p1,this._p1)},zr.prototype.getDy=function(){return this._dy},zr.prototype.getCoordinate=function(){return this._p0},zr.prototype.setNode=function(e){this._node=e},zr.prototype.print=function(e){var i=Math.atan2(this._dy,this._dx),h=this.getClass().getName(),d=h.lastIndexOf("."),x=h.substring(d+1);e.print("  "+x+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+i+"   "+this._label)},zr.prototype.compareTo=function(e){return this.compareDirection(e)},zr.prototype.getDirectedCoordinate=function(){return this._p1},zr.prototype.getDx=function(){return this._dx},zr.prototype.getLabel=function(){return this._label},zr.prototype.getEdge=function(){return this._edge},zr.prototype.getQuadrant=function(){return this._quadrant},zr.prototype.getNode=function(){return this._node},zr.prototype.toString=function(){var e=Math.atan2(this._dy,this._dx),i=this.getClass().getName(),h=i.lastIndexOf(".");return"  "+i.substring(h+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label},zr.prototype.computeLabel=function(e){},zr.prototype.init=function(e,i){this._p0=e,this._p1=i,this._dx=i.x-e.x,this._dy=i.y-e.y,this._quadrant=en.quadrant(this._dx,this._dy),ot.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")},zr.prototype.interfaces_=function(){return[H]},zr.prototype.getClass=function(){return zr};var Qo=function(e){function i(){var h=arguments[0],d=arguments[1];if(e.call(this,h),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=d,d)this.init(h.getCoordinate(0),h.getCoordinate(1));else{var x=h.getNumPoints()-1;this.init(h.getCoordinate(x),h.getCoordinate(x-1))}this.computeDirectedLabel()}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.getNextMin=function(){return this._nextMin},i.prototype.getDepth=function(h){return this._depth[h]},i.prototype.setVisited=function(h){this._isVisited=h},i.prototype.computeDirectedLabel=function(){this._label=new hr(this._edge.getLabel()),this._isForward||this._label.flip()},i.prototype.getNext=function(){return this._next},i.prototype.setDepth=function(h,d){if(-999!==this._depth[h]&&this._depth[h]!==d)throw new ur("assigned depths do not match",this.getCoordinate());this._depth[h]=d},i.prototype.isInteriorAreaEdge=function(){for(var h=!0,d=0;d<2;d++)this._label.isArea(d)&&this._label.getLocation(d,Bt.LEFT)===gt.INTERIOR&&this._label.getLocation(d,Bt.RIGHT)===gt.INTERIOR||(h=!1);return h},i.prototype.setNextMin=function(h){this._nextMin=h},i.prototype.print=function(h){e.prototype.print.call(this,h),h.print(" "+this._depth[Bt.LEFT]+"/"+this._depth[Bt.RIGHT]),h.print(" ("+this.getDepthDelta()+")"),this._isInResult&&h.print(" inResult")},i.prototype.setMinEdgeRing=function(h){this._minEdgeRing=h},i.prototype.isLineEdge=function(){var h=this._label.isLine(0)||this._label.isLine(1),d=!this._label.isArea(0)||this._label.allPositionsEqual(0,gt.EXTERIOR),x=!this._label.isArea(1)||this._label.allPositionsEqual(1,gt.EXTERIOR);return h&&d&&x},i.prototype.setEdgeRing=function(h){this._edgeRing=h},i.prototype.getMinEdgeRing=function(){return this._minEdgeRing},i.prototype.getDepthDelta=function(){var h=this._edge.getDepthDelta();return this._isForward||(h=-h),h},i.prototype.setInResult=function(h){this._isInResult=h},i.prototype.getSym=function(){return this._sym},i.prototype.isForward=function(){return this._isForward},i.prototype.getEdge=function(){return this._edge},i.prototype.printEdge=function(h){this.print(h),h.print(" "),this._isForward?this._edge.print(h):this._edge.printReverse(h)},i.prototype.setSym=function(h){this._sym=h},i.prototype.setVisitedEdge=function(h){this.setVisited(h),this._sym.setVisited(h)},i.prototype.setEdgeDepths=function(h,d){var x=this.getEdge().getDepthDelta();this._isForward||(x=-x);var L=1;h===Bt.LEFT&&(L=-1);var F=Bt.opposite(h),K=d+x*L;this.setDepth(h,d),this.setDepth(F,K)},i.prototype.getEdgeRing=function(){return this._edgeRing},i.prototype.isInResult=function(){return this._isInResult},i.prototype.setNext=function(h){this._next=h},i.prototype.isVisited=function(){return this._isVisited},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i.depthFactor=function(h,d){return h===gt.EXTERIOR&&d===gt.INTERIOR?1:h===gt.INTERIOR&&d===gt.EXTERIOR?-1:0},i}(zr),ls=function(){};ls.prototype.createNode=function(e){return new Vr(e,null)},ls.prototype.interfaces_=function(){return[]},ls.prototype.getClass=function(){return ls};var Qr=function(){this._edges=new or,this._nodes=null,this._edgeEndList=new or,0===arguments.length?this._nodes=new Qn(new ls):1===arguments.length&&(this._nodes=new Qn(arguments[0]))};Qr.prototype.printEdges=function(e){e.println("Edges:");for(var i=0;i<this._edges.size();i++){e.println("edge "+i+":");var h=this._edges.get(i);h.print(e),h.eiList.print(e)}},Qr.prototype.find=function(e){return this._nodes.find(e)},Qr.prototype.addNode=function(){return arguments[0]instanceof Vr||arguments[0]instanceof j?this._nodes.addNode(arguments[0]):void 0},Qr.prototype.getNodeIterator=function(){return this._nodes.iterator()},Qr.prototype.linkResultDirectedEdges=function(){for(var e=this._nodes.iterator();e.hasNext();)e.next().getEdges().linkResultDirectedEdges()},Qr.prototype.debugPrintln=function(e){Xr.out.println(e)},Qr.prototype.isBoundaryNode=function(e,i){var h=this._nodes.find(i);if(null===h)return!1;var d=h.getLabel();return null!==d&&d.getLocation(e)===gt.BOUNDARY},Qr.prototype.linkAllDirectedEdges=function(){for(var e=this._nodes.iterator();e.hasNext();)e.next().getEdges().linkAllDirectedEdges()},Qr.prototype.matchInSameDirection=function(e,i,h,d){return!!e.equals(h)&&Xe.computeOrientation(e,i,d)===Xe.COLLINEAR&&en.quadrant(e,i)===en.quadrant(h,d)},Qr.prototype.getEdgeEnds=function(){return this._edgeEndList},Qr.prototype.debugPrint=function(e){Xr.out.print(e)},Qr.prototype.getEdgeIterator=function(){return this._edges.iterator()},Qr.prototype.findEdgeInSameDirection=function(e,i){for(var h=0;h<this._edges.size();h++){var d=this._edges.get(h),x=d.getCoordinates();if(this.matchInSameDirection(e,i,x[0],x[1])||this.matchInSameDirection(e,i,x[x.length-1],x[x.length-2]))return d}return null},Qr.prototype.insertEdge=function(e){this._edges.add(e)},Qr.prototype.findEdgeEnd=function(e){for(var i=this.getEdgeEnds().iterator();i.hasNext();){var h=i.next();if(h.getEdge()===e)return h}return null},Qr.prototype.addEdges=function(e){for(var i=e.iterator();i.hasNext();){var h=i.next();this._edges.add(h);var d=new Qo(h,!0),x=new Qo(h,!1);d.setSym(x),x.setSym(d),this.add(d),this.add(x)}},Qr.prototype.add=function(e){this._nodes.add(e),this._edgeEndList.add(e)},Qr.prototype.getNodes=function(){return this._nodes.values()},Qr.prototype.findEdge=function(e,i){for(var h=0;h<this._edges.size();h++){var d=this._edges.get(h),x=d.getCoordinates();if(e.equals(x[0])&&i.equals(x[1]))return d}return null},Qr.prototype.interfaces_=function(){return[]},Qr.prototype.getClass=function(){return Qr},Qr.linkResultDirectedEdges=function(e){for(var i=e.iterator();i.hasNext();)i.next().getEdges().linkResultDirectedEdges()};var ni=function(){this._geometryFactory=null,this._shellList=new or,this._geometryFactory=arguments[0]};ni.prototype.sortShellsAndHoles=function(e,i,h){for(var d=e.iterator();d.hasNext();){var x=d.next();x.isHole()?h.add(x):i.add(x)}},ni.prototype.computePolygons=function(e){for(var i=new or,h=e.iterator();h.hasNext();){var d=h.next().toPolygon(this._geometryFactory);i.add(d)}return i},ni.prototype.placeFreeHoles=function(e,i){for(var h=i.iterator();h.hasNext();){var d=h.next();if(null===d.getShell()){var x=this.findEdgeRingContaining(d,e);if(null===x)throw new ur("unable to assign hole to a shell",d.getCoordinate(0));d.setShell(x)}}},ni.prototype.buildMinimalEdgeRings=function(e,i,h){for(var d=new or,x=e.iterator();x.hasNext();){var L=x.next();if(L.getMaxNodeDegree()>2){L.linkDirectedEdgesForMinimalEdgeRings();var F=L.buildMinimalRings(),K=this.findShell(F);null!==K?(this.placePolygonHoles(K,F),i.add(K)):h.addAll(F)}else d.add(L)}return d},ni.prototype.containsPoint=function(e){for(var i=this._shellList.iterator();i.hasNext();)if(i.next().containsPoint(e))return!0;return!1},ni.prototype.buildMaximalEdgeRings=function(e){for(var i=new or,h=e.iterator();h.hasNext();){var d=h.next();if(d.isInResult()&&d.getLabel().isArea()&&null===d.getEdgeRing()){var x=new zo(d,this._geometryFactory);i.add(x),x.setInResult()}}return i},ni.prototype.placePolygonHoles=function(e,i){for(var h=i.iterator();h.hasNext();){var d=h.next();d.isHole()&&d.setShell(e)}},ni.prototype.getPolygons=function(){return this.computePolygons(this._shellList)},ni.prototype.findEdgeRingContaining=function(e,i){for(var h=e.getLinearRing(),d=h.getEnvelopeInternal(),x=h.getCoordinateN(0),L=null,F=null,K=i.iterator();K.hasNext();){var Mt=K.next(),Qt=Mt.getLinearRing(),ke=Qt.getEnvelopeInternal();null!==L&&(F=L.getLinearRing().getEnvelopeInternal());var Ge=!1;ke.contains(d)&&Xe.isPointInRing(x,Qt.getCoordinates())&&(Ge=!0),Ge&&(null===L||F.contains(ke))&&(L=Mt)}return L},ni.prototype.findShell=function(e){for(var i=0,h=null,d=e.iterator();d.hasNext();){var x=d.next();x.isHole()||(h=x,i++)}return ot.isTrue(i<=1,"found two shells in MinimalEdgeRing list"),h},ni.prototype.add=function(){if(1===arguments.length){var e=arguments[0];this.add(e.getEdgeEnds(),e.getNodes())}else if(2===arguments.length){var i=arguments[0];Qr.linkResultDirectedEdges(arguments[1]);var d=this.buildMaximalEdgeRings(i),x=new or,L=this.buildMinimalEdgeRings(d,this._shellList,x);this.sortShellsAndHoles(L,this._shellList,x),this.placeFreeHoles(this._shellList,x)}},ni.prototype.interfaces_=function(){return[]},ni.prototype.getClass=function(){return ni};var Ao=function(){};Ao.prototype.getBounds=function(){},Ao.prototype.interfaces_=function(){return[]},Ao.prototype.getClass=function(){return Ao};var Lo=function(){this._bounds=null,this._item=null;var i=arguments[1];this._bounds=arguments[0],this._item=i};Lo.prototype.getItem=function(){return this._item},Lo.prototype.getBounds=function(){return this._bounds},Lo.prototype.interfaces_=function(){return[Ao,dt]},Lo.prototype.getClass=function(){return Lo};var io=function(){this._size=null,this._items=null,this._size=0,this._items=new or,this._items.add(null)};io.prototype.poll=function(){if(this.isEmpty())return null;var e=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),e},io.prototype.size=function(){return this._size},io.prototype.reorder=function(e){for(var i=null,h=this._items.get(e);2*e<=this._size&&((i=2*e)!==this._size&&this._items.get(i+1).compareTo(this._items.get(i))<0&&i++,this._items.get(i).compareTo(h)<0);e=i)this._items.set(e,this._items.get(i));this._items.set(e,h)},io.prototype.clear=function(){this._size=0,this._items.clear()},io.prototype.isEmpty=function(){return 0===this._size},io.prototype.add=function(e){this._items.add(null),this._size+=1;var i=this._size;for(this._items.set(0,e);e.compareTo(this._items.get(Math.trunc(i/2)))<0;i/=2)this._items.set(i,this._items.get(Math.trunc(i/2)));this._items.set(i,e)},io.prototype.interfaces_=function(){return[]},io.prototype.getClass=function(){return io};var ba=function(){};ba.prototype.visitItem=function(e){},ba.prototype.interfaces_=function(){return[]},ba.prototype.getClass=function(){return ba};var yu=function(){};yu.prototype.insert=function(e,i){},yu.prototype.remove=function(e,i){},yu.prototype.query=function(){},yu.prototype.interfaces_=function(){return[]},yu.prototype.getClass=function(){return yu};var Do=function(){this._childBoundables=new or,this._bounds=null,this._level=null,0!==arguments.length&&1===arguments.length&&(this._level=arguments[0])},jl={serialVersionUID:{configurable:!0}};Do.prototype.getLevel=function(){return this._level},Do.prototype.size=function(){return this._childBoundables.size()},Do.prototype.getChildBoundables=function(){return this._childBoundables},Do.prototype.addChildBoundable=function(e){ot.isTrue(null===this._bounds),this._childBoundables.add(e)},Do.prototype.isEmpty=function(){return this._childBoundables.isEmpty()},Do.prototype.getBounds=function(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds},Do.prototype.interfaces_=function(){return[Ao,dt]},Do.prototype.getClass=function(){return Do},jl.serialVersionUID.get=function(){return 0x5a1e55ec41369800},Object.defineProperties(Do,jl);var Vn=function(){};Vn.reverseOrder=function(){return{compare:function(e,i){return i.compareTo(e)}}},Vn.min=function(e){return Vn.sort(e),e.get(0)},Vn.sort=function(e,i){var h=e.toArray();i?Te.sort(h,i):Te.sort(h);for(var d=e.iterator(),x=0,L=h.length;x<L;x++)d.next(),d.set(h[x])},Vn.singletonList=function(e){var i=new or;return i.add(e),i};var wo=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var i=arguments[1],h=arguments[2];this._boundable1=arguments[0],this._boundable2=i,this._itemDistance=h,this._distance=this.distance()};wo.prototype.expandToQueue=function(e,i){var h=wo.isComposite(this._boundable1),d=wo.isComposite(this._boundable2);if(h&&d)return wo.area(this._boundable1)>wo.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,e,i),null):(this.expand(this._boundable2,this._boundable1,e,i),null);if(h)return this.expand(this._boundable1,this._boundable2,e,i),null;if(d)return this.expand(this._boundable2,this._boundable1,e,i),null;throw new tt("neither boundable is composite")},wo.prototype.isLeaves=function(){return!(wo.isComposite(this._boundable1)||wo.isComposite(this._boundable2))},wo.prototype.compareTo=function(e){return this._distance<e._distance?-1:this._distance>e._distance?1:0},wo.prototype.expand=function(e,i,h,d){for(var x=e.getChildBoundables().iterator();x.hasNext();){var L=x.next(),F=new wo(L,i,this._itemDistance);F.getDistance()<d&&h.add(F)}},wo.prototype.getBoundable=function(e){return 0===e?this._boundable1:this._boundable2},wo.prototype.getDistance=function(){return this._distance},wo.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())},wo.prototype.interfaces_=function(){return[H]},wo.prototype.getClass=function(){return wo},wo.area=function(e){return e.getBounds().getArea()},wo.isComposite=function(e){return e instanceof Do};var Ho=function e(){if(this._root=null,this._built=!1,this._itemBoundables=new or,this._nodeCapacity=null,0===arguments.length)this._nodeCapacity=e.DEFAULT_NODE_CAPACITY;else if(1===arguments.length){var h=arguments[0];ot.isTrue(h>1,"Node capacity must be greater than 1"),this._nodeCapacity=h}},zu={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};Ho.prototype.getNodeCapacity=function(){return this._nodeCapacity},Ho.prototype.lastNode=function(e){return e.get(e.size()-1)},Ho.prototype.size=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){for(var e=0,i=arguments[0].getChildBoundables().iterator();i.hasNext();){var h=i.next();h instanceof Do?e+=this.size(h):h instanceof Lo&&(e+=1)}return e}},Ho.prototype.removeItem=function(e,i){for(var h=null,d=e.getChildBoundables().iterator();d.hasNext();){var x=d.next();x instanceof Lo&&x.getItem()===i&&(h=x)}return null!==h&&(e.getChildBoundables().remove(h),!0)},Ho.prototype.itemsTree=function(){if(0===arguments.length){this.build();var e=this.itemsTree(this._root);return null===e?new or:e}if(1===arguments.length){for(var i=arguments[0],h=new or,d=i.getChildBoundables().iterator();d.hasNext();){var x=d.next();if(x instanceof Do){var L=this.itemsTree(x);null!==L&&h.add(L)}else x instanceof Lo?h.add(x.getItem()):ot.shouldNeverReachHere()}return h.size()<=0?null:h}},Ho.prototype.insert=function(e,i){ot.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new Lo(e,i))},Ho.prototype.boundablesAtLevel=function(){if(1===arguments.length){var e=arguments[0],i=new or;return this.boundablesAtLevel(e,this._root,i),i}if(3===arguments.length){var h=arguments[0],d=arguments[1],x=arguments[2];if(ot.isTrue(h>-2),d.getLevel()===h)return x.add(d),null;for(var L=d.getChildBoundables().iterator();L.hasNext();){var F=L.next();F instanceof Do?this.boundablesAtLevel(h,F,x):(ot.isTrue(F instanceof Lo),-1===h&&x.add(F))}return null}},Ho.prototype.query=function(){if(1===arguments.length){var e=arguments[0];this.build();var i=new or;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),e)&&this.query(e,this._root,i),i}if(2===arguments.length){var h=arguments[0],d=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),h)&&this.query(h,this._root,d)}else if(3===arguments.length)if(Ie(arguments[2],ba)&&arguments[0]instanceof Object&&arguments[1]instanceof Do)for(var x=arguments[0],F=arguments[2],K=arguments[1].getChildBoundables(),Mt=0;Mt<K.size();Mt++){var Qt=K.get(Mt);this.getIntersectsOp().intersects(Qt.getBounds(),x)&&(Qt instanceof Do?this.query(x,Qt,F):Qt instanceof Lo?F.visitItem(Qt.getItem()):ot.shouldNeverReachHere())}else if(Ie(arguments[2],On)&&arguments[0]instanceof Object&&arguments[1]instanceof Do)for(var ke=arguments[0],gr=arguments[2],Ir=arguments[1].getChildBoundables(),jr=0;jr<Ir.size();jr++){var ln=Ir.get(jr);this.getIntersectsOp().intersects(ln.getBounds(),ke)&&(ln instanceof Do?this.query(ke,ln,gr):ln instanceof Lo?gr.add(ln.getItem()):ot.shouldNeverReachHere())}},Ho.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0},Ho.prototype.getRoot=function(){return this.build(),this._root},Ho.prototype.remove=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),e)&&this.remove(e,this._root,i)}if(3===arguments.length){var h=arguments[0],d=arguments[1],x=arguments[2],L=this.removeItem(d,x);if(L)return!0;for(var F=null,K=d.getChildBoundables().iterator();K.hasNext();){var Mt=K.next();if(this.getIntersectsOp().intersects(Mt.getBounds(),h)&&Mt instanceof Do&&(L=this.remove(h,Mt,x))){F=Mt;break}}return null!==F&&F.getChildBoundables().isEmpty()&&d.getChildBoundables().remove(F),L}},Ho.prototype.createHigherLevels=function(e,i){ot.isTrue(!e.isEmpty());var h=this.createParentBoundables(e,i+1);return 1===h.size()?h.get(0):this.createHigherLevels(h,i+1)},Ho.prototype.depth=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){for(var e=0,i=arguments[0].getChildBoundables().iterator();i.hasNext();){var h=i.next();if(h instanceof Do){var d=this.depth(h);d>e&&(e=d)}}return e+1}},Ho.prototype.createParentBoundables=function(e,i){ot.isTrue(!e.isEmpty());var h=new or;h.add(this.createNode(i));var d=new or(e);Vn.sort(d,this.getComparator());for(var x=d.iterator();x.hasNext();){var L=x.next();this.lastNode(h).getChildBoundables().size()===this.getNodeCapacity()&&h.add(this.createNode(i)),this.lastNode(h).addChildBoundable(L)}return h},Ho.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()},Ho.prototype.interfaces_=function(){return[dt]},Ho.prototype.getClass=function(){return Ho},Ho.compareDoubles=function(e,i){return e>i?1:e<i?-1:0},zu.IntersectsOp.get=function(){return Dl},zu.serialVersionUID.get=function(){return-0x35ef64c82d4c5400},zu.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(Ho,zu);var Dl=function(){},xs=function(){};xs.prototype.distance=function(e,i){},xs.prototype.interfaces_=function(){return[]},xs.prototype.getClass=function(){return xs};var Ol=function(e){function i(d){e.call(this,d=d||i.DEFAULT_NODE_CAPACITY)}e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i;var h={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return i.prototype.createParentBoundablesFromVerticalSlices=function(d,x){ot.isTrue(d.length>0);for(var L=new or,F=0;F<d.length;F++)L.addAll(this.createParentBoundablesFromVerticalSlice(d[F],x));return L},i.prototype.createNode=function(d){return new tl(d)},i.prototype.size=function(){return 0===arguments.length?e.prototype.size.call(this):e.prototype.size.apply(this,arguments)},i.prototype.insert=function(){if(2!==arguments.length)return e.prototype.insert.apply(this,arguments);var d=arguments[0],x=arguments[1];if(d.isNull())return null;e.prototype.insert.call(this,d,x)},i.prototype.getIntersectsOp=function(){return i.intersectsOp},i.prototype.verticalSlices=function(d,x){for(var L=Math.trunc(Math.ceil(d.size()/x)),F=new Array(x).fill(null),K=d.iterator(),Mt=0;Mt<x;Mt++){F[Mt]=new or;for(var Qt=0;K.hasNext()&&Qt<L;){var ke=K.next();F[Mt].add(ke),Qt++}}return F},i.prototype.query=function(){if(1===arguments.length)return e.prototype.query.call(this,arguments[0]);2===arguments.length?e.prototype.query.call(this,arguments[0],arguments[1]):3===arguments.length&&(Ie(arguments[2],ba)&&arguments[0]instanceof Object&&arguments[1]instanceof Do||Ie(arguments[2],On)&&arguments[0]instanceof Object&&arguments[1]instanceof Do)&&e.prototype.query.call(this,arguments[0],arguments[1],arguments[2])},i.prototype.getComparator=function(){return i.yComparator},i.prototype.createParentBoundablesFromVerticalSlice=function(d,x){return e.prototype.createParentBoundables.call(this,d,x)},i.prototype.remove=function(){return 2===arguments.length?e.prototype.remove.call(this,arguments[0],arguments[1]):e.prototype.remove.apply(this,arguments)},i.prototype.depth=function(){return 0===arguments.length?e.prototype.depth.call(this):e.prototype.depth.apply(this,arguments)},i.prototype.createParentBoundables=function(d,x){ot.isTrue(!d.isEmpty());var L=Math.trunc(Math.ceil(d.size()/this.getNodeCapacity())),F=new or(d);Vn.sort(F,i.xComparator);var K=this.verticalSlices(F,Math.trunc(Math.ceil(Math.sqrt(L))));return this.createParentBoundablesFromVerticalSlices(K,x)},i.prototype.nearestNeighbour=function(){if(1===arguments.length){if(Ie(arguments[0],xs)){var d=arguments[0],x=new wo(this.getRoot(),this.getRoot(),d);return this.nearestNeighbour(x)}if(arguments[0]instanceof wo)return this.nearestNeighbour(arguments[0],X.POSITIVE_INFINITY)}else if(2===arguments.length){if(arguments[0]instanceof i&&Ie(arguments[1],xs)){var F=arguments[0],K=arguments[1],Mt=new wo(this.getRoot(),F.getRoot(),K);return this.nearestNeighbour(Mt)}if(arguments[0]instanceof wo&&"number"==typeof arguments[1]){var Qt=arguments[0],ke=arguments[1],Ge=null,gr=new io;for(gr.add(Qt);!gr.isEmpty()&&ke>0;){var Ir=gr.poll(),jr=Ir.getDistance();if(jr>=ke)break;Ir.isLeaves()?(ke=jr,Ge=Ir):Ir.expandToQueue(gr,ke)}return[Ge.getBoundable(0).getItem(),Ge.getBoundable(1).getItem()]}}else if(3===arguments.length){var l=arguments[2],f=new Lo(arguments[0],arguments[1]),c=new wo(this.getRoot(),f,l);return this.nearestNeighbour(c)[0]}},i.prototype.interfaces_=function(){return[yu,dt]},i.prototype.getClass=function(){return i},i.centreX=function(d){return i.avg(d.getMinX(),d.getMaxX())},i.avg=function(d,x){return(d+x)/2},i.centreY=function(d){return i.avg(d.getMinY(),d.getMaxY())},h.STRtreeNode.get=function(){return tl},h.serialVersionUID.get=function(){return 0x39920f7d5f261e0},h.xComparator.get=function(){return{interfaces_:function(){return[at]},compare:function(d,x){return e.compareDoubles(i.centreX(d.getBounds()),i.centreX(x.getBounds()))}}},h.yComparator.get=function(){return{interfaces_:function(){return[at]},compare:function(d,x){return e.compareDoubles(i.centreY(d.getBounds()),i.centreY(x.getBounds()))}}},h.intersectsOp.get=function(){return{interfaces_:function(){return[e.IntersectsOp]},intersects:function(d,x){return d.intersects(x)}}},h.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(i,h),i}(Ho),tl=function(e){function i(){e.call(this,arguments[0])}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.computeBounds=function(){for(var h=null,d=this.getChildBoundables().iterator();d.hasNext();){var x=d.next();null===h?h=new qe(x.getBounds()):h.expandToInclude(x.getBounds())}return h},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i}(Do),da=function(){};da.prototype.interfaces_=function(){return[]},da.prototype.getClass=function(){return da},da.relativeSign=function(e,i){return e<i?-1:e>i?1:0},da.compare=function(e,i,h){if(i.equals2D(h))return 0;var d=da.relativeSign(i.x,h.x),x=da.relativeSign(i.y,h.y);switch(e){case 0:return da.compareValue(d,x);case 1:return da.compareValue(x,d);case 2:return da.compareValue(x,-d);case 3:return da.compareValue(-d,x);case 4:return da.compareValue(-d,-x);case 5:return da.compareValue(-x,-d);case 6:return da.compareValue(-x,d);case 7:return da.compareValue(d,-x)}return ot.shouldNeverReachHere("invalid octant value"),0},da.compareValue=function(e,i){return e<0?-1:e>0?1:i<0?-1:i>0?1:0};var Ys=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var e=arguments[0],i=arguments[1],h=arguments[2],d=arguments[3];this._segString=e,this.coord=new j(i),this.segmentIndex=h,this._segmentOctant=d,this._isInterior=!i.equals2D(e.getCoordinate(h))};Ys.prototype.getCoordinate=function(){return this.coord},Ys.prototype.print=function(e){e.print(this.coord),e.print(" seg # = "+this.segmentIndex)},Ys.prototype.compareTo=function(e){var i=e;return this.segmentIndex<i.segmentIndex?-1:this.segmentIndex>i.segmentIndex?1:this.coord.equals2D(i.coord)?0:da.compare(this._segmentOctant,this.coord,i.coord)},Ys.prototype.isEndPoint=function(e){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===e},Ys.prototype.isInterior=function(){return this._isInterior},Ys.prototype.interfaces_=function(){return[H]},Ys.prototype.getClass=function(){return Ys};var yi=function(){this._nodeMap=new yt,this._edge=null,this._edge=arguments[0]};yi.prototype.getSplitCoordinates=function(){var e=new Y;this.addEndpoints();for(var i=this.iterator(),h=i.next();i.hasNext();){var d=i.next();this.addEdgeCoordinates(h,d,e),h=d}return e.toCoordinateArray()},yi.prototype.addCollapsedNodes=function(){var e=new or;this.findCollapsesFromInsertedNodes(e),this.findCollapsesFromExistingVertices(e);for(var i=e.iterator();i.hasNext();){var h=i.next().intValue();this.add(this._edge.getCoordinate(h),h)}},yi.prototype.print=function(e){e.println("Intersections:");for(var i=this.iterator();i.hasNext();)i.next().print(e)},yi.prototype.findCollapsesFromExistingVertices=function(e){for(var i=0;i<this._edge.size()-2;i++){var h=this._edge.getCoordinate(i),d=this._edge.getCoordinate(i+2);h.equals2D(d)&&e.add(new te(i+1))}},yi.prototype.addEdgeCoordinates=function(e,i,h){var d=this._edge.getCoordinate(i.segmentIndex),x=i.isInterior()||!i.coord.equals2D(d);h.add(new j(e.coord),!1);for(var L=e.segmentIndex+1;L<=i.segmentIndex;L++)h.add(this._edge.getCoordinate(L));x&&h.add(new j(i.coord))},yi.prototype.iterator=function(){return this._nodeMap.values().iterator()},yi.prototype.addSplitEdges=function(e){this.addEndpoints(),this.addCollapsedNodes();for(var i=this.iterator(),h=i.next();i.hasNext();){var d=i.next(),x=this.createSplitEdge(h,d);e.add(x),h=d}},yi.prototype.findCollapseIndex=function(e,i,h){if(!e.coord.equals2D(i.coord))return!1;var d=i.segmentIndex-e.segmentIndex;return i.isInterior()||d--,1===d&&(h[0]=e.segmentIndex+1,!0)},yi.prototype.findCollapsesFromInsertedNodes=function(e){for(var i=new Array(1).fill(null),h=this.iterator(),d=h.next();h.hasNext();){var x=h.next();this.findCollapseIndex(d,x,i)&&e.add(new te(i[0])),d=x}},yi.prototype.getEdge=function(){return this._edge},yi.prototype.addEndpoints=function(){var e=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(e),e)},yi.prototype.createSplitEdge=function(e,i){var h=i.segmentIndex-e.segmentIndex+2,d=this._edge.getCoordinate(i.segmentIndex),x=i.isInterior()||!i.coord.equals2D(d);x||h--;var L=new Array(h).fill(null),F=0;L[F++]=new j(e.coord);for(var K=e.segmentIndex+1;K<=i.segmentIndex;K++)L[F++]=this._edge.getCoordinate(K);return x&&(L[F]=new j(i.coord)),new Fi(L,this._edge.getData())},yi.prototype.add=function(e,i){var h=new Ys(this._edge,e,i,this._edge.getSegmentOctant(i)),d=this._nodeMap.get(h);return null!==d?(ot.isTrue(d.coord.equals2D(e),"Found equal nodes with different coordinates"),d):(this._nodeMap.put(h,h),h)},yi.prototype.checkSplitEdgesCorrectness=function(e){var i=this._edge.getCoordinates(),h=e.get(0).getCoordinate(0);if(!h.equals2D(i[0]))throw new st("bad split edge start point at "+h);var d=e.get(e.size()-1).getCoordinates(),x=d[d.length-1];if(!x.equals2D(i[i.length-1]))throw new st("bad split edge end point at "+x)},yi.prototype.interfaces_=function(){return[]},yi.prototype.getClass=function(){return yi};var uu=function(){};uu.prototype.interfaces_=function(){return[]},uu.prototype.getClass=function(){return uu},uu.octant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var e=arguments[0],i=arguments[1];if(0===e&&0===i)throw new tt("Cannot compute the octant for point ( "+e+", "+i+" )");var h=Math.abs(e),d=Math.abs(i);return e>=0?i>=0?h>=d?0:1:h>=d?7:6:i>=0?h>=d?3:2:h>=d?4:5}if(arguments[0]instanceof j&&arguments[1]instanceof j){var x=arguments[0],L=arguments[1],F=L.x-x.x,K=L.y-x.y;if(0===F&&0===K)throw new tt("Cannot compute the octant for two identical points "+x);return uu.octant(F,K)}};var wa=function(){};wa.prototype.getCoordinates=function(){},wa.prototype.size=function(){},wa.prototype.getCoordinate=function(e){},wa.prototype.isClosed=function(){},wa.prototype.setData=function(e){},wa.prototype.getData=function(){},wa.prototype.interfaces_=function(){return[]},wa.prototype.getClass=function(){return wa};var Rs=function(){};Rs.prototype.addIntersection=function(e,i){},Rs.prototype.interfaces_=function(){return[wa]},Rs.prototype.getClass=function(){return Rs};var Fi=function(){this._nodeList=new yi(this),this._pts=null,this._data=null;var i=arguments[1];this._pts=arguments[0],this._data=i};Fi.prototype.getCoordinates=function(){return this._pts},Fi.prototype.size=function(){return this._pts.length},Fi.prototype.getCoordinate=function(e){return this._pts[e]},Fi.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},Fi.prototype.getSegmentOctant=function(e){return e===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(e),this.getCoordinate(e+1))},Fi.prototype.setData=function(e){this._data=e},Fi.prototype.safeOctant=function(e,i){return e.equals2D(i)?0:uu.octant(e,i)},Fi.prototype.getData=function(){return this._data},Fi.prototype.addIntersection=function(){if(2===arguments.length)this.addIntersectionNode(arguments[0],arguments[1]);else if(4===arguments.length){var d=arguments[1],L=new j(arguments[0].getIntersection(arguments[3]));this.addIntersection(L,d)}},Fi.prototype.toString=function(){return Kt.toLineString(new Hn(this._pts))},Fi.prototype.getNodeList=function(){return this._nodeList},Fi.prototype.addIntersectionNode=function(e,i){var h=i,d=h+1;return d<this._pts.length&&e.equals2D(this._pts[d])&&(h=d),this._nodeList.add(e,h)},Fi.prototype.addIntersections=function(e,i,h){for(var d=0;d<e.getIntersectionNum();d++)this.addIntersection(e,i,h,d)},Fi.prototype.interfaces_=function(){return[Rs]},Fi.prototype.getClass=function(){return Fi},Fi.getNodedSubstrings=function(){if(1===arguments.length){var e=arguments[0],i=new or;return Fi.getNodedSubstrings(e,i),i}if(2===arguments.length)for(var d=arguments[1],x=arguments[0].iterator();x.hasNext();)x.next().getNodeList().addSplitEdges(d)};var Jr=function(){if(this.p0=null,this.p1=null,0===arguments.length)this.p0=new j,this.p1=new j;else if(1===arguments.length){var e=arguments[0];this.p0=new j(e.p0),this.p1=new j(e.p1)}else if(2===arguments.length)this.p0=arguments[0],this.p1=arguments[1];else if(4===arguments.length){var d=arguments[2],x=arguments[3];this.p0=new j(arguments[0],arguments[1]),this.p1=new j(d,x)}},vu={serialVersionUID:{configurable:!0}};Jr.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)},Jr.prototype.orientationIndex=function(){if(arguments[0]instanceof Jr){var e=arguments[0],i=Xe.orientationIndex(this.p0,this.p1,e.p0),h=Xe.orientationIndex(this.p0,this.p1,e.p1);return i>=0&&h>=0||i<=0&&h<=0?Math.max(i,h):0}if(arguments[0]instanceof j)return Xe.orientationIndex(this.p0,this.p1,arguments[0])},Jr.prototype.toGeometry=function(e){return e.createLineString([this.p0,this.p1])},Jr.prototype.isVertical=function(){return this.p0.x===this.p1.x},Jr.prototype.equals=function(e){if(!(e instanceof Jr))return!1;var i=e;return this.p0.equals(i.p0)&&this.p1.equals(i.p1)},Jr.prototype.intersection=function(e){var i=new De;return i.computeIntersection(this.p0,this.p1,e.p0,e.p1),i.hasIntersection()?i.getIntersection(0):null},Jr.prototype.project=function(){if(arguments[0]instanceof j){var e=arguments[0];if(e.equals(this.p0)||e.equals(this.p1))return new j(e);var i=this.projectionFactor(e),h=new j;return h.x=this.p0.x+i*(this.p1.x-this.p0.x),h.y=this.p0.y+i*(this.p1.y-this.p0.y),h}if(arguments[0]instanceof Jr){var d=arguments[0],x=this.projectionFactor(d.p0),L=this.projectionFactor(d.p1);if(x>=1&&L>=1||x<=0&&L<=0)return null;var F=this.project(d.p0);x<0&&(F=this.p0),x>1&&(F=this.p1);var K=this.project(d.p1);return L<0&&(K=this.p0),L>1&&(K=this.p1),new Jr(F,K)}},Jr.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()},Jr.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},Jr.prototype.getCoordinate=function(e){return 0===e?this.p0:this.p1},Jr.prototype.distancePerpendicular=function(e){return Xe.distancePointLinePerpendicular(e,this.p0,this.p1)},Jr.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)},Jr.prototype.midPoint=function(){return Jr.midPoint(this.p0,this.p1)},Jr.prototype.projectionFactor=function(e){if(e.equals(this.p0))return 0;if(e.equals(this.p1))return 1;var i=this.p1.x-this.p0.x,h=this.p1.y-this.p0.y,d=i*i+h*h;return d<=0?X.NaN:((e.x-this.p0.x)*i+(e.y-this.p0.y)*h)/d},Jr.prototype.closestPoints=function(e){var i=this.intersection(e);if(null!==i)return[i,i];var h=new Array(2).fill(null),d=X.MAX_VALUE,x=null,L=this.closestPoint(e.p0);d=L.distance(e.p0),h[0]=L,h[1]=e.p0;var F=this.closestPoint(e.p1);(x=F.distance(e.p1))<d&&(d=x,h[0]=F,h[1]=e.p1);var K=e.closestPoint(this.p0);(x=K.distance(this.p0))<d&&(d=x,h[0]=this.p0,h[1]=K);var Mt=e.closestPoint(this.p1);return(x=Mt.distance(this.p1))<d&&(d=x,h[0]=this.p1,h[1]=Mt),h},Jr.prototype.closestPoint=function(e){var i=this.projectionFactor(e);return i>0&&i<1?this.project(e):this.p0.distance(e)<this.p1.distance(e)?this.p0:this.p1},Jr.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)},Jr.prototype.getLength=function(){return this.p0.distance(this.p1)},Jr.prototype.compareTo=function(e){var i=e,h=this.p0.compareTo(i.p0);return 0!==h?h:this.p1.compareTo(i.p1)},Jr.prototype.reverse=function(){var e=this.p0;this.p0=this.p1,this.p1=e},Jr.prototype.equalsTopo=function(e){return this.p0.equals(e.p0)&&(this.p1.equals(e.p1)||this.p0.equals(e.p1))&&this.p1.equals(e.p0)},Jr.prototype.lineIntersection=function(e){try{return Sr.intersection(this.p0,this.p1,e.p0,e.p1)}catch(i){if(!(i instanceof kr))throw i}return null},Jr.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)},Jr.prototype.pointAlongOffset=function(e,i){var h=this.p0.x+e*(this.p1.x-this.p0.x),d=this.p0.y+e*(this.p1.y-this.p0.y),x=this.p1.x-this.p0.x,L=this.p1.y-this.p0.y,F=Math.sqrt(x*x+L*L),K=0,Mt=0;if(0!==i){if(F<=0)throw new Error("Cannot compute offset from zero-length line segment");K=i*x/F,Mt=i*L/F}return new j(h-Mt,d+K)},Jr.prototype.setCoordinates=function(){if(1===arguments.length){var e=arguments[0];this.setCoordinates(e.p0,e.p1)}else if(2===arguments.length){var i=arguments[0],h=arguments[1];this.p0.x=i.x,this.p0.y=i.y,this.p1.x=h.x,this.p1.y=h.y}},Jr.prototype.segmentFraction=function(e){var i=this.projectionFactor(e);return i<0?i=0:(i>1||X.isNaN(i))&&(i=1),i},Jr.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},Jr.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},Jr.prototype.distance=function(){if(arguments[0]instanceof Jr){var e=arguments[0];return Xe.distanceLineLine(this.p0,this.p1,e.p0,e.p1)}if(arguments[0]instanceof j)return Xe.distancePointLine(arguments[0],this.p0,this.p1)},Jr.prototype.pointAlong=function(e){var i=new j;return i.x=this.p0.x+e*(this.p1.x-this.p0.x),i.y=this.p0.y+e*(this.p1.y-this.p0.y),i},Jr.prototype.hashCode=function(){var e=X.doubleToLongBits(this.p0.x);e^=31*X.doubleToLongBits(this.p0.y);var i=Math.trunc(e)^Math.trunc(e>>32),h=X.doubleToLongBits(this.p1.x);return h^=31*X.doubleToLongBits(this.p1.y),i^Math.trunc(h)^Math.trunc(h>>32)},Jr.prototype.interfaces_=function(){return[H,dt]},Jr.prototype.getClass=function(){return Jr},Jr.midPoint=function(e,i){return new j((e.x+i.x)/2,(e.y+i.y)/2)},vu.serialVersionUID.get=function(){return 0x2d2172135f411c00},Object.defineProperties(Jr,vu);var Js=function(){this.tempEnv1=new qe,this.tempEnv2=new qe,this._overlapSeg1=new Jr,this._overlapSeg2=new Jr};Js.prototype.overlap=function(){if(2!==arguments.length&&4===arguments.length){var h=arguments[2],d=arguments[3];arguments[0].getLineSegment(arguments[1],this._overlapSeg1),h.getLineSegment(d,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}},Js.prototype.interfaces_=function(){return[]},Js.prototype.getClass=function(){return Js};var aa=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var i=arguments[1],h=arguments[2],d=arguments[3];this._pts=arguments[0],this._start=i,this._end=h,this._context=d};aa.prototype.getLineSegment=function(e,i){i.p0=this._pts[e],i.p1=this._pts[e+1]},aa.prototype.computeSelect=function(e,i,h,d){if(d.tempEnv1.init(this._pts[i],this._pts[h]),h-i==1)return d.select(this,i),null;if(!e.intersects(d.tempEnv1))return null;var F=Math.trunc((i+h)/2);i<F&&this.computeSelect(e,i,F,d),F<h&&this.computeSelect(e,F,h,d)},aa.prototype.getCoordinates=function(){for(var e=new Array(this._end-this._start+1).fill(null),i=0,h=this._start;h<=this._end;h++)e[i++]=this._pts[h];return e},aa.prototype.computeOverlaps=function(e,i){this.computeOverlapsInternal(this._start,this._end,e,e._start,e._end,i)},aa.prototype.setId=function(e){this._id=e},aa.prototype.select=function(e,i){this.computeSelect(e,this._start,this._end,i)},aa.prototype.getEnvelope=function(){return null===this._env&&(this._env=new qe(this._pts[this._start],this._pts[this._end])),this._env},aa.prototype.getEndIndex=function(){return this._end},aa.prototype.getStartIndex=function(){return this._start},aa.prototype.getContext=function(){return this._context},aa.prototype.getId=function(){return this._id},aa.prototype.computeOverlapsInternal=function(e,i,h,d,x,L){var F=this._pts[e],K=this._pts[i],Mt=h._pts[d],Qt=h._pts[x];if(i-e==1&&x-d==1)return L.overlap(this,e,h,d),null;if(L.tempEnv1.init(F,K),L.tempEnv2.init(Mt,Qt),!L.tempEnv1.intersects(L.tempEnv2))return null;var ke=Math.trunc((e+i)/2),Ge=Math.trunc((d+x)/2);e<ke&&(d<Ge&&this.computeOverlapsInternal(e,ke,h,d,Ge,L),Ge<x&&this.computeOverlapsInternal(e,ke,h,Ge,x,L)),ke<i&&(d<Ge&&this.computeOverlapsInternal(ke,i,h,d,Ge,L),Ge<x&&this.computeOverlapsInternal(ke,i,h,Ge,x,L))},aa.prototype.interfaces_=function(){return[]},aa.prototype.getClass=function(){return aa};var za=function(){};za.prototype.interfaces_=function(){return[]},za.prototype.getClass=function(){return za},za.getChainStartIndices=function(e){var i=0,h=new or;h.add(new te(i));do{var d=za.findChainEnd(e,i);h.add(new te(d)),i=d}while(i<e.length-1);return za.toIntArray(h)},za.findChainEnd=function(e,i){for(var h=i;h<e.length-1&&e[h].equals2D(e[h+1]);)h++;if(h>=e.length-1)return e.length-1;for(var d=en.quadrant(e[h],e[h+1]),x=i+1;x<e.length&&(e[x-1].equals2D(e[x])||en.quadrant(e[x-1],e[x])===d);)x++;return x-1},za.getChains=function(){if(1===arguments.length)return za.getChains(arguments[0],null);if(2===arguments.length){for(var i=arguments[0],h=arguments[1],d=new or,x=za.getChainStartIndices(i),L=0;L<x.length-1;L++){var F=new aa(i,x[L],x[L+1],h);d.add(F)}return d}},za.toIntArray=function(e){for(var i=new Array(e.size()).fill(null),h=0;h<i.length;h++)i[h]=e.get(h).intValue();return i};var Mu=function(){};Mu.prototype.computeNodes=function(e){},Mu.prototype.getNodedSubstrings=function(){},Mu.prototype.interfaces_=function(){return[]},Mu.prototype.getClass=function(){return Mu};var Vi=function(){this._segInt=null,0!==arguments.length&&1===arguments.length&&this.setSegmentIntersector(arguments[0])};Vi.prototype.setSegmentIntersector=function(e){this._segInt=e},Vi.prototype.interfaces_=function(){return[Mu]},Vi.prototype.getClass=function(){return Vi};var Ms=function(e){function i(d){d?e.call(this,d):e.call(this),this._monoChains=new or,this._index=new Ol,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i;var h={SegmentOverlapAction:{configurable:!0}};return i.prototype.getMonotoneChains=function(){return this._monoChains},i.prototype.getNodedSubstrings=function(){return Fi.getNodedSubstrings(this._nodedSegStrings)},i.prototype.getIndex=function(){return this._index},i.prototype.add=function(d){for(var x=za.getChains(d.getCoordinates(),d).iterator();x.hasNext();){var L=x.next();L.setId(this._idCounter++),this._index.insert(L.getEnvelope(),L),this._monoChains.add(L)}},i.prototype.computeNodes=function(d){this._nodedSegStrings=d;for(var x=d.iterator();x.hasNext();)this.add(x.next());this.intersectChains()},i.prototype.intersectChains=function(){for(var d=new Hs(this._segInt),x=this._monoChains.iterator();x.hasNext();)for(var L=x.next(),F=this._index.query(L.getEnvelope()).iterator();F.hasNext();){var K=F.next();if(K.getId()>L.getId()&&(L.computeOverlaps(K,d),this._nOverlaps++),this._segInt.isDone())return null}},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},h.SegmentOverlapAction.get=function(){return Hs},Object.defineProperties(i,h),i}(Vi),Hs=function(e){function i(){e.call(this),this._si=null,this._si=arguments[0]}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.overlap=function(){if(4!==arguments.length)return e.prototype.overlap.apply(this,arguments);var d=arguments[1],x=arguments[2],L=arguments[3],F=arguments[0].getContext(),K=x.getContext();this._si.processIntersections(F,d,K,L)},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i}(Js),$n=function e(){if(this._quadrantSegments=e.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=e.CAP_ROUND,this._joinStyle=e.JOIN_ROUND,this._mitreLimit=e.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=e.DEFAULT_SIMPLIFY_FACTOR,0!==arguments.length)if(1===arguments.length)this.setQuadrantSegments(arguments[0]);else if(2===arguments.length){var d=arguments[1];this.setQuadrantSegments(arguments[0]),this.setEndCapStyle(d)}else if(4===arguments.length){var L=arguments[1],F=arguments[2],K=arguments[3];this.setQuadrantSegments(arguments[0]),this.setEndCapStyle(L),this.setJoinStyle(F),this.setMitreLimit(K)}},Ps={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};$n.prototype.getEndCapStyle=function(){return this._endCapStyle},$n.prototype.isSingleSided=function(){return this._isSingleSided},$n.prototype.setQuadrantSegments=function(e){this._quadrantSegments=e,0===this._quadrantSegments&&(this._joinStyle=$n.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=$n.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),e<=0&&(this._quadrantSegments=1),this._joinStyle!==$n.JOIN_ROUND&&(this._quadrantSegments=$n.DEFAULT_QUADRANT_SEGMENTS)},$n.prototype.getJoinStyle=function(){return this._joinStyle},$n.prototype.setJoinStyle=function(e){this._joinStyle=e},$n.prototype.setSimplifyFactor=function(e){this._simplifyFactor=e<0?0:e},$n.prototype.getSimplifyFactor=function(){return this._simplifyFactor},$n.prototype.getQuadrantSegments=function(){return this._quadrantSegments},$n.prototype.setEndCapStyle=function(e){this._endCapStyle=e},$n.prototype.getMitreLimit=function(){return this._mitreLimit},$n.prototype.setMitreLimit=function(e){this._mitreLimit=e},$n.prototype.setSingleSided=function(e){this._isSingleSided=e},$n.prototype.interfaces_=function(){return[]},$n.prototype.getClass=function(){return $n},$n.bufferDistanceError=function(e){var i=Math.PI/2/e;return 1-Math.cos(i/2)},Ps.CAP_ROUND.get=function(){return 1},Ps.CAP_FLAT.get=function(){return 2},Ps.CAP_SQUARE.get=function(){return 3},Ps.JOIN_ROUND.get=function(){return 1},Ps.JOIN_MITRE.get=function(){return 2},Ps.JOIN_BEVEL.get=function(){return 3},Ps.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8},Ps.DEFAULT_MITRE_LIMIT.get=function(){return 5},Ps.DEFAULT_SIMPLIFY_FACTOR.get=function(){return.01},Object.defineProperties($n,Ps);var zi=function(e){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=Xe.COUNTERCLOCKWISE,this._inputLine=e||null},el={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};zi.prototype.isDeletable=function(e,i,h,d){var x=this._inputLine[e],L=this._inputLine[i],F=this._inputLine[h];return!!this.isConcave(x,L,F)&&!!this.isShallow(x,L,F,d)&&this.isShallowSampled(x,L,e,h,d)},zi.prototype.deleteShallowConcavities=function(){for(var e=1,i=this.findNextNonDeletedIndex(e),h=this.findNextNonDeletedIndex(i),d=!1;h<this._inputLine.length;){var x=!1;this.isDeletable(e,i,h,this._distanceTol)&&(this._isDeleted[i]=zi.DELETE,x=!0,d=!0),i=this.findNextNonDeletedIndex(e=x?h:i),h=this.findNextNonDeletedIndex(i)}return d},zi.prototype.isShallowConcavity=function(e,i,h,d){return Xe.computeOrientation(e,i,h)===this._angleOrientation&&Xe.distancePointLine(i,e,h)<d},zi.prototype.isShallowSampled=function(e,i,h,d,x){var L=Math.trunc((d-h)/zi.NUM_PTS_TO_CHECK);L<=0&&(L=1);for(var F=h;F<d;F+=L)if(!this.isShallow(e,i,this._inputLine[F],x))return!1;return!0},zi.prototype.isConcave=function(e,i,h){return Xe.computeOrientation(e,i,h)===this._angleOrientation},zi.prototype.simplify=function(e){this._distanceTol=Math.abs(e),e<0&&(this._angleOrientation=Xe.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var i=!1;do{i=this.deleteShallowConcavities()}while(i);return this.collapseLine()},zi.prototype.findNextNonDeletedIndex=function(e){for(var i=e+1;i<this._inputLine.length&&this._isDeleted[i]===zi.DELETE;)i++;return i},zi.prototype.isShallow=function(e,i,h,d){return Xe.distancePointLine(i,e,h)<d},zi.prototype.collapseLine=function(){for(var e=new Y,i=0;i<this._inputLine.length;i++)this._isDeleted[i]!==zi.DELETE&&e.add(this._inputLine[i]);return e.toCoordinateArray()},zi.prototype.interfaces_=function(){return[]},zi.prototype.getClass=function(){return zi},zi.simplify=function(e,i){return new zi(e).simplify(i)},el.INIT.get=function(){return 0},el.DELETE.get=function(){return 1},el.KEEP.get=function(){return 1},el.NUM_PTS_TO_CHECK.get=function(){return 10},Object.defineProperties(zi,el);var $a=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new or},cs={COORDINATE_ARRAY_TYPE:{configurable:!0}};$a.prototype.getCoordinates=function(){return this._ptList.toArray($a.COORDINATE_ARRAY_TYPE)},$a.prototype.setPrecisionModel=function(e){this._precisionModel=e},$a.prototype.addPt=function(e){var i=new j(e);if(this._precisionModel.makePrecise(i),this.isRedundant(i))return null;this._ptList.add(i)},$a.prototype.revere=function(){},$a.prototype.addPts=function(e,i){if(i)for(var h=0;h<e.length;h++)this.addPt(e[h]);else for(var d=e.length-1;d>=0;d--)this.addPt(e[d])},$a.prototype.isRedundant=function(e){if(this._ptList.size()<1)return!1;var i=this._ptList.get(this._ptList.size()-1);return e.distance(i)<this._minimimVertexDistance},$a.prototype.toString=function(){return(new xn).createLineString(this.getCoordinates()).toString()},$a.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var e=new j(this._ptList.get(0)),i=this._ptList.get(this._ptList.size()-1);if(e.equals(i))return null;this._ptList.add(e)},$a.prototype.setMinimumVertexDistance=function(e){this._minimimVertexDistance=e},$a.prototype.interfaces_=function(){return[]},$a.prototype.getClass=function(){return $a},cs.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)},Object.defineProperties($a,cs);var Nn=function(){},Ws={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};Nn.prototype.interfaces_=function(){return[]},Nn.prototype.getClass=function(){return Nn},Nn.toDegrees=function(e){return 180*e/Math.PI},Nn.normalize=function(e){for(;e>Math.PI;)e-=Nn.PI_TIMES_2;for(;e<=-Math.PI;)e+=Nn.PI_TIMES_2;return e},Nn.angle=function(){if(1===arguments.length){var e=arguments[0];return Math.atan2(e.y,e.x)}if(2===arguments.length){var i=arguments[0],h=arguments[1];return Math.atan2(h.y-i.y,h.x-i.x)}},Nn.isAcute=function(e,i,h){return(e.x-i.x)*(h.x-i.x)+(e.y-i.y)*(h.y-i.y)>0},Nn.isObtuse=function(e,i,h){return(e.x-i.x)*(h.x-i.x)+(e.y-i.y)*(h.y-i.y)<0},Nn.interiorAngle=function(e,i,h){var d=Nn.angle(i,e),x=Nn.angle(i,h);return Math.abs(x-d)},Nn.normalizePositive=function(e){if(e<0){for(;e<0;)e+=Nn.PI_TIMES_2;e>=Nn.PI_TIMES_2&&(e=0)}else{for(;e>=Nn.PI_TIMES_2;)e-=Nn.PI_TIMES_2;e<0&&(e=0)}return e},Nn.angleBetween=function(e,i,h){var d=Nn.angle(i,e),x=Nn.angle(i,h);return Nn.diff(d,x)},Nn.diff=function(e,i){var h=null;return(h=e<i?i-e:e-i)>Math.PI&&(h=2*Math.PI-h),h},Nn.toRadians=function(e){return e*Math.PI/180},Nn.getTurn=function(e,i){var h=Math.sin(i-e);return h>0?Nn.COUNTERCLOCKWISE:h<0?Nn.CLOCKWISE:Nn.NONE},Nn.angleBetweenOriented=function(e,i,h){var d=Nn.angle(i,e),x=Nn.angle(i,h)-d;return x<=-Math.PI?x+Nn.PI_TIMES_2:x>Math.PI?x-Nn.PI_TIMES_2:x},Ws.PI_TIMES_2.get=function(){return 2*Math.PI},Ws.PI_OVER_2.get=function(){return Math.PI/2},Ws.PI_OVER_4.get=function(){return Math.PI/4},Ws.COUNTERCLOCKWISE.get=function(){return Xe.COUNTERCLOCKWISE},Ws.CLOCKWISE.get=function(){return Xe.CLOCKWISE},Ws.NONE.get=function(){return Xe.COLLINEAR},Object.defineProperties(Nn,Ws);var Eo=function e(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new Jr,this._seg1=new Jr,this._offset0=new Jr,this._offset1=new Jr,this._side=0,this._hasNarrowConcaveAngle=!1;var h=arguments[1],d=arguments[2];this._precisionModel=arguments[0],this._bufParams=h,this._li=new De,this._filletAngleQuantum=Math.PI/2/h.getQuadrantSegments(),h.getQuadrantSegments()>=8&&h.getJoinStyle()===$n.JOIN_ROUND&&(this._closingSegLengthFactor=e.MAX_CLOSING_SEG_LEN_FACTOR),this.init(d)},pl={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};Eo.prototype.addNextSegment=function(e,i){if(this._s0=this._s1,this._s1=this._s2,this._s2=e,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var h=Xe.computeOrientation(this._s0,this._s1,this._s2),d=h===Xe.CLOCKWISE&&this._side===Bt.LEFT||h===Xe.COUNTERCLOCKWISE&&this._side===Bt.RIGHT;0===h?this.addCollinear(i):d?this.addOutsideTurn(h,i):this.addInsideTurn(h,i)},Eo.prototype.addLineEndCap=function(e,i){var h=new Jr(e,i),d=new Jr;this.computeOffsetSegment(h,Bt.LEFT,this._distance,d);var x=new Jr;this.computeOffsetSegment(h,Bt.RIGHT,this._distance,x);var K=Math.atan2(i.y-e.y,i.x-e.x);switch(this._bufParams.getEndCapStyle()){case $n.CAP_ROUND:this._segList.addPt(d.p1),this.addFilletArc(i,K+Math.PI/2,K-Math.PI/2,Xe.CLOCKWISE,this._distance),this._segList.addPt(x.p1);break;case $n.CAP_FLAT:this._segList.addPt(d.p1),this._segList.addPt(x.p1);break;case $n.CAP_SQUARE:var Mt=new j;Mt.x=Math.abs(this._distance)*Math.cos(K),Mt.y=Math.abs(this._distance)*Math.sin(K);var Qt=new j(d.p1.x+Mt.x,d.p1.y+Mt.y),ke=new j(x.p1.x+Mt.x,x.p1.y+Mt.y);this._segList.addPt(Qt),this._segList.addPt(ke)}},Eo.prototype.getCoordinates=function(){return this._segList.getCoordinates()},Eo.prototype.addMitreJoin=function(e,i,h,d){var x=!0,L=null;try{L=Sr.intersection(i.p0,i.p1,h.p0,h.p1),(d<=0?1:L.distance(e)/Math.abs(d))>this._bufParams.getMitreLimit()&&(x=!1)}catch(F){if(!(F instanceof kr))throw F;L=new j(0,0),x=!1}x?this._segList.addPt(L):this.addLimitedMitreJoin(i,h,d,this._bufParams.getMitreLimit())},Eo.prototype.addFilletCorner=function(e,i,h,d,x){var K=Math.atan2(i.y-e.y,i.x-e.x),ke=Math.atan2(h.y-e.y,h.x-e.x);d===Xe.CLOCKWISE?K<=ke&&(K+=2*Math.PI):K>=ke&&(K-=2*Math.PI),this._segList.addPt(i),this.addFilletArc(e,K,ke,d,x),this._segList.addPt(h)},Eo.prototype.addOutsideTurn=function(e,i){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*Eo.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===$n.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===$n.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(i&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,e,this._distance),this._segList.addPt(this._offset1.p0))},Eo.prototype.createSquare=function(e){this._segList.addPt(new j(e.x+this._distance,e.y+this._distance)),this._segList.addPt(new j(e.x+this._distance,e.y-this._distance)),this._segList.addPt(new j(e.x-this._distance,e.y-this._distance)),this._segList.addPt(new j(e.x-this._distance,e.y+this._distance)),this._segList.closeRing()},Eo.prototype.addSegments=function(e,i){this._segList.addPts(e,i)},Eo.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)},Eo.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)},Eo.prototype.initSideSegments=function(e,i,h){this._s1=e,this._s2=i,this._side=h,this._seg1.setCoordinates(e,i),this.computeOffsetSegment(this._seg1,h,this._distance,this._offset1)},Eo.prototype.addLimitedMitreJoin=function(e,i,h,d){var x=this._seg0.p1,L=Nn.angle(x,this._seg0.p0),F=Nn.angleBetweenOriented(this._seg0.p0,x,this._seg1.p1)/2,K=Nn.normalize(L+F),Mt=Nn.normalize(K+Math.PI),Qt=d*h,ke=h-Qt*Math.abs(Math.sin(F)),Ge=x.x+Qt*Math.cos(Mt),gr=x.y+Qt*Math.sin(Mt),Ir=new j(Ge,gr),jr=new Jr(x,Ir),ln=jr.pointAlongOffset(1,ke),Mi=jr.pointAlongOffset(1,-ke);this._side===Bt.LEFT?(this._segList.addPt(ln),this._segList.addPt(Mi)):(this._segList.addPt(Mi),this._segList.addPt(ln))},Eo.prototype.computeOffsetSegment=function(e,i,h,d){var x=i===Bt.LEFT?1:-1,L=e.p1.x-e.p0.x,F=e.p1.y-e.p0.y,K=Math.sqrt(L*L+F*F),Mt=x*h*L/K,Qt=x*h*F/K;d.p0.x=e.p0.x-Qt,d.p0.y=e.p0.y+Mt,d.p1.x=e.p1.x-Qt,d.p1.y=e.p1.y+Mt},Eo.prototype.addFilletArc=function(e,i,h,d,x){var L=d===Xe.CLOCKWISE?-1:1,F=Math.abs(i-h),K=Math.trunc(F/this._filletAngleQuantum+.5);if(K<1)return null;for(var Mt=F/K,Qt=0,ke=new j;Qt<F;){var Ge=i+L*Qt;ke.x=e.x+x*Math.cos(Ge),ke.y=e.y+x*Math.sin(Ge),this._segList.addPt(ke),Qt+=Mt}},Eo.prototype.addInsideTurn=function(e,i){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*Eo.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var h=new j((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(h);var d=new j((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(d)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}},Eo.prototype.createCircle=function(e){var i=new j(e.x+this._distance,e.y);this._segList.addPt(i),this.addFilletArc(e,0,2*Math.PI,-1,this._distance),this._segList.closeRing()},Eo.prototype.addBevelJoin=function(e,i){this._segList.addPt(e.p1),this._segList.addPt(i.p0)},Eo.prototype.init=function(e){this._distance=e,this._maxCurveSegmentError=e*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new $a,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(e*Eo.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},Eo.prototype.addCollinear=function(e){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===$n.JOIN_BEVEL||this._bufParams.getJoinStyle()===$n.JOIN_MITRE?(e&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,Xe.CLOCKWISE,this._distance))},Eo.prototype.closeRing=function(){this._segList.closeRing()},Eo.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle},Eo.prototype.interfaces_=function(){return[]},Eo.prototype.getClass=function(){return Eo},pl.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return.001},pl.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return.001},pl.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6},pl.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80},Object.defineProperties(Eo,pl);var ga=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var i=arguments[1];this._precisionModel=arguments[0],this._bufParams=i};ga.prototype.getOffsetCurve=function(e,i){if(this._distance=i,0===i)return null;var h=i<0,d=Math.abs(i),x=this.getSegGen(d);e.length<=1?this.computePointCurve(e[0],x):this.computeOffsetCurve(e,h,x);var L=x.getCoordinates();return h&&W.reverse(L),L},ga.prototype.computeSingleSidedBufferCurve=function(e,i,h){var d=this.simplifyTolerance(this._distance);if(i){h.addSegments(e,!0);var x=zi.simplify(e,-d),L=x.length-1;h.initSideSegments(x[L],x[L-1],Bt.LEFT),h.addFirstSegment();for(var F=L-2;F>=0;F--)h.addNextSegment(x[F],!0)}else{h.addSegments(e,!1);var K=zi.simplify(e,d),Mt=K.length-1;h.initSideSegments(K[0],K[1],Bt.LEFT),h.addFirstSegment();for(var Qt=2;Qt<=Mt;Qt++)h.addNextSegment(K[Qt],!0)}h.addLastSegment(),h.closeRing()},ga.prototype.computeRingBufferCurve=function(e,i,h){var d=this.simplifyTolerance(this._distance);i===Bt.RIGHT&&(d=-d);var x=zi.simplify(e,d),L=x.length-1;h.initSideSegments(x[L-1],x[0],i);for(var F=1;F<=L;F++)h.addNextSegment(x[F],1!==F);h.closeRing()},ga.prototype.computeLineBufferCurve=function(e,i){var h=this.simplifyTolerance(this._distance),d=zi.simplify(e,h),x=d.length-1;i.initSideSegments(d[0],d[1],Bt.LEFT);for(var L=2;L<=x;L++)i.addNextSegment(d[L],!0);i.addLastSegment(),i.addLineEndCap(d[x-1],d[x]);var F=zi.simplify(e,-h),K=F.length-1;i.initSideSegments(F[K],F[K-1],Bt.LEFT);for(var Mt=K-2;Mt>=0;Mt--)i.addNextSegment(F[Mt],!0);i.addLastSegment(),i.addLineEndCap(F[1],F[0]),i.closeRing()},ga.prototype.computePointCurve=function(e,i){switch(this._bufParams.getEndCapStyle()){case $n.CAP_ROUND:i.createCircle(e);break;case $n.CAP_SQUARE:i.createSquare(e)}},ga.prototype.getLineCurve=function(e,i){if(this._distance=i,i<0&&!this._bufParams.isSingleSided()||0===i)return null;var h=Math.abs(i),d=this.getSegGen(h);return e.length<=1?this.computePointCurve(e[0],d):this._bufParams.isSingleSided()?this.computeSingleSidedBufferCurve(e,i<0,d):this.computeLineBufferCurve(e,d),d.getCoordinates()},ga.prototype.getBufferParameters=function(){return this._bufParams},ga.prototype.simplifyTolerance=function(e){return e*this._bufParams.getSimplifyFactor()},ga.prototype.getRingCurve=function(e,i,h){if(this._distance=h,e.length<=2)return this.getLineCurve(e,h);if(0===h)return ga.copyCoordinates(e);var d=this.getSegGen(h);return this.computeRingBufferCurve(e,i,d),d.getCoordinates()},ga.prototype.computeOffsetCurve=function(e,i,h){var d=this.simplifyTolerance(this._distance);if(i){var x=zi.simplify(e,-d),L=x.length-1;h.initSideSegments(x[L],x[L-1],Bt.LEFT),h.addFirstSegment();for(var F=L-2;F>=0;F--)h.addNextSegment(x[F],!0)}else{var K=zi.simplify(e,d),Mt=K.length-1;h.initSideSegments(K[0],K[1],Bt.LEFT),h.addFirstSegment();for(var Qt=2;Qt<=Mt;Qt++)h.addNextSegment(K[Qt],!0)}h.addLastSegment()},ga.prototype.getSegGen=function(e){return new Eo(this._precisionModel,this._bufParams,e)},ga.prototype.interfaces_=function(){return[]},ga.prototype.getClass=function(){return ga},ga.copyCoordinates=function(e){for(var i=new Array(e.length).fill(null),h=0;h<i.length;h++)i[h]=new j(e[h]);return i};var bs=function(){this._subgraphs=null,this._seg=new Jr,this._cga=new Xe,this._subgraphs=arguments[0]},_u={DepthSegment:{configurable:!0}};bs.prototype.findStabbedSegments=function(){if(1===arguments.length){for(var e=arguments[0],i=new or,h=this._subgraphs.iterator();h.hasNext();){var d=h.next(),x=d.getEnvelope();e.y<x.getMinY()||e.y>x.getMaxY()||this.findStabbedSegments(e,d.getDirectedEdges(),i)}return i}if(3===arguments.length)if(Ie(arguments[2],On)&&arguments[0]instanceof j&&arguments[1]instanceof Qo){for(var L=arguments[0],F=arguments[1],K=arguments[2],Mt=F.getEdge().getCoordinates(),Qt=0;Qt<Mt.length-1;Qt++)if(this._seg.p0=Mt[Qt],this._seg.p1=Mt[Qt+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<L.x||this._seg.isHorizontal()||L.y<this._seg.p0.y||L.y>this._seg.p1.y||Xe.computeOrientation(this._seg.p0,this._seg.p1,L)===Xe.RIGHT)){var ke=F.getDepth(Bt.LEFT);this._seg.p0.equals(Mt[Qt])||(ke=F.getDepth(Bt.RIGHT));var Ge=new Ba(this._seg,ke);K.add(Ge)}}else if(Ie(arguments[2],On)&&arguments[0]instanceof j&&Ie(arguments[1],On))for(var gr=arguments[0],jr=arguments[2],ln=arguments[1].iterator();ln.hasNext();){var Mi=ln.next();Mi.isForward()&&this.findStabbedSegments(gr,Mi,jr)}},bs.prototype.getDepth=function(e){var i=this.findStabbedSegments(e);return 0===i.size()?0:Vn.min(i)._leftDepth},bs.prototype.interfaces_=function(){return[]},bs.prototype.getClass=function(){return bs},_u.DepthSegment.get=function(){return Ba},Object.defineProperties(bs,_u);var Ba=function(){this._upwardSeg=null,this._leftDepth=null;var i=arguments[1];this._upwardSeg=new Jr(arguments[0]),this._leftDepth=i};Ba.prototype.compareTo=function(e){var i=e;if(this._upwardSeg.minX()>=i._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=i._upwardSeg.minX())return-1;var h=this._upwardSeg.orientationIndex(i._upwardSeg);return 0!==h||0!=(h=-1*i._upwardSeg.orientationIndex(this._upwardSeg))?h:this._upwardSeg.compareTo(i._upwardSeg)},Ba.prototype.compareX=function(e,i){var h=e.p0.compareTo(i.p0);return 0!==h?h:e.p1.compareTo(i.p1)},Ba.prototype.toString=function(){return this._upwardSeg.toString()},Ba.prototype.interfaces_=function(){return[H]},Ba.prototype.getClass=function(){return Ba};var hi=function(e,i,h){this.p0=e||null,this.p1=i||null,this.p2=h||null};hi.prototype.area=function(){return hi.area(this.p0,this.p1,this.p2)},hi.prototype.signedArea=function(){return hi.signedArea(this.p0,this.p1,this.p2)},hi.prototype.interpolateZ=function(e){if(null===e)throw new tt("Supplied point is null.");return hi.interpolateZ(e,this.p0,this.p1,this.p2)},hi.prototype.longestSideLength=function(){return hi.longestSideLength(this.p0,this.p1,this.p2)},hi.prototype.isAcute=function(){return hi.isAcute(this.p0,this.p1,this.p2)},hi.prototype.circumcentre=function(){return hi.circumcentre(this.p0,this.p1,this.p2)},hi.prototype.area3D=function(){return hi.area3D(this.p0,this.p1,this.p2)},hi.prototype.centroid=function(){return hi.centroid(this.p0,this.p1,this.p2)},hi.prototype.inCentre=function(){return hi.inCentre(this.p0,this.p1,this.p2)},hi.prototype.interfaces_=function(){return[]},hi.prototype.getClass=function(){return hi},hi.area=function(e,i,h){return Math.abs(((h.x-e.x)*(i.y-e.y)-(i.x-e.x)*(h.y-e.y))/2)},hi.signedArea=function(e,i,h){return((h.x-e.x)*(i.y-e.y)-(i.x-e.x)*(h.y-e.y))/2},hi.det=function(e,i,h,d){return e*d-i*h},hi.interpolateZ=function(e,i,h,d){var x=i.x,L=i.y,F=h.x-x,K=d.x-x,Mt=h.y-L,Qt=d.y-L,ke=F*Qt-K*Mt,Ge=e.x-x,gr=e.y-L;return i.z+(Qt*Ge-K*gr)/ke*(h.z-i.z)+(-Mt*Ge+F*gr)/ke*(d.z-i.z)},hi.longestSideLength=function(e,i,h){var d=e.distance(i),x=i.distance(h),L=h.distance(e),F=d;return x>F&&(F=x),L>F&&(F=L),F},hi.isAcute=function(e,i,h){return!!Nn.isAcute(e,i,h)&&!!Nn.isAcute(i,h,e)&&!!Nn.isAcute(h,e,i)},hi.circumcentre=function(e,i,h){var d=h.x,x=h.y,L=e.x-d,F=e.y-x,K=i.x-d,Mt=i.y-x,Qt=2*hi.det(L,F,K,Mt),ke=hi.det(F,L*L+F*F,Mt,K*K+Mt*Mt),Ge=hi.det(L,L*L+F*F,K,K*K+Mt*Mt);return new j(d-ke/Qt,x+Ge/Qt)},hi.perpendicularBisector=function(e,i){var h=i.x-e.x,d=i.y-e.y,x=new Sr(e.x+h/2,e.y+d/2,1),L=new Sr(e.x-d+h/2,e.y+h+d/2,1);return new Sr(x,L)},hi.angleBisector=function(e,i,h){var d=i.distance(e),x=d/(d+i.distance(h));return new j(e.x+x*(h.x-e.x),e.y+x*(h.y-e.y))},hi.area3D=function(e,i,h){var d=i.x-e.x,x=i.y-e.y,L=i.z-e.z,F=h.x-e.x,K=h.y-e.y,Mt=h.z-e.z,Qt=x*Mt-L*K,ke=L*F-d*Mt,Ge=d*K-x*F;return Math.sqrt(Qt*Qt+ke*ke+Ge*Ge)/2},hi.centroid=function(e,i,h){return new j((e.x+i.x+h.x)/3,(e.y+i.y+h.y)/3)},hi.inCentre=function(e,i,h){var d=i.distance(h),x=e.distance(h),L=e.distance(i),F=d+x+L;return new j((d*e.x+x*i.x+L*h.x)/F,(d*e.y+x*i.y+L*h.y)/F)};var ta=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new or;var i=arguments[1],h=arguments[2];this._inputGeom=arguments[0],this._distance=i,this._curveBuilder=h};ta.prototype.addPoint=function(e){if(this._distance<=0)return null;var i=e.getCoordinates(),h=this._curveBuilder.getLineCurve(i,this._distance);this.addCurve(h,gt.EXTERIOR,gt.INTERIOR)},ta.prototype.addPolygon=function(e){var i=this._distance,h=Bt.LEFT;this._distance<0&&(i=-this._distance,h=Bt.RIGHT);var d=e.getExteriorRing(),x=W.removeRepeatedPoints(d.getCoordinates());if(this._distance<0&&this.isErodedCompletely(d,this._distance)||this._distance<=0&&x.length<3)return null;this.addPolygonRing(x,i,h,gt.EXTERIOR,gt.INTERIOR);for(var L=0;L<e.getNumInteriorRing();L++){var F=e.getInteriorRingN(L),K=W.removeRepeatedPoints(F.getCoordinates());this._distance>0&&this.isErodedCompletely(F,-this._distance)||this.addPolygonRing(K,i,Bt.opposite(h),gt.INTERIOR,gt.EXTERIOR)}},ta.prototype.isTriangleErodedCompletely=function(e,i){var h=new hi(e[0],e[1],e[2]),d=h.inCentre();return Xe.distancePointLine(d,h.p0,h.p1)<Math.abs(i)},ta.prototype.addLineString=function(e){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var i=W.removeRepeatedPoints(e.getCoordinates()),h=this._curveBuilder.getLineCurve(i,this._distance);this.addCurve(h,gt.EXTERIOR,gt.INTERIOR)},ta.prototype.addCurve=function(e,i,h){if(null===e||e.length<2)return null;var d=new Fi(e,new hr(0,gt.BOUNDARY,i,h));this._curveList.add(d)},ta.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList},ta.prototype.addPolygonRing=function(e,i,h,d,x){if(0===i&&e.length<li.MINIMUM_VALID_SIZE)return null;var L=d,F=x;e.length>=li.MINIMUM_VALID_SIZE&&Xe.isCCW(e)&&(L=x,F=d,h=Bt.opposite(h));var K=this._curveBuilder.getRingCurve(e,h,i);this.addCurve(K,L,F)},ta.prototype.add=function(e){if(e.isEmpty())return null;e instanceof En?this.addPolygon(e):e instanceof Nr?this.addLineString(e):e instanceof ri?this.addPoint(e):(e instanceof ho||e instanceof yr||e instanceof Gr||e instanceof He)&&this.addCollection(e)},ta.prototype.isErodedCompletely=function(e,i){var h=e.getCoordinates();if(h.length<4)return i<0;if(4===h.length)return this.isTriangleErodedCompletely(h,i);var d=e.getEnvelopeInternal(),x=Math.min(d.getHeight(),d.getWidth());return i<0&&2*Math.abs(i)>x},ta.prototype.addCollection=function(e){for(var i=0;i<e.getNumGeometries();i++){var h=e.getGeometryN(i);this.add(h)}},ta.prototype.interfaces_=function(){return[]},ta.prototype.getClass=function(){return ta};var Bu=function(){};Bu.prototype.locate=function(e){},Bu.prototype.interfaces_=function(){return[]},Bu.prototype.getClass=function(){return Bu};var jn=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var e=arguments[0];this._parent=e,this._atStart=!0,this._index=0,this._max=e.getNumGeometries()};jn.prototype.next=function(){if(this._atStart)return this._atStart=!1,jn.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new s;var e=this._parent.getGeometryN(this._index++);return e instanceof He?(this._subcollectionIterator=new jn(e),this._subcollectionIterator.next()):e},jn.prototype.remove=function(){throw new Error(this.getClass().getName())},jn.prototype.hasNext=function(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)},jn.prototype.interfaces_=function(){return[vo]},jn.prototype.getClass=function(){return jn},jn.isAtomic=function(e){return!(e instanceof He)};var Ua=function(){this._geom=null,this._geom=arguments[0]};Ua.prototype.locate=function(e){return Ua.locate(e,this._geom)},Ua.prototype.interfaces_=function(){return[Bu]},Ua.prototype.getClass=function(){return Ua},Ua.isPointInRing=function(e,i){return!!i.getEnvelopeInternal().intersects(e)&&Xe.isPointInRing(e,i.getCoordinates())},Ua.containsPointInPolygon=function(e,i){if(i.isEmpty())return!1;var h=i.getExteriorRing();if(!Ua.isPointInRing(e,h))return!1;for(var d=0;d<i.getNumInteriorRing();d++){var x=i.getInteriorRingN(d);if(Ua.isPointInRing(e,x))return!1}return!0},Ua.containsPoint=function(e,i){if(i instanceof En)return Ua.containsPointInPolygon(e,i);if(i instanceof He)for(var h=new jn(i);h.hasNext();){var d=h.next();if(d!==i&&Ua.containsPoint(e,d))return!0}return!1},Ua.locate=function(e,i){return i.isEmpty()?gt.EXTERIOR:Ua.containsPoint(e,i)?gt.INTERIOR:gt.EXTERIOR};var Da=function(){this._edgeMap=new yt,this._edgeList=null,this._ptInAreaLocation=[gt.NONE,gt.NONE]};Da.prototype.getNextCW=function(e){this.getEdges();var i=this._edgeList.indexOf(e),h=i-1;return 0===i&&(h=this._edgeList.size()-1),this._edgeList.get(h)},Da.prototype.propagateSideLabels=function(e){for(var i=gt.NONE,h=this.iterator();h.hasNext();){var d=h.next().getLabel();d.isArea(e)&&d.getLocation(e,Bt.LEFT)!==gt.NONE&&(i=d.getLocation(e,Bt.LEFT))}if(i===gt.NONE)return null;for(var x=i,L=this.iterator();L.hasNext();){var F=L.next(),K=F.getLabel();if(K.getLocation(e,Bt.ON)===gt.NONE&&K.setLocation(e,Bt.ON,x),K.isArea(e)){var Mt=K.getLocation(e,Bt.LEFT),Qt=K.getLocation(e,Bt.RIGHT);if(Qt!==gt.NONE){if(Qt!==x)throw new ur("side location conflict",F.getCoordinate());Mt===gt.NONE&&ot.shouldNeverReachHere("found single null side (at "+F.getCoordinate()+")"),x=Mt}else ot.isTrue(K.getLocation(e,Bt.LEFT)===gt.NONE,"found single null side"),K.setLocation(e,Bt.RIGHT,x),K.setLocation(e,Bt.LEFT,x)}}},Da.prototype.getCoordinate=function(){var e=this.iterator();return e.hasNext()?e.next().getCoordinate():null},Da.prototype.print=function(e){Xr.out.println("EdgeEndStar:   "+this.getCoordinate());for(var i=this.iterator();i.hasNext();)i.next().print(e)},Da.prototype.isAreaLabelsConsistent=function(e){return this.computeEdgeEndLabels(e.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},Da.prototype.checkAreaLabelsConsistent=function(e){var i=this.getEdges();if(i.size()<=0)return!0;var h=i.size()-1,d=i.get(h).getLabel().getLocation(e,Bt.LEFT);ot.isTrue(d!==gt.NONE,"Found unlabelled area edge");for(var x=d,L=this.iterator();L.hasNext();){var F=L.next().getLabel();ot.isTrue(F.isArea(e),"Found non-area edge");var K=F.getLocation(e,Bt.LEFT),Mt=F.getLocation(e,Bt.RIGHT);if(K===Mt||Mt!==x)return!1;x=K}return!0},Da.prototype.findIndex=function(e){this.iterator();for(var i=0;i<this._edgeList.size();i++)if(this._edgeList.get(i)===e)return i;return-1},Da.prototype.iterator=function(){return this.getEdges().iterator()},Da.prototype.getEdges=function(){return null===this._edgeList&&(this._edgeList=new or(this._edgeMap.values())),this._edgeList},Da.prototype.getLocation=function(e,i,h){return this._ptInAreaLocation[e]===gt.NONE&&(this._ptInAreaLocation[e]=Ua.locate(i,h[e].getGeometry())),this._ptInAreaLocation[e]},Da.prototype.toString=function(){var e=new Pt;e.append("EdgeEndStar:   "+this.getCoordinate()),e.append("\n");for(var i=this.iterator();i.hasNext();){var h=i.next();e.append(h),e.append("\n")}return e.toString()},Da.prototype.computeEdgeEndLabels=function(e){for(var i=this.iterator();i.hasNext();)i.next().computeLabel(e)},Da.prototype.computeLabelling=function(e){this.computeEdgeEndLabels(e[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var i=[!1,!1],h=this.iterator();h.hasNext();)for(var d=h.next().getLabel(),x=0;x<2;x++)d.isLine(x)&&d.getLocation(x)===gt.BOUNDARY&&(i[x]=!0);for(var L=this.iterator();L.hasNext();)for(var F=L.next(),K=F.getLabel(),Mt=0;Mt<2;Mt++)if(K.isAnyNull(Mt)){var Qt=gt.NONE;if(i[Mt])Qt=gt.EXTERIOR;else{var ke=F.getCoordinate();Qt=this.getLocation(Mt,ke,e)}K.setAllLocationsIfNull(Mt,Qt)}},Da.prototype.getDegree=function(){return this._edgeMap.size()},Da.prototype.insertEdgeEnd=function(e,i){this._edgeMap.put(e,i),this._edgeList=null},Da.prototype.interfaces_=function(){return[]},Da.prototype.getClass=function(){return Da};var Uu=function(e){function i(){e.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();for(var h=null,d=null,x=this._SCANNING_FOR_INCOMING,L=0;L<this._resultAreaEdgeList.size();L++){var F=this._resultAreaEdgeList.get(L),K=F.getSym();if(F.getLabel().isArea())switch(null===h&&F.isInResult()&&(h=F),x){case this._SCANNING_FOR_INCOMING:if(!K.isInResult())continue;d=K,x=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!F.isInResult())continue;d.setNext(F),x=this._SCANNING_FOR_INCOMING}}if(x===this._LINKING_TO_OUTGOING){if(null===h)throw new ur("no outgoing dirEdge found",this.getCoordinate());ot.isTrue(h.isInResult(),"unable to link last incoming dirEdge"),d.setNext(h)}},i.prototype.insert=function(h){this.insertEdgeEnd(h,h)},i.prototype.getRightmostEdge=function(){var h=this.getEdges(),d=h.size();if(d<1)return null;var x=h.get(0);if(1===d)return x;var L=h.get(d-1),F=x.getQuadrant(),K=L.getQuadrant();return en.isNorthern(F)&&en.isNorthern(K)?x:en.isNorthern(F)||en.isNorthern(K)?0!==x.getDy()?x:0!==L.getDy()?L:(ot.shouldNeverReachHere("found two horizontal edges incident on node"),null):L},i.prototype.print=function(h){Xr.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var d=this.iterator();d.hasNext();){var x=d.next();h.print("out "),x.print(h),h.println(),h.print("in "),x.getSym().print(h),h.println()}},i.prototype.getResultAreaEdges=function(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new or;for(var h=this.iterator();h.hasNext();){var d=h.next();(d.isInResult()||d.getSym().isInResult())&&this._resultAreaEdgeList.add(d)}return this._resultAreaEdgeList},i.prototype.updateLabelling=function(h){for(var d=this.iterator();d.hasNext();){var x=d.next().getLabel();x.setAllLocationsIfNull(0,h.getLocation(0)),x.setAllLocationsIfNull(1,h.getLocation(1))}},i.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var h=null,d=null,x=this._edgeList.size()-1;x>=0;x--){var L=this._edgeList.get(x),F=L.getSym();null===d&&(d=F),null!==h&&F.setNext(h),h=L}d.setNext(h)},i.prototype.computeDepths=function(){if(1===arguments.length){var h=arguments[0],d=this.findIndex(h),x=h.getDepth(Bt.LEFT),L=h.getDepth(Bt.RIGHT),F=this.computeDepths(d+1,this._edgeList.size(),x);if(this.computeDepths(0,d,F)!==L)throw new ur("depth mismatch at "+h.getCoordinate())}else if(3===arguments.length){for(var Mt=arguments[1],Qt=arguments[2],ke=arguments[0];ke<Mt;ke++){var Ge=this._edgeList.get(ke);Ge.setEdgeDepths(Bt.RIGHT,Qt),Qt=Ge.getDepth(Bt.LEFT)}return Qt}},i.prototype.mergeSymLabels=function(){for(var h=this.iterator();h.hasNext();){var d=h.next();d.getLabel().merge(d.getSym().getLabel())}},i.prototype.linkMinimalDirectedEdges=function(h){for(var d=null,x=null,L=this._SCANNING_FOR_INCOMING,F=this._resultAreaEdgeList.size()-1;F>=0;F--){var K=this._resultAreaEdgeList.get(F),Mt=K.getSym();switch(null===d&&K.getEdgeRing()===h&&(d=K),L){case this._SCANNING_FOR_INCOMING:if(Mt.getEdgeRing()!==h)continue;x=Mt,L=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(K.getEdgeRing()!==h)continue;x.setNextMin(K),L=this._SCANNING_FOR_INCOMING}}L===this._LINKING_TO_OUTGOING&&(ot.isTrue(null!==d,"found null for first outgoing dirEdge"),ot.isTrue(d.getEdgeRing()===h,"unable to link last incoming dirEdge"),x.setNextMin(d))},i.prototype.getOutgoingDegree=function(){if(0===arguments.length){for(var h=0,d=this.iterator();d.hasNext();)d.next().isInResult()&&h++;return h}if(1===arguments.length){for(var x=arguments[0],L=0,F=this.iterator();F.hasNext();)F.next().getEdgeRing()===x&&L++;return L}},i.prototype.getLabel=function(){return this._label},i.prototype.findCoveredLineEdges=function(){for(var h=gt.NONE,d=this.iterator();d.hasNext();){var x=d.next(),L=x.getSym();if(!x.isLineEdge()){if(x.isInResult()){h=gt.INTERIOR;break}if(L.isInResult()){h=gt.EXTERIOR;break}}}if(h===gt.NONE)return null;for(var F=h,K=this.iterator();K.hasNext();){var Mt=K.next(),Qt=Mt.getSym();Mt.isLineEdge()?Mt.getEdge().setCovered(F===gt.INTERIOR):(Mt.isInResult()&&(F=gt.EXTERIOR),Qt.isInResult()&&(F=gt.INTERIOR))}},i.prototype.computeLabelling=function(h){e.prototype.computeLabelling.call(this,h),this._label=new hr(gt.NONE);for(var d=this.iterator();d.hasNext();)for(var x=d.next().getEdge().getLabel(),L=0;L<2;L++){var F=x.getLocation(L);F!==gt.INTERIOR&&F!==gt.BOUNDARY||this._label.setLocation(L,gt.INTERIOR)}},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i}(Da),kl=function(e){function i(){e.apply(this,arguments)}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.createNode=function(h){return new Vr(h,new Uu)},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i}(ls),xu=function e(){this._pts=null,this._orientation=null;var i=arguments[0];this._pts=i,this._orientation=e.orientation(i)};xu.prototype.compareTo=function(e){return xu.compareOriented(this._pts,this._orientation,e._pts,e._orientation)},xu.prototype.interfaces_=function(){return[H]},xu.prototype.getClass=function(){return xu},xu.orientation=function(e){return 1===W.increasingDirection(e)},xu.compareOriented=function(e,i,h,d){for(var x=i?1:-1,L=d?1:-1,F=i?e.length:-1,K=d?h.length:-1,Mt=i?0:e.length-1,Qt=d?0:h.length-1;;){var ke=e[Mt].compareTo(h[Qt]);if(0!==ke)return ke;var Ge=(Mt+=x)===F,gr=(Qt+=L)===K;if(Ge&&!gr)return-1;if(!Ge&&gr)return 1;if(Ge&&gr)return 0}};var qa=function(){this._edges=new or,this._ocaMap=new yt};qa.prototype.print=function(e){e.print("MULTILINESTRING ( ");for(var i=0;i<this._edges.size();i++){var h=this._edges.get(i);i>0&&e.print(","),e.print("(");for(var d=h.getCoordinates(),x=0;x<d.length;x++)x>0&&e.print(","),e.print(d[x].x+" "+d[x].y);e.println(")")}e.print(")  ")},qa.prototype.addAll=function(e){for(var i=e.iterator();i.hasNext();)this.add(i.next())},qa.prototype.findEdgeIndex=function(e){for(var i=0;i<this._edges.size();i++)if(this._edges.get(i).equals(e))return i;return-1},qa.prototype.iterator=function(){return this._edges.iterator()},qa.prototype.getEdges=function(){return this._edges},qa.prototype.get=function(e){return this._edges.get(e)},qa.prototype.findEqualEdge=function(e){var i=new xu(e.getCoordinates());return this._ocaMap.get(i)},qa.prototype.add=function(e){this._edges.add(e);var i=new xu(e.getCoordinates());this._ocaMap.put(i,e)},qa.prototype.interfaces_=function(){return[]},qa.prototype.getClass=function(){return qa};var Pu=function(){};Pu.prototype.processIntersections=function(e,i,h,d){},Pu.prototype.isDone=function(){},Pu.prototype.interfaces_=function(){return[]},Pu.prototype.getClass=function(){return Pu};var ea=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0,this._li=arguments[0]};ea.prototype.isTrivialIntersection=function(e,i,h,d){if(e===h&&1===this._li.getIntersectionNum()){if(ea.isAdjacentSegments(i,d))return!0;if(e.isClosed()){var x=e.size()-1;if(0===i&&d===x||0===d&&i===x)return!0}}return!1},ea.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},ea.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},ea.prototype.getLineIntersector=function(){return this._li},ea.prototype.hasProperIntersection=function(){return this._hasProper},ea.prototype.processIntersections=function(e,i,h,d){if(e===h&&i===d)return null;this.numTests++;var x=e.getCoordinates()[i],L=e.getCoordinates()[i+1],F=h.getCoordinates()[d],K=h.getCoordinates()[d+1];this._li.computeIntersection(x,L,F,K),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(e,i,h,d)||(this._hasIntersection=!0,e.addIntersections(this._li,i,0),h.addIntersections(this._li,d,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))},ea.prototype.hasIntersection=function(){return this._hasIntersection},ea.prototype.isDone=function(){return!1},ea.prototype.hasInteriorIntersection=function(){return this._hasInterior},ea.prototype.interfaces_=function(){return[Pu]},ea.prototype.getClass=function(){return ea},ea.isAdjacentSegments=function(e,i){return 1===Math.abs(e-i)};var hs=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var i=arguments[1],h=arguments[2];this.coord=new j(arguments[0]),this.segmentIndex=i,this.dist=h};hs.prototype.getSegmentIndex=function(){return this.segmentIndex},hs.prototype.getCoordinate=function(){return this.coord},hs.prototype.print=function(e){e.print(this.coord),e.print(" seg # = "+this.segmentIndex),e.println(" dist = "+this.dist)},hs.prototype.compareTo=function(e){return this.compare(e.segmentIndex,e.dist)},hs.prototype.isEndPoint=function(e){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===e},hs.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},hs.prototype.getDistance=function(){return this.dist},hs.prototype.compare=function(e,i){return this.segmentIndex<e?-1:this.segmentIndex>e?1:this.dist<i?-1:this.dist>i?1:0},hs.prototype.interfaces_=function(){return[H]},hs.prototype.getClass=function(){return hs};var Fs=function(){this._nodeMap=new yt,this.edge=null,this.edge=arguments[0]};Fs.prototype.print=function(e){e.println("Intersections:");for(var i=this.iterator();i.hasNext();)i.next().print(e)},Fs.prototype.iterator=function(){return this._nodeMap.values().iterator()},Fs.prototype.addSplitEdges=function(e){this.addEndpoints();for(var i=this.iterator(),h=i.next();i.hasNext();){var d=i.next(),x=this.createSplitEdge(h,d);e.add(x),h=d}},Fs.prototype.addEndpoints=function(){var e=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[e],e,0)},Fs.prototype.createSplitEdge=function(e,i){var h=i.segmentIndex-e.segmentIndex+2,x=i.dist>0||!i.coord.equals2D(this.edge.pts[i.segmentIndex]);x||h--;var L=new Array(h).fill(null),F=0;L[F++]=new j(e.coord);for(var K=e.segmentIndex+1;K<=i.segmentIndex;K++)L[F++]=this.edge.pts[K];return x&&(L[F]=i.coord),new Ei(L,new hr(this.edge._label))},Fs.prototype.add=function(e,i,h){var d=new hs(e,i,h),x=this._nodeMap.get(d);return null!==x?x:(this._nodeMap.put(d,d),d)},Fs.prototype.isIntersection=function(e){for(var i=this.iterator();i.hasNext();)if(i.next().coord.equals(e))return!0;return!1},Fs.prototype.interfaces_=function(){return[]},Fs.prototype.getClass=function(){return Fs};var be=function(){};be.prototype.getChainStartIndices=function(e){var i=0,h=new or;h.add(new te(i));do{var d=this.findChainEnd(e,i);h.add(new te(d)),i=d}while(i<e.length-1);return be.toIntArray(h)},be.prototype.findChainEnd=function(e,i){for(var h=en.quadrant(e[i],e[i+1]),d=i+1;d<e.length&&en.quadrant(e[d-1],e[d])===h;)d++;return d-1},be.prototype.interfaces_=function(){return[]},be.prototype.getClass=function(){return be},be.toIntArray=function(e){for(var i=new Array(e.size()).fill(null),h=0;h<i.length;h++)i[h]=e.get(h).intValue();return i};var je=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new qe,this.env2=new qe;var e=arguments[0];this.e=e,this.pts=e.getCoordinates();var i=new be;this.startIndex=i.getChainStartIndices(this.pts)};je.prototype.getCoordinates=function(){return this.pts},je.prototype.getMaxX=function(e){var i=this.pts[this.startIndex[e]].x,h=this.pts[this.startIndex[e+1]].x;return i>h?i:h},je.prototype.getMinX=function(e){var i=this.pts[this.startIndex[e]].x,h=this.pts[this.startIndex[e+1]].x;return i<h?i:h},je.prototype.computeIntersectsForChain=function(){if(4===arguments.length){var e=arguments[0],i=arguments[1],h=arguments[2];this.computeIntersectsForChain(this.startIndex[e],this.startIndex[e+1],i,i.startIndex[h],i.startIndex[h+1],arguments[3])}else if(6===arguments.length){var x=arguments[0],L=arguments[1],F=arguments[2],K=arguments[3],Mt=arguments[4],Qt=arguments[5],ke=this.pts[x],Ge=this.pts[L],gr=F.pts[K],Ir=F.pts[Mt];if(L-x==1&&Mt-K==1)return Qt.addIntersections(this.e,x,F.e,K),null;if(this.env1.init(ke,Ge),this.env2.init(gr,Ir),!this.env1.intersects(this.env2))return null;var jr=Math.trunc((x+L)/2),ln=Math.trunc((K+Mt)/2);x<jr&&(K<ln&&this.computeIntersectsForChain(x,jr,F,K,ln,Qt),ln<Mt&&this.computeIntersectsForChain(x,jr,F,ln,Mt,Qt)),jr<L&&(K<ln&&this.computeIntersectsForChain(jr,L,F,K,ln,Qt),ln<Mt&&this.computeIntersectsForChain(jr,L,F,ln,Mt,Qt))}},je.prototype.getStartIndexes=function(){return this.startIndex},je.prototype.computeIntersects=function(e,i){for(var h=0;h<this.startIndex.length-1;h++)for(var d=0;d<e.startIndex.length-1;d++)this.computeIntersectsForChain(h,e,d,i)},je.prototype.interfaces_=function(){return[]},je.prototype.getClass=function(){return je};var dr=function e(){this._depth=Array(2).fill().map(function(){return Array(3)});for(var i=0;i<2;i++)for(var h=0;h<3;h++)this._depth[i][h]=e.NULL_VALUE},fn={NULL_VALUE:{configurable:!0}};dr.prototype.getDepth=function(e,i){return this._depth[e][i]},dr.prototype.setDepth=function(e,i,h){this._depth[e][i]=h},dr.prototype.isNull=function(){if(0===arguments.length){for(var e=0;e<2;e++)for(var i=0;i<3;i++)if(this._depth[e][i]!==dr.NULL_VALUE)return!1;return!0}return 1===arguments.length?this._depth[arguments[0]][1]===dr.NULL_VALUE:2===arguments.length?this._depth[arguments[0]][arguments[1]]===dr.NULL_VALUE:void 0},dr.prototype.normalize=function(){for(var e=0;e<2;e++)if(!this.isNull(e)){var i=this._depth[e][1];this._depth[e][2]<i&&(i=this._depth[e][2]),i<0&&(i=0);for(var h=1;h<3;h++){var d=0;this._depth[e][h]>i&&(d=1),this._depth[e][h]=d}}},dr.prototype.getDelta=function(e){return this._depth[e][Bt.RIGHT]-this._depth[e][Bt.LEFT]},dr.prototype.getLocation=function(e,i){return this._depth[e][i]<=0?gt.EXTERIOR:gt.INTERIOR},dr.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]},dr.prototype.add=function(){if(1===arguments.length)for(var e=arguments[0],i=0;i<2;i++)for(var h=1;h<3;h++){var d=e.getLocation(i,h);d!==gt.EXTERIOR&&d!==gt.INTERIOR||(this.isNull(i,h)?this._depth[i][h]=dr.depthAtLocation(d):this._depth[i][h]+=dr.depthAtLocation(d))}else 3===arguments.length&&arguments[2]===gt.INTERIOR&&this._depth[arguments[0]][arguments[1]]++},dr.prototype.interfaces_=function(){return[]},dr.prototype.getClass=function(){return dr},dr.depthAtLocation=function(e){return e===gt.EXTERIOR?0:e===gt.INTERIOR?1:dr.NULL_VALUE},fn.NULL_VALUE.get=function(){return-1},Object.defineProperties(dr,fn);var Ei=function(e){function i(){if(e.call(this),this.pts=null,this._env=null,this.eiList=new Fs(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new dr,this._depthDelta=0,1===arguments.length)i.call(this,arguments[0],null);else if(2===arguments.length){var x=arguments[1];this.pts=arguments[0],this._label=x}}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.getDepth=function(){return this._depth},i.prototype.getCollapsedEdge=function(){var h=new Array(2).fill(null);return h[0]=this.pts[0],h[1]=this.pts[1],new i(h,hr.toLineLabel(this._label))},i.prototype.isIsolated=function(){return this._isIsolated},i.prototype.getCoordinates=function(){return this.pts},i.prototype.setIsolated=function(h){this._isIsolated=h},i.prototype.setName=function(h){this._name=h},i.prototype.equals=function(h){if(!(h instanceof i))return!1;var d=h;if(this.pts.length!==d.pts.length)return!1;for(var x=!0,L=!0,F=this.pts.length,K=0;K<this.pts.length;K++)if(this.pts[K].equals2D(d.pts[K])||(x=!1),this.pts[K].equals2D(d.pts[--F])||(L=!1),!x&&!L)return!1;return!0},i.prototype.getCoordinate=function(){return 0===arguments.length?this.pts.length>0?this.pts[0]:null:1===arguments.length?this.pts[arguments[0]]:void 0},i.prototype.print=function(h){h.print("edge "+this._name+": "),h.print("LINESTRING (");for(var d=0;d<this.pts.length;d++)d>0&&h.print(","),h.print(this.pts[d].x+" "+this.pts[d].y);h.print(")  "+this._label+" "+this._depthDelta)},i.prototype.computeIM=function(h){i.updateIM(this._label,h)},i.prototype.isCollapsed=function(){return!!this._label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])},i.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},i.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},i.prototype.getDepthDelta=function(){return this._depthDelta},i.prototype.getNumPoints=function(){return this.pts.length},i.prototype.printReverse=function(h){h.print("edge "+this._name+": ");for(var d=this.pts.length-1;d>=0;d--)h.print(this.pts[d]+" ");h.println("")},i.prototype.getMonotoneChainEdge=function(){return null===this._mce&&(this._mce=new je(this)),this._mce},i.prototype.getEnvelope=function(){if(null===this._env){this._env=new qe;for(var h=0;h<this.pts.length;h++)this._env.expandToInclude(this.pts[h])}return this._env},i.prototype.addIntersection=function(h,d,x,L){var F=new j(h.getIntersection(L)),K=d,Mt=h.getEdgeDistance(x,L),Qt=K+1;Qt<this.pts.length&&F.equals2D(this.pts[Qt])&&(K=Qt,Mt=0),this.eiList.add(F,K,Mt)},i.prototype.toString=function(){var h=new Pt;h.append("edge "+this._name+": "),h.append("LINESTRING (");for(var d=0;d<this.pts.length;d++)d>0&&h.append(","),h.append(this.pts[d].x+" "+this.pts[d].y);return h.append(")  "+this._label+" "+this._depthDelta),h.toString()},i.prototype.isPointwiseEqual=function(h){if(this.pts.length!==h.pts.length)return!1;for(var d=0;d<this.pts.length;d++)if(!this.pts[d].equals2D(h.pts[d]))return!1;return!0},i.prototype.setDepthDelta=function(h){this._depthDelta=h},i.prototype.getEdgeIntersectionList=function(){return this.eiList},i.prototype.addIntersections=function(h,d,x){for(var L=0;L<h.getIntersectionNum();L++)this.addIntersection(h,d,x,L)},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i.updateIM=function(){if(2!==arguments.length)return e.prototype.updateIM.apply(this,arguments);var h=arguments[0],d=arguments[1];d.setAtLeastIfValid(h.getLocation(0,Bt.ON),h.getLocation(1,Bt.ON),1),h.isArea()&&(d.setAtLeastIfValid(h.getLocation(0,Bt.LEFT),h.getLocation(1,Bt.LEFT),2),d.setAtLeastIfValid(h.getLocation(0,Bt.RIGHT),h.getLocation(1,Bt.RIGHT),2))},i}($e),An=function(e){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new qa,this._bufParams=e||null};An.prototype.setWorkingPrecisionModel=function(e){this._workingPrecisionModel=e},An.prototype.insertUniqueEdge=function(e){var i=this._edgeList.findEqualEdge(e);if(null!==i){var h=i.getLabel(),d=e.getLabel();i.isPointwiseEqual(e)||(d=new hr(e.getLabel())).flip(),h.merge(d);var x=An.depthDelta(d),L=i.getDepthDelta()+x;i.setDepthDelta(L)}else this._edgeList.add(e),e.setDepthDelta(An.depthDelta(e.getLabel()))},An.prototype.buildSubgraphs=function(e,i){for(var h=new or,d=e.iterator();d.hasNext();){var x=d.next(),L=x.getRightmostCoordinate(),F=new bs(h).getDepth(L);x.computeDepth(F),x.findResultEdges(),h.add(x),i.add(x.getDirectedEdges(),x.getNodes())}},An.prototype.createSubgraphs=function(e){for(var i=new or,h=e.getNodes().iterator();h.hasNext();){var d=h.next();if(!d.isVisited()){var x=new Ae;x.create(d),i.add(x)}}return Vn.sort(i,Vn.reverseOrder()),i},An.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()},An.prototype.getNoder=function(e){if(null!==this._workingNoder)return this._workingNoder;var i=new Ms,h=new De;return h.setPrecisionModel(e),i.setSegmentIntersector(new ea(h)),i},An.prototype.buffer=function(e,i){var h=this._workingPrecisionModel;null===h&&(h=e.getPrecisionModel()),this._geomFact=e.getFactory();var d=new ga(h,this._bufParams),x=new ta(e,i,d).getCurves();if(x.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(x,h),this._graph=new Qr(new kl),this._graph.addEdges(this._edgeList.getEdges());var L=this.createSubgraphs(this._graph),F=new ni(this._geomFact);this.buildSubgraphs(L,F);var K=F.getPolygons();return K.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(K)},An.prototype.computeNodedEdges=function(e,i){var h=this.getNoder(i);h.computeNodes(e);for(var d=h.getNodedSubstrings().iterator();d.hasNext();){var x=d.next(),L=x.getCoordinates();if(2!==L.length||!L[0].equals2D(L[1])){var F=x.getData(),K=new Ei(x.getCoordinates(),new hr(F));this.insertUniqueEdge(K)}}},An.prototype.setNoder=function(e){this._workingNoder=e},An.prototype.interfaces_=function(){return[]},An.prototype.getClass=function(){return An},An.depthDelta=function(e){var i=e.getLocation(0,Bt.LEFT),h=e.getLocation(0,Bt.RIGHT);return i===gt.INTERIOR&&h===gt.EXTERIOR?1:i===gt.EXTERIOR&&h===gt.INTERIOR?-1:0},An.convertSegStrings=function(e){for(var i=new xn,h=new or;e.hasNext();){var d=e.next(),x=i.createLineString(d.getCoordinates());h.add(x)}return i.buildGeometry(h)};var xo=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){var i=arguments[1];this._noder=arguments[0],this._scaleFactor=i,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(4===arguments.length){var d=arguments[1],x=arguments[2],L=arguments[3];this._noder=arguments[0],this._scaleFactor=d,this._offsetX=x,this._offsetY=L,this._isScaled=!this.isIntegerPrecision()}};xo.prototype.rescale=function(){if(Ie(arguments[0],gi))for(var e=arguments[0].iterator();e.hasNext();){var i=e.next();this.rescale(i.getCoordinates())}else if(arguments[0]instanceof Array){for(var h=arguments[0],d=0;d<h.length;d++)h[d].x=h[d].x/this._scaleFactor+this._offsetX,h[d].y=h[d].y/this._scaleFactor+this._offsetY;2===h.length&&h[0].equals2D(h[1])&&Xr.out.println(h)}},xo.prototype.scale=function(){if(Ie(arguments[0],gi)){for(var e=arguments[0],i=new or,h=e.iterator();h.hasNext();){var d=h.next();i.add(new Fi(this.scale(d.getCoordinates()),d.getData()))}return i}if(arguments[0]instanceof Array){for(var x=arguments[0],L=new Array(x.length).fill(null),F=0;F<x.length;F++)L[F]=new j(Math.round((x[F].x-this._offsetX)*this._scaleFactor),Math.round((x[F].y-this._offsetY)*this._scaleFactor),x[F].z);return W.removeRepeatedPoints(L)}},xo.prototype.isIntegerPrecision=function(){return 1===this._scaleFactor},xo.prototype.getNodedSubstrings=function(){var e=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(e),e},xo.prototype.computeNodes=function(e){var i=e;this._isScaled&&(i=this.scale(e)),this._noder.computeNodes(i)},xo.prototype.interfaces_=function(){return[Mu]},xo.prototype.getClass=function(){return xo};var oo=function(){this._li=new De,this._segStrings=null,this._segStrings=arguments[0]},Ga={fact:{configurable:!0}};oo.prototype.checkEndPtVertexIntersections=function(){if(0===arguments.length)for(var e=this._segStrings.iterator();e.hasNext();){var i=e.next().getCoordinates();this.checkEndPtVertexIntersections(i[0],this._segStrings),this.checkEndPtVertexIntersections(i[i.length-1],this._segStrings)}else if(2===arguments.length)for(var h=arguments[0],d=arguments[1].iterator();d.hasNext();)for(var x=d.next().getCoordinates(),L=1;L<x.length-1;L++)if(x[L].equals(h))throw new st("found endpt/interior pt intersection at index "+L+" :pt "+h)},oo.prototype.checkInteriorIntersections=function(){if(0===arguments.length)for(var e=this._segStrings.iterator();e.hasNext();)for(var i=e.next(),h=this._segStrings.iterator();h.hasNext();){var d=h.next();this.checkInteriorIntersections(i,d)}else if(2===arguments.length)for(var x=arguments[0],L=arguments[1],F=x.getCoordinates(),K=L.getCoordinates(),Mt=0;Mt<F.length-1;Mt++)for(var Qt=0;Qt<K.length-1;Qt++)this.checkInteriorIntersections(x,Mt,L,Qt);else if(4===arguments.length){var ke=arguments[0],Ge=arguments[1],gr=arguments[2],Ir=arguments[3];if(ke===gr&&Ge===Ir)return null;var jr=ke.getCoordinates()[Ge],ln=ke.getCoordinates()[Ge+1],Mi=gr.getCoordinates()[Ir],l=gr.getCoordinates()[Ir+1];if(this._li.computeIntersection(jr,ln,Mi,l),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,jr,ln)||this.hasInteriorIntersection(this._li,Mi,l)))throw new st("found non-noded intersection at "+jr+"-"+ln+" and "+Mi+"-"+l)}},oo.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},oo.prototype.checkCollapses=function(){if(0===arguments.length)for(var e=this._segStrings.iterator();e.hasNext();){var i=e.next();this.checkCollapses(i)}else if(1===arguments.length)for(var h=arguments[0].getCoordinates(),d=0;d<h.length-2;d++)this.checkCollapse(h[d],h[d+1],h[d+2])},oo.prototype.hasInteriorIntersection=function(e,i,h){for(var d=0;d<e.getIntersectionNum();d++){var x=e.getIntersection(d);if(!x.equals(i)&&!x.equals(h))return!0}return!1},oo.prototype.checkCollapse=function(e,i,h){if(e.equals(h))throw new st("found non-noded collapse at "+oo.fact.createLineString([e,i,h]))},oo.prototype.interfaces_=function(){return[]},oo.prototype.getClass=function(){return oo},Ga.fact.get=function(){return new xn},Object.defineProperties(oo,Ga);var mi=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var e=arguments[0],i=arguments[1],h=arguments[2];if(this._originalPt=e,this._pt=e,this._scaleFactor=i,this._li=h,i<=0)throw new tt("Scale factor must be non-zero");1!==i&&(this._pt=new j(this.scale(e.x),this.scale(e.y)),this._p0Scaled=new j,this._p1Scaled=new j),this.initCorners(this._pt)},Wo={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};mi.prototype.intersectsScaled=function(e,i){var h=Math.min(e.x,i.x),d=Math.max(e.x,i.x),x=Math.min(e.y,i.y),L=Math.max(e.y,i.y),F=this._maxx<h||this._minx>d||this._maxy<x||this._miny>L;if(F)return!1;var K=this.intersectsToleranceSquare(e,i);return ot.isTrue(!(F&&K),"Found bad envelope test"),K},mi.prototype.initCorners=function(e){this._minx=e.x-.5,this._maxx=e.x+.5,this._miny=e.y-.5,this._maxy=e.y+.5,this._corner[0]=new j(this._maxx,this._maxy),this._corner[1]=new j(this._minx,this._maxy),this._corner[2]=new j(this._minx,this._miny),this._corner[3]=new j(this._maxx,this._miny)},mi.prototype.intersects=function(e,i){return 1===this._scaleFactor?this.intersectsScaled(e,i):(this.copyScaled(e,this._p0Scaled),this.copyScaled(i,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))},mi.prototype.scale=function(e){return Math.round(e*this._scaleFactor)},mi.prototype.getCoordinate=function(){return this._originalPt},mi.prototype.copyScaled=function(e,i){i.x=this.scale(e.x),i.y=this.scale(e.y)},mi.prototype.getSafeEnvelope=function(){if(null===this._safeEnv){var e=mi.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new qe(this._originalPt.x-e,this._originalPt.x+e,this._originalPt.y-e,this._originalPt.y+e)}return this._safeEnv},mi.prototype.intersectsPixelClosure=function(e,i){return this._li.computeIntersection(e,i,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(e,i,this._corner[1],this._corner[2]),this._li.hasIntersection()||(this._li.computeIntersection(e,i,this._corner[2],this._corner[3]),this._li.hasIntersection()||(this._li.computeIntersection(e,i,this._corner[3],this._corner[0]),this._li.hasIntersection()))))},mi.prototype.intersectsToleranceSquare=function(e,i){var h=!1,d=!1;return this._li.computeIntersection(e,i,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(e,i,this._corner[1],this._corner[2]),this._li.isProper()||(this._li.hasIntersection()&&(h=!0),this._li.computeIntersection(e,i,this._corner[2],this._corner[3]),this._li.isProper()||(this._li.hasIntersection()&&(d=!0),this._li.computeIntersection(e,i,this._corner[3],this._corner[0]),this._li.isProper()||h&&d||e.equals(this._pt)||i.equals(this._pt)))))},mi.prototype.addSnappedNode=function(e,i){var h=e.getCoordinate(i),d=e.getCoordinate(i+1);return!!this.intersects(h,d)&&(e.addIntersection(this.getCoordinate(),i),!0)},mi.prototype.interfaces_=function(){return[]},mi.prototype.getClass=function(){return mi},Wo.SAFE_ENV_EXPANSION_FACTOR.get=function(){return.75},Object.defineProperties(mi,Wo);var Ts=function(){this.tempEnv1=new qe,this.selectedSegment=new Jr};Ts.prototype.select=function(){1!==arguments.length&&2===arguments.length&&(arguments[0].getLineSegment(arguments[1],this.selectedSegment),this.select(this.selectedSegment))},Ts.prototype.interfaces_=function(){return[]},Ts.prototype.getClass=function(){return Ts};var Qa=function(){this._index=null,this._index=arguments[0]},ps={HotPixelSnapAction:{configurable:!0}};Qa.prototype.snap=function(){if(1===arguments.length)return this.snap(arguments[0],null,-1);if(3===arguments.length){var i=arguments[0],h=arguments[1],d=arguments[2],x=i.getSafeEnvelope(),L=new Ks(i,h,d);return this._index.query(x,{interfaces_:function(){return[ba]},visitItem:function(F){F.select(x,L)}}),L.isNodeAdded()}},Qa.prototype.interfaces_=function(){return[]},Qa.prototype.getClass=function(){return Qa},ps.HotPixelSnapAction.get=function(){return Ks},Object.defineProperties(Qa,ps);var Ks=function(e){function i(){e.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var d=arguments[1],x=arguments[2];this._hotPixel=arguments[0],this._parentEdge=d,this._hotPixelVertexIndex=x}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.isNodeAdded=function(){return this._isNodeAdded},i.prototype.select=function(){if(2!==arguments.length)return e.prototype.select.apply(this,arguments);var d=arguments[1],x=arguments[0].getContext();if(null!==this._parentEdge&&x===this._parentEdge&&d===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(x,d)},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i}(Ts),zs=function(){this._li=null,this._interiorIntersections=null,this._li=arguments[0],this._interiorIntersections=new or};zs.prototype.processIntersections=function(e,i,h,d){if(e===h&&i===d)return null;var x=e.getCoordinates()[i],L=e.getCoordinates()[i+1],F=h.getCoordinates()[d],K=h.getCoordinates()[d+1];if(this._li.computeIntersection(x,L,F,K),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var Mt=0;Mt<this._li.getIntersectionNum();Mt++)this._interiorIntersections.add(this._li.getIntersection(Mt));e.addIntersections(this._li,i,0),h.addIntersections(this._li,d,1)}},zs.prototype.isDone=function(){return!1},zs.prototype.getInteriorIntersections=function(){return this._interiorIntersections},zs.prototype.interfaces_=function(){return[Pu]},zs.prototype.getClass=function(){return zs};var As=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var e=arguments[0];this._pm=e,this._li=new De,this._li.setPrecisionModel(e),this._scaleFactor=e.getScale()};As.prototype.checkCorrectness=function(e){var i=Fi.getNodedSubstrings(e),h=new oo(i);try{h.checkValid()}catch(d){if(!(d instanceof lr))throw d;d.printStackTrace()}},As.prototype.getNodedSubstrings=function(){return Fi.getNodedSubstrings(this._nodedSegStrings)},As.prototype.snapRound=function(e,i){var h=this.findInteriorIntersections(e,i);this.computeIntersectionSnaps(h),this.computeVertexSnaps(e)},As.prototype.findInteriorIntersections=function(e,i){var h=new zs(i);return this._noder.setSegmentIntersector(h),this._noder.computeNodes(e),h.getInteriorIntersections()},As.prototype.computeVertexSnaps=function(){if(Ie(arguments[0],gi))for(var e=arguments[0].iterator();e.hasNext();){var i=e.next();this.computeVertexSnaps(i)}else if(arguments[0]instanceof Fi)for(var h=arguments[0],d=h.getCoordinates(),x=0;x<d.length;x++){var L=new mi(d[x],this._scaleFactor,this._li);this._pointSnapper.snap(L,h,x)&&h.addIntersection(d[x],x)}},As.prototype.computeNodes=function(e){this._nodedSegStrings=e,this._noder=new Ms,this._pointSnapper=new Qa(this._noder.getIndex()),this.snapRound(e,this._li)},As.prototype.computeIntersectionSnaps=function(e){for(var i=e.iterator();i.hasNext();){var h=i.next(),d=new mi(h,this._scaleFactor,this._li);this._pointSnapper.snap(d)}},As.prototype.interfaces_=function(){return[Mu]},As.prototype.getClass=function(){return As};var Bo=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new $n,this._resultGeometry=null,this._saveException=null,1===arguments.length)this._argGeom=arguments[0];else if(2===arguments.length){var h=arguments[1];this._argGeom=arguments[0],this._bufParams=h}},$s={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};Bo.prototype.bufferFixedPrecision=function(e){var i=new xo(new As(new Pn(1)),e.getScale()),h=new An(this._bufParams);h.setWorkingPrecisionModel(e),h.setNoder(i),this._resultGeometry=h.buffer(this._argGeom,this._distance)},Bo.prototype.bufferReducedPrecision=function(){var e=this;if(0===arguments.length){for(var i=Bo.MAX_PRECISION_DIGITS;i>=0;i--){try{e.bufferReducedPrecision(i)}catch(L){if(!(L instanceof ur))throw L;e._saveException=L}if(null!==e._resultGeometry)return null}throw this._saveException}if(1===arguments.length){var d=Bo.precisionScaleFactor(this._argGeom,this._distance,arguments[0]),x=new Pn(d);this.bufferFixedPrecision(x)}},Bo.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;var e=this._argGeom.getFactory().getPrecisionModel();e.getType()===Pn.FIXED?this.bufferFixedPrecision(e):this.bufferReducedPrecision()},Bo.prototype.setQuadrantSegments=function(e){this._bufParams.setQuadrantSegments(e)},Bo.prototype.bufferOriginalPrecision=function(){try{var e=new An(this._bufParams);this._resultGeometry=e.buffer(this._argGeom,this._distance)}catch(i){if(!(i instanceof st))throw i;this._saveException=i}},Bo.prototype.getResultGeometry=function(e){return this._distance=e,this.computeGeometry(),this._resultGeometry},Bo.prototype.setEndCapStyle=function(e){this._bufParams.setEndCapStyle(e)},Bo.prototype.interfaces_=function(){return[]},Bo.prototype.getClass=function(){return Bo},Bo.bufferOp=function(){if(2===arguments.length){var i=arguments[1];return new Bo(arguments[0]).getResultGeometry(i)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof pr&&"number"==typeof arguments[1]){var d=arguments[1],x=arguments[2],L=new Bo(arguments[0]);return L.setQuadrantSegments(x),L.getResultGeometry(d)}if(arguments[2]instanceof $n&&arguments[0]instanceof pr&&"number"==typeof arguments[1]){var K=arguments[1];return new Bo(arguments[0],arguments[2]).getResultGeometry(K)}}else if(4===arguments.length){var ke=arguments[1],Ge=arguments[2],gr=arguments[3],Ir=new Bo(arguments[0]);return Ir.setQuadrantSegments(Ge),Ir.setEndCapStyle(gr),Ir.getResultGeometry(ke)}},Bo.precisionScaleFactor=function(e,i,h){var d=e.getEnvelopeInternal(),x=It.max(Math.abs(d.getMaxX()),Math.abs(d.getMaxY()),Math.abs(d.getMinX()),Math.abs(d.getMinY()))+2*(i>0?i:0),L=h-Math.trunc(Math.log(x)/Math.log(10)+1);return Math.pow(10,L)},$s.CAP_ROUND.get=function(){return $n.CAP_ROUND},$s.CAP_BUTT.get=function(){return $n.CAP_FLAT},$s.CAP_FLAT.get=function(){return $n.CAP_FLAT},$s.CAP_SQUARE.get=function(){return $n.CAP_SQUARE},$s.MAX_PRECISION_DIGITS.get=function(){return 12},Object.defineProperties(Bo,$s);var sa=function(){this._pt=[new j,new j],this._distance=X.NaN,this._isNull=!0};sa.prototype.getCoordinates=function(){return this._pt},sa.prototype.getCoordinate=function(e){return this._pt[e]},sa.prototype.setMinimum=function(){if(1===arguments.length){var e=arguments[0];this.setMinimum(e._pt[0],e._pt[1])}else if(2===arguments.length){var i=arguments[0],h=arguments[1];if(this._isNull)return this.initialize(i,h),null;var d=i.distance(h);d<this._distance&&this.initialize(i,h,d)}},sa.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var e=arguments[0],i=arguments[1];this._pt[0].setCoordinate(e),this._pt[1].setCoordinate(i),this._distance=e.distance(i),this._isNull=!1}else if(3===arguments.length){var d=arguments[1],x=arguments[2];this._pt[0].setCoordinate(arguments[0]),this._pt[1].setCoordinate(d),this._distance=x,this._isNull=!1}},sa.prototype.getDistance=function(){return this._distance},sa.prototype.setMaximum=function(){if(1===arguments.length){var e=arguments[0];this.setMaximum(e._pt[0],e._pt[1])}else if(2===arguments.length){var i=arguments[0],h=arguments[1];if(this._isNull)return this.initialize(i,h),null;var d=i.distance(h);d>this._distance&&this.initialize(i,h,d)}},sa.prototype.interfaces_=function(){return[]},sa.prototype.getClass=function(){return sa};var Bs=function(){};Bs.prototype.interfaces_=function(){return[]},Bs.prototype.getClass=function(){return Bs},Bs.computeDistance=function(){if(arguments[2]instanceof sa&&arguments[0]instanceof Nr&&arguments[1]instanceof j)for(var i=arguments[1],h=arguments[2],d=arguments[0].getCoordinates(),x=new Jr,L=0;L<d.length-1;L++){x.setCoordinates(d[L],d[L+1]);var F=x.closestPoint(i);h.setMinimum(F,i)}else if(arguments[2]instanceof sa&&arguments[0]instanceof En&&arguments[1]instanceof j){var K=arguments[0],Mt=arguments[1],Qt=arguments[2];Bs.computeDistance(K.getExteriorRing(),Mt,Qt);for(var ke=0;ke<K.getNumInteriorRing();ke++)Bs.computeDistance(K.getInteriorRingN(ke),Mt,Qt)}else if(arguments[2]instanceof sa&&arguments[0]instanceof pr&&arguments[1]instanceof j){var Ge=arguments[0],gr=arguments[1],Ir=arguments[2];if(Ge instanceof Nr)Bs.computeDistance(Ge,gr,Ir);else if(Ge instanceof En)Bs.computeDistance(Ge,gr,Ir);else if(Ge instanceof He)for(var jr=Ge,ln=0;ln<jr.getNumGeometries();ln++){var Mi=jr.getGeometryN(ln);Bs.computeDistance(Mi,gr,Ir)}else Ir.setMinimum(Ge.getCoordinate(),gr)}else if(arguments[2]instanceof sa&&arguments[0]instanceof Jr&&arguments[1]instanceof j){var f=arguments[1],c=arguments[2],m=arguments[0].closestPoint(f);c.setMinimum(m,f)}};var Qs=function(e){this._maxPtDist=new sa,this._inputGeom=e||null},So={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};Qs.prototype.computeMaxMidpointDistance=function(e){var i=new oi(this._inputGeom);e.apply(i),this._maxPtDist.setMaximum(i.getMaxPointDistance())},Qs.prototype.computeMaxVertexDistance=function(e){var i=new Ii(this._inputGeom);e.apply(i),this._maxPtDist.setMaximum(i.getMaxPointDistance())},Qs.prototype.findDistance=function(e){return this.computeMaxVertexDistance(e),this.computeMaxMidpointDistance(e),this._maxPtDist.getDistance()},Qs.prototype.getDistancePoints=function(){return this._maxPtDist},Qs.prototype.interfaces_=function(){return[]},Qs.prototype.getClass=function(){return Qs},So.MaxPointDistanceFilter.get=function(){return Ii},So.MaxMidpointDistanceFilter.get=function(){return oi},Object.defineProperties(Qs,So);var Ii=function(e){this._maxPtDist=new sa,this._minPtDist=new sa,this._geom=e||null};Ii.prototype.filter=function(e){this._minPtDist.initialize(),Bs.computeDistance(this._geom,e,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Ii.prototype.getMaxPointDistance=function(){return this._maxPtDist},Ii.prototype.interfaces_=function(){return[Kn]},Ii.prototype.getClass=function(){return Ii};var oi=function(e){this._maxPtDist=new sa,this._minPtDist=new sa,this._geom=e||null};oi.prototype.filter=function(e,i){if(0===i)return null;var h=e.getCoordinate(i-1),d=e.getCoordinate(i),x=new j((h.x+d.x)/2,(h.y+d.y)/2);this._minPtDist.initialize(),Bs.computeDistance(this._geom,x,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},oi.prototype.isDone=function(){return!1},oi.prototype.isGeometryChanged=function(){return!1},oi.prototype.getMaxPointDistance=function(){return this._maxPtDist},oi.prototype.interfaces_=function(){return[Pr]},oi.prototype.getClass=function(){return oi};var Ea=function(e){this._comps=e||null};Ea.prototype.filter=function(e){e instanceof En&&this._comps.add(e)},Ea.prototype.interfaces_=function(){return[_r]},Ea.prototype.getClass=function(){return Ea},Ea.getPolygons=function(){if(1===arguments.length)return Ea.getPolygons(arguments[0],new or);if(2===arguments.length){var i=arguments[0],h=arguments[1];return i instanceof En?h.add(i):i instanceof He&&i.apply(new Ea(h)),h}};var Po=function(){if(this._lines=null,this._isForcedToLineString=!1,1===arguments.length)this._lines=arguments[0];else if(2===arguments.length){var h=arguments[1];this._lines=arguments[0],this._isForcedToLineString=h}};Po.prototype.filter=function(e){if(this._isForcedToLineString&&e instanceof li){var i=e.getFactory().createLineString(e.getCoordinateSequence());return this._lines.add(i),null}e instanceof Nr&&this._lines.add(e)},Po.prototype.setForceToLineString=function(e){this._isForcedToLineString=e},Po.prototype.interfaces_=function(){return[Kr]},Po.prototype.getClass=function(){return Po},Po.getGeometry=function(){if(1===arguments.length){var e=arguments[0];return e.getFactory().buildGeometry(Po.getLines(e))}if(2===arguments.length){var i=arguments[0],h=arguments[1];return i.getFactory().buildGeometry(Po.getLines(i,h))}},Po.getLines=function(){if(1===arguments.length)return Po.getLines(arguments[0],!1);if(2===arguments.length){if(Ie(arguments[0],gi)&&Ie(arguments[1],gi)){for(var h=arguments[1],d=arguments[0].iterator();d.hasNext();){var x=d.next();Po.getLines(x,h)}return h}if(arguments[0]instanceof pr&&"boolean"==typeof arguments[1]){var L=arguments[0],F=arguments[1],K=new or;return L.apply(new Po(K,F)),K}if(arguments[0]instanceof pr&&Ie(arguments[1],gi)){var Mt=arguments[0],Qt=arguments[1];return Mt instanceof Nr?Qt.add(Mt):Mt.apply(new Po(Qt)),Qt}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&Ie(arguments[0],gi)&&Ie(arguments[1],gi)){for(var Ge=arguments[1],gr=arguments[2],Ir=arguments[0].iterator();Ir.hasNext();){var jr=Ir.next();Po.getLines(jr,Ge,gr)}return Ge}if("boolean"==typeof arguments[2]&&arguments[0]instanceof pr&&Ie(arguments[1],gi)){var Mi=arguments[1];return arguments[0].apply(new Po(Mi,arguments[2])),Mi}}};var po=function(){if(this._boundaryRule=Gn.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0!==arguments.length&&1===arguments.length){var e=arguments[0];if(null===e)throw new tt("Rule must be non-null");this._boundaryRule=e}};po.prototype.locateInternal=function(){if(arguments[0]instanceof j&&arguments[1]instanceof En){var e=arguments[0],i=arguments[1];if(i.isEmpty())return gt.EXTERIOR;var h=i.getExteriorRing(),d=this.locateInPolygonRing(e,h);if(d===gt.EXTERIOR)return gt.EXTERIOR;if(d===gt.BOUNDARY)return gt.BOUNDARY;for(var x=0;x<i.getNumInteriorRing();x++){var L=i.getInteriorRingN(x),F=this.locateInPolygonRing(e,L);if(F===gt.INTERIOR)return gt.EXTERIOR;if(F===gt.BOUNDARY)return gt.BOUNDARY}return gt.INTERIOR}if(arguments[0]instanceof j&&arguments[1]instanceof Nr){var K=arguments[0],Mt=arguments[1];if(!Mt.getEnvelopeInternal().intersects(K))return gt.EXTERIOR;var Qt=Mt.getCoordinates();return Mt.isClosed()||!K.equals(Qt[0])&&!K.equals(Qt[Qt.length-1])?Xe.isOnLine(K,Qt)?gt.INTERIOR:gt.EXTERIOR:gt.BOUNDARY}if(arguments[0]instanceof j&&arguments[1]instanceof ri){var ke=arguments[0];return arguments[1].getCoordinate().equals2D(ke)?gt.INTERIOR:gt.EXTERIOR}},po.prototype.locateInPolygonRing=function(e,i){return i.getEnvelopeInternal().intersects(e)?Xe.locatePointInRing(e,i.getCoordinates()):gt.EXTERIOR},po.prototype.intersects=function(e,i){return this.locate(e,i)!==gt.EXTERIOR},po.prototype.updateLocationInfo=function(e){e===gt.INTERIOR&&(this._isIn=!0),e===gt.BOUNDARY&&this._numBoundaries++},po.prototype.computeLocation=function(e,i){if(i instanceof ri&&this.updateLocationInfo(this.locateInternal(e,i)),i instanceof Nr)this.updateLocationInfo(this.locateInternal(e,i));else if(i instanceof En)this.updateLocationInfo(this.locateInternal(e,i));else if(i instanceof yr)for(var h=i,d=0;d<h.getNumGeometries();d++){var x=h.getGeometryN(d);this.updateLocationInfo(this.locateInternal(e,x))}else if(i instanceof Gr)for(var L=i,F=0;F<L.getNumGeometries();F++){var K=L.getGeometryN(F);this.updateLocationInfo(this.locateInternal(e,K))}else if(i instanceof He)for(var Mt=new jn(i);Mt.hasNext();){var Qt=Mt.next();Qt!==i&&this.computeLocation(e,Qt)}},po.prototype.locate=function(e,i){return i.isEmpty()?gt.EXTERIOR:i instanceof Nr||i instanceof En?this.locateInternal(e,i):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(e,i),this._boundaryRule.isInBoundary(this._numBoundaries)?gt.BOUNDARY:this._numBoundaries>0||this._isIn?gt.INTERIOR:gt.EXTERIOR)},po.prototype.interfaces_=function(){return[]},po.prototype.getClass=function(){return po};var bn=function e(){if(this._component=null,this._segIndex=null,this._pt=null,2===arguments.length)e.call(this,arguments[0],e.INSIDE_AREA,arguments[1]);else if(3===arguments.length){var x=arguments[1],L=arguments[2];this._component=arguments[0],this._segIndex=x,this._pt=L}},Wn={INSIDE_AREA:{configurable:!0}};bn.prototype.isInsideArea=function(){return this._segIndex===bn.INSIDE_AREA},bn.prototype.getCoordinate=function(){return this._pt},bn.prototype.getGeometryComponent=function(){return this._component},bn.prototype.getSegmentIndex=function(){return this._segIndex},bn.prototype.interfaces_=function(){return[]},bn.prototype.getClass=function(){return bn},Wn.INSIDE_AREA.get=function(){return-1},Object.defineProperties(bn,Wn);var Va=function(e){this._pts=e||null};Va.prototype.filter=function(e){e instanceof ri&&this._pts.add(e)},Va.prototype.interfaces_=function(){return[_r]},Va.prototype.getClass=function(){return Va},Va.getPoints=function(){if(1===arguments.length){var e=arguments[0];return e instanceof ri?Vn.singletonList(e):Va.getPoints(e,new or)}if(2===arguments.length){var i=arguments[0],h=arguments[1];return i instanceof ri?h.add(i):i instanceof He&&i.apply(new Va(h)),h}};var ja=function(){this._locations=null,this._locations=arguments[0]};ja.prototype.filter=function(e){(e instanceof ri||e instanceof Nr||e instanceof En)&&this._locations.add(new bn(e,0,e.getCoordinate()))},ja.prototype.interfaces_=function(){return[_r]},ja.prototype.getClass=function(){return ja},ja.getLocations=function(e){var i=new or;return e.apply(new ja(i)),i};var Zo=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new po,this._minDistanceLocation=null,this._minDistance=X.MAX_VALUE,2===arguments.length)this._geom=[arguments[0],arguments[1]],this._terminateDistance=0;else if(3===arguments.length){var h=arguments[0],d=arguments[1],x=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=h,this._geom[1]=d,this._terminateDistance=x}};Zo.prototype.computeContainmentDistance=function(){if(0===arguments.length){var e=new Array(2).fill(null);if(this.computeContainmentDistance(0,e),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,e)}else if(2===arguments.length){var i=arguments[0],h=arguments[1],d=1-i,x=Ea.getPolygons(this._geom[i]);if(x.size()>0){var L=ja.getLocations(this._geom[d]);if(this.computeContainmentDistance(L,x,h),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[d]=h[0],this._minDistanceLocation[i]=h[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&Ie(arguments[0],On)&&Ie(arguments[1],On)){for(var F=arguments[0],K=arguments[1],Mt=arguments[2],Qt=0;Qt<F.size();Qt++)for(var ke=F.get(Qt),Ge=0;Ge<K.size();Ge++)if(this.computeContainmentDistance(ke,K.get(Ge),Mt),this._minDistance<=this._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof bn&&arguments[1]instanceof En){var gr=arguments[0],Ir=arguments[1],jr=arguments[2],ln=gr.getCoordinate();if(gt.EXTERIOR!==this._ptLocator.locate(ln,Ir))return this._minDistance=0,jr[0]=gr,jr[1]=new bn(Ir,ln),null}},Zo.prototype.computeMinDistanceLinesPoints=function(e,i,h){for(var d=0;d<e.size();d++)for(var x=e.get(d),L=0;L<i.size();L++){var F=i.get(L);if(this.computeMinDistance(x,F,h),this._minDistance<=this._terminateDistance)return null}},Zo.prototype.computeFacetDistance=function(){var e=new Array(2).fill(null),i=Po.getLines(this._geom[0]),h=Po.getLines(this._geom[1]),d=Va.getPoints(this._geom[0]),x=Va.getPoints(this._geom[1]);return this.computeMinDistanceLines(i,h,e),this.updateMinDistance(e,!1),this._minDistance<=this._terminateDistance?null:(e[0]=null,e[1]=null,this.computeMinDistanceLinesPoints(i,x,e),this.updateMinDistance(e,!1),this._minDistance<=this._terminateDistance?null:(e[0]=null,e[1]=null,this.computeMinDistanceLinesPoints(h,d,e),this.updateMinDistance(e,!0),this._minDistance<=this._terminateDistance?null:(e[0]=null,e[1]=null,this.computeMinDistancePoints(d,x,e),void this.updateMinDistance(e,!1))))},Zo.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation},Zo.prototype.updateMinDistance=function(e,i){if(null===e[0])return null;i?(this._minDistanceLocation[0]=e[1],this._minDistanceLocation[1]=e[0]):(this._minDistanceLocation[0]=e[0],this._minDistanceLocation[1]=e[1])},Zo.prototype.nearestPoints=function(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]},Zo.prototype.computeMinDistance=function(){if(0===arguments.length){if(null!==this._minDistanceLocation||(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance))return null;this.computeFacetDistance()}else if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof Nr&&arguments[1]instanceof ri){var e=arguments[0],i=arguments[1],h=arguments[2];if(e.getEnvelopeInternal().distance(i.getEnvelopeInternal())>this._minDistance)return null;for(var d=e.getCoordinates(),x=i.getCoordinate(),L=0;L<d.length-1;L++){var F=Xe.distancePointLine(x,d[L],d[L+1]);if(F<this._minDistance){this._minDistance=F;var K=new Jr(d[L],d[L+1]).closestPoint(x);h[0]=new bn(e,L,K),h[1]=new bn(i,0,x)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Nr&&arguments[1]instanceof Nr){var Mt=arguments[0],Qt=arguments[1],ke=arguments[2];if(Mt.getEnvelopeInternal().distance(Qt.getEnvelopeInternal())>this._minDistance)return null;for(var Ge=Mt.getCoordinates(),gr=Qt.getCoordinates(),Ir=0;Ir<Ge.length-1;Ir++)for(var jr=0;jr<gr.length-1;jr++){var ln=Xe.distanceLineLine(Ge[Ir],Ge[Ir+1],gr[jr],gr[jr+1]);if(ln<this._minDistance){this._minDistance=ln;var Mi=new Jr(Ge[Ir],Ge[Ir+1]),l=new Jr(gr[jr],gr[jr+1]),f=Mi.closestPoints(l);ke[0]=new bn(Mt,Ir,f[0]),ke[1]=new bn(Qt,jr,f[1])}if(this._minDistance<=this._terminateDistance)return null}}},Zo.prototype.computeMinDistancePoints=function(e,i,h){for(var d=0;d<e.size();d++)for(var x=e.get(d),L=0;L<i.size();L++){var F=i.get(L),K=x.getCoordinate().distance(F.getCoordinate());if(K<this._minDistance&&(this._minDistance=K,h[0]=new bn(x,0,x.getCoordinate()),h[1]=new bn(F,0,F.getCoordinate())),this._minDistance<=this._terminateDistance)return null}},Zo.prototype.distance=function(){if(null===this._geom[0]||null===this._geom[1])throw new tt("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)},Zo.prototype.computeMinDistanceLines=function(e,i,h){for(var d=0;d<e.size();d++)for(var x=e.get(d),L=0;L<i.size();L++){var F=i.get(L);if(this.computeMinDistance(x,F,h),this._minDistance<=this._terminateDistance)return null}},Zo.prototype.interfaces_=function(){return[]},Zo.prototype.getClass=function(){return Zo},Zo.distance=function(e,i){return new Zo(e,i).distance()},Zo.isWithinDistance=function(e,i,h){return new Zo(e,i,h).distance()<=h},Zo.nearestPoints=function(e,i){return new Zo(e,i).nearestPoints()};var fo=function(){this._pt=[new j,new j],this._distance=X.NaN,this._isNull=!0};fo.prototype.getCoordinates=function(){return this._pt},fo.prototype.getCoordinate=function(e){return this._pt[e]},fo.prototype.setMinimum=function(){if(1===arguments.length){var e=arguments[0];this.setMinimum(e._pt[0],e._pt[1])}else if(2===arguments.length){var i=arguments[0],h=arguments[1];if(this._isNull)return this.initialize(i,h),null;var d=i.distance(h);d<this._distance&&this.initialize(i,h,d)}},fo.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var e=arguments[0],i=arguments[1];this._pt[0].setCoordinate(e),this._pt[1].setCoordinate(i),this._distance=e.distance(i),this._isNull=!1}else if(3===arguments.length){var d=arguments[1],x=arguments[2];this._pt[0].setCoordinate(arguments[0]),this._pt[1].setCoordinate(d),this._distance=x,this._isNull=!1}},fo.prototype.toString=function(){return Kt.toLineString(this._pt[0],this._pt[1])},fo.prototype.getDistance=function(){return this._distance},fo.prototype.setMaximum=function(){if(1===arguments.length){var e=arguments[0];this.setMaximum(e._pt[0],e._pt[1])}else if(2===arguments.length){var i=arguments[0],h=arguments[1];if(this._isNull)return this.initialize(i,h),null;var d=i.distance(h);d>this._distance&&this.initialize(i,h,d)}},fo.prototype.interfaces_=function(){return[]},fo.prototype.getClass=function(){return fo};var ts=function(){};ts.prototype.interfaces_=function(){return[]},ts.prototype.getClass=function(){return ts},ts.computeDistance=function(){if(arguments[2]instanceof fo&&arguments[0]instanceof Nr&&arguments[1]instanceof j)for(var e=arguments[0],i=arguments[1],h=arguments[2],d=new Jr,x=e.getCoordinates(),L=0;L<x.length-1;L++){d.setCoordinates(x[L],x[L+1]);var F=d.closestPoint(i);h.setMinimum(F,i)}else if(arguments[2]instanceof fo&&arguments[0]instanceof En&&arguments[1]instanceof j){var K=arguments[0],Mt=arguments[1],Qt=arguments[2];ts.computeDistance(K.getExteriorRing(),Mt,Qt);for(var ke=0;ke<K.getNumInteriorRing();ke++)ts.computeDistance(K.getInteriorRingN(ke),Mt,Qt)}else if(arguments[2]instanceof fo&&arguments[0]instanceof pr&&arguments[1]instanceof j){var Ge=arguments[0],gr=arguments[1],Ir=arguments[2];if(Ge instanceof Nr)ts.computeDistance(Ge,gr,Ir);else if(Ge instanceof En)ts.computeDistance(Ge,gr,Ir);else if(Ge instanceof He)for(var jr=Ge,ln=0;ln<jr.getNumGeometries();ln++){var Mi=jr.getGeometryN(ln);ts.computeDistance(Mi,gr,Ir)}else Ir.setMinimum(Ge.getCoordinate(),gr)}else if(arguments[2]instanceof fo&&arguments[0]instanceof Jr&&arguments[1]instanceof j){var f=arguments[1],c=arguments[2],m=arguments[0].closestPoint(f);c.setMinimum(m,f)}};var es=function(){this._g0=null,this._g1=null,this._ptDist=new fo,this._densifyFrac=0;var i=arguments[1];this._g0=arguments[0],this._g1=i},qu={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};es.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()},es.prototype.setDensifyFraction=function(e){if(e>1||e<=0)throw new tt("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=e},es.prototype.compute=function(e,i){this.computeOrientedDistance(e,i,this._ptDist),this.computeOrientedDistance(i,e,this._ptDist)},es.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()},es.prototype.computeOrientedDistance=function(e,i,h){var d=new tu(i);if(e.apply(d),h.setMaximum(d.getMaxPointDistance()),this._densifyFrac>0){var x=new ws(i,this._densifyFrac);e.apply(x),h.setMaximum(x.getMaxPointDistance())}},es.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()},es.prototype.interfaces_=function(){return[]},es.prototype.getClass=function(){return es},es.distance=function(){if(2===arguments.length)return new es(arguments[0],arguments[1]).distance();if(3===arguments.length){var x=arguments[2],L=new es(arguments[0],arguments[1]);return L.setDensifyFraction(x),L.distance()}},qu.MaxPointDistanceFilter.get=function(){return tu},qu.MaxDensifiedByFractionDistanceFilter.get=function(){return ws},Object.defineProperties(es,qu);var tu=function(){this._maxPtDist=new fo,this._minPtDist=new fo,this._euclideanDist=new ts,this._geom=null,this._geom=arguments[0]};tu.prototype.filter=function(e){this._minPtDist.initialize(),ts.computeDistance(this._geom,e,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},tu.prototype.getMaxPointDistance=function(){return this._maxPtDist},tu.prototype.interfaces_=function(){return[Kn]},tu.prototype.getClass=function(){return tu};var ws=function(){this._maxPtDist=new fo,this._minPtDist=new fo,this._geom=null,this._numSubSegs=0;var i=arguments[1];this._geom=arguments[0],this._numSubSegs=Math.trunc(Math.round(1/i))};ws.prototype.filter=function(e,i){if(0===i)return null;for(var h=e.getCoordinate(i-1),d=e.getCoordinate(i),x=(d.x-h.x)/this._numSubSegs,L=(d.y-h.y)/this._numSubSegs,F=0;F<this._numSubSegs;F++){var Qt=new j(h.x+F*x,h.y+F*L);this._minPtDist.initialize(),ts.computeDistance(this._geom,Qt,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}},ws.prototype.isDone=function(){return!1},ws.prototype.isGeometryChanged=function(){return!1},ws.prototype.getMaxPointDistance=function(){return this._maxPtDist},ws.prototype.interfaces_=function(){return[Pr]},ws.prototype.getClass=function(){return ws};var ao=function(e,i,h){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=e||null,this._bufDistance=i||null,this._result=h||null},rs={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};ao.prototype.checkMaximumDistance=function(e,i,h){var d=new es(i,e);if(d.setDensifyFraction(.25),this._maxDistanceFound=d.orientedDistance(),this._maxDistanceFound>h){this._isValid=!1;var x=d.getCoordinates();this._errorLocation=x[1],this._errorIndicator=e.getFactory().createLineString(x),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+Kt.toLineString(x[0],x[1])+")"}},ao.prototype.isValid=function(){var e=Math.abs(this._bufDistance),i=ao.MAX_DISTANCE_DIFF_FRAC*e;return this._minValidDistance=e-i,this._maxValidDistance=e+i,!(!this._input.isEmpty()&&!this._result.isEmpty())||(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),ao.VERBOSE&&Xr.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)},ao.prototype.checkNegativeValid=function(){if(!(this._input instanceof En||this._input instanceof Gr||this._input instanceof He))return null;var e=this.getPolygonLines(this._input);if(this.checkMinimumDistance(e,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(e,this._result,this._maxValidDistance)},ao.prototype.getErrorIndicator=function(){return this._errorIndicator},ao.prototype.checkMinimumDistance=function(e,i,h){var d=new Zo(e,i,h);if(this._minDistanceFound=d.distance(),this._minDistanceFound<h){this._isValid=!1;var x=d.nearestPoints();this._errorLocation=d.nearestPoints()[1],this._errorIndicator=e.getFactory().createLineString(x),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+Kt.toLineString(x[0],x[1])+" )"}},ao.prototype.checkPositiveValid=function(){var e=this._result.getBoundary();if(this.checkMinimumDistance(this._input,e,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,e,this._maxValidDistance)},ao.prototype.getErrorLocation=function(){return this._errorLocation},ao.prototype.getPolygonLines=function(e){for(var i=new or,h=new Po(i),d=Ea.getPolygons(e).iterator();d.hasNext();)d.next().apply(h);return e.getFactory().buildGeometry(i)},ao.prototype.getErrorMessage=function(){return this._errMsg},ao.prototype.interfaces_=function(){return[]},ao.prototype.getClass=function(){return ao},rs.VERBOSE.get=function(){return!1},rs.MAX_DISTANCE_DIFF_FRAC.get=function(){return.012},Object.defineProperties(ao,rs);var ra=function(e,i,h){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=e||null,this._distance=i||null,this._result=h||null},Za={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};ra.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid},ra.prototype.checkEnvelope=function(){if(this._distance<0)return null;var e=this._distance*ra.MAX_ENV_DIFF_FRAC;0===e&&(e=.001);var i=new qe(this._input.getEnvelopeInternal());i.expandBy(this._distance);var h=new qe(this._result.getEnvelopeInternal());h.expandBy(e),h.contains(i)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(h)),this.report("Envelope")},ra.prototype.checkDistance=function(){var e=new ao(this._input,this._distance,this._result);e.isValid()||(this._isValid=!1,this._errorMsg=e.getErrorMessage(),this._errorLocation=e.getErrorLocation(),this._errorIndicator=e.getErrorIndicator()),this.report("Distance")},ra.prototype.checkArea=function(){var e=this._input.getArea(),i=this._result.getArea();this._distance>0&&e>i&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&e<i&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")},ra.prototype.checkPolygonal=function(){this._result instanceof En||this._result instanceof Gr||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")},ra.prototype.getErrorIndicator=function(){return this._errorIndicator},ra.prototype.getErrorLocation=function(){return this._errorLocation},ra.prototype.checkExpectedEmpty=function(){return this._input.getDimension()>=2||this._distance>0?null:(this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),void this.report("ExpectedEmpty"))},ra.prototype.report=function(e){if(!ra.VERBOSE)return null;Xr.out.println("Check "+e+": "+(this._isValid?"passed":"FAILED"))},ra.prototype.getErrorMessage=function(){return this._errorMsg},ra.prototype.interfaces_=function(){return[]},ra.prototype.getClass=function(){return ra},ra.isValidMsg=function(e,i,h){var d=new ra(e,i,h);return d.isValid()?null:d.getErrorMessage()},ra.isValid=function(e,i,h){return!!new ra(e,i,h).isValid()},Za.VERBOSE.get=function(){return!1},Za.MAX_ENV_DIFF_FRAC.get=function(){return.012},Object.defineProperties(ra,Za);var Ko=function(){this._pts=null,this._data=null;var i=arguments[1];this._pts=arguments[0],this._data=i};Ko.prototype.getCoordinates=function(){return this._pts},Ko.prototype.size=function(){return this._pts.length},Ko.prototype.getCoordinate=function(e){return this._pts[e]},Ko.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},Ko.prototype.getSegmentOctant=function(e){return e===this._pts.length-1?-1:uu.octant(this.getCoordinate(e),this.getCoordinate(e+1))},Ko.prototype.setData=function(e){this._data=e},Ko.prototype.getData=function(){return this._data},Ko.prototype.toString=function(){return Kt.toLineString(new Hn(this._pts))},Ko.prototype.interfaces_=function(){return[wa]},Ko.prototype.getClass=function(){return Ko};var xr=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new or,this._intersectionCount=0,this._keepIntersections=!0,this._li=arguments[0],this._interiorIntersection=null};xr.prototype.getInteriorIntersection=function(){return this._interiorIntersection},xr.prototype.setCheckEndSegmentsOnly=function(e){this._isCheckEndSegmentsOnly=e},xr.prototype.getIntersectionSegments=function(){return this._intSegments},xr.prototype.count=function(){return this._intersectionCount},xr.prototype.getIntersections=function(){return this._intersections},xr.prototype.setFindAllIntersections=function(e){this._findAllIntersections=e},xr.prototype.setKeepIntersections=function(e){this._keepIntersections=e},xr.prototype.processIntersections=function(e,i,h,d){if(!this._findAllIntersections&&this.hasIntersection()||e===h&&i===d||this._isCheckEndSegmentsOnly&&!this.isEndSegment(e,i)&&!this.isEndSegment(h,d))return null;var x=e.getCoordinates()[i],L=e.getCoordinates()[i+1],F=h.getCoordinates()[d],K=h.getCoordinates()[d+1];this._li.computeIntersection(x,L,F,K),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=x,this._intSegments[1]=L,this._intSegments[2]=F,this._intSegments[3]=K,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)},xr.prototype.isEndSegment=function(e,i){return 0===i||i>=e.size()-2},xr.prototype.hasIntersection=function(){return null!==this._interiorIntersection},xr.prototype.isDone=function(){return!this._findAllIntersections&&null!==this._interiorIntersection},xr.prototype.interfaces_=function(){return[Pu]},xr.prototype.getClass=function(){return xr},xr.createAllIntersectionsFinder=function(e){var i=new xr(e);return i.setFindAllIntersections(!0),i},xr.createAnyIntersectionFinder=function(e){return new xr(e)},xr.createIntersectionCounter=function(e){var i=new xr(e);return i.setFindAllIntersections(!0),i.setKeepIntersections(!1),i};var Ls=function(){this._li=new De,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0,this._segStrings=arguments[0]};Ls.prototype.execute=function(){if(null!==this._segInt)return null;this.checkInteriorIntersections()},Ls.prototype.getIntersections=function(){return this._segInt.getIntersections()},Ls.prototype.isValid=function(){return this.execute(),this._isValid},Ls.prototype.setFindAllIntersections=function(e){this._findAllIntersections=e},Ls.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new xr(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var e=new Ms;if(e.setSegmentIntersector(this._segInt),e.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null},Ls.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new ur(this.getErrorMessage(),this._segInt.getInteriorIntersection())},Ls.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var e=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+Kt.toLineString(e[0],e[1])+" and "+Kt.toLineString(e[2],e[3])},Ls.prototype.interfaces_=function(){return[]},Ls.prototype.getClass=function(){return Ls},Ls.computeIntersections=function(e){var i=new Ls(e);return i.setFindAllIntersections(!0),i.isValid(),i.getIntersections()};var bu=function e(){this._nv=null,this._nv=new Ls(e.toSegmentStrings(arguments[0]))};bu.prototype.checkValid=function(){this._nv.checkValid()},bu.prototype.interfaces_=function(){return[]},bu.prototype.getClass=function(){return bu},bu.toSegmentStrings=function(e){for(var i=new or,h=e.iterator();h.hasNext();){var d=h.next();i.add(new Ko(d.getCoordinates(),d))}return i},bu.checkValid=function(e){new bu(e).checkValid()};var lu=function(e){this._mapOp=e};lu.prototype.map=function(e){for(var i=new or,h=0;h<e.getNumGeometries();h++){var d=this._mapOp.map(e.getGeometryN(h));d.isEmpty()||i.add(d)}return e.getFactory().createGeometryCollection(xn.toGeometryArray(i))},lu.prototype.interfaces_=function(){return[]},lu.prototype.getClass=function(){return lu},lu.map=function(e,i){return new lu(i).map(e)};var ua=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new or,this._resultLineList=new or;var i=arguments[1],h=arguments[2];this._op=arguments[0],this._geometryFactory=i,this._ptLocator=h};ua.prototype.collectLines=function(e){for(var i=this._op.getGraph().getEdgeEnds().iterator();i.hasNext();){var h=i.next();this.collectLineEdge(h,e,this._lineEdgesList),this.collectBoundaryTouchEdge(h,e,this._lineEdgesList)}},ua.prototype.labelIsolatedLine=function(e,i){var h=this._ptLocator.locate(e.getCoordinate(),this._op.getArgGeometry(i));e.getLabel().setLocation(i,h)},ua.prototype.build=function(e){return this.findCoveredLineEdges(),this.collectLines(e),this.buildLines(e),this._resultLineList},ua.prototype.collectLineEdge=function(e,i,h){var d=e.getLabel(),x=e.getEdge();e.isLineEdge()&&(e.isVisited()||!dn.isResultOfOp(d,i)||x.isCovered()||(h.add(x),e.setVisitedEdge(!0)))},ua.prototype.findCoveredLineEdges=function(){for(var e=this._op.getGraph().getNodes().iterator();e.hasNext();)e.next().getEdges().findCoveredLineEdges();for(var i=this._op.getGraph().getEdgeEnds().iterator();i.hasNext();){var h=i.next(),d=h.getEdge();if(h.isLineEdge()&&!d.isCoveredSet()){var x=this._op.isCoveredByA(h.getCoordinate());d.setCovered(x)}}},ua.prototype.labelIsolatedLines=function(e){for(var i=e.iterator();i.hasNext();){var h=i.next(),d=h.getLabel();h.isIsolated()&&(d.isNull(0)?this.labelIsolatedLine(h,0):this.labelIsolatedLine(h,1))}},ua.prototype.buildLines=function(e){for(var i=this._lineEdgesList.iterator();i.hasNext();){var h=i.next(),d=this._geometryFactory.createLineString(h.getCoordinates());this._resultLineList.add(d),h.setInResult(!0)}},ua.prototype.collectBoundaryTouchEdge=function(e,i,h){var d=e.getLabel();return e.isLineEdge()||e.isVisited()||e.isInteriorAreaEdge()||e.getEdge().isInResult()?null:(ot.isTrue(!(e.isInResult()||e.getSym().isInResult())||!e.getEdge().isInResult()),void(dn.isResultOfOp(d,i)&&i===dn.INTERSECTION&&(h.add(e.getEdge()),e.setVisitedEdge(!0))))},ua.prototype.interfaces_=function(){return[]},ua.prototype.getClass=function(){return ua};var Tu=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new or;var i=arguments[1];this._op=arguments[0],this._geometryFactory=i};Tu.prototype.filterCoveredNodeToPoint=function(e){var i=e.getCoordinate();if(!this._op.isCoveredByLA(i)){var h=this._geometryFactory.createPoint(i);this._resultPointList.add(h)}},Tu.prototype.extractNonCoveredResultNodes=function(e){for(var i=this._op.getGraph().getNodes().iterator();i.hasNext();){var h=i.next();if(!(h.isInResult()||h.isIncidentEdgeInResult()||0!==h.getEdges().getDegree()&&e!==dn.INTERSECTION)){var d=h.getLabel();dn.isResultOfOp(d,e)&&this.filterCoveredNodeToPoint(h)}}},Tu.prototype.build=function(e){return this.extractNonCoveredResultNodes(e),this._resultPointList},Tu.prototype.interfaces_=function(){return[]},Tu.prototype.getClass=function(){return Tu};var Co=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};Co.prototype.transformPoint=function(e,i){return this._factory.createPoint(this.transformCoordinates(e.getCoordinateSequence(),e))},Co.prototype.transformPolygon=function(e,i){var h=!0,d=this.transformLinearRing(e.getExteriorRing(),e);null!==d&&d instanceof li&&!d.isEmpty()||(h=!1);for(var x=new or,L=0;L<e.getNumInteriorRing();L++){var F=this.transformLinearRing(e.getInteriorRingN(L),e);null===F||F.isEmpty()||(F instanceof li||(h=!1),x.add(F))}if(h)return this._factory.createPolygon(d,x.toArray([]));var K=new or;return null!==d&&K.add(d),K.addAll(x),this._factory.buildGeometry(K)},Co.prototype.createCoordinateSequence=function(e){return this._factory.getCoordinateSequenceFactory().create(e)},Co.prototype.getInputGeometry=function(){return this._inputGeom},Co.prototype.transformMultiLineString=function(e,i){for(var h=new or,d=0;d<e.getNumGeometries();d++){var x=this.transformLineString(e.getGeometryN(d),e);null!==x&&(x.isEmpty()||h.add(x))}return this._factory.buildGeometry(h)},Co.prototype.transformCoordinates=function(e,i){return this.copy(e)},Co.prototype.transformLineString=function(e,i){return this._factory.createLineString(this.transformCoordinates(e.getCoordinateSequence(),e))},Co.prototype.transformMultiPoint=function(e,i){for(var h=new or,d=0;d<e.getNumGeometries();d++){var x=this.transformPoint(e.getGeometryN(d),e);null!==x&&(x.isEmpty()||h.add(x))}return this._factory.buildGeometry(h)},Co.prototype.transformMultiPolygon=function(e,i){for(var h=new or,d=0;d<e.getNumGeometries();d++){var x=this.transformPolygon(e.getGeometryN(d),e);null!==x&&(x.isEmpty()||h.add(x))}return this._factory.buildGeometry(h)},Co.prototype.copy=function(e){return e.copy()},Co.prototype.transformGeometryCollection=function(e,i){for(var h=new or,d=0;d<e.getNumGeometries();d++){var x=this.transform(e.getGeometryN(d));null!==x&&(this._pruneEmptyGeometry&&x.isEmpty()||h.add(x))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(xn.toGeometryArray(h)):this._factory.buildGeometry(h)},Co.prototype.transform=function(e){if(this._inputGeom=e,this._factory=e.getFactory(),e instanceof ri)return this.transformPoint(e,null);if(e instanceof ho)return this.transformMultiPoint(e,null);if(e instanceof li)return this.transformLinearRing(e,null);if(e instanceof Nr)return this.transformLineString(e,null);if(e instanceof yr)return this.transformMultiLineString(e,null);if(e instanceof En)return this.transformPolygon(e,null);if(e instanceof Gr)return this.transformMultiPolygon(e,null);if(e instanceof He)return this.transformGeometryCollection(e,null);throw new tt("Unknown Geometry subtype: "+e.getClass().getName())},Co.prototype.transformLinearRing=function(e,i){var h=this.transformCoordinates(e.getCoordinateSequence(),e);if(null===h)return this._factory.createLinearRing(null);var d=h.size();return d>0&&d<4&&!this._preserveType?this._factory.createLineString(h):this._factory.createLinearRing(h)},Co.prototype.interfaces_=function(){return[]},Co.prototype.getClass=function(){return Co};var Cr=function e(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new Jr,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Nr&&"number"==typeof arguments[1]){var h=arguments[1];e.call(this,arguments[0].getCoordinates(),h)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){var d=arguments[0],x=arguments[1];this._srcPts=d,this._isClosed=e.isClosed(d),this._snapTolerance=x}};Cr.prototype.snapVertices=function(e,i){for(var h=this._isClosed?e.size()-1:e.size(),d=0;d<h;d++){var x=e.get(d),L=this.findSnapForVertex(x,i);null!==L&&(e.set(d,new j(L)),0===d&&this._isClosed&&e.set(e.size()-1,new j(L)))}},Cr.prototype.findSnapForVertex=function(e,i){for(var h=0;h<i.length;h++){if(e.equals2D(i[h]))return null;if(e.distance(i[h])<this._snapTolerance)return i[h]}return null},Cr.prototype.snapTo=function(e){var i=new Y(this._srcPts);return this.snapVertices(i,e),this.snapSegments(i,e),i.toCoordinateArray()},Cr.prototype.snapSegments=function(e,i){if(0===i.length)return null;var h=i.length;i[0].equals2D(i[i.length-1])&&(h=i.length-1);for(var d=0;d<h;d++){var x=i[d],L=this.findSegmentIndexToSnap(x,e);L>=0&&e.add(L+1,new j(x),!1)}},Cr.prototype.findSegmentIndexToSnap=function(e,i){for(var h=X.MAX_VALUE,d=-1,x=0;x<i.size()-1;x++){if(this._seg.p0=i.get(x),this._seg.p1=i.get(x+1),this._seg.p0.equals2D(e)||this._seg.p1.equals2D(e)){if(this._allowSnappingToSourceVertices)continue;return-1}var L=this._seg.distance(e);L<this._snapTolerance&&L<h&&(h=L,d=x)}return d},Cr.prototype.setAllowSnappingToSourceVertices=function(e){this._allowSnappingToSourceVertices=e},Cr.prototype.interfaces_=function(){return[]},Cr.prototype.getClass=function(){return Cr},Cr.isClosed=function(e){return!(e.length<=1)&&e[0].equals2D(e[e.length-1])};var Xo=function(e){this._srcGeom=e||null},Zl={SNAP_PRECISION_FACTOR:{configurable:!0}};Xo.prototype.snapTo=function(e,i){var h=this.extractTargetCoordinates(e);return new wu(i,h).transform(this._srcGeom)},Xo.prototype.snapToSelf=function(e,i){var h=this.extractTargetCoordinates(this._srcGeom),d=new wu(e,h,!0).transform(this._srcGeom),x=d;return i&&Ie(x,qn)&&(x=d.buffer(0)),x},Xo.prototype.computeSnapTolerance=function(e){return this.computeMinimumSegmentLength(e)/10},Xo.prototype.extractTargetCoordinates=function(e){for(var i=new Yt,h=e.getCoordinates(),d=0;d<h.length;d++)i.add(h[d]);return i.toArray(new Array(0).fill(null))},Xo.prototype.computeMinimumSegmentLength=function(e){for(var i=X.MAX_VALUE,h=0;h<e.length-1;h++){var d=e[h].distance(e[h+1]);d<i&&(i=d)}return i},Xo.prototype.interfaces_=function(){return[]},Xo.prototype.getClass=function(){return Xo},Xo.snap=function(e,i,h){var d=new Array(2).fill(null),x=new Xo(e);d[0]=x.snapTo(i,h);var L=new Xo(i);return d[1]=L.snapTo(d[0],h),d},Xo.computeOverlaySnapTolerance=function(){if(1===arguments.length){var e=arguments[0],i=Xo.computeSizeBasedSnapTolerance(e),h=e.getPrecisionModel();if(h.getType()===Pn.FIXED){var d=1/h.getScale()*2/1.415;d>i&&(i=d)}return i}if(2===arguments.length){var L=arguments[1];return Math.min(Xo.computeOverlaySnapTolerance(arguments[0]),Xo.computeOverlaySnapTolerance(L))}},Xo.computeSizeBasedSnapTolerance=function(e){var i=e.getEnvelopeInternal();return Math.min(i.getHeight(),i.getWidth())*Xo.SNAP_PRECISION_FACTOR},Xo.snapToSelf=function(e,i,h){return new Xo(e).snapToSelf(i,h)},Zl.SNAP_PRECISION_FACTOR.get=function(){return 1e-9},Object.defineProperties(Xo,Zl);var wu=function(e){function i(h,d,x){e.call(this),this._snapTolerance=h||null,this._snapPts=d||null,this._isSelfSnap=void 0!==x&&x}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.snapLine=function(h,d){var x=new Cr(h,this._snapTolerance);return x.setAllowSnappingToSourceVertices(this._isSelfSnap),x.snapTo(d)},i.prototype.transformCoordinates=function(h,d){var x=h.toCoordinateArray(),L=this.snapLine(x,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(L)},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i}(Co),go=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};go.prototype.getCommon=function(){return X.longBitsToDouble(this._commonBits)},go.prototype.add=function(e){var i=X.doubleToLongBits(e);return this._isFirst?(this._commonBits=i,this._commonSignExp=go.signExpBits(this._commonBits),this._isFirst=!1,null):go.signExpBits(i)!==this._commonSignExp?(this._commonBits=0,null):(this._commonMantissaBitsCount=go.numCommonMostSigMantissaBits(this._commonBits,i),void(this._commonBits=go.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))))},go.prototype.toString=function(){if(1===arguments.length){var e=arguments[0],i=X.longBitsToDouble(e),h="0000000000000000000000000000000000000000000000000000000000000000"+X.toBinaryString(e),d=h.substring(h.length-64);return d.substring(0,1)+"  "+d.substring(1,12)+"(exp) "+d.substring(12)+" [ "+i+" ]"}},go.prototype.interfaces_=function(){return[]},go.prototype.getClass=function(){return go},go.getBit=function(e,i){return 0!=(e&1<<i)?1:0},go.signExpBits=function(e){return e>>52},go.zeroLowerBits=function(e,i){return e&~((1<<i)-1)},go.numCommonMostSigMantissaBits=function(e,i){for(var h=0,d=52;d>=0;d--){if(go.getBit(e,d)!==go.getBit(i,d))return h;h++}return 52};var Au=function(){this._commonCoord=null,this._ccFilter=new rl},ac={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};Au.prototype.addCommonBits=function(e){var i=new Sa(this._commonCoord);e.apply(i),e.geometryChanged()},Au.prototype.removeCommonBits=function(e){if(0===this._commonCoord.x&&0===this._commonCoord.y)return e;var i=new j(this._commonCoord);i.x=-i.x,i.y=-i.y;var h=new Sa(i);return e.apply(h),e.geometryChanged(),e},Au.prototype.getCommonCoordinate=function(){return this._commonCoord},Au.prototype.add=function(e){e.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()},Au.prototype.interfaces_=function(){return[]},Au.prototype.getClass=function(){return Au},ac.CommonCoordinateFilter.get=function(){return rl},ac.Translater.get=function(){return Sa},Object.defineProperties(Au,ac);var rl=function(){this._commonBitsX=new go,this._commonBitsY=new go};rl.prototype.filter=function(e){this._commonBitsX.add(e.x),this._commonBitsY.add(e.y)},rl.prototype.getCommonCoordinate=function(){return new j(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())},rl.prototype.interfaces_=function(){return[Kn]},rl.prototype.getClass=function(){return rl};var Sa=function(){this.trans=null,this.trans=arguments[0]};Sa.prototype.filter=function(e,i){var h=e.getOrdinate(i,0)+this.trans.x,d=e.getOrdinate(i,1)+this.trans.y;e.setOrdinate(i,0,h),e.setOrdinate(i,1,d)},Sa.prototype.isDone=function(){return!1},Sa.prototype.isGeometryChanged=function(){return!0},Sa.prototype.interfaces_=function(){return[Pr]},Sa.prototype.getClass=function(){return Sa};var Uo=function(e,i){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=e,this._geom[1]=i,this.computeSnapTolerance()};Uo.prototype.selfSnap=function(e){return new Xo(e).snapTo(e,this._snapTolerance)},Uo.prototype.removeCommonBits=function(e){this._cbr=new Au,this._cbr.add(e[0]),this._cbr.add(e[1]);var i=new Array(2).fill(null);return i[0]=this._cbr.removeCommonBits(e[0].copy()),i[1]=this._cbr.removeCommonBits(e[1].copy()),i},Uo.prototype.prepareResult=function(e){return this._cbr.addCommonBits(e),e},Uo.prototype.getResultGeometry=function(e){var i=this.snap(this._geom),h=dn.overlayOp(i[0],i[1],e);return this.prepareResult(h)},Uo.prototype.checkValid=function(e){e.isValid()||Xr.out.println("Snapped geometry is invalid")},Uo.prototype.computeSnapTolerance=function(){this._snapTolerance=Xo.computeOverlaySnapTolerance(this._geom[0],this._geom[1])},Uo.prototype.snap=function(e){var i=this.removeCommonBits(e);return Xo.snap(i[0],i[1],this._snapTolerance)},Uo.prototype.interfaces_=function(){return[]},Uo.prototype.getClass=function(){return Uo},Uo.overlayOp=function(e,i,h){return new Uo(e,i).getResultGeometry(h)},Uo.union=function(e,i){return Uo.overlayOp(e,i,dn.UNION)},Uo.intersection=function(e,i){return Uo.overlayOp(e,i,dn.INTERSECTION)},Uo.symDifference=function(e,i){return Uo.overlayOp(e,i,dn.SYMDIFFERENCE)},Uo.difference=function(e,i){return Uo.overlayOp(e,i,dn.DIFFERENCE)};var Xa=function(e,i){this._geom=new Array(2).fill(null),this._geom[0]=e,this._geom[1]=i};Xa.prototype.getResultGeometry=function(e){var i=null,h=!1,d=null;try{i=dn.overlayOp(this._geom[0],this._geom[1],e),h=!0}catch(x){if(!(x instanceof st))throw x;d=x}if(!h)try{i=Uo.overlayOp(this._geom[0],this._geom[1],e)}catch(x){throw x instanceof st?d:x}return i},Xa.prototype.interfaces_=function(){return[]},Xa.prototype.getClass=function(){return Xa},Xa.overlayOp=function(e,i,h){return new Xa(e,i).getResultGeometry(h)},Xa.union=function(e,i){return Xa.overlayOp(e,i,dn.UNION)},Xa.intersection=function(e,i){return Xa.overlayOp(e,i,dn.INTERSECTION)},Xa.symDifference=function(e,i){return Xa.overlayOp(e,i,dn.SYMDIFFERENCE)},Xa.difference=function(e,i){return Xa.overlayOp(e,i,dn.DIFFERENCE)};var bl=function(){this.mce=null,this.chainIndex=null;var i=arguments[1];this.mce=arguments[0],this.chainIndex=i};bl.prototype.computeIntersections=function(e,i){this.mce.computeIntersectsForChain(this.chainIndex,e.mce,e.chainIndex,i)},bl.prototype.interfaces_=function(){return[]},bl.prototype.getClass=function(){return bl};var fs=function e(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){var i=arguments[0],h=arguments[1];this._eventType=e.DELETE,this._xValue=i,this._insertEvent=h}else if(3===arguments.length){var d=arguments[0],x=arguments[1],L=arguments[2];this._eventType=e.INSERT,this._label=d,this._xValue=x,this._obj=L}},eu={INSERT:{configurable:!0},DELETE:{configurable:!0}};fs.prototype.isDelete=function(){return this._eventType===fs.DELETE},fs.prototype.setDeleteEventIndex=function(e){this._deleteEventIndex=e},fs.prototype.getObject=function(){return this._obj},fs.prototype.compareTo=function(e){return this._xValue<e._xValue?-1:this._xValue>e._xValue?1:this._eventType<e._eventType?-1:this._eventType>e._eventType?1:0},fs.prototype.getInsertEvent=function(){return this._insertEvent},fs.prototype.isInsert=function(){return this._eventType===fs.INSERT},fs.prototype.isSameLabel=function(e){return null!==this._label&&this._label===e._label},fs.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex},fs.prototype.interfaces_=function(){return[H]},fs.prototype.getClass=function(){return fs},eu.INSERT.get=function(){return 1},eu.DELETE.get=function(){return 2},Object.defineProperties(fs,eu);var fl=function(){};fl.prototype.interfaces_=function(){return[]},fl.prototype.getClass=function(){return fl};var ai=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var i=arguments[1],h=arguments[2];this._li=arguments[0],this._includeProper=i,this._recordIsolated=h};ai.prototype.isTrivialIntersection=function(e,i,h,d){if(e===h&&1===this._li.getIntersectionNum()){if(ai.isAdjacentSegments(i,d))return!0;if(e.isClosed()){var x=e.getNumPoints()-1;if(0===i&&d===x||0===d&&i===x)return!0}}return!1},ai.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},ai.prototype.setIsDoneIfProperInt=function(e){this._isDoneWhenProperInt=e},ai.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},ai.prototype.isBoundaryPointInternal=function(e,i){for(var h=i.iterator();h.hasNext();){var d=h.next().getCoordinate();if(e.isIntersection(d))return!0}return!1},ai.prototype.hasProperIntersection=function(){return this._hasProper},ai.prototype.hasIntersection=function(){return this._hasIntersection},ai.prototype.isDone=function(){return this._isDone},ai.prototype.isBoundaryPoint=function(e,i){return!(null===i||!this.isBoundaryPointInternal(e,i[0])&&!this.isBoundaryPointInternal(e,i[1]))},ai.prototype.setBoundaryNodes=function(e,i){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=e,this._bdyNodes[1]=i},ai.prototype.addIntersections=function(e,i,h,d){if(e===h&&i===d)return null;this.numTests++;var x=e.getCoordinates()[i],L=e.getCoordinates()[i+1],F=h.getCoordinates()[d],K=h.getCoordinates()[d+1];this._li.computeIntersection(x,L,F,K),this._li.hasIntersection()&&(this._recordIsolated&&(e.setIsolated(!1),h.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(e,i,h,d)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(e.addIntersections(this._li,i,0),h.addIntersections(this._li,d,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))},ai.prototype.interfaces_=function(){return[]},ai.prototype.getClass=function(){return ai},ai.isAdjacentSegments=function(e,i){return 1===Math.abs(e-i)};var mo=function(e){function i(){e.call(this),this.events=new or,this.nOverlaps=null}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.prepareEvents=function(){Vn.sort(this.events);for(var h=0;h<this.events.size();h++){var d=this.events.get(h);d.isDelete()&&d.getInsertEvent().setDeleteEventIndex(h)}},i.prototype.computeIntersections=function(){if(1===arguments.length){var h=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var d=0;d<this.events.size();d++){var x=this.events.get(d);if(x.isInsert()&&this.processOverlaps(d,x.getDeleteEventIndex(),x,h),h.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof ai&&Ie(arguments[0],On)&&Ie(arguments[1],On)){var L=arguments[0],F=arguments[1],K=arguments[2];this.addEdges(L,L),this.addEdges(F,F),this.computeIntersections(K)}else if("boolean"==typeof arguments[2]&&Ie(arguments[0],On)&&arguments[1]instanceof ai){var Mt=arguments[0],Qt=arguments[1];arguments[2]?this.addEdges(Mt,null):this.addEdges(Mt),this.computeIntersections(Qt)}},i.prototype.addEdge=function(h,d){for(var x=h.getMonotoneChainEdge(),L=x.getStartIndexes(),F=0;F<L.length-1;F++){var K=new bl(x,F),Mt=new fs(d,x.getMinX(F),K);this.events.add(Mt),this.events.add(new fs(x.getMaxX(F),Mt))}},i.prototype.processOverlaps=function(h,d,x,L){for(var F=x.getObject(),K=h;K<d;K++){var Mt=this.events.get(K);if(Mt.isInsert()){var Qt=Mt.getObject();x.isSameLabel(Mt)||(F.computeIntersections(Qt,L),this.nOverlaps++)}}},i.prototype.addEdges=function(){if(1===arguments.length)for(var h=arguments[0].iterator();h.hasNext();){var d=h.next();this.addEdge(d,d)}else if(2===arguments.length)for(var L=arguments[1],F=arguments[0].iterator();F.hasNext();){var K=F.next();this.addEdge(K,L)}},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i}(fl),Ca=function(){this._min=X.POSITIVE_INFINITY,this._max=X.NEGATIVE_INFINITY},ru={NodeComparator:{configurable:!0}};Ca.prototype.getMin=function(){return this._min},Ca.prototype.intersects=function(e,i){return!(this._min>i||this._max<e)},Ca.prototype.getMax=function(){return this._max},Ca.prototype.toString=function(){return Kt.toLineString(new j(this._min,0),new j(this._max,0))},Ca.prototype.interfaces_=function(){return[]},Ca.prototype.getClass=function(){return Ca},ru.NodeComparator.get=function(){return Ds},Object.defineProperties(Ca,ru);var Ds=function(){};Ds.prototype.compare=function(e,i){var x=(e._min+e._max)/2,L=(i._min+i._max)/2;return x<L?-1:x>L?1:0},Ds.prototype.interfaces_=function(){return[at]},Ds.prototype.getClass=function(){return Ds};var wl=function(e){function i(){e.call(this),this._item=null;var d=arguments[1],x=arguments[2];this._min=arguments[0],this._max=d,this._item=x}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.query=function(h,d,x){if(!this.intersects(h,d))return null;x.visitItem(this._item)},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i}(Ca),Ju=function(e){function i(){e.call(this),this._node1=null,this._node2=null;var d=arguments[1];this._node1=arguments[0],this._node2=d,this.buildExtent(this._node1,this._node2)}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.buildExtent=function(h,d){this._min=Math.min(h._min,d._min),this._max=Math.max(h._max,d._max)},i.prototype.query=function(h,d,x){if(!this.intersects(h,d))return null;null!==this._node1&&this._node1.query(h,d,x),null!==this._node2&&this._node2.query(h,d,x)},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i}(Ca),ds=function(){this._leaves=new or,this._root=null,this._level=0};ds.prototype.buildTree=function(){Vn.sort(this._leaves,new Ca.NodeComparator);for(var e=this._leaves,i=null,h=new or;;){if(this.buildLevel(e,h),1===h.size())return h.get(0);i=e,e=h,h=i}},ds.prototype.insert=function(e,i,h){if(null!==this._root)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new wl(e,i,h))},ds.prototype.query=function(e,i,h){this.init(),this._root.query(e,i,h)},ds.prototype.buildRoot=function(){if(null!==this._root)return null;this._root=this.buildTree()},ds.prototype.printNode=function(e){Xr.out.println(Kt.toLineString(new j(e._min,this._level),new j(e._max,this._level)))},ds.prototype.init=function(){if(null!==this._root)return null;this.buildRoot()},ds.prototype.buildLevel=function(e,i){this._level++,i.clear();for(var h=0;h<e.size();h+=2){var d=e.get(h);if(null===(h+1<e.size()?e.get(h):null))i.add(d);else{var x=new Ju(e.get(h),e.get(h+1));i.add(x)}}},ds.prototype.interfaces_=function(){return[]},ds.prototype.getClass=function(){return ds};var Es=function(){this._items=new or};Es.prototype.visitItem=function(e){this._items.add(e)},Es.prototype.getItems=function(){return this._items},Es.prototype.interfaces_=function(){return[ba]},Es.prototype.getClass=function(){return Es};var Eu=function(){this._index=null;var e=arguments[0];if(!Ie(e,qn))throw new tt("Argument must be Polygonal");this._index=new Ia(e)},Tr={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};Eu.prototype.locate=function(e){var i=new nr(e),h=new mn(i);return this._index.query(e.y,e.y,h),i.getLocation()},Eu.prototype.interfaces_=function(){return[Bu]},Eu.prototype.getClass=function(){return Eu},Tr.SegmentVisitor.get=function(){return mn},Tr.IntervalIndexedGeometry.get=function(){return Ia},Object.defineProperties(Eu,Tr);var mn=function(){this._counter=null,this._counter=arguments[0]};mn.prototype.visitItem=function(e){var i=e;this._counter.countSegment(i.getCoordinate(0),i.getCoordinate(1))},mn.prototype.interfaces_=function(){return[ba]},mn.prototype.getClass=function(){return mn};var Ia=function(){this._index=new ds,this.init(arguments[0])};Ia.prototype.init=function(e){for(var i=Po.getLines(e).iterator();i.hasNext();){var h=i.next().getCoordinates();this.addLine(h)}},Ia.prototype.addLine=function(e){for(var i=1;i<e.length;i++){var h=new Jr(e[i-1],e[i]),d=Math.min(h.p0.y,h.p1.y),x=Math.max(h.p0.y,h.p1.y);this._index.insert(d,x,h)}},Ia.prototype.query=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1],h=new Es;return this._index.query(e,i,h),h.getItems()}3===arguments.length&&this._index.query(arguments[0],arguments[1],arguments[2])},Ia.prototype.interfaces_=function(){return[]},Ia.prototype.getClass=function(){return Ia};var Ss=function(e){function i(){if(e.call(this),this._parentGeom=null,this._lineEdgeMap=new su,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new po,2===arguments.length){var d=arguments[1],x=Gn.OGC_SFS_BOUNDARY_RULE;this._argIndex=arguments[0],this._parentGeom=d,this._boundaryNodeRule=x,null!==d&&this.add(d)}else if(3===arguments.length){var F=arguments[1],K=arguments[2];this._argIndex=arguments[0],this._parentGeom=F,this._boundaryNodeRule=K,null!==F&&this.add(F)}}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.insertBoundaryPoint=function(h,d){var x=this._nodes.addNode(d).getLabel(),L=1;x.getLocation(h,Bt.ON)===gt.BOUNDARY&&L++;var F=i.determineBoundary(this._boundaryNodeRule,L);x.setLocation(h,F)},i.prototype.computeSelfNodes=function(){if(2===arguments.length)return this.computeSelfNodes(arguments[0],arguments[1],!1);if(3===arguments.length){var L=arguments[1],F=arguments[2],K=new ai(arguments[0],!0,!1);return K.setIsDoneIfProperInt(F),this.createEdgeSetIntersector().computeIntersections(this._edges,K,L||!(this._parentGeom instanceof li||this._parentGeom instanceof En||this._parentGeom instanceof Gr)),this.addSelfIntersectionNodes(this._argIndex),K}},i.prototype.computeSplitEdges=function(h){for(var d=this._edges.iterator();d.hasNext();)d.next().eiList.addSplitEdges(h)},i.prototype.computeEdgeIntersections=function(h,d,x){var L=new ai(d,x,!0);return L.setBoundaryNodes(this.getBoundaryNodes(),h.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,h._edges,L),L},i.prototype.getGeometry=function(){return this._parentGeom},i.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},i.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},i.prototype.addPoint=function(){if(arguments[0]instanceof ri){var h=arguments[0].getCoordinate();this.insertPoint(this._argIndex,h,gt.INTERIOR)}else arguments[0]instanceof j&&this.insertPoint(this._argIndex,arguments[0],gt.INTERIOR)},i.prototype.addPolygon=function(h){this.addPolygonRing(h.getExteriorRing(),gt.EXTERIOR,gt.INTERIOR);for(var d=0;d<h.getNumInteriorRing();d++){var x=h.getInteriorRingN(d);this.addPolygonRing(x,gt.INTERIOR,gt.EXTERIOR)}},i.prototype.addEdge=function(h){this.insertEdge(h);var d=h.getCoordinates();this.insertPoint(this._argIndex,d[0],gt.BOUNDARY),this.insertPoint(this._argIndex,d[d.length-1],gt.BOUNDARY)},i.prototype.addLineString=function(h){var d=W.removeRepeatedPoints(h.getCoordinates());if(d.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=d[0],null;var x=new Ei(d,new hr(this._argIndex,gt.INTERIOR));this._lineEdgeMap.put(h,x),this.insertEdge(x),ot.isTrue(d.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,d[0]),this.insertBoundaryPoint(this._argIndex,d[d.length-1])},i.prototype.getInvalidPoint=function(){return this._invalidPoint},i.prototype.getBoundaryPoints=function(){for(var h=this.getBoundaryNodes(),d=new Array(h.size()).fill(null),x=0,L=h.iterator();L.hasNext();){var F=L.next();d[x++]=F.getCoordinate().copy()}return d},i.prototype.getBoundaryNodes=function(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},i.prototype.addSelfIntersectionNode=function(h,d,x){if(this.isBoundaryNode(h,d))return null;x===gt.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(h,d):this.insertPoint(h,d,x)},i.prototype.addPolygonRing=function(h,d,x){if(h.isEmpty())return null;var L=W.removeRepeatedPoints(h.getCoordinates());if(L.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=L[0],null;var F=d,K=x;Xe.isCCW(L)&&(F=x,K=d);var Mt=new Ei(L,new hr(this._argIndex,gt.BOUNDARY,F,K));this._lineEdgeMap.put(h,Mt),this.insertEdge(Mt),this.insertPoint(this._argIndex,L[0],gt.BOUNDARY)},i.prototype.insertPoint=function(h,d,x){var L=this._nodes.addNode(d),F=L.getLabel();null===F?L._label=new hr(h,x):F.setLocation(h,x)},i.prototype.createEdgeSetIntersector=function(){return new mo},i.prototype.addSelfIntersectionNodes=function(h){for(var d=this._edges.iterator();d.hasNext();)for(var x=d.next(),L=x.getLabel().getLocation(h),F=x.eiList.iterator();F.hasNext();){var K=F.next();this.addSelfIntersectionNode(h,K.coord,L)}},i.prototype.add=function(){if(1!==arguments.length)return e.prototype.add.apply(this,arguments);var h=arguments[0];if(h.isEmpty())return null;if(h instanceof Gr&&(this._useBoundaryDeterminationRule=!1),h instanceof En)this.addPolygon(h);else if(h instanceof Nr)this.addLineString(h);else if(h instanceof ri)this.addPoint(h);else if(h instanceof ho)this.addCollection(h);else if(h instanceof yr)this.addCollection(h);else if(h instanceof Gr)this.addCollection(h);else{if(!(h instanceof He))throw new Error(h.getClass().getName());this.addCollection(h)}},i.prototype.addCollection=function(h){for(var d=0;d<h.getNumGeometries();d++){var x=h.getGeometryN(d);this.add(x)}},i.prototype.locate=function(h){return Ie(this._parentGeom,qn)&&this._parentGeom.getNumGeometries()>50?(null===this._areaPtLocator&&(this._areaPtLocator=new Eu(this._parentGeom)),this._areaPtLocator.locate(h)):this._ptLocator.locate(h,this._parentGeom)},i.prototype.findEdge=function(){return 1===arguments.length?this._lineEdgeMap.get(arguments[0]):e.prototype.findEdge.apply(this,arguments)},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i.determineBoundary=function(h,d){return h.isInBoundary(d)?gt.BOUNDARY:gt.INTERIOR},i}(Qr),nu=function(){if(this._li=new De,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){var e=arguments[0];this.setComputationPrecision(e.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new Ss(0,e)}else if(2===arguments.length){var i=arguments[0],h=arguments[1],d=Gn.OGC_SFS_BOUNDARY_RULE;i.getPrecisionModel().compareTo(h.getPrecisionModel())>=0?this.setComputationPrecision(i.getPrecisionModel()):this.setComputationPrecision(h.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Ss(0,i,d),this._arg[1]=new Ss(1,h,d)}else if(3===arguments.length){var x=arguments[0],L=arguments[1],F=arguments[2];x.getPrecisionModel().compareTo(L.getPrecisionModel())>=0?this.setComputationPrecision(x.getPrecisionModel()):this.setComputationPrecision(L.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Ss(0,x,F),this._arg[1]=new Ss(1,L,F)}};nu.prototype.getArgGeometry=function(e){return this._arg[e].getGeometry()},nu.prototype.setComputationPrecision=function(e){this._resultPrecisionModel=e,this._li.setPrecisionModel(this._resultPrecisionModel)},nu.prototype.interfaces_=function(){return[]},nu.prototype.getClass=function(){return nu};var Ma=function(){};Ma.prototype.interfaces_=function(){return[]},Ma.prototype.getClass=function(){return Ma},Ma.map=function(){if(arguments[0]instanceof pr&&Ie(arguments[1],Ma.MapOp)){for(var e=arguments[0],i=arguments[1],h=new or,d=0;d<e.getNumGeometries();d++){var x=i.map(e.getGeometryN(d));null!==x&&h.add(x)}return e.getFactory().buildGeometry(h)}if(Ie(arguments[0],gi)&&Ie(arguments[1],Ma.MapOp)){for(var L=arguments[0],F=arguments[1],K=new or,Mt=L.iterator();Mt.hasNext();){var Qt=Mt.next(),ke=F.map(Qt);null!==ke&&K.add(ke)}return K}},Ma.MapOp=function(){};var dn=function(e){function i(){var h=arguments[0];e.call(this,h,arguments[1]),this._ptLocator=new po,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new qa,this._resultPolyList=new or,this._resultLineList=new or,this._resultPointList=new or,this._graph=new Qr(new kl),this._geomFact=h.getFactory()}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.insertUniqueEdge=function(h){var d=this._edgeList.findEqualEdge(h);if(null!==d){var x=d.getLabel(),L=h.getLabel();d.isPointwiseEqual(h)||(L=new hr(h.getLabel())).flip();var F=d.getDepth();F.isNull()&&F.add(x),F.add(L),x.merge(L)}else this._edgeList.add(h)},i.prototype.getGraph=function(){return this._graph},i.prototype.cancelDuplicateResultEdges=function(){for(var h=this._graph.getEdgeEnds().iterator();h.hasNext();){var d=h.next(),x=d.getSym();d.isInResult()&&x.isInResult()&&(d.setInResult(!1),x.setInResult(!1))}},i.prototype.isCoveredByLA=function(h){return!!this.isCovered(h,this._resultLineList)||!!this.isCovered(h,this._resultPolyList)},i.prototype.computeGeometry=function(h,d,x,L){var F=new or;return F.addAll(h),F.addAll(d),F.addAll(x),F.isEmpty()?i.createEmptyResult(L,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(F)},i.prototype.mergeSymLabels=function(){for(var h=this._graph.getNodes().iterator();h.hasNext();)h.next().getEdges().mergeSymLabels()},i.prototype.isCovered=function(h,d){for(var x=d.iterator();x.hasNext();){var L=x.next();if(this._ptLocator.locate(h,L)!==gt.EXTERIOR)return!0}return!1},i.prototype.replaceCollapsedEdges=function(){for(var h=new or,d=this._edgeList.iterator();d.hasNext();){var x=d.next();x.isCollapsed()&&(d.remove(),h.add(x.getCollapsedEdge()))}this._edgeList.addAll(h)},i.prototype.updateNodeLabelling=function(){for(var h=this._graph.getNodes().iterator();h.hasNext();){var d=h.next(),x=d.getEdges().getLabel();d.getLabel().merge(x)}},i.prototype.getResultGeometry=function(h){return this.computeOverlay(h),this._resultGeom},i.prototype.insertUniqueEdges=function(h){for(var d=h.iterator();d.hasNext();){var x=d.next();this.insertUniqueEdge(x)}},i.prototype.computeOverlay=function(h){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var d=new or;this._arg[0].computeSplitEdges(d),this._arg[1].computeSplitEdges(d),this.insertUniqueEdges(d),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),bu.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(h),this.cancelDuplicateResultEdges();var x=new ni(this._geomFact);x.add(this._graph),this._resultPolyList=x.getPolygons();var L=new ua(this,this._geomFact,this._ptLocator);this._resultLineList=L.build(h);var F=new Tu(this,this._geomFact,this._ptLocator);this._resultPointList=F.build(h),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,h)},i.prototype.labelIncompleteNode=function(h,d){var x=this._ptLocator.locate(h.getCoordinate(),this._arg[d].getGeometry());h.getLabel().setLocation(d,x)},i.prototype.copyPoints=function(h){for(var d=this._arg[h].getNodeIterator();d.hasNext();){var x=d.next();this._graph.addNode(x.getCoordinate()).setLabel(h,x.getLabel().getLocation(h))}},i.prototype.findResultAreaEdges=function(h){for(var d=this._graph.getEdgeEnds().iterator();d.hasNext();){var x=d.next(),L=x.getLabel();L.isArea()&&!x.isInteriorAreaEdge()&&i.isResultOfOp(L.getLocation(0,Bt.RIGHT),L.getLocation(1,Bt.RIGHT),h)&&x.setInResult(!0)}},i.prototype.computeLabelsFromDepths=function(){for(var h=this._edgeList.iterator();h.hasNext();){var d=h.next(),x=d.getLabel(),L=d.getDepth();if(!L.isNull()){L.normalize();for(var F=0;F<2;F++)x.isNull(F)||!x.isArea()||L.isNull(F)||(0===L.getDelta(F)?x.toLine(F):(ot.isTrue(!L.isNull(F,Bt.LEFT),"depth of LEFT side has not been initialized"),x.setLocation(F,Bt.LEFT,L.getLocation(F,Bt.LEFT)),ot.isTrue(!L.isNull(F,Bt.RIGHT),"depth of RIGHT side has not been initialized"),x.setLocation(F,Bt.RIGHT,L.getLocation(F,Bt.RIGHT))))}}},i.prototype.computeLabelling=function(){for(var h=this._graph.getNodes().iterator();h.hasNext();)h.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()},i.prototype.labelIncompleteNodes=function(){for(var h=this._graph.getNodes().iterator();h.hasNext();){var d=h.next(),x=d.getLabel();d.isIsolated()&&(x.isNull(0)?this.labelIncompleteNode(d,0):this.labelIncompleteNode(d,1)),d.getEdges().updateLabelling(x)}},i.prototype.isCoveredByA=function(h){return!!this.isCovered(h,this._resultPolyList)},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i}(nu);dn.overlayOp=function(e,i,h){return new dn(e,i).getResultGeometry(h)},dn.intersection=function(e,i){if(e.isEmpty()||i.isEmpty())return dn.createEmptyResult(dn.INTERSECTION,e,i,e.getFactory());if(e.isGeometryCollection()){var h=i;return lu.map(e,{interfaces_:function(){return[Ma.MapOp]},map:function(d){return d.intersection(h)}})}return e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(i),Xa.overlayOp(e,i,dn.INTERSECTION)},dn.symDifference=function(e,i){if(e.isEmpty()||i.isEmpty()){if(e.isEmpty()&&i.isEmpty())return dn.createEmptyResult(dn.SYMDIFFERENCE,e,i,e.getFactory());if(e.isEmpty())return i.copy();if(i.isEmpty())return e.copy()}return e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(i),Xa.overlayOp(e,i,dn.SYMDIFFERENCE)},dn.resultDimension=function(e,i,h){var d=i.getDimension(),x=h.getDimension(),L=-1;switch(e){case dn.INTERSECTION:L=Math.min(d,x);break;case dn.UNION:L=Math.max(d,x);break;case dn.DIFFERENCE:L=d;break;case dn.SYMDIFFERENCE:L=Math.max(d,x)}return L},dn.createEmptyResult=function(e,i,h,d){var x=null;switch(dn.resultDimension(e,i,h)){case-1:x=d.createGeometryCollection(new Array(0).fill(null));break;case 0:x=d.createPoint();break;case 1:x=d.createLineString();break;case 2:x=d.createPolygon()}return x},dn.difference=function(e,i){return e.isEmpty()?dn.createEmptyResult(dn.DIFFERENCE,e,i,e.getFactory()):i.isEmpty()?e.copy():(e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(i),Xa.overlayOp(e,i,dn.DIFFERENCE))},dn.isResultOfOp=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1],h=e.getLocation(0),d=e.getLocation(1);return dn.isResultOfOp(h,d,i)}if(3===arguments.length){var x=arguments[0],L=arguments[1];switch(x===gt.BOUNDARY&&(x=gt.INTERIOR),L===gt.BOUNDARY&&(L=gt.INTERIOR),arguments[2]){case dn.INTERSECTION:return x===gt.INTERIOR&&L===gt.INTERIOR;case dn.UNION:return x===gt.INTERIOR||L===gt.INTERIOR;case dn.DIFFERENCE:return x===gt.INTERIOR&&L!==gt.INTERIOR;case dn.SYMDIFFERENCE:return x===gt.INTERIOR&&L!==gt.INTERIOR||x!==gt.INTERIOR&&L===gt.INTERIOR}return!1}},dn.INTERSECTION=1,dn.UNION=2,dn.DIFFERENCE=3,dn.SYMDIFFERENCE=4;var Lu=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new po,this._seg=new Jr;var e=arguments[0],i=arguments[1];this._g=e,this._boundaryDistanceTolerance=i,this._linework=this.extractLinework(e)};Lu.prototype.isWithinToleranceOfBoundary=function(e){for(var i=0;i<this._linework.getNumGeometries();i++)for(var h=this._linework.getGeometryN(i).getCoordinateSequence(),d=0;d<h.size()-1;d++)if(h.getCoordinate(d,this._seg.p0),h.getCoordinate(d+1,this._seg.p1),this._seg.distance(e)<=this._boundaryDistanceTolerance)return!0;return!1},Lu.prototype.getLocation=function(e){return this.isWithinToleranceOfBoundary(e)?gt.BOUNDARY:this._ptLocator.locate(e,this._g)},Lu.prototype.extractLinework=function(e){var i=new cu;e.apply(i);var h=i.getLinework(),d=xn.toLineStringArray(h);return e.getFactory().createMultiLineString(d)},Lu.prototype.interfaces_=function(){return[]},Lu.prototype.getClass=function(){return Lu};var cu=function(){this._linework=null,this._linework=new or};cu.prototype.getLinework=function(){return this._linework},cu.prototype.filter=function(e){if(e instanceof En){var i=e;this._linework.add(i.getExteriorRing());for(var h=0;h<i.getNumInteriorRing();h++)this._linework.add(i.getInteriorRingN(h))}},cu.prototype.interfaces_=function(){return[_r]},cu.prototype.getClass=function(){return cu};var Si=function(){this._g=null,this._doLeft=!0,this._doRight=!0,this._g=arguments[0]};Si.prototype.extractPoints=function(e,i,h){for(var d=e.getCoordinates(),x=0;x<d.length-1;x++)this.computeOffsetPoints(d[x],d[x+1],i,h)},Si.prototype.setSidesToGenerate=function(e,i){this._doLeft=e,this._doRight=i},Si.prototype.getPoints=function(e){for(var i=new or,h=Po.getLines(this._g).iterator();h.hasNext();){var d=h.next();this.extractPoints(d,e,i)}return i},Si.prototype.computeOffsetPoints=function(e,i,h,d){var x=i.x-e.x,L=i.y-e.y,F=Math.sqrt(x*x+L*L),K=h*x/F,Mt=h*L/F,Qt=(i.x+e.x)/2,ke=(i.y+e.y)/2;if(this._doLeft){var Ge=new j(Qt-Mt,ke+K);d.add(Ge)}if(this._doRight){var gr=new j(Qt+Mt,ke-K);d.add(gr)}},Si.prototype.interfaces_=function(){return[]},Si.prototype.getClass=function(){return Si};var bo=function e(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=e.TOLERANCE,this._testCoords=new or;var i=arguments[0],h=arguments[1],d=arguments[2];this._boundaryDistanceTolerance=e.computeBoundaryDistanceTolerance(i,h),this._geom=[i,h,d],this._locFinder=[new Lu(this._geom[0],this._boundaryDistanceTolerance),new Lu(this._geom[1],this._boundaryDistanceTolerance),new Lu(this._geom[2],this._boundaryDistanceTolerance)]},sc={TOLERANCE:{configurable:!0}};bo.prototype.reportResult=function(e,i,h){Xr.out.println("Overlay result invalid - A:"+gt.toLocationSymbol(i[0])+" B:"+gt.toLocationSymbol(i[1])+" expected:"+(h?"i":"e")+" actual:"+gt.toLocationSymbol(i[2]))},bo.prototype.isValid=function(e){return this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]),this.checkValid(e)},bo.prototype.checkValid=function(){if(1===arguments.length){for(var e=arguments[0],i=0;i<this._testCoords.size();i++){var h=this._testCoords.get(i);if(!this.checkValid(e,h))return this._invalidLocation=h,!1}return!0}if(2===arguments.length){var d=arguments[0],x=arguments[1];return this._location[0]=this._locFinder[0].getLocation(x),this._location[1]=this._locFinder[1].getLocation(x),this._location[2]=this._locFinder[2].getLocation(x),!!bo.hasLocation(this._location,gt.BOUNDARY)||this.isValidResult(d,this._location)}},bo.prototype.addTestPts=function(e){var i=new Si(e);this._testCoords.addAll(i.getPoints(5*this._boundaryDistanceTolerance))},bo.prototype.isValidResult=function(e,i){var h=dn.isResultOfOp(i[0],i[1],e),d=!(h^i[2]===gt.INTERIOR);return d||this.reportResult(e,i,h),d},bo.prototype.getInvalidLocation=function(){return this._invalidLocation},bo.prototype.interfaces_=function(){return[]},bo.prototype.getClass=function(){return bo},bo.hasLocation=function(e,i){for(var h=0;h<3;h++)if(e[h]===i)return!0;return!1},bo.computeBoundaryDistanceTolerance=function(e,i){return Math.min(Xo.computeSizeBasedSnapTolerance(e),Xo.computeSizeBasedSnapTolerance(i))},bo.isValid=function(e,i,h,d){return new bo(e,i,d).isValid(h)},sc.TOLERANCE.get=function(){return 1e-6},Object.defineProperties(bo,sc);var gs=function e(i){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=e.extractFactory(i),this._inputGeoms=i};gs.prototype.extractElements=function(e,i){if(null===e)return null;for(var h=0;h<e.getNumGeometries();h++){var d=e.getGeometryN(h);this._skipEmpty&&d.isEmpty()||i.add(d)}},gs.prototype.combine=function(){for(var e=new or,i=this._inputGeoms.iterator();i.hasNext();){var h=i.next();this.extractElements(h,e)}return 0===e.size()?null!==this._geomFactory?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(e)},gs.prototype.interfaces_=function(){return[]},gs.prototype.getClass=function(){return gs},gs.combine=function(){return 1===arguments.length?new gs(arguments[0]).combine():2===arguments.length?new gs(gs.createList(arguments[0],arguments[1])).combine():3===arguments.length?new gs(gs.createList(arguments[0],arguments[1],arguments[2])).combine():void 0},gs.extractFactory=function(e){return e.isEmpty()?null:e.iterator().next().getFactory()},gs.createList=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1],h=new or;return h.add(e),h.add(i),h}if(3===arguments.length){var d=arguments[0],x=arguments[1],L=arguments[2],F=new or;return F.add(d),F.add(x),F.add(L),F}};var Io=function(){this._inputPolys=null,this._geomFactory=null,this._inputPolys=arguments[0],null===this._inputPolys&&(this._inputPolys=new or)},iu={STRTREE_NODE_CAPACITY:{configurable:!0}};Io.prototype.reduceToGeometries=function(e){for(var i=new or,h=e.iterator();h.hasNext();){var d=h.next(),x=null;Ie(d,On)?x=this.unionTree(d):d instanceof pr&&(x=d),i.add(x)}return i},Io.prototype.extractByEnvelope=function(e,i,h){for(var d=new or,x=0;x<i.getNumGeometries();x++){var L=i.getGeometryN(x);L.getEnvelopeInternal().intersects(e)?d.add(L):h.add(L)}return this._geomFactory.buildGeometry(d)},Io.prototype.unionOptimized=function(e,i){var h=e.getEnvelopeInternal(),d=i.getEnvelopeInternal();if(!h.intersects(d))return gs.combine(e,i);if(e.getNumGeometries()<=1&&i.getNumGeometries()<=1)return this.unionActual(e,i);var x=h.intersection(d);return this.unionUsingEnvelopeIntersection(e,i,x)},Io.prototype.union=function(){if(null===this._inputPolys)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var e=new Ol(Io.STRTREE_NODE_CAPACITY),i=this._inputPolys.iterator();i.hasNext();){var h=i.next();e.insert(h.getEnvelopeInternal(),h)}this._inputPolys=null;var d=e.itemsTree();return this.unionTree(d)},Io.prototype.binaryUnion=function(){if(1===arguments.length){var e=arguments[0];return this.binaryUnion(e,0,e.size())}if(3===arguments.length){var i=arguments[0],h=arguments[1],d=arguments[2];if(d-h<=1){var x=Io.getGeometry(i,h);return this.unionSafe(x,null)}if(d-h==2)return this.unionSafe(Io.getGeometry(i,h),Io.getGeometry(i,h+1));var L=Math.trunc((d+h)/2),F=this.binaryUnion(i,h,L),K=this.binaryUnion(i,L,d);return this.unionSafe(F,K)}},Io.prototype.repeatedUnion=function(e){for(var i=null,h=e.iterator();h.hasNext();){var d=h.next();i=null===i?d.copy():i.union(d)}return i},Io.prototype.unionSafe=function(e,i){return null===e&&null===i?null:null===e?i.copy():null===i?e.copy():this.unionOptimized(e,i)},Io.prototype.unionActual=function(e,i){return Io.restrictToPolygons(e.union(i))},Io.prototype.unionTree=function(e){var i=this.reduceToGeometries(e);return this.binaryUnion(i)},Io.prototype.unionUsingEnvelopeIntersection=function(e,i,h){var d=new or,x=this.extractByEnvelope(h,e,d),L=this.extractByEnvelope(h,i,d),F=this.unionActual(x,L);return d.add(F),gs.combine(d)},Io.prototype.bufferUnion=function(){if(1===arguments.length){var e=arguments[0];return e.get(0).getFactory().buildGeometry(e).buffer(0)}if(2===arguments.length){var i=arguments[0],h=arguments[1];return i.getFactory().createGeometryCollection([i,h]).buffer(0)}},Io.prototype.interfaces_=function(){return[]},Io.prototype.getClass=function(){return Io},Io.restrictToPolygons=function(e){if(Ie(e,qn))return e;var i=Ea.getPolygons(e);return 1===i.size()?i.get(0):e.getFactory().createMultiPolygon(xn.toPolygonArray(i))},Io.getGeometry=function(e,i){return i>=e.size()?null:e.get(i)},Io.union=function(e){return new Io(e).union()},iu.STRTREE_NODE_CAPACITY.get=function(){return 4},Object.defineProperties(Io,iu);var nl=function(){};nl.prototype.interfaces_=function(){return[]},nl.prototype.getClass=function(){return nl},nl.union=function(e,i){if(e.isEmpty()||i.isEmpty()){if(e.isEmpty()&&i.isEmpty())return dn.createEmptyResult(dn.UNION,e,i,e.getFactory());if(e.isEmpty())return i.copy();if(i.isEmpty())return e.copy()}return e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(i),Xa.overlayOp(e,i,dn.UNION)},St.GeoJSONReader=oe,St.GeoJSONWriter=Se,St.OverlayOp=dn,St.UnionOp=nl,St.BufferOp=Bo,Object.defineProperty(St,"__esModule",{value:!0})}(he)}}]);
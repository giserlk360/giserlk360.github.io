import{U as F,r as h,A as x,o as N,a as V,b as y,e as I,a1 as B,h as O,g as S,f as v,k as u,K as g,a2 as E,D as L,a3 as P,a4 as R}from"./index-e9689063.js";import{_ as w}from"./_plugin-vue_export-helper-c4cb8a60.js";import{M as T}from"./index-90a973b9.js";import{B as D}from"./index-a9809549.js";import{F as J,a as z}from"./index-169e9de4.js";import"./index-8de522e4.js";import{I as A}from"./index-5243bea0.js";import"./pick-8ec4d301.js";import"./index-3eb6fbb9.js";import"./index-0e2598a5.js";import"./index-b9249fbe.js";import"./use-cursor-93a49f50.js";const M=F("svgmap",()=>{let p=h("./svg/320000.svg"),e=h({bounds:[[115.564327,29.942059],[122.821885,35.554538]],dimensions:[809,754],data:[{name:"\u5357\u4EAC",value:[118.7794,32.0395]},{name:"\u82CF\u5DDE",value:[120.5905,31.3094]},{name:"\u5357\u901A",value:[120.89,32.0049]}]});function l(r){p.value=r}function o(r){e.value=r}function _(r){e.value.dimensions=r}return{svgUrl:p,updateSvgUrl:l,pointConfig:e,updatePointConfig:o,updateSvgDimensions:_}});const $={__name:"EchartsSvg",setup(p){const e=M(),l=h(),o=h(),_=async(t,a)=>{try{const n=await fetch(a);if(n.status==200){const b=await n.text();return B(t,{svg:b}),!0}else T.error("\u65E0\u5730\u56FE\u8D44\u6E90\uFF01\uFF01\uFF01")}catch(n){return console.log(n),!1}},r=async()=>{const t=e.svgUrl;o.value=i(),await _(o.value.geo.map,t)&&d()},i=()=>({geo:{left:0,top:0,right:0,bottom:0,map:"svgMap",roam:!0,layoutCenter:["50%","50%"],layoutSize:"100%",itemStyle:{borderWidth:0,color:"transparent"},select:{label:{show:!0,color:"#fff",fontSize:12},itemStyle:{color:"#ffff33",borderColor:"#ebc11e",borderWidth:4}},label:{show:!1},emphasis:{focus:"none",itemStyle:{areaColor:"#2080D7",borderColor:"#2B91B7",borderWidth:2,opacity:1,shadowColor:"rgba(74, 188, 251, 0.4)",shadowBlur:3,shadowOffsetX:3,shadowOffsetY:5},label:{show:!1,color:"#fff",fontSize:12}},tooltip:{show:!0,padding:0,formatter:function(t){return t.name}}},tooltip:{show:!0},series:[{type:"scatter",coordinateSystem:"geo",geoIndex:0,data:[]}]}),c=()=>{var t;(t=l.value)==null||t.setOption(o.value,!0)},s=t=>{const a=e.pointConfig.bounds[0],n=e.pointConfig.bounds[1],b=e.pointConfig.dimensions[0],C=e.pointConfig.dimensions[1],k=b/(n[0]-a[0]),U=C/(n[1]-a[1]);return f(t,n,a,U,k)},f=(t,a,n,b,C)=>[Math.abs(t[0]-n[0])*C,Math.abs(t[1]-a[1])*b],d=()=>{const a=e.pointConfig.data.map(n=>({name:n.name,value:s(n.value),symbol:"image://imgs/point.png",symbolSize:[35,35]}));o.value.series[0].data=a,c()},m=t=>{const a=[t.event.offsetX,t.event.offsetY],n=l.value.convertFromPixel({geoIndex:0},a);console.log("\u{1F680} ~ clickMap ~ dataPoint:",n)};return x(()=>e.svgUrl,()=>{r()}),x(()=>e.pointConfig,()=>{d()},{immediate:!1,deep:!0}),N(()=>{r()}),(t,a)=>{const n=V("v-chart");return y(),I(n,{ref_key:"svgMapRef",ref:l,autoresize:"",class:"map-content",onClick:m},null,512)}}},G=w($,[["__scopeId","data-v-eed71dd9"]]);const X={class:"tools"},j={__name:"Tools",setup(p){const e=M(),l=h(null),o=i=>{const c=i.target.files[0];if(!c)return;const s=new FileReader;s.onload=f=>{console.log("\u{1F680} ~ uploadFile ~ e:",f);const d=URL.createObjectURL(new Blob([f.target.result]));console.log("\u{1F680} ~ uploadFile ~ url:",d),e.updateSvgUrl(d),r(d),window.addEventListener("beforeunload",function(){URL.revokeObjectURL(d)})},s.readAsText(c)},_=()=>{l.value.click()},r=i=>{var c=document.createElementNS("http://www.w3.org/2000/svg","svg"),s=new XMLHttpRequest;s.open("GET",i,!0),s.onreadystatechange=function(){if(s.readyState==4&&s.status==200){c.innerHTML=s.responseText;var f=c.querySelector("svg"),d=f.getAttribute("width"),m=f.getAttribute("height"),t=parseFloat(d),a=parseFloat(m);e.updateSvgDimensions([t,a]),console.log(e.pointConfig),console.log("SVG \u5BBD\u5EA6: "+t),console.log("SVG \u9AD8\u5EA6: "+a)}},s.send()};return(i,c)=>(y(),O("div",X,[S("div",{class:"btn-group"},[S("div",{class:"btn",onClick:_},"\u4E0A\u4F20svg")]),S("input",{ref_key:"fileInput",ref:l,type:"file",accept:".svg",style:{display:"none"},onChange:o},null,544)]))}},W=w(j,[["__scopeId","data-v-bd826853"]]);const Y=p=>(P("data-v-27298754"),p=p(),R(),p),q=Y(()=>S("div",{class:"title"},"\u7ECF\u7EAC\u5EA6\u6253\u70B9",-1)),H={__name:"PointsInfo",setup(p){const e=M(),l={autorefresh:!0,smartIndent:!0,tabSize:4,mode:"application/json",theme:"dracula",matchBrackets:!0,lineWrapping:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter","CodeMirror-lint-markers"],lint:!1,lineNumbers:!0,indentUnit:2,foldGutter:!0,styleActiveLine:!0},o=h({bounds:JSON.stringify(e.pointConfig.bounds),dimensions:JSON.stringify(e.pointConfig.dimensions),data:JSON.stringify(e.pointConfig.data,null,2)}),_=()=>{console.log(o);const r={...o.value};e.updatePointConfig({bounds:JSON.parse(r.bounds),dimensions:JSON.parse(r.dimensions),data:JSON.parse(r.data)})};return x(()=>e.pointConfig.dimensions,()=>{o.value.dimensions=JSON.stringify(e.pointConfig.dimensions)}),(r,i)=>{const c=A,s=z,f=D,d=J;return y(),I(d,{model:g(o),class:"formLayout",onSubmit:_},{default:v(()=>[q,u(s,{field:"bounds",label:"\u56DB\u81F3\u8303\u56F4"},{default:v(()=>[u(c,{modelValue:g(o).bounds,"onUpdate:modelValue":i[0]||(i[0]=m=>g(o).bounds=m),placeholder:"\u8BF7\u8F93\u5165\u56DB\u81F3\u8303\u56F4[[\u5DE6\u4E0B\u89D2\u7ECF\u7EAC\u5EA6], [\u53F3\u4E0A\u89D2\u7ECF\u7EAC\u5EA6]]"},null,8,["modelValue"])]),_:1}),u(s,{field:"dimensions",label:"svg\u5C3A\u5BF8"},{default:v(()=>[u(c,{modelValue:g(o).dimensions,"onUpdate:modelValue":i[1]||(i[1]=m=>g(o).dimensions=m),placeholder:"\u8BF7\u8F93\u5165svg\u5C3A\u5BF8[\u5BBD, \u9AD8]"},null,8,["modelValue"])]),_:1}),u(s,{field:"data",label:"\u70B9\u6570\u636E"},{default:v(()=>[u(g(E),{value:g(o).data,"onUpdate:value":i[2]||(i[2]=m=>g(o).data=m),options:l,height:300},null,8,["value"])]),_:1}),u(s,null,{default:v(()=>[u(f,{"html-type":"submit",onClick:_},{default:v(()=>[L("\u786E\u5B9A")]),_:1})]),_:1})]),_:1},8,["model"])}}},K=w(H,[["__scopeId","data-v-27298754"]]);const Q={class:"mapView w-full min-h-[calc(100vh-58px)]"},Z={__name:"index",setup(p){return(e,l)=>(y(),O("div",Q,[u(G),u(W),u(K)]))}},pe=w(Z,[["__scopeId","data-v-2baf9efd"]]);export{pe as default};

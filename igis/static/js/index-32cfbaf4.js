import{m as Ge,n as Ue,p as Ye,q as qe,a as fe,g as Ke,h as Xe,r as Ze,t as Je,o as q,v as Qe,b as de,s as Re,d as et}from"./use-popup-manager-fc119641.js";import{r as b,o as W,Z as X,d as Z,A as V,Y as Pe,t as tt,c as B,z as ce,p as lt,m as ot,_ as nt,k as g,$ as rt,u as at,T as st,G as it,H as ut,F as ft,O as he}from"./index-2b249113.js";import{i as Se,o as dt}from"./index-32f7bee3.js";const pe=typeof window>"u"?global:window,ct=pe.requestAnimationFrame,ve=pe.cancelAnimationFrame;function me(e){let t=0;const l=(...n)=>{t&&ve(t),t=ct(()=>{e(...n),t=0})};return l.cancel=()=>{ve(t),t=0},l}var ht=Object.defineProperty,be=Object.getOwnPropertySymbols,vt=Object.prototype.hasOwnProperty,mt=Object.prototype.propertyIsEnumerable,we=(e,t,l)=>t in e?ht(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l,F=(e,t)=>{for(var l in t||(t={}))vt.call(t,l)&&we(e,l,t[l]);if(be)for(var l of be(t))mt.call(t,l)&&we(e,l,t[l]);return e};const bt=()=>{const{height:e,width:t}=Ue();return{width:Math.min(t,window.innerWidth),height:Math.min(e,window.innerHeight)}},ye=(e,t)=>{var l,n;const r=e.getBoundingClientRect();return{top:r.top,bottom:r.bottom,left:r.left,right:r.right,scrollTop:r.top-t.top,scrollBottom:r.bottom-t.top,scrollLeft:r.left-t.left,scrollRight:r.right-t.left,width:(l=e.offsetWidth)!=null?l:e.clientWidth,height:(n=e.offsetHeight)!=null?n:e.clientHeight}},wt=e=>{switch(e){case"top":case"tl":case"tr":return"top";case"bottom":case"bl":case"br":return"bottom";case"left":case"lt":case"lb":return"left";case"right":case"rt":case"rb":return"right";default:return"top"}},D=(e,t)=>{switch(t){case"top":switch(e){case"bottom":return"top";case"bl":return"tl";case"br":return"tr";default:return e}case"bottom":switch(e){case"top":return"bottom";case"tl":return"bl";case"tr":return"br";default:return e}case"left":switch(e){case"right":return"left";case"rt":return"lt";case"rb":return"lb";default:return e}case"right":switch(e){case"left":return"right";case"lt":return"rt";case"lb":return"rb";default:return e}default:return e}},yt=(e,t,{containerRect:l,triggerRect:n,popupRect:r,offset:i,translate:s})=>{const f=wt(e),u=bt(),d={top:l.top+t.top,bottom:u.height-(l.top+t.top+r.height),left:l.left+t.left,right:u.width-(l.left+t.left+r.width)};let c=e;if(f==="top"&&d.top<0)if(n.top>r.height)t.top=-l.top;else{const v=x("bottom",n,r,{offset:i,translate:s});u.height-(l.top+v.top+r.height)>0&&(c=D(e,"bottom"),t.top=v.top)}if(f==="bottom"&&d.bottom<0)if(u.height-n.bottom>r.height)t.top=-l.top+(u.height-r.height);else{const v=x("top",n,r,{offset:i,translate:s});l.top+v.top>0&&(c=D(e,"top"),t.top=v.top)}if(f==="left"&&d.left<0)if(n.left>r.width)t.left=-l.left;else{const v=x("right",n,r,{offset:i,translate:s});u.width-(l.left+v.left+r.width)>0&&(c=D(e,"right"),t.left=v.left)}if(f==="right"&&d.right<0)if(u.width-n.right>r.width)t.left=-l.left+(u.width-r.width);else{const v=x("left",n,r,{offset:i,translate:s});l.left+v.left>0&&(c=D(e,"left"),t.left=v.left)}return(f==="top"||f==="bottom")&&(d.left<0?t.left=-l.left:d.right<0&&(t.left=-l.left+(u.width-r.width))),(f==="left"||f==="right")&&(d.top<0?t.top=-l.top:d.bottom<0&&(t.top=-l.top+(u.height-r.height))),{popupPosition:t,position:c}},x=(e,t,l,{offset:n=0,translate:r=[0,0]}={})=>{var i;const s=(i=Ge(r)?r:r[e])!=null?i:[0,0];switch(e){case"top":return{left:t.scrollLeft+Math.round(t.width/2)-Math.round(l.width/2)+s[0],top:t.scrollTop-l.height-n+s[1]};case"tl":return{left:t.scrollLeft+s[0],top:t.scrollTop-l.height-n+s[1]};case"tr":return{left:t.scrollRight-l.width+s[0],top:t.scrollTop-l.height-n+s[1]};case"bottom":return{left:t.scrollLeft+Math.round(t.width/2)-Math.round(l.width/2)+s[0],top:t.scrollBottom+n+s[1]};case"bl":return{left:t.scrollLeft+s[0],top:t.scrollBottom+n+s[1]};case"br":return{left:t.scrollRight-l.width+s[0],top:t.scrollBottom+n+s[1]};case"left":return{left:t.scrollLeft-l.width-n+s[0],top:t.scrollTop+Math.round(t.height/2)-Math.round(l.height/2)+s[1]};case"lt":return{left:t.scrollLeft-l.width-n+s[0],top:t.scrollTop+s[1]};case"lb":return{left:t.scrollLeft-l.width-n+s[0],top:t.scrollBottom-l.height+s[1]};case"right":return{left:t.scrollRight+n+s[0],top:t.scrollTop+Math.round(t.height/2)-Math.round(l.height/2)+s[1]};case"rt":return{left:t.scrollRight+n+s[0],top:t.scrollTop+s[1]};case"rb":return{left:t.scrollRight+n+s[0],top:t.scrollBottom-l.height+s[1]};default:return{left:0,top:0}}},gt=e=>{let t="0";["top","bottom"].includes(e)?t="50%":["left","lt","lb","tr","br"].includes(e)&&(t="100%");let l="0";return["left","right"].includes(e)?l="50%":["top","tl","tr","lt","rt"].includes(e)&&(l="100%"),`${t} ${l}`},Ct=(e,t,l,n,{offset:r=0,translate:i=[0,0],customStyle:s={},autoFitPosition:f=!1}={})=>{let u=e,d=x(e,l,n,{offset:r,translate:i});if(f){const v=yt(e,d,{containerRect:t,popupRect:n,triggerRect:l,offset:r,translate:i});d=v.popupPosition,u=v.position}return{style:F({left:`${d.left}px`,top:`${d.top}px`},s),position:u}},Ot=(e,t,l,{customStyle:n={}})=>{if(["top","tl","tr","bottom","bl","br"].includes(e)){let i=Math.abs(t.scrollLeft+t.width/2-l.scrollLeft);return i>l.width-8&&(t.width>l.width?i=l.width/2:i=l.width-8),["top","tl","tr"].includes(e)?F({left:`${i}px`,bottom:"0",transform:"translate(-50%,50%) rotate(45deg)"},n):F({left:`${i}px`,top:"0",transform:"translate(-50%,-50%) rotate(45deg)"},n)}let r=Math.abs(t.scrollTop+t.height/2-l.scrollTop);return r>l.height-8&&(t.height>l.height?r=l.height/2:r=l.height-8),["left","lt","lb"].includes(e)?F({top:`${r}px`,right:"0",transform:"translate(50%,-50%) rotate(45deg)"},n):F({top:`${r}px`,left:"0",transform:"translate(-50%,-50%) rotate(45deg)"},n)},Tt=e=>e.scrollHeight>e.offsetHeight||e.scrollWidth>e.offsetWidth,ge=e=>{var t;const l=[];let n=e;for(;n&&n!==document.documentElement;)Tt(n)&&l.push(n),n=(t=n.parentElement)!=null?t:void 0;return l},Ee=()=>{const e={},t=b(),l=()=>{const n=Ye(e.value);n!==t.value&&(t.value=n)};return W(()=>l()),X(()=>l()),{children:e,firstElement:t}};var Ce=Z({name:"ResizeObserver",props:{watchOnUpdated:Boolean},emits:["resize"],setup(e,{emit:t,slots:l}){const{children:n,firstElement:r}=Ee();let i;const s=u=>{!u||(i=new Se(d=>{const c=d[0];t("resize",c)}),i.observe(u))},f=()=>{i&&(i.disconnect(),i=null)};return V(r,u=>{i&&f(),u&&s(u)}),Pe(()=>{i&&f()}),()=>{var u;return n.value=(u=l.default)==null?void 0:u.call(l),n.value}}});function _t(e,t){const l=b(e[t]);return X(()=>{const n=e[t];l.value!==n&&(l.value=n)}),l}const Oe=Symbol("ArcoTrigger"),Pt=({elementRef:e,onResize:t})=>{let l;return{createResizeObserver:()=>{!e.value||(l=new Se(i=>{const s=i[0];qe(t)&&t(s)}),l.observe(e.value))},destroyResizeObserver:()=>{l&&(l.disconnect(),l=null)}}};var St=Z({name:"ClientOnly",setup(e,{slots:t}){const l=b(!1);return W(()=>l.value=!0),()=>{var n;return l.value?(n=t.default)==null?void 0:n.call(t):null}}});const pt=({popupContainer:e,visible:t,defaultContainer:l="body",documentContainer:n})=>{const r=b(e.value),i=b(),s=()=>{const f=fe(e.value),u=f?e.value:l,d=f!=null?f:n?document.documentElement:fe(l);u!==r.value&&(r.value=u),d!==i.value&&(i.value=d)};return W(()=>s()),V(t,f=>{r.value!==e.value&&f&&s()}),{teleportContainer:r,containerRef:i}};var Et=Object.defineProperty,Mt=Object.defineProperties,Bt=Object.getOwnPropertyDescriptors,Te=Object.getOwnPropertySymbols,Ft=Object.prototype.hasOwnProperty,xt=Object.prototype.propertyIsEnumerable,_e=(e,t,l)=>t in e?Et(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l,Lt=(e,t)=>{for(var l in t||(t={}))Ft.call(t,l)&&_e(e,l,t[l]);if(Te)for(var l of Te(t))xt.call(t,l)&&_e(e,l,t[l]);return e},zt=(e,t)=>Mt(e,Bt(t));const At=["onClick","onMouseenter","onMouseleave","onFocusin","onFocusout","onContextmenu"];var K=Z({name:"Trigger",inheritAttrs:!1,props:{popupVisible:{type:Boolean,default:void 0},defaultPopupVisible:{type:Boolean,default:!1},trigger:{type:[String,Array],default:"hover"},position:{type:String,default:"bottom"},disabled:{type:Boolean,default:!1},popupOffset:{type:Number,default:0},popupTranslate:{type:[Array,Object]},showArrow:{type:Boolean,default:!1},alignPoint:{type:Boolean,default:!1},popupHoverStay:{type:Boolean,default:!0},blurToClose:{type:Boolean,default:!0},clickToClose:{type:Boolean,default:!0},clickOutsideToClose:{type:Boolean,default:!0},unmountOnClose:{type:Boolean,default:!0},contentClass:{type:[String,Array,Object]},contentStyle:{type:Object},arrowClass:{type:[String,Array,Object]},arrowStyle:{type:Object},popupStyle:{type:Object},animationName:{type:String,default:"fade-in"},duration:{type:[Number,Object]},mouseEnterDelay:{type:Number,default:100},mouseLeaveDelay:{type:Number,default:100},focusDelay:{type:Number,default:0},autoFitPopupWidth:{type:Boolean,default:!1},autoFitPopupMinWidth:{type:Boolean,default:!1},autoFixPosition:{type:Boolean,default:!0},popupContainer:{type:[String,Object]},updateAtScroll:{type:Boolean,default:!1},autoFitTransformOrigin:{type:Boolean,default:!1},hideEmpty:{type:Boolean,default:!1},openedClass:{type:[String,Array,Object]},autoFitPosition:{type:Boolean,default:!0},renderToBody:{type:Boolean,default:!0},preventFocus:{type:Boolean,default:!1},scrollToClose:{type:Boolean,default:!1},scrollToCloseDistance:{type:Number,default:0}},emits:{"update:popupVisible":e=>!0,popupVisibleChange:e=>!0,show:()=>!0,hide:()=>!0,resize:()=>!0},setup(e,{emit:t,slots:l,attrs:n}){const{popupContainer:r}=tt(e),i=Ke("trigger"),s=B(()=>dt(n,At)),f=ce(Xe,void 0),u=B(()=>[].concat(e.trigger)),d=new Set,c=ce(Oe,void 0),{children:v,firstElement:E}=Ee(),P=b(),J=b(e.defaultPopupVisible),L=b(e.position),Q=b({}),R=b({}),ee=b({}),Me=b(),C=b({top:0,left:0});let z=null,A=null;const h=B(()=>{var o;return(o=e.popupVisible)!=null?o:J.value}),{teleportContainer:Be,containerRef:k}=pt({popupContainer:r,visible:h,documentContainer:!0}),{zIndex:Fe}=Ze("popup",{visible:h});let M=0,O=!1,N=!1;const xe=()=>{M&&(window.clearTimeout(M),M=0)},I=o=>{if(e.alignPoint){const{pageX:a,pageY:m}=o;C.value={top:m,left:a}}},T=()=>{if(!E.value||!P.value||!k.value)return;const o=k.value.getBoundingClientRect(),a=e.alignPoint?{top:C.value.top,bottom:C.value.top,left:C.value.left,right:C.value.left,scrollTop:C.value.top,scrollBottom:C.value.top,scrollLeft:C.value.left,scrollRight:C.value.left,width:0,height:0}:ye(E.value,o),m=()=>ye(P.value,o),S=m(),{style:_,position:p}=Ct(e.position,o,a,S,{offset:e.popupOffset,translate:e.popupTranslate,customStyle:e.popupStyle,autoFitPosition:e.autoFitPosition});e.autoFitTransformOrigin&&(R.value={transformOrigin:gt(p)}),e.autoFitPopupMinWidth?_.minWidth=`${a.width}px`:e.autoFitPopupWidth&&(_.width=`${a.width}px`),L.value!==p&&(L.value=p),Q.value=_,e.showArrow&&he(()=>{ee.value=Ot(p,a,m(),{customStyle:e.arrowStyle})})},w=(o,a)=>{if(o===h.value&&M===0)return;const m=()=>{J.value=o,t("update:popupVisible",o),t("popupVisibleChange",o),o&&he(()=>{T()})};o||(z=null,A=null),a?(xe(),o!==h.value&&(M=window.setTimeout(m,a))):m()},Le=o=>{var a;(a=n.onClick)==null||a.call(n,o),!(e.disabled||h.value&&!e.clickToClose)&&(u.value.includes("click")?(I(o),w(!h.value)):u.value.includes("contextMenu")&&h.value&&w(!1))},te=o=>{var a;(a=n.onMouseenter)==null||a.call(n,o),!(e.disabled||!u.value.includes("hover"))&&(I(o),w(!0,e.mouseEnterDelay))},le=o=>{c==null||c.onMouseenter(o),te(o)},oe=o=>{var a;(a=n.onMouseleave)==null||a.call(n,o),!(e.disabled||!u.value.includes("hover"))&&w(!1,e.mouseLeaveDelay)},ne=o=>{c==null||c.onMouseleave(o),oe(o)},ze=o=>{var a;(a=n.onFocusin)==null||a.call(n,o),!(e.disabled||!u.value.includes("focus"))&&w(!0,e.focusDelay)},Ae=o=>{var a;(a=n.onFocusout)==null||a.call(n,o),!(e.disabled||!u.value.includes("focus"))&&(!e.blurToClose||w(!1))},$e=o=>{var a;(a=n.onContextmenu)==null||a.call(n,o),!(e.disabled||!u.value.includes("contextMenu")||h.value&&!e.clickToClose)&&(I(o),w(!h.value),o.preventDefault())};lt(Oe,ot({onMouseenter:le,onMouseleave:ne,addChildRef:o=>{d.add(o),c==null||c.addChildRef(o)},removeChildRef:o=>{d.delete(o),c==null||c.removeChildRef(o)}}));const H=()=>{de(document.documentElement,"mousedown",G),O=!1},re=_t(l,"content"),je=B(()=>{var o;return e.hideEmpty&&Je((o=re.value)==null?void 0:o.call(re))}),G=o=>{var a,m,S;if(!(((a=E.value)==null?void 0:a.contains(o.target))||((m=P.value)==null?void 0:m.contains(o.target)))){for(const _ of d)if((S=_.value)!=null&&S.contains(o.target))return;H(),w(!1)}},ae=(o,a)=>{const[m,S]=o,{scrollTop:_,scrollLeft:p}=a;return Math.abs(_-m)>=e.scrollToCloseDistance||Math.abs(p-S)>=e.scrollToCloseDistance},$=me(o=>{if(h.value)if(e.scrollToClose||(f==null?void 0:f.scrollToClose)){const a=o.target;z||(z=[a.scrollTop,a.scrollLeft]),ae(z,a)?w(!1):T()}else T()}),se=()=>{de(window,"scroll",ie),N=!1},ie=me(o=>{const a=o.target.documentElement;A||(A=[a.scrollTop,a.scrollLeft]),ae(A,a)&&(w(!1),se())}),U=()=>{h.value&&T()},De=()=>{U(),t("resize")},Ve=o=>{e.preventFocus&&o.preventDefault()};c==null||c.addChildRef(P);const We=B(()=>h.value?e.openedClass:void 0);let y;V(h,o=>{if(e.clickOutsideToClose&&(!o&&O?H():o&&!O&&(q(document.documentElement,"mousedown",G),O=!0)),(e.scrollToClose||(f==null?void 0:f.scrollToClose))&&(q(window,"scroll",ie),N=!0),e.updateAtScroll||(f==null?void 0:f.updateAtScroll)){if(o){y=ge(E.value);for(const a of y)a.addEventListener("scroll",$)}else if(y){for(const a of y)a.removeEventListener("scroll",$);y=void 0}}o&&(Y.value=!0)}),V(()=>[e.autoFitPopupWidth,e.autoFitPopupMinWidth],()=>{h.value&&T()});const{createResizeObserver:ke,destroyResizeObserver:Ne}=Pt({elementRef:k,onResize:U});W(()=>{if(ke(),h.value&&(T(),e.clickOutsideToClose&&!O&&(q(document.documentElement,"mousedown",G),O=!0),e.updateAtScroll||(f==null?void 0:f.updateAtScroll))){y=ge(E.value);for(const o of y)o.addEventListener("scroll",$)}}),X(()=>{h.value&&T()}),nt(()=>{w(!1)}),Pe(()=>{if(c==null||c.removeChildRef(P),Ne(),O&&H(),N&&se(),y){for(const o of y)o.removeEventListener("scroll",$);y=void 0}});const Y=b(h.value),j=b(!1),ue=()=>{j.value=!0},Ie=()=>{j.value=!1,h.value&&t("show")},He=()=>{j.value=!1,h.value||(Y.value=!1,t("hide"))};return()=>{var o,a;return v.value=(a=(o=l.default)==null?void 0:o.call(l))!=null?a:[],Qe(v.value,{class:We.value,onClick:Le,onMouseenter:te,onMouseleave:oe,onFocusin:ze,onFocusout:Ae,onContextmenu:$e}),g(ft,null,[e.autoFixPosition?g(Ce,{onResize:De},{default:()=>[v.value]}):v.value,g(St,null,{default:()=>[g(rt,{to:Be.value,disabled:!e.renderToBody},{default:()=>[(!e.unmountOnClose||h.value||Y.value)&&!je.value&&g(Ce,{onResize:U},{default:()=>[g("div",at({ref:P,class:[`${i}-popup`,`${i}-position-${L.value}`],style:zt(Lt({},Q.value),{zIndex:Fe.value,pointerEvents:j.value?"none":"auto"}),"trigger-placement":L.value,onMouseenter:le,onMouseleave:ne,onMousedown:Ve},s.value),[g(st,{name:e.animationName,duration:e.duration,appear:!0,onBeforeEnter:ue,onAfterEnter:Ie,onBeforeLeave:ue,onAfterLeave:He},{default:()=>{var m;return[it(g("div",{class:`${i}-popup-wrapper`,style:R.value},[g("div",{class:[`${i}-content`,e.contentClass],style:e.contentStyle},[(m=l.content)==null?void 0:m.call(l)]),e.showArrow&&g("div",{ref:Me,class:[`${i}-arrow`,e.arrowClass],style:ee.value},null)]),[[ut,h.value]])]}})])]})]})]})])}}});const kt=Object.assign(K,{install:(e,t)=>{Re(e,t);const l=et(t);e.component(l+K.name,K)}});export{Ce as R,kt as T,me as t,_t as u};
